{"version":3,"sources":["tonva/index.ts","tonva/components/index.ts","tonva/net/guestApi.ts","tonva/net/caller.ts","tonva/components/nav.tsx","tonva/net/netToken.ts","tonva/components/fetchErrorView.tsx","tonva/components/reloadPage.tsx","tonva/tool/cacheIds.ts","tonva/tool/local.ts","tonva/tool/getObjPropIgnoreCase.ts","tonva/components/page/pageHeader.tsx","tonva/components/page/page.tsx","tonva/net/appBridge.ts","tonva/uq/caller.ts","tonva/uq/entity.ts","tonva/components/edit/itemEdit.tsx","tonva/net/httpChannel.ts","tonva/net/httpChannelUI.ts","tonva/net/uqApi.ts","tonva/res/res.ts","tonva/vm/controller.tsx","tonva/vm/view.tsx","tonva/vm/vpage.tsx","tonva/tool/uid.ts","tonva/uq/index.ts","tonva/uq/query.ts","tonva/net/wsChannel.ts","tonva/components/image.tsx","tonva/tool/user.ts","tonva/net/host.ts","tonva/uq/action.ts","tonva/components/simple/LMR.tsx","tonva/components/simple/Badge.tsx","tonva/components/simple/FA.tsx","tonva/components/simple/IconText.tsx","tonva/components/simple/Muted.tsx","tonva/tool/localDb.ts","tonva/uq/tuid/reactBoxId.tsx","tonva/components/page/scrollView.tsx","tonva/components/loading.tsx","tonva/tool/env.ts","tonva/uq/tuid/index.ts","tonva/net/apiBase.ts","tonva/components/edit/imageItemEdit.tsx","tonva/res/formRes.ts","tonva/res/listRes.ts","tonva/res/entry/login.ts","tonva/res/entry/register.ts","tonva/tool/pageItems.ts","tonva/net/messageHub.ts","tonva/components/navigo.ts","tonva/components/page/tabs.tsx","tonva/components/resUploader.tsx","tonva/uq/uqMan.ts","tonva/uq/sheet.ts","tonva/uq/book.ts","tonva/uq/history.ts","tonva/uq/map.ts","tonva/uq/pending.ts","tonva/uq/tag/tagView.tsx","tonva/uq/tag/tag.ts","tonva/components/page/index.ts","tonva/components/schema/index.ts","tonva/components/rules/index.ts","tonva/components/dropDownActions/index.tsx","tonva/components/easyDate/index.tsx","tonva/components/media.tsx","tonva/components/searchBox.tsx","tonva/components/userIcon.tsx","tonva/uq/tuid/tuidsCache.ts","tonva/uq/uqsMan.ts","tonva/components/form/rules/index.ts","tonva/components/form/widgets/widget.tsx","tonva/components/form/widgets/textWidget.tsx","tonva/components/form/widgets/textareaWidget.tsx","tonva/components/form/widgets/passwordWidget.tsx","tonva/components/form/widgets/numberWidget.tsx","tonva/components/form/widgets/updownWidget.tsx","tonva/components/form/widgets/dateWidget.tsx","tonva/components/form/widgets/checkBoxWidget.tsx","tonva/components/form/widgets/selectWidget.tsx","tonva/components/form/widgets/radioWidget.tsx","tonva/components/form/widgets/rangeWidget.tsx","tonva/components/form/widgets/idWidget.tsx","tonva/components/form/widgets/unknown.tsx","tonva/components/form/widgets/buttonWidget.tsx","tonva/components/form/context.tsx","tonva/components/form/widgets/arrComponent.tsx","tonva/components/form/widgets/imageWidget.tsx","tonva/components/form/widgets/tagWidget.tsx","tonva/components/form/widgets/factory.tsx","tonva/components/form/form.tsx","tonva/components/form/field.tsx","tonva/components/edit/stringItemEdit.tsx","tonva/components/edit/radioItemEdit.tsx","tonva/components/edit/selectItemEdit.tsx","tonva/components/edit/idItemEdit.tsx","tonva/components/edit/tagItemEdit.tsx","tonva/components/edit/textAreaItemEdit.tsx","tonva/components/edit/edit.tsx","tonva/app/centerApi.ts","tonva/app/vMain.tsx","tonva/app/CAppBase.ts","tonva/app/start.ts","tonva/app/CBase.ts","tonva/components/list/base.tsx","tonva/components/list/clickable.tsx","tonva/components/list/static.tsx","tonva/components/list/selectable.tsx","tonva/components/list/index.tsx","tonva/components/propGrid/row.tsx","tonva/components/propGrid/propView.tsx","tonva/components/propGrid/PropGrid.tsx","tonva/uq/tuid/idCache.ts","tonva/uq/tuid/tuid.ts","tonva/entry/meInfo.tsx","serviceWorker.ts","tapp/appConfig.ts","tapp/appName.ts","tapp/CBase.ts","tapp/main.tsx","notes/model.ts","notes/views/VBasePage.tsx","notes/views/VSelectContact.tsx","notes/views/VNotesDropDown.tsx","notes/noteBase/CNoteBase.tsx","notes/noteBase/VNoteBase.tsx","notes/noteBase/VNoteBaseDir.tsx","notes/noteBase/VNoteBaseEdit.tsx","notes/noteBase/VNoteBaseForm.tsx","notes/noteBase/VNoteBaseView.tsx","tool/none.tsx","notes/noteBase/VRelativesBase.tsx","notes/components/content/CContent.ts","notes/components/content/checkable/VBase.tsx","notes/components/content/checkable/VView.tsx","notes/components/content/checkable/VItem.tsx","notes/components/content/ListInputBase.tsx","notes/components/content/checkable/CheckableListInput.tsx","notes/components/content/checkable/CCheckable.ts","notes/components/content/list/VView.tsx","notes/components/content/list/ListInput.tsx","notes/components/content/list/CList.ts","notes/components/content/textBase/CTextBase.ts","notes/components/content/textBase/VTextBaseView.tsx","notes/components/content/textBase/VTextBaseInput.tsx","notes/components/content/text/VInput.tsx","notes/components/content/text/VView.tsx","notes/components/content/text/CText.ts","notes/components/content/folder/VInput.tsx","notes/components/content/folder/VView.tsx","notes/components/content/folder/CFolder.ts","notes/components/to/VSent.tsx","notes/components/to/VTo.tsx","notes/components/to/CTo.ts","notes/components/renderParagraphs.tsx","notes/container/views/VFolder.tsx","notes/container/views/VFolderDir.tsx","notes/container/views/VFolderRelatives.tsx","notes/container/views/VFolderView.tsx","notes/container/CContainer.ts","notes/container/space/VSpaceDir.tsx","notes/container/space/VSpaceMembers.tsx","notes/container/space/VSpaceView.tsx","notes/container/views/VContainerForm.tsx","notes/container/space/VSpaceEdit.tsx","notes/container/space/VContentView.tsx","notes/container/space/VContacts.tsx","notes/container/space/VSpaceAdd.tsx","notes/container/space/CSpace.ts","notes/container/CFolder.ts","notes/container/folderMy/VFolderMyEdit.tsx","notes/container/folderMy/VFolderMyAdd.tsx","notes/container/folderMy/VFolderMyView.tsx","notes/container/folderMy/VFolderMy.tsx","notes/container/folderMy/CFolderMy.ts","notes/container/folderShare/VFolderShare.tsx","notes/container/folderShare/CFolderShare.ts","notes/container/folderRoot/CFolderRoot.ts","notes/container/unitNote/VUnitNoteDir.tsx","notes/container/unitNote/CUnitNote.ts","notes/note/components/comments/VCommentsList.tsx","notes/note/task/TaskState.ts","notes/note/components/comments/VAddComment.tsx","notes/note/components/comments/VWriteComment.tsx","notes/note/components/comments/CComments.ts","notes/note/CNote.ts","notes/note/views/VRelativesNoteBase.tsx","notes/note/assign/VAssignRelatives.tsx","notes/note/assign/VAssignView.tsx","notes/note/assign/VAssignEdit.tsx","notes/note/assign/VAssignAdd.tsx","notes/note/assign/VAssignDir.tsx","notes/components/selectContact/VSelectContact.tsx","notes/components/selectContact/CSelectContact.ts","notes/note/assign/VAssignParams.tsx","notes/note/assign/CAssignTo.ts","notes/note/assign/CNoteAssign.ts","notes/note/text/VTextRelatives.tsx","notes/note/text/VTextHeader.tsx","notes/note/text/VTextView.tsx","notes/note/text/VTextEdit.tsx","notes/note/text/VTextAdd.tsx","notes/note/text/VTextDir.tsx","notes/note/text/CNoteText.ts","notes/note/task/content/VBase.tsx","notes/note/task/content/VView.tsx","notes/note/task/content/VItem.tsx","notes/note/task/content/CTaskContent.ts","notes/note/task/CNoteTask.ts","notes/note/task/VTaskRelatives.tsx","notes/note/task/VTaskView.tsx","notes/note/task/start/VTaskStart.tsx","notes/note/task/start/CTaskStart.ts","notes/note/task/done/VTaskDone.tsx","notes/note/task/done/CTaskDone.ts","notes/note/task/canceled/VTaskCanceled.tsx","notes/note/task/canceled/CTaskCanceled.ts","notes/note/task/pass/VTaskPass.tsx","notes/note/task/pass/CTaskPass.ts","notes/note/task/fail/VTaskFail.tsx","notes/note/task/fail/CTaskFail.ts","notes/note/task/rated/VTaskRated.tsx","notes/note/task/rated/CTaskRated.ts","notes/note/task/VEditTextItem.tsx","notes/note/task/check/VTaskCheck.tsx","notes/note/task/check/CTaskCheck.ts","notes/note/task/rate/VRateTask.tsx","notes/note/task/rate/CTaskRate.ts","notes/views/VActions.tsx","notes/CShareTo.ts","notes/CNotes.ts","notes/container/index.ts","notes/note/task/index.ts","notes/container/unitNote/index.ts","home/VHome.tsx","home/CHome.ts","relation/VAdd.tsx","relation/VRelation.tsx","relation/contact/VContact.tsx","relation/contact/VEditAssigned.tsx","relation/contact/CContact.ts","relation/CRelation.ts","me/VAdmin.tsx","me/VEditMe.tsx","me/VMe.tsx","me/CMe.ts","tapp/uqs.ts","discover/VDiscover.tsx","book/VBook.tsx","book/VFlow.tsx","book/CBook.ts","discover/CDiscover.ts","tapp/VTestMe.tsx","tapp/VTestAB.tsx","tapp/res/index.ts","tapp/res/zh.ts","tapp/res/en.ts","tapp/CApp.ts","index.tsx"],"names":["guestApi","this","get","ret","decodeGuestToken","guest","token","unitName","unit","CenterApiBase","undefined","Caller","params","waiting","_params","method","logMark","netToken","userId","setCenterToken","WSChannel","FetchErrorView","reApi","a","props","clearError","channel","url","options","resolve","reject","refetchApi","close","errContent","error","err","i","push","key","style","wordWrap","className","type","onClick","React","SystemNotifyPage","message","header","ReloadPage","timerHandler","reload","clearInterval","nav","seconds","state","setInterval","setState","title","msg","ConfirmReloadPage","back","confirm","isMobile","RegExp","test","navigator","userAgent","logs","stackKey","NavView","stack","htmlTitle","waitCount","waitTimeHandler","upgradeUq","start","isHistoryBack","navBack","tick","Date","now","console","log","length","len","window","self","top","postMessage","confirmClose","pop","fetchError","wait","set","addEventListener","isRouting","init","env","setTimeout","clearTimeout","unauthorized","showLogin","uq","version","show","view","disposer","clear","removeCeased","history","pushState","ceased","refresh","item","dispose","level","p","backLevel","popAndDispose","find","v","elWait","elError","testing","left","zIndex","name","map","index","visibility","position","wsHost","local","LocalData","navigo","navSettings","language","culture","resUrl","hashParam","centerHost","arrs","windowOnError","event","source","lineno","colno","windowOnUnhandledRejection","ev","reason","windowOnClick","windowOnMouseMove","x","y","windowOnScroll","showPrivacyPage","privacy","getPrivacyContent","privacyPage","getPrivacy","html","content","__html","marked","dangerouslySetInnerHTML","Promise","race","serviceWorker","ready","registration","unregister","document","location","plus","webview","webView","resetAll","ok","showReloadPage","localStorage","lang","resOptions","district","messageHub","dispatch","unitJsonPath","fetch","unitRes","json","res","remove","el","getElementById","innerText","loadUnitJson","innerHTML","JSON","parse","envUnit","process","REACT_APP_UNIT","Number","isDevelopment","id","getPredefinedUnitName","unitFromName","unitId","settings","origin","pathname","toLowerCase","endsWith","substr","host","hash","pos","getExHashPos","substring","ws","resHost","resUrlFromHost","setCenterUrl","Error","setGuest","exHash","getExHash","appInFrame","setAppInFrame","parent","loadPredefinedUnit","predefinedUnit","onerror","onunhandledrejection","onselectstart","oncontextmenu","startWait","user","notLogined","logined","endWait","Navigo","on","absolute","navigate","showPage","isUserLogin","onLogined","userApi","me","icon","nick","callback","logoutApis","stringify","saveLocalUser","showAppView","internalLogined","defaultTop","loginTop","headers","Headers","indexOf","http","text","withBack","lv","loginView","default","footer","logout","logoutClear","cp","ChangePasswordPage","onError","showUpgradeUq","replace","topKey","popTo","ceaseTop","regConfirmClose","confirmBox","apiId","sheetType","sheetId","sheet","includes","uh","appUrl","src","String","open","date","getTime","toTimeString","step","href","r","parser","DOMParser","htmlDoc","parseFromString","elHtml","getElementsByTagName","newVersion","getAttribute","g","oem","observable","maxCount","arr","ids","dict","loadId","shift","delete","_loadIds","items","_loadId","setItem","e","Map","localDb","child","_user","_guest","_unit","forEach","d","getObjPropIgnoreCase","obj","prop","keys","Object","PageHeader","afterBack","logoutClick","showLogout","debugLogout","b","right","center","ex","role","rightView","Page","observer","tabsView","tabsProps","TabsView","headerClassName","elFooter","onScroll","onScrollTop","onScrollBottom","children","renderHeader","renderFooter","uqTokens","logoutUqTokens","appsInFrame","page","param","val","isBridged","subFrameStarted","evt","data","subWin","setSubAppWindow","hidden","hideFrameBack","_","clone","initSubWin","onReceiveAppApiMessage","apiName","db","parts","split","uqOwner","uqName","appOwner","appName","uqTokenApi","onAppApiReturn","urlTest","action","uqTokenActions","realUrl","getUrlOrTest","appHash","slice","lastIndexOf","u","uid","getUnit","realUnit","onReceive","callCenterApiFromMessage","bridgeCenterApiReturn","startsWith","buildAppUq","uqToken","centerToken","at","opener","appUq","brideCenterApis","bridgeCenterApi","body","callId","from","callCenterapi","directCall","result","bca","EntityCaller","entity","tries","_entity","loadSchema","innerRequest","uqApi","xcall","innerCall","jsonResult","$uq","$modify","pullModify","xresult","retry","schema","rebuildSchema","buildEntities","setSchema","ver","uqVersion","en","ActionCaller","QueryQueryCaller","unpackReturns","buildParams","QueryPageCaller","pageStart","pageSize","chars","codeBackSlash","charCodeAt","codeN","codeT","codeB","codeF","codeV","codeR","codes","codeBN","codeBT","codeBB","codeBF","codeBV","codeBR","Entity","typeId","jName","sys","cache","fields","arrFields","returns","face","fieldMaps","localMap","f","loadEntitySchema","buildFieldsTuid","loadValues","setJName","buildFieldTuid","buildArrFieldsTuid","value","fieldName","arrName","entities","fn","getTuid","an","fieldArr","tuid","buildFieldsParams","arrResult","pa","rowResult","field","buildDateTimeParam","getFullYear","getMonth","getDate","_tuid","getIdFromObj","dt","Math","floor","toISOString","packRow","arrData","packArr","join","row","ch","escape","values","boxId","ln","unpackRow","unpackArr","ch0","c","fLen","to","reverseNT","n","isNaN","p0","vals","ItemEdit","itemSchema","uiItem","label","_itemSchema","_uiItem","newValue","internalStart","internalEnd","divValue","labelHide","templet","Templet","widget","list","rules","nv","Array","isArray","verifyRule","rule","methodsWithBody","HttpChannel","hostUrl","apiToken","ui","timeout","showError","post","urlPrefix","caller","buildOptions","path","h","append","encodeURI","innerFetch","k","innerFetchResult","buildError","retErr","that","timeOutHandler","statusText","ct","then","retJson","retError","catch","buildHeaders","CenterHttpChannel","UqHttpChannel","HttpChannelNavUI","channelUIs","channelNoUIs","channels","UqApi","basePath","access","showWaiting","channelUI","acc","ApiBase","UnitxApi","buildChannel","centerAppApi","CenterAppApi","unitxUq","centerChannel","centerChannelUI","loginedUserId","t","un","localCache","nowTick","appUqParams","call","loadAppUqs","uqs","decodeUserToken","account","verify","password","$lang","$district","resLang","merge","l","languages","toUpperCase","setResOptions","resGlobal","setRes","target","str","setGlobalRes","Controller","_t","isDev","receiveHandlerId","unregisterReceiveHandler","onDispose","onMessageReceive","onMessage","_resolve_$","topPageKey","internalT","vp","render","onEvent","alert","openPage","registerReceiveHandler","beforeStart","afterStart","onClosePage","go","caption","yes","no","classNames","closePage","buttons","View","controller","isMe","vm","vCall","returnCall","imageClassName","textClassName","renderUser","replacePage","backPage","ceasePage","popToTopPage","VPage","retOnClosePage","_onClosePage","openPageElement","renderPage","onPageScroll","scroller","onPageScrollTop","onPageScrollBottom","ALPHABET","rtn","charAt","random","QueryPager","query","firstSize","itemObservable","$page","idFieldName","appendPosition","sortOrder","order","_items","startIndex","getPageId","load","splice","newItem","newId","oldItem","oldId","PageItems","Query","more","startField","isPaged","size","array","deep","pageCaller","request","queryCaller","table","subAppWindow","postWsToSubApp","win","WsBase","wsBaseSeed","wsBaseId","WebSocket","onopen","onmessage","wsMessage","onclose","receive","netThis","connect","send","Image","altImage","alt","currentTarget","jwtDecode","hosts","centerhost","reshost","uqhost","unitxhost","httpArr","urlFromHost","isAbsoluteUrl","centerUrlFromHost","centerWsFromHost","fetchOptions","mode","tryLocal","getCenterHost","getResHost","promises","hostArr","findIndex","fetchUrl","debugHostUrl","localCheck","all","results","j","hostValue","debugHost","getUrlOrDebug","urlDebug","fetchLocalCheck","Action","ActionSubmitCaller","SubmitReturnsCaller","SubmitConvertCaller","pack","LMR","badge","color","badgeAlign","badgeVertical","cn","cursor","FA","spin","fixWidth","border","pull","pulse","rotate","flip","inverse","IconText","iconClass","textClass","Muted","__ls","getItem","removeItem","LocalCache","removeLocal","Local","caches","locals","keyForGet","keyForSet","sk","LocalArr","LocalMap","keyForRemove","removeAll","ks","unshift","saveIndex","max","ls","TuidContent","tuidName","s","uqStringify","ReactBoxId","isUndefined","boxName","assureBox","valueFromId","tuidValue","nullUI","ttv","divObj","bi","logContent","boxIdContent","Scroller","scrollTo","scrollTop","offsetHeight","ScrollView","bottomTime","topTime","div","refDiv","onResize","removeEventListener","sh","scrollHeight","direct","Children","_$scroll","toString","eachChild","ref","Component","Loading","testingTags","pn","isTesting","tag","ms","args","global","handle","getHttpChannel","callFetch","put","ImageItemEdit","resId","onSaved","formRes","required","number","integer","min","zh","listRes","none","loginRes","registerRes","isFirst","pageItemAction","itemConverter","scrollToTop","scrollIntoView","topDiv","scrollToBottom","bottomDiv","changing","divId","loadResults","pageList","beforeLoad","loaded","allLoaded","reset","isAsc","endItem","scrollToEnd","pushItem","endIndex","startId","pid","sum","setLoaded","loading","onLoad","setPageStart","onLoaded","reverse","computed","handlerSeed","anyHandlers","msgHandlers","handler","seed","args0","handlerId","$type","useHash","root","_routes","_useHash","_hash","_paused","_destroyed","_lastRouteResolved","_notFoundHandler","_defaultHandler","_usePushState","_genericHooks","_historyUpdateMethod","timout","_onLocationChange","isPushStateAvailable","_cLoc","_listen","updatePageLinks","cleanUrl","match","names","reduce","decodeURIComponent","route","paramNames","regexp","PARAMETER_REGEXP","full","dots","REPLACE_VARIABLE_REGEXP","WILDCARD_REGEXP","REPLACE_WILDCARD","FOLLOWED_BY_SLASH_REGEXP","MATCH_REGEXP_FLAGS","urlA","urlB","getUrlDepth","routes","replaceDynamicURLParts","clean","regExpResultToParams","filter","m","findMatchedRoutes","colonExp","matched","routeExp","fallbackURL","matched0","cleanGETParam","hooks","exHooks","before","shouldRoute","after","_getRoot","_historyUpdate","arg0","arg1","orderedRoutes","sort","compareUrlDepth","uses","_add","current","GETParameters","extractGETParameters","onlyURL","getOnlyURL","already","manageHooks","_callLeave","isHashedRoot","_findLinks","link","hasListenerAttached","ctrlKey","metaKey","tagName","getLinkPath","preventDefault","status","pause","destroy","as","replaceState","cLocRoot","isHashChangeAPIAvailable","cached","check","querySelectorAll","lastRouteResolved","leave","Tab","contentBuilder","notify","onShown","_content","selected","TabCaptionComponent","tabBg","sep","tabClick","tab","selectedTab","tabArr","shown","tabs","bsCur","bsTab","tabPosition","borderColor","borderStyle","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","notifyCircle","num","displayNone","pageHeader","pageFooter","tabBack","isSelected","display","ResUploader","fileInput","upload","formData","buildFormData","onFilesChange","files","fileName","maxSize","FormData","file","multiple","onChange","formatSize","pointLength","units","toFixed","ImageUploader","imgBaseSize","imageTypes","suffix","resUploader","onFileChange","fileError","uploaded","enableUploadButton","reader","FileReader","readAsDataURL","onload","srcImage","setSize","desImgSize","desImage","compress","img","width","height","srcImgWidth","srcImgHeight","w","scale","desImgWidth","round","desImgHeight","canvas","createElement","ctx","getContext","anw","createAttribute","nodeValue","anh","setAttributeNode","drawImage","base64","toDataURL","blob","convertBase64UrlToBlob","isChanged","showOrgImage","maxWidth","urlData","mime","bstr","atob","u8arr","Uint8Array","Blob","defaultChecked","disabled","levelDiv","padding","AudioUploader","audioTypes","fileSize","uploading","UqMan","uqData","createBoxId","tvs","actions","sheets","queries","books","maps","histories","pendings","tags","tuidsCache","localAccess","localModifyMax","tuids","createBoxIdFromTVs","tuidArr","actionArr","sheetArr","queryArr","bookArr","mapArr","historyArr","pendingArr","tagArr","clearTuids","trim","TuidsCache","accesses","loadAccess","buildTuids","buildAccess","newTuid","entityName","fromType","fromObj","defer","cacheTuids","TuidImport","TuidInner","book","Book","Tag","History","pending","Pending","Sheet","newAction","newQuery","newBook","newMap","newHistory","newSheet","newPending","newTag","buildSheet","build","mainFields","buildTuidBox","owner","ownerField","buildTuidDivBox","modifyMax","states","ops","op","discription","app","SaveCaller","flow","brief","unpackSheet","flows","GetSheetCaller","getArchive","unpack","SheetArchiveCaller","SheetArchivesCaller","StateSheetsCaller","PageStateItems","StateSheetCountCaller","UserSheetsCaller","MySheetsCaller","SheetCaller","count","getStateSheets","queryApiName","BookQueryCaller","schemaFrom","actionSchema","querySchema","AddCaller","DelCaller","AllCaller","PageCaller","qc","QueryCaller","MapCaller","getCaller","MapAddCaller","add","MapDelCaller","MapAllCaller","MapPageCaller","MapQueryCaller","radioStyle","TagView","nameFromId","namesFromIds","renderRadio","renderView","checked","renderCheck","wrapClassName","inputs","inputName","onInputChange","input","coll","_view","lines","line","ext","mobileRegex","emailRegex","DropdownActions","menu","button","handleDocumentClick","dropdownOpen","contains","toggle","isRight","itemIconClass","itemCaptionClass","hasIcon","some","data-toggle","aria-expanded","captionClass","aria-hidden","onTouchStart","timeRes","md","month","ymd","year","yesterday","today","tomorrow","$zh","$en","tt","renderDate","vDate","withTime","always","nDate","_date","nowYear","hour","getHours","minute","getMinutes","appendTime","dPart","hm","EasyTime","SearchBox","allowEmptySearch","onSubmit","initKey","onSearch","inputSize","inputClassName","onFocus","placeholder","buttonText","maxLength","defaultValue","userCache","loader","UserView","noneImage","getValue","idProp","useUser","use","cacheTimer","loadIds","clearCacheTimer","cacheIds","tuidCached","innerPullModify","tuidLists","queueModify","group","queue","modify","modifyIds","UQsMan","tonvaAppName","collection","localData","buildTVs","uqsMan","uqAppData","retErrors","setTuidImportsLocal","_uqs","buildUQs","errors","uqTVs","lj","uqsData","promiseInits","uqFullName","lower","loadEntities","uqMan","Proxy","receiver","showReload","isImport","setInner","tuidImport","fromName","iName","setFrom","Rule","RuleCustom","func","defy","RulePredefined","RuleRequired","RuleNum","minMsg","maxMsg","template","checkMore","RuleInt","isInteger","Widget","context","fieldProps","_ui","readOnly","isChanging","changeValue","container","visible","form","inNode","requiredFlag","FieldContainer","renderBody","getUiItem","contextErrors","buildRules","removeErrorWidget","addErrorWidget","initData","fromElement","onChanging","onChanged","prev","allowChange","setDataValue","setElementValue","elDiscription","hasError","discriptionClassName","errorList","fieldClass","FieldClass","uiLabel","TextWidget","inputType","onKeyDown","internalOnKeyDown","keyCode","onEnter","blur","setError","onBlur","checkRules","checkContextRules","hasFocus","clearErrors","renderTemplet","renderErrors","TextAreaWidget","setValue","rows","PasswordWidget","UrlWidget","EmailWidget","NumberWidget","UpdownWidget","returnValue","isValidKey","DateWidget","DateTimeWidget","TimeWidget","MonthWidget","CheckBoxWidget","trueValue","falseValue","SelectWidget","select","option","RadioWidget","rowKey","isRow","RangeWidget","IdWidget","pickId","clearContextError","Unknown","dataType","uiType","dataTypes","ButtonWidget","submit","observerRender","widgetType","ButtonClass","Context","uiSchema","subContexts","widgets","arrRowContexts","itemName","getDisabled","setDisabled","getReadOnly","setReadOnly","getVisible","setVisible","buttonName","errorWidgets","ew","onButtonClick","checkFieldRules","rowContext","setContextError","clearWidgetsErrors","clearContextErrors","checkHasError","rowKeySeed","RowContext","parentContext","arrSchema","uiArr","itemSchemas","FormContext","ContextContainer","ArrComponent","selectable","deletable","restorable","getArrRowContexts","arrLabel","ArrContainer","RowContainer","RowSeperator","formSelectable","formDeletable","formRestorable","arrSelectable","arrDeletable","arrRestorable","ac","rc","rs","first","rowContent","typeofTemplet","factory","selectCheck","deleteIcon","$isSelected","$source","isDeleted","$isDeleted","editContainer","Provider","ImageWidget","edit","imageSrc","end","TagWidget","widgetsFactory","textarea","datetime","time","email","updown","checkbox","image","checkboxes","radio","tagSingle","valuesView","renderRadios","tagMulti","defaultArr","def","renderChecks","range","typeWidget","getItemSchema","getTypeWidget","WidgetClass","Form","formContext","Container","watch","calcSelectOrDelete","DefaultContainer","DefaultFieldContainer","fieldLabelSize","labelView","fieldCol","DefaultFieldClass","DefaultButtonClass","DefaultRes","autorun","dv","initDataItem","arrItem","arrItems","arrDict","arrItemOperated","formArrVal","beforeShow","renderContent","contextType","StringItemEdit","preValue","verifyValue","onSave","element","RadioItemEdit","SelectItemEdit","IdItemEdit","TagItemEdit","renderInputs","TagSingleItemEdit","TagMultiItemEdit","TextAreaItemEdit","Edit","defaultSepClassName","defaultRowContainerClassName","topBorder","bottomBorder","rowContainerClassName","rowClick","itemEdit","onItemChanged","onItemClick","stopEdit","topBorderClassName","bottomBorderClassName","sepClassName","divLabel","ie","createItemEdit","requireFlag","centerApi","userName","VUnsupportedUnit","VUnitSelect","renderRow","onRowClick","appUnits","VErrorsPage","VStartError","CAppBase","config","appConfig","noUnit","elements","onRoute","userAppUnits","showUnsupport","appUnit","openVPage","resolveRoute","userFromId","CApp","html0","cApp","CBase","_cApp","CSub","_owner","ListBase","pageItems","Clickable","Static","Selectable","inputItems","buildItems","itemsArray","isItemSelected","selectedItems","compare","retItems","labelId","comp","selectItem","si","obItem","onSelect","flex","marginBottom","htmlFor","listenArraySplice","isObservableArray","observe","change","removedCount","added","_added","checkAll","anySelected","List","listBase","buildBase","prevProps","prevState","isEqual","forceUpdate","selectAll","unselectAll","waitingMore","tabIndex","isLoading","staticRow","PropRow","PropBorder","borderTop","PropGap","LabeledPropRow","gridProps","_prop","col","labelFixLeft","bk","renderLabel","renderProp","align","vAlign","alignValue","renderPropBody","renderPropContent","StringPropRow","NumberPropRow","ListPropRow","borderBottom","ComponentPropRow","component","PropView","buildRows","isGap","setValues","PropGrid","propView","IdCache","tuidLocal","localArr","waitingIds","tuidInner","divName","initLocalArr","isNumber","has","moveToHead","_id","useId","tuidValues","cacheIdValues","unpackTuidIds","cacheValue","cacheTuidFieldValues","loadTuidIdsOrLocal","localedValues","netIds","loadTuidIds","netRet","IdDivCache","Tuid","noCache","typeName","idName","unique","TuidBox","id1","id2","equ","divs","cacheFields","idCache","tuidDiv","TuidDiv","resetCache","assureObj","IdsCaller","GetCaller","cacheFieldsInValue","arrValues","$create","$update","stampOnMain","unpackTuidIdsOfFields","SavePropCaller","searchArr","SearchCaller","LoadArrCaller","SaveArrCaller","ArrPosCaller","TuidNoCaller","TuidCaller","$id","transParams","arrParams","arrValue","buildDateParam","bid","$order","loadMain","save","saveProp","search","loadArr","saveArr","posArr","hasDiv","TuidBoxDiv","userSetProp","Boolean","hostname","CUqBase","CUqSub","CUqApp","EnumNoteType","VMain","cHome","cRelation","cDiscover","cMe","loadBookProjects","numberFromId","compareID","checkHourMinutes","taskTimeToString","initNoteItemObj","flowContent","textList","textCheckable","VBasePage","renderContact","assigned","renderContactItem","contact","contacts","VSelectContact","buildRight","single","onToggleSelect","onNext","onContactSelect","onContactClick","VNotesDropDown","showAddNoteTextPage","showAddNoteListPage","checkable","showAddNoteCheckablePage","task","showAddAssignPage","folder","showAddMyFolderPage","space","showAddGroupPage","dropdownActions","VHomeDropdown","VFolderDropdown","VSpaceDropdown","CNoteBase","disableFrom","noteItem","showShareTo","endContentInput","noteContent","editNote","updateChange","itemChanged","folderId","currentFold","addNote","groupFolder","note","isContentChanged","isCaptionChanged","renderIcon","VNoteBase","renderFrom","disableOwnerFrom","vImage","cnName","renderCommentFlag","commentCount","commentUnread","vCU","cu","onSendNote","loadRelation","renderTop","renderCaption","renderEditTime","create","update","toCount","spawnCount","onEdit","isEnd","showEditPage","VNoteBaseDir","renderTopCaptionContent","renderDirBottom","divToCount","renderToCount","divSpawnCount","renderSpawnCount","divComment","dot","unread","VNoteBaseEdit","onButtonSave","isNoteChanged","renderExButtons","SetNote","onCaptionChange","renderEditBottom","renderCaptionInput","hideNote","onDelete","VNoteBaseView","renderViewBottom","renderRelatives","vEditButton","renderEditButton","VRelativesBase","tabShare","isAction","vCount","noteModel","activeRelativeTab","isActive","renderTab","marginTop","renderTabs","tabName","tabContent","CContent","changed","buildObj","renderViewContent","fromString","startInput","VBase","doneItems","uncheckedItems","checkedItems","renderCheckItem","renderCheckedItems","VView","data-key","onCheckChange","checkedCount","VItem","ListInputBase","currentFocusable","inputingText","focuseTimeout","renderItem","focusable","focused","renderInputItem","renderTextItem","onAddNewEnter","addNewItem","setItemText","inputRef","getComputedStyle","onBlurAddNew","focusables","toJS","renderNewInput","getItemKey","getItemText","renderItemHeader","onMouseDown","focus","renderInput","uniqueKey","trimRight","CheckableListInput","CCheckable","listInput","itemKey","getList","ci","ListInput","CList","CTextBase","changedNoteContent","VTextBaseView","renderParagraphs","VTextBaseInput","onContentChange","renderContentTextArea","VInput","CText","CFolder","VSent","VTo","anyChanged","onContactsSelected","groupContacts","CTo","currentGroupFolder","currentNoteItem","onSendOut","toList","sendOut","GetContacts","startAction","afterContactsSelected","VFolder","noteKey","renderItemInFolder","cNoteBase","renderDirItem","popFolder","renderFolderDropDown","paragraphs","contentString","trimEnd","stopPropagation","showFolderView","notesPager","showNoteItem","VFolderDir","vIcon","VFolderRelatives","VFolderView","renderVm","cContent","CContainer","getNote","showViewPage","EnumSpecFolder","notes","GetNotes","setItemConverter","getItemConverter","noteItemConverter","newnotes","newitems","cNoteItem","GetNote","spawn","contain","comments","fItem","renderListView","openFolder","showFolderViewPage","sub","AddNote","fromAssigned","createCNoteBase","theItems","theItem","HideNote","members","AddGroup","VSpaceDir","VSpaceMembers","showAddMember","VSpaceView","groupOwner","renderSpaceDropDown","showSpaceContent","whiteSpace","overflow","textOverflow","cNotes","cSpace","addMember","VContainerForm","VSpaceEdit","SetGroup","VContentView","memberCount","VContacts","selectMember","VSapceAdd","addGroup","CSpace","groupId","showMembers","loadMembers","loadContacts","loadSpace","GetGroupFolderMemberCount","resulte","GetGroupMembers","GetGroupContacts","AddGroupMember","member","RemoveGroupMember","mi","endInput","rootFold","editGroup","CFolderDisableItemFrom","queryResults","VFolderMyEdit","VFolderMyAdd","VFolderMyView","renderShareButton","VFolderMy","CFolderMy","VFolderShare","CFolderShare","CFolderRoot","VUnitNoteDir","CUniteNote","unitNote","EnumTaskState","VCommentsList","renderComments","cNote","renderComment","showMoreComments","comment","divUserName","renderCommentContent","vUser","VAddComment","onCommentChange","onCommentSubmit","onAddComment","VWriteComment","onComment","CComments","addComment","renderButton","CNote","cComments","AddComment","commentId","stateContents","Start","Done","Pass","Fail","Rated","Canceled","getTaskItemState","checker","rater","GetTaskStateContent","VRelativesNoteBase","tabComment","renderCommentsList","tabFlow","VAssignRelatives","VAssignView","renderSpawn","renderStateSpan","renderWriteComment","showAssignTo","VAssignEdit","renderDeleteButton","VAssignAdd","onSaveAndSendNote","cnewNote","VAssignDir","renderDirContent","CSelectContact","VAssignParams","cNoteAssign","onItemChange","point","onItemKeyDown","onHoursChange","assignhours","onHoursKeyDown","onHoursBlur","onClickChecker","cSelectContact","CNotesSelectContact","SetContacts","GetAssignToContacts","callSelectContact","onClickRater","renderHours","renderChecker","renderRater","renderParam","CAssignTo","assignTask","CNoteAssign","cAssignTo","cObj","tos","AssignTask","assign","VTextRelatives","VTextHeader","VTextView","VTextEdit","changeToText","changeToList","changeToCheckable","cType","renderButtonLeft","dropdowns","VTextAdd","VTextDir","CNoteText","createTextContent","createListContent","createCheckableContent","getItems","allowCheck","CTaskContent","itmes","CNoteTask","checkInfoInput","rateInfoInput","rateValue","rateValueInput","hours","checkInfo","rateInfo","saveX","noteId","SetNoteX","VTaskRelatives","VTaskView","additionRows","renderAssignHours","renderTaskAdditions","renderTaskDirTop","divCaption","renderState","VTaskStart","onDone","DoneTask","showActionEndPage","VTaskStartDir","renderDirView","CTaskStart","taskUpdateState","VTaskDone","VTaskDoneDir","CTaskDone","VTaskCanceled","VTaskCanceledDir","CTaskCanceled","VTaskPass","VTaskPassDir","CTaskPass","VTaskFail","VTaskFailDir","CTaskFail","VTaskRated","VTaskRatedDir","CTaskRated","VEditTextItemInput","inputText","onUpdate","onClickSave","VTaskCheck","onDiscribeChange","updateCheckInfo","onDiscribeKeyDown","checkSaveInfo","onCheck","pass","checkTask","resultPage","eprops","setCheckInfo","vEdit","renderOrtherContent","VTaskCheckDir","CTaskCheck","CheckTask","VTaskRate","updateRateInfo","onRate","rateTask","renderValueRadio","VTaskRateDir","CTaskRate","RateTask","VActions","renderSelectedContact","CShareTo","sendNoteTo","GetShareContacts","CNotes","foldStack","createCNoteText","showAddPage","createCNoteList","createCNoteCheckable","cFolder","cGroup","newSub","folderNoteItem","foldItem","showFolder","createCFolder","createCNoteTask","createCUnitNote","SendNoteTo","cShareTo","VHome","cNodes","renderHomeDropDown","renderNotesView","CHome","newC","VAdd","fromKey","onAddContact","AddContact","VRelation","onShowContact","VContact","onEditAlias","onEditAssigned","VEditAssigned","btnSaveDisabled","SaveContactAssign","autoFocus","CContact","CRelation","GetMyContacts","showContact","SetContactAssinged","VAdmin","VUser","unitOwner","VUnit","vError","onCreate","createUnit","VEditMe","vAdmin","showAdmin","VMe","onExit","changePassword","meInfo","showEditMe","userSpan","aboutRows","logOutRows","CMe","GetSystemRole","CreateUnit","VDiscover","onTaskReport","onOtherReport","cBook","renderBook","VBook","onProject","projectSum","showProjectFlow","projectSums","debitMonth","debitWeek","debitDay","renderNumber","VFlow","renderFlowItem","flowItem","stamp","memo","debit","credit","showFlowItem","projectDetailPager","CBook","GetBookProjects","GetProjectFlow","project","projectFlowItem","GetNoteItemFromId","CDiscover","VTestMe","VTestAB","home","relation","discover","aboutTheApp","pleaseLogin","noteSpace","noteText","noteList","noteCheckable","noteTask","noteFolder","noteCreateSpace","gaps","timer","gapIndex","callTick","$Poked","poke","initMySetting","startHome","showMain","timezone","getTimezoneOffset","InitMySetting","startAB","queryStr","startMe","initTabName","setSettings","App","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.701c8ab7.chunk.js","sourcesContent":["export * from './tool';\nexport * from './net';\nexport * from './components';\nexport * from './entry';\nexport * from './uq';\nexport * from './app';\nexport * from './vm';\n","export * from './navigo';\nexport * from './nav';\nexport * from './page';\nexport * from './schema';\nexport * from './form';\nexport * from './edit';\nexport * from '../res/res';\nexport * from './loading';\nexport * from './image';\nexport * from './resUploader';\nexport * from './rules';\nexport * from './list';\nexport * from './dropDownActions';\nexport * from './easyDate';\nexport * from './propGrid';\nexport * from './simple';\nexport * from './media';\nexport * from './searchBox';\nexport * from './userIcon';\n\n","import { decodeGuestToken } from '../tool/user';\nimport { CenterApiBase } from './uqApi';\n\nexport class GuestApi extends CenterApiBase {\n    async guest(): Promise<any> {\n        //let guest = nav.local.guest.get();\n        let ret = await this.get('', {});\n        switch (typeof ret) {\n            default: return;\n            case 'string': return decodeGuestToken(ret);\n            case 'object':\n                let guest = decodeGuestToken(ret.token);\n                return guest;\n        }\n    }\n\n    async unitFromName(unitName:string): Promise<number> {\n        let ret = await this.get(unitName);\n        return ret && ret.unit;\n    }\n}\n\nexport const guestApi = new GuestApi('tv/guest/', undefined);\n","export abstract class Caller<T> {\n    protected readonly _params: T;\n    constructor(params: T, waiting: boolean) {\n        this._params = params;\n        this.waiting = waiting;\n    }\n    protected get params():any {return this._params;}\n    buildParams():any {return this.params;}\n    method: string  = 'POST';\n    abstract get path(): string;\n    get headers(): {[header:string]: string} {return undefined}\n    waiting: boolean;\n}\n","import * as React from 'react';\nimport {observable} from 'mobx';\nimport marked from 'marked';\nimport {User, Guest/*, UserInNav*/} from '../tool/user';\nimport {Page} from './page/page';\nimport {netToken} from '../net/netToken';\nimport FetchErrorView, { SystemNotifyPage } from './fetchErrorView';\nimport {FetchError} from '../net/fetchError';\nimport {appUrl, setAppInFrame, getExHash, getExHashPos} from '../net/appBridge';\nimport {LocalData, env} from '../tool';\nimport {guestApi, logoutApis, setCenterUrl, setCenterToken, appInFrame, host, resUrlFromHost, messageHub} from '../net';\n//import { WsBase, wsBridge } from '../net/wsChannel';\nimport { resOptions } from '../res/res';\nimport { Loading } from './loading';\nimport { Navigo, RouteFunc, Hooks, NamedRoute } from './navigo';\n\nimport 'font-awesome/css/font-awesome.min.css';\nimport '../css/va-form.css';\nimport '../css/va.css';\nimport '../css/animation.css';\nimport { FA } from './simple';\nimport { userApi } from '../net';\nimport { ReloadPage, ConfirmReloadPage } from './reloadPage';\n\nconst regEx = new RegExp('Android|webOS|iPhone|iPad|' +\n    'BlackBerry|Windows Phone|'  +\n    'Opera Mini|IEMobile|Mobile' , \n    'i');\nconst isMobile = regEx.test(navigator.userAgent);\n\n/*\nexport const mobileHeaderStyle = isMobile? {\n    minHeight:  '3em'\n} : undefined;\n*/\n//const logo = require('../img/logo.svg');\nlet logMark: number;\nconst logs:string[] = [];\n\nexport interface Props //extends React.Props<Nav>\n{\n    onLogined: (isUserLogin?:boolean)=>Promise<void>;\n    notLogined?: ()=>Promise<void>;\n};\nlet stackKey = 1;\nexport interface StackItem {\n    key: number;\n    view: JSX.Element;\n    ceased: boolean;\n    confirmClose?: ()=>Promise<boolean>;\n    disposer?: ()=>void;\n}\nexport interface NavViewState {\n    stack: StackItem[];\n    wait: 0|1|2;\n    fetchError: FetchError\n}\n\nexport class NavView extends React.Component<Props, NavViewState> {\n    private stack: StackItem[];\n    private htmlTitle: string;\n    private waitCount: number = 0;\n    private waitTimeHandler?: NodeJS.Timer;\n\n    constructor(props:Props) {\n        super(props);\n        this.stack = [];\n        this.state = {\n            stack: this.stack,\n            wait: 0,\n            fetchError: undefined\n        };\n        nav.set(this);\n    }\n    async componentDidMount()\n    {\n\t\twindow.addEventListener('popstate', this.navBack);\n\t\tif (nav.isRouting === false) await nav.init();\n        await nav.start();\n    }\n\n    get level(): number {\n        return this.stack.length;\n    }\n\n    startWait() {\n        if (this.waitCount === 0) {\n            this.setState({wait: 1});\n            this.waitTimeHandler = env.setTimeout(\n                'NavView.startWait',\n                () => {\n                    this.waitTimeHandler = undefined;\n                    this.setState({wait: 2});\n                },\n                1000) as NodeJS.Timer;\n        }\n        ++this.waitCount;\n        this.setState({\n            fetchError: undefined,\n        });\n    }\n\n    endWait() {\n        env.setTimeout(\n            undefined, //'NavView.endWait',\n            () => {\n            /*\n            this.setState({\n                fetchError: undefined,\n            });*/\n            --this.waitCount;\n            if (this.waitCount === 0) {\n                if (this.waitTimeHandler !== undefined) {\n                    env.clearTimeout(this.waitTimeHandler);\n                    this.waitTimeHandler = undefined;\n                }\n                this.setState({wait: 0});\n            }\n        },100);\n    }\n\n    async onError(fetchError: FetchError)\n    {\n        let err = fetchError.error;\n        if (err !== undefined) {\n            if (err.unauthorized === true) {\n                await nav.showLogin(undefined);\n                return;\n            }\n            switch (err.type) {\n                case 'unauthorized':\n                    await nav.showLogin(undefined);\n                    return;\n                case 'sheet-processing':\n                    nav.push(<SystemNotifyPage message=\"单据正在处理中。请重新操作！\" />);\n                    return;\n            }\n        }\n        this.setState({\n            fetchError: fetchError,\n        });\n    }\n\n    private upgradeUq = () => {\n        nav.start();\n    }\n\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        this.show(<Page header={false}>\n            <div>\n                UQ升级了，请点击按钮升级 <br />\n                <small className=\"text-muted\">{uq} ver-{version}</small>\n                <button className=\"btn btn-primary\" onClick={this.upgradeUq}>升级</button>\n            </div>\n        </Page>)\n    }\n\n    show(view: JSX.Element, disposer?: ()=>void): number {\n        this.clear();\n        return this.push(view, disposer);\n    }\n\n    push(view: JSX.Element, disposer?: ()=>void): number {\n        this.removeCeased();\n        if (this.stack.length > 0) {\n            window.history.pushState('forward', null, null);\n        }\n        let key = stackKey++;\n        this.stack.push({\n            key: key,\n            view: view, \n            ceased: false,\n            disposer: disposer\n        });\n        this.refresh();\n        //console.log('push: %s pages', this.stack.length);\n        return key;\n    }\n\n    replace(view: JSX.Element, disposer?: ()=>void): number {\n        let item:StackItem = undefined;\n        let stack = this.stack;\n        if (stack.length > 0) {\n            item = stack.pop();\n            //this.popAndDispose();\n        }\n        let key = stackKey++;\n        this.stack.push({\n            key: key, \n            view: view, \n            ceased: false,\n            disposer: disposer\n        });\n        if (item !== undefined) this.dispose(item.disposer);\n        this.refresh();\n        //console.log('replace: %s pages', this.stack.length);\n        return key;\n    }\n\n    ceaseTop(level:number = 1) {\n        let p = this.stack.length - 1;\n        for (let i=0; i<level; i++, p--) {\n            if (p < 0) break;\n            let item = this.stack[p];\n            item.ceased = true;\n        }\n    }\n\n    pop(level:number = 1) {\n        let stack = this.stack;\n        let len = stack.length;\n        //console.log('pop start: %s pages level=%s', len, level);\n        if (level <= 0 || len <= 1) return;\n        if (len < level) level = len;\n        let backLevel = 0;\n        for (let i = 0; i < level; i++) {\n            if (stack.length === 0) break;\n            //stack.pop();\n            this.popAndDispose();\n            ++backLevel;\n        }\n        if (backLevel >= len) backLevel--;\n        this.refresh();\n        if (this.isHistoryBack !== true) {\n            //window.removeEventListener('popstate', this.navBack);\n            //window.history.back(backLevel);\n            //window.addEventListener('popstate', this.navBack);\n        }\n        //console.log('pop: %s pages', stack.length);\n    }\n\n    popTo(key: number) {\n        if (key === undefined) return;\n        if (this.stack.find(v => v.key === key) === undefined) return;\n        while (this.stack.length >0) {\n            let len = this.stack.length;\n            let top = this.stack[len-1];\n            if (top.key === key) break;\n            this.pop();\n        }\n    }\n\n    topKey():number {\n        let len = this.stack.length;\n        if (len === 0) return undefined;\n        return this.stack[len-1].key;\n    }\n\n    removeCeased() {\n        for (;;) {\n            let p=this.stack.length-1;\n            if (p < 0) break;\n            let top = this.stack[p];\n            if (top.ceased === false) break;\n            let item = this.stack.pop();\n            let {disposer} = item;\n            this.dispose(disposer);\n        }\n        this.refresh();\n    }\n\n    private popAndDispose() {\n        this.removeCeased();\n        let item = this.stack.pop();\n\t\tif (item === undefined) return;\n\t\t//if (nav.isRouting) {\n\t\t//\twindow.history.back();\n\t\t//}\n        let {disposer} = item;\n        this.dispose(disposer);\n        this.removeCeased();\n        return item;\n    }\n\n    private dispose(disposer:()=>void) {\n        if (disposer === undefined) return;\n        let item = this.stack.find(v => v.disposer === disposer);\n        if (item === undefined) disposer();\n    }\n\n    clear() {\n        let len = this.stack.length;\n        while (this.stack.length > 0) this.popAndDispose();\n        //this.refresh();\n        if (len > 1) {\n            //window.removeEventListener('popstate', this.navBack);\n            //window.history.back(len-1);\n            //window.addEventListener('popstate', this.navBack);\n        }\n    }\n\n    regConfirmClose(confirmClose:()=>Promise<boolean>) {\n        let stack = this.stack;\n        let len = stack.length;\n        if (len === 0) return;\n        let top = stack[len-1];\n        top.confirmClose = confirmClose;\n    }\n\n    private isHistoryBack:boolean = false;\n    navBack = () => {\n        //nav.log('backbutton pressed - nav level: ' + this.stack.length);\n        let tick = Date.now();\n        this.isHistoryBack = true;\n        this.back(true);\n        this.isHistoryBack = false;\n        console.log(`///\\\\\\\\ ${Date.now()-tick}ms backbutton pressed - nav level: ${this.stack.length}`);\n    }\n\n    back = async (confirm:boolean = true) => {\n        let stack = this.stack;\n        let len = stack.length;\n        if (len === 0) return;\n        if (len === 1) {\n            if (window.self !== window.top) {\n                window.top.postMessage({type:'pop-app'}, '*');\n            }\n            return;\n        }\n        let top = stack[len-1];\n        if (confirm===true && top.confirmClose) {\n            if (await top.confirmClose()===true) this.pop();\n        }\n        else {\n            this.pop();\n        }\n    }\n\n    confirmBox(message?:string): boolean {\n        return window.confirm(message);\n    }\n    clearError = () => {\n        this.setState({fetchError: undefined});\n    }\n    render() {\n        const {wait, fetchError} = this.state;\n        let stack = this.state.stack;\n        let top = stack.length - 1;\n        let elWait = null, elError = null;\n        switch (wait) {\n            case 1:\n                elWait = <div className=\"va-wait va-wait1\">\n                </div>;\n                break;\n            case 2:\n                elWait = <div className=\"va-wait va-wait2\">\n                    <Loading />\n                </div>;\n                break;\n        }\n        if (fetchError)\n            elError = <FetchErrorView clearError={this.clearError} {...fetchError} />;\n        let test = nav.testing===true && \n\t\t\t<span className=\"cursor-pointer position-fixed\" style={{top:0,left:'0.2rem',zIndex:90001}}>\n                <FA className=\"text-warning\" name=\"info-circle\" />\n            </span>;\n        return <>\n\t\t\t{stack.map((item, index) => {\n\t\t\t\tlet {key, view} = item;\n\t\t\t\treturn <div key={key} style={index<top? {visibility: 'hidden', position: 'absolute'}:undefined}>\n\t\t\t\t\t{view}\n\t\t\t\t</div>\n\t\t\t})}\n\t\t\t{elWait}\n\t\t\t{elError}\n\t\t\t{test}\n        </>;\n    }\n\n    private refresh() {\n        this.setState({stack: this.stack });\n    }\n}\n\nexport interface NavSettings {\n    oem?: string;\n    loginTop?: JSX.Element;\n    privacy?: string;\n}\n\nexport class Nav {\n    private nav:NavView;\n    //private ws: WsBase;\n    private wsHost: string;\n    private local: LocalData = new LocalData();\n\tprivate navigo: Navigo;\n\tisRouting: boolean = false;\n\tnavSettings: NavSettings;\n    @observable user: User/*InNav*/ = undefined;\n    testing: boolean;\n    language: string;\n    culture: string;\n    resUrl: string;\n\n    constructor() {\n        let {lang, district} = resOptions;\n        this.language = lang;\n        this.culture = district;\n\t\tthis.testing = false;\n    }\n\n    get guest(): number {\n        let guest = this.local.guest;\n        if (guest === undefined) return 0;\n        let g = guest.get();\n        if (g === undefined) return 0;\n        return g.guest;\n    }\n\n    set(nav:NavView) {\n        //this.logo = logo;\n        this.nav = nav;\n\t}\n\t/*\n    registerReceiveHandler(handler: (message:any)=>Promise<void>):number {\n        //if (this.ws === undefined) return;\n        return messageHub.onReceiveAny(handler);\n    }\n\n    unregisterReceiveHandler(handlerId:number) {\n        //if (this.ws === undefined) return;\n        if (handlerId === undefined) return;\n        messageHub.endReceive(handlerId);\n    }\n\t*/\n    async onReceive(msg:any) {\n        //if (this.ws === undefined) return;\n        await messageHub.dispatch(msg);\n    }\n\n\tprivate async loadUnitJson() {\n\t\ttry {\n\t\t\tlet unitJsonPath = this.unitJsonPath();\n\t\t\tlet unitRes = await fetch(unitJsonPath, {});\n\t\t\tlet res = await unitRes.json();\n\t\t\treturn res.unit;\n\t\t}\n\t\tcatch (err1) {\n\t\t\tthis.local.unit.remove();\n\t\t\treturn;\n\t\t}\n\t}\n\n    private async getPredefinedUnitName() {\t\t\n\t\tlet el = document.getElementById('unit');\n\t\tif (el) {\n\t\t\treturn el.innerText;\n\t\t}\n\t\tel = document.getElementById('unit.json');\n\t\tif (!el) {\n\t\t\treturn await this.loadUnitJson();\n\t\t}\n\t\ttry {\n            let json = el.innerHTML;\n            let res = JSON.parse(json);\n            return res.unit;\n        }\n        catch (err) {\n\t\t\treturn await this.loadUnitJson();\n        }\n    }\n\n    private async loadPredefinedUnit() {\n        let envUnit = process.env.REACT_APP_UNIT;\n        if (envUnit !== undefined) {\n            return Number(envUnit);\n        }\n        let unitName:string;\n        let unit = this.local.unit.get();\n        if (unit !== undefined) {\n            if (env.isDevelopment !== true) return unit.id;\n            unitName = await this.getPredefinedUnitName();\n            if (unitName === undefined) return;\n            if (unit.name === unitName) return unit.id;\n        }\n        else {\n            unitName = await this.getPredefinedUnitName();\n            if (unitName === undefined) return;\n        }\n        let unitId = await guestApi.unitFromName(unitName);\n        if (unitId !== undefined) {\n            this.local.unit.set({id: unitId, name: unitName});\n        }\n        return unitId;\n    }\n\n    setSettings(settings?: NavSettings) {\n        this.navSettings = settings;\n    }\n\n    get oem():string {\n        return this.navSettings && this.navSettings.oem;\n    }\n\n    hashParam: string;\n    private centerHost: string;\n    private arrs = ['/test', '/test/'];\n    private unitJsonPath():string {\n        let {origin, pathname} = document.location;\n\t\tpathname = pathname.toLowerCase();\n        for (let item of this.arrs) {\n            if (pathname.endsWith(item) === true) {\n                pathname = pathname.substr(0, pathname.length - item.length);\n                break;\n            }\n        }\n        if (pathname.endsWith('/') === true || pathname.endsWith('\\\\') === true) {\n            pathname = pathname.substr(0, pathname.length-1);\n        }\n        return origin + pathname + '/unit.json';\n    }\n    private windowOnError = (event: Event | string, source?: string, lineno?: number, colno?: number, error?: Error) => {\n\t\tdebugger;\n        console.error('windowOnError');\n        console.error(error);\n    }\n    private windowOnUnhandledRejection = (ev: PromiseRejectionEvent) => {\n\t\tdebugger;\n        console.error('windowOnUnhandledRejection');\n        console.error(ev.reason);\n    }\n    private windowOnClick = (ev: MouseEvent) => {\n        console.error('windowOnClick');\n    }\n    private windowOnMouseMove = (ev: MouseEvent) => {\n        console.log('navigator.userAgent: ' + navigator.userAgent);\n        console.log('mouse move (%s, %s)', ev.x, ev.y);\n    }\n    private windowOnScroll = (ev: Event) => {\n        console.log('scroll event');\n\t}\n\t\n\tasync init() {\n\t\tthis.testing = env.testing;\n\t\tawait host.start(this.testing);\n\t\tlet hash = document.location.hash;\n\t\tif (hash !== undefined && hash.length > 0) {\n\t\t\tlet pos = getExHashPos();\n\t\t\tif (pos < 0) pos = undefined;\n\t\t\tthis.hashParam = hash.substring(1, pos);\n\t\t}\n\t\tlet {url, ws, resHost} = host;\n\t\tthis.centerHost = url;\n\t\tthis.resUrl = resUrlFromHost( resHost);\n\t\tthis.wsHost = ws;\n\t\tsetCenterUrl(url);\n\n\t\tlet guest:Guest = this.local.guest.get();\n\t\tif (guest === undefined) {\n\t\t\tguest = await guestApi.guest();\n\t\t}\n\t\tif (!guest) {\n\t\t\tdebugger;\n\t\t\tthrow Error('guest can not be undefined');\n\t\t}\n\t\tnav.setGuest(guest);\n\n\t\tlet exHash = getExHash();\n\t\tlet appInFrame = setAppInFrame(exHash);\n\t\tif (exHash !== undefined && window !== window.parent) {\n\t\t\t// is in frame\n\t\t\tif (appInFrame !== undefined) {\n\t\t\t\t//this.ws = wsBridge;\n\t\t\t\tconsole.log('this.ws = wsBridge in sub frame');\n\t\t\t\t//nav.user = {id:0} as User;\n\t\t\t\tif (window.self !== window.parent) {\n\t\t\t\t\twindow.parent.postMessage({type:'sub-frame-started', hash: appInFrame.hash}, '*');\n\t\t\t\t}\n\t\t\t\t// 下面这一句，已经移到 appBridge.ts 里面的 initSubWin，也就是响应从main frame获得user之后开始。\n\t\t\t\t//await this.showAppView();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet predefinedUnit = await this.loadPredefinedUnit();\n\t\tappInFrame.predefinedUnit = predefinedUnit;\n\t}\n\n    async start() {\n        try {\n\t\t\twindow.onerror = this.windowOnError;\n            window.onunhandledrejection = this.windowOnUnhandledRejection;\n            //window.addEventListener('click', this.windowOnClick);\n            //window.addEventListener('mousemove', this.windowOnMouseMove);\n            //window.addEventListener('touchmove', this.windowOnMouseMove);\n            //window.addEventListener('scroll', this.windowOnScroll);\n            if (isMobile === true) {\n                document.onselectstart = function() {return false;}\n                document.oncontextmenu = function() {return false;}\n            }\n            //window.setInterval(()=>console.error('tick every 5 seconds'), 5000);\n\t\t\tnav.clear();\n\t\t\tthis.startWait();\n            \n            let user: User = this.local.user.get();\n            if (user === undefined) {\n                let {notLogined} = this.nav.props;\n                if (notLogined !== undefined) {\n                    await notLogined();\n                }\n                else {\n                    await nav.showLogin(undefined);\n                }\n                return;\n            }\n\n            await nav.logined(user);\n        }\n        catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tdebugger;\n        }\n        finally {\n            this.endWait();\n        }\n\t}\n\n\tresolveRoute() {\n\t\tif (this.isRouting === false) return;\n\t\tif (this.navigo === undefined) return;\n\t\tthis.navigo.resolve();\n\t}\n\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\ton(...args:any[]):Navigo {\n\t\tif (this.navigo === undefined) {\n\t\t\tthis.navigo = new Navigo();\n\t\t}\n\t\treturn this.navigo.on(args[0], args[1], args[2]);\n\t}\n\n\tnavigate(url:string, absolute?:boolean) {\n\t\tthis.clear();\n\t\treturn this.navigo.navigate(url, absolute);\n\t}\n\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tif (this.navigo !== undefined) {\n\t\t\tthis.navigate(url, absolute);\n\t\t}\n\t\telse {\n\t\t\tshowPage();\n\t\t}\n\t}\n\n    async showAppView(isUserLogin?: boolean) {\n        let {onLogined} = this.nav.props;\n        if (onLogined === undefined) {\n            nav.push(<div>NavView has no prop onLogined</div>);\n            return;\n        }\n        nav.clear();\n        await onLogined(isUserLogin);\n    }\n\n    setGuest(guest: Guest) {\n        this.local.guest.set(guest);\n        netToken.set(0, guest.token);\n    }\n\n    saveLocalUser() {\n        this.local.user.set(this.user);\n    }\n\n    async loadMe() {\n        let me = await userApi.me();\n        this.user.icon = me.icon;\n        this.user.nick = me.nick;\n    }\n\n\tprivate async internalLogined(user: User, callback: (user:User)=>Promise<void>, isUserLogin:boolean) {\n        logoutApis();\n        console.log(\"logined: %s\", JSON.stringify(user));\n        this.user = user;\n        this.saveLocalUser();\n\t\tnetToken.set(user.id, user.token);\n\t\tnav.clear();\n\n        if (callback !== undefined) //this.loginCallbacks.has)\n            callback(user);\n            //this.loginCallbacks.call(user);\n        else {\n            await this.showAppView(isUserLogin);\n        }\n\t}\n\n\t// 缓冲登录\n    async logined(user: User, callback?: (user:User)=>Promise<void>) {\n\t\tawait this.internalLogined(user, callback, false);\n    }\n\n\t// 用户操作之后登录\n    async userLogined(user: User, callback?: (user:User)=>Promise<void>) {\n\t\tawait this.internalLogined(user, callback, true);\n    }\n\n    //wsConnect() {\n        //let ws:WSChannel = this.ws = new WSChannel(this.wsHost, this.user.token);\n        //ws.connect();\n    //}\n\n    loginTop(defaultTop:JSX.Element) {\n        return (this.navSettings && this.navSettings.loginTop) || defaultTop;\n    }\n\n    privacyEntry() {\n        if (!this.getPrivacyContent()) return;\n        return <div className=\"text-center\">\n            <button className=\"btn btn-sm btn-link\"\n                onClick={this.showPrivacyPage}>\n                <small className=\"text-muted\">隐私政策</small>\n            </button>\n        </div>;\n    }\n\n    private getPrivacyContent():string {\n        if (!this.navSettings) return;\n        let {privacy} = this.navSettings;\n        return privacy;\n    }\n\n    showPrivacyPage = () => {\n        let privacy = this.getPrivacyContent();\n        if (privacy) {\n            this.privacyPage(privacy);\n        }\n        else {\n            nav.push(<Page header=\"隐私政策\">\n                <div className=\"p-3\">AppConfig 中没有定义 privacy。可以定义为字符串，或者url。markdown格式</div>\n            </Page>);\n        }\n    }\n\n    private privacyPage = async (privacy:string) => {\n        let html = await this.getPrivacy(privacy);\n        let content = {__html: marked(html)};\n        nav.push(<Page header=\"隐私政策\">\n            <div className=\"p-3\" dangerouslySetInnerHTML={content} />\n        </Page>);\n    }\n\n    private async getPrivacy(privacy:string):Promise<string> {\n        const headers = new  Headers({\n            \"Content-Type\":'text/plain'\n       })\n        let pos = privacy.indexOf('://');\n        if (pos > 0) {\n            let http = privacy.substring(0, pos).toLowerCase();\n            if (http === 'http' || http === 'https') {\n                try {\n                    let res = await fetch(privacy, {\n                        method:'GET',\n                        headers: headers,\n                    });\n                    let text = await res.text();\n                    return text;\n                }\n                catch (err) {\n                    return err.message;\n                }\n            }\n        }\n        return privacy;\n    }\n\n    async showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean) {\n        let lv = await import('../entry/login');\n        let loginView = React.createElement(\n\t\t\tlv.default, \n\t\t\t{withBack, callback}\n\t\t);\n        if (withBack !== true) {\n            this.nav.clear();\n            this.pop();\n        }\n        this.nav.push(loginView);\n    }\n\n    async showLogout(callback?: ()=>Promise<void>) {\n        let footer = <div className=\"text-center justify-content-center\">\n            <button className=\"btn btn-outline-danger\" onClick={this.resetAll}>升级软件</button>\n        </div>;\n        nav.push(<Page header=\"安全退出\" back=\"close\" footer={footer}>\n            <div className=\"my-5 mx-1 border border-info bg-white rounded p-3 text-center\">\n                <div>退出当前账号不会删除任何历史数据，下次登录依然可以使用本账号</div>\n                <div className=\"mt-3 text-center\">\n                        <button className=\"btn btn-danger\" onClick={()=>this.logout(callback)}>安全退出</button>\n                </div>\n            </div>\n        </Page>);\n    }\n\n    async logout(callback?:()=>Promise<void>) { //notShowLogin?:boolean) {\n        appInFrame.unit = undefined;\n        this.local.logoutClear();\n        this.user = undefined; //{} as User;\n        logoutApis();\n        let guest = this.local.guest.get();\n        setCenterToken(0, guest && guest.token);\n\t\t//this.ws = undefined;\n\t\tthis.clear();\n        if (callback === undefined)\n            await nav.start();\n        else\n            await callback();\n    }\n\n    async changePassword() {\n        let cp = await import('../entry/changePassword');\n        nav.push(<cp.ChangePasswordPage />);\n    }\n\n    get level(): number {\n        return this.nav.level;\n    }\n    startWait() {\n        this.nav?.startWait();\n    }\n    endWait() {\n        this.nav?.endWait();\n    }\n    async onError(error: FetchError) {\n        await this.nav.onError(error);\n    }\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        await this.nav.showUpgradeUq(uq, version);\n    }\n\n    show (view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.show(view, disposer);\n    }\n    push(view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.push(view, disposer);\n    }\n    replace(view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.replace(view, disposer);\n    }\n    pop(level:number = 1) {\n        this.nav.pop(level);\n    }\n    topKey():number {\n        return this.nav.topKey();\n    }\n    popTo(key:number) {\n        this.nav.popTo(key);\n    }\n    clear() {\n        this.nav?.clear();\n    }\n    navBack() {\n        this.nav.navBack();\n    }\n    ceaseTop(level?:number) {\n        this.nav.ceaseTop(level);\n    }\n    removeCeased() {\n        this.nav.removeCeased();\n    }\n    async back(confirm:boolean = true) {\n        await this.nav.back(confirm);\n    }\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        this.nav.regConfirmClose(confirmClose);\n    }\n    confirmBox(message?:string): boolean {\n        return this.nav.confirmBox(message);\n    }\n    async navToApp(url: string, unitId: number, apiId?:number, sheetType?:number, sheetId?:number):Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            let sheet = this.centerHost.includes('http://localhost:') === true? 'sheet_debug':'sheet'\n            let uh = sheetId === undefined?\n                    appUrl(url, unitId) :\n                    appUrl(url, unitId, sheet, [apiId, sheetType, sheetId]);\n            console.log('navToApp: %s', JSON.stringify(uh));\n            nav.push(<article className='app-container'>\n                <span id={uh.hash} onClick={()=>this.back()} /*style={mobileHeaderStyle}*/>\n                    <i className=\"fa fa-arrow-left\" />\n                </span>\n                {\n                    // eslint-disable-next-line \n                    <iframe src={uh.url} title={String(sheetId)} />\n                }\n            </article>, \n            ()=> {\n                resolve();\n            });\n        });\n    }\n\n    navToSite(url: string) {\n        // show in new window\n        window.open(url);\n    }\n\n    get logs() {return logs};\n    log(msg:string) {\n        logs.push(msg);\n    }\n    logMark() {\n        let date = new Date();\n        logMark = date.getTime();\n        logs.push('log-mark: ' + date.toTimeString());\n    }\n    logStep(step:string) {\n        logs.push(step + ': ' + (new Date().getTime() - logMark));\n    }\n\n    showReloadPage(msg: string) {\n        let seconds = -1;\n\t\tthis.push(<ReloadPage message={msg} seconds={seconds} />);\n\t\t/*\n\t\tif (seconds > 0) {\n\t\t\tenv.setTimeout(undefined, this.reload, seconds*1000);\n\t\t}\n\t\t*/\n    }\n\n    reload = async () => {\n        let waiting:Promise<void> = new Promise<void>((resolve, reject) => {\n            setTimeout(resolve, 100);\n        });\n\n        if ('serviceWorker' in navigator) {\n            let registration =await Promise.race([waiting, navigator.serviceWorker.ready]);\n            if (registration) registration.unregister();\n        }\n\t\twindow.document.location.reload();\n\t\t// dcloud hbuilder里面的app自动升级，需要清webview的缓存\n\t\tlet plus = (window as any).plus;\n\t\tif (plus) {\n\t\t\tlet webview = plus.webview;\n\t\t\tif (webview) {\n\t\t\t\tif (webview.reload) webview.reload(true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet webView = plus.webView;\n\t\t\t\tif (webView) {\n\t\t\t\t\tif (webView.reload) webView.reload(true);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//plus.webview.reload(true)\n\t\t}\n    }\n\n    resetAll = () => {\n        this.push(<ConfirmReloadPage confirm={(ok:boolean):Promise<void> => {\n            if (ok === true) {\n                this.showReloadPage('彻底升级');\n\t\t\t\tlocalStorage.clear();\n\t\t\t\t/*\n                this.local.readToMemory();\n                env.localDb.removeAll();\n\t\t\t\tthis.local.saveToLocalStorage();\n\t\t\t\t*/\n            }\n            else {\n                this.pop();\n            }\n            return;\n        }} />);\n    }\n\n    async checkVersion():Promise<string> {\n        let {href} = document.location;\n        href += (href.indexOf('?')>=0? '&':'?') + '_t_t_=' + new Date().getTime();\n        let ret = await fetch(href);\n        let r = await ret.text();\n        let parser = new DOMParser();\n        let htmlDoc = parser.parseFromString(r, 'text/html');\n        let elHtml = htmlDoc.getElementsByTagName('html');\n        let newVersion = elHtml[0].getAttribute('data-version');\n        return newVersion;\n    }\n}\nexport const nav: Nav = new Nav();\n\nexport class TonvaView extends NavView {\n\n}\n","\nimport {setCenterToken} from './uqApi';\nimport {WSChannel} from './wsChannel';\n\nexport const netToken = {\n    set(userId:number, token:string) {\n        setCenterToken(userId, token);\n        WSChannel.setCenterToken(token);\n    },\n    clear() {\n        setCenterToken(0, undefined);\n        WSChannel.setCenterToken(undefined);\n    }\n};\n","import * as React from 'react';\nimport {FetchError} from '../net/fetchError';\nimport { refetchApi } from '../net';\nimport { Page } from './page/page';\n\nexport interface FetchErrorProps extends FetchError {\n    clearError: ()=>void\n}\n\nexport default class FetchErrorView extends React.Component<FetchErrorProps, null> {\n    private reApi = async () => {\n        this.props.clearError();\n        const {channel, url, options, resolve, reject} = this.props;\n        await refetchApi(channel, url, options, resolve, reject);\n    }\n    private close = async () => {\n        this.props.clearError();\n    }\n    render() {\n        let {error, url} = this.props;\n        let errContent:any;\n        if (typeof error === 'object') {\n            let err = [];\n            for (let i in error) {\n                err.push(<li key={i}><label>{i}</label><div style={{wordWrap:\"break-word\"}}>{error[i]}</div></li>);\n            }\n            errContent = <ul>{err}</ul>;\n        }\n        else {\n            errContent = <div>{error}</div>;\n        }\n        return <div>\n            <article>\n\t\t\t\t<main className=\"va-error\">\n\t\t\t\t\t<div>网络出现问题</div>\n\t\t\t\t\t<div>点击重新访问</div>\n\t\t\t\t\t<div style={{wordWrap:\"break-word\"}}>url: {url}</div>\n\t\t\t\t\t{errContent}\n\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t<button type='button' onClick={this.reApi}>重新API</button>\n\t\t\t\t\t\t<button type='button' onClick={this.close}>关闭</button>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n            </article>\n        </div>;\n    }\n}\n\nexport const SystemNotifyPage = ({message}:{message:string}):JSX.Element => {\n    return <Page header=\"系统提醒\">\n        <div className=\"px-3\">{message}</div>\n    </Page>;\n}","import * as React from 'react';\nimport { nav } from './nav';\nimport { Page } from './page/page';\n\ninterface Props {\n    message: string,\n    seconds: number\n}\n\ninterface State {\n    seconds: number\n}\n\nexport class ReloadPage extends React.Component<Props, State> {\n    private timerHandler:any;\n    constructor(props:Props) {\n\t\tsuper(props);\n\t\tlet {seconds} = props;\n\t\tif (seconds===undefined) return;\n        this.state = {seconds};\n\t\tif (seconds <= 0) return;\n        this.timerHandler = setInterval(() => {\n\t\t\tlet {seconds} = this.state;\n            seconds--;\n            if (seconds <= 0) {\n                this.reload();\n            }\n            else {\n                this.setState({seconds: seconds});\n            }\n        }, 1000);\n    }\n    private reload = () => {\n        clearInterval(this.timerHandler);\n        nav.reload();\n    }\n    render() {\n\t\tlet {seconds} = this.state;\n\t\tlet title:string, msg:string;\t\t\n\t\tif (seconds > 0) {\n\t\t\ttitle = '程序升级中...';\n\t\t\tmsg = this.state.seconds + '秒钟之后自动重启动';\n\t\t}\n\t\telse {\n\t\t\ttitle = '程序需要升级';\n\t\t\tmsg = '请点击下面按钮重启';\n\t\t}\n        return <Page header={false}>\n            <div className=\"text-center p-5\">\n                <div className=\"text-info py-5\">\n\t\t\t\t\t<span className=\"text-danger\">{title}</span>\n\t\t\t\t\t<br/>\n\t\t\t\t\t{msg}\n                    <br/>\n                    <span className=\"small text-muted\">{this.props.message}</span>\n                </div>\n                <button className=\"btn btn-danger\" onClick={this.reload}>立刻重启</button>\n            </div>\n        </Page>;\n    }\n}\n\ninterface ConfirmReloadPageProps {\n    confirm: (ok: boolean)=>Promise<void>;\n}\nexport const ConfirmReloadPage = (props: ConfirmReloadPageProps):JSX.Element => {\n    return <Page header=\"升级软件\" back=\"close\">\n        <div className=\"py-5 px-3 my-5 mx-2 border bg-white rounded\">\n            <div className=\"text-center text-info\">\n                升级将清除所有本机缓冲区内容，并从服务器重新安装程序！\n            </div>\n            <div className=\"text-center mt-5\">\n                <button className=\"btn btn-danger mr-3\" onClick={()=>props.confirm(true)}>确认升级</button>\n            </div>\n        </div>\n    </Page>;\n    // <button className=\"btn btn-outline-danger\" onClick={()=>props.confirm(false)}>暂不</button>\n}\n","import {observable} from 'mobx';\n\nexport interface Id {\n    id: number;\n}\n\nexport abstract class CacheIds<T extends Id> {\n    constructor(maxCount:number = 100) {\n        this.maxCount = maxCount;\n    }\n    private maxCount:number;\n    private arr:T[] = [];\n    @observable dict = new Map<number, T>();\n\n    loadIds(ids:number[]) {\n        let arr:number[] = [];\n        for (let id of ids) {\n            if (id === null) continue;\n            let item = this.dict.get(id);\n            if (item === undefined) {\n                arr.push(id);\n                item = {id:id} as T;\n                this.dict.set(id, item);\n            }\n        }                \n        this.loadId(arr);\n    }\n\n    get(id:number):T {\n        if (id === undefined || id === null) return null;\n        let item = this.dict.get(id);\n        if (item === undefined) {\n            this.dict.set(id, {id:id} as T);\n            this.loadId([id]);\n            item = this.dict.get(id);\n        }\n        return item;\n    }\n    private setItem(id:number, item:T) {\n        if (item === undefined) {\n            this.dict.set(id, null);\n            this.arr.push({id: id} as T);\n        }\n        else {\n            this.dict.set(id, item);\n            this.arr.push(item);\n        }\n        if (this.arr.length > this.maxCount) {\n            item = this.arr.shift();\n            this.dict.delete(item.id);\n        }\n    }\n    private async loadId(ids:number[]) {\n        let items = await this._loadIds(ids);\n        if (items === undefined) {\n            for (let id of ids) {\n                if (id === null) continue;\n                let item = await this._loadId(id);\n                this.setItem(id, item);\n            }\n        }\n        else {\n            for (let id of ids) {\n                let item = items.find(v => v.id === id);\n                this.setItem(id, item);\n            }\n        }\n    }\n\n    protected abstract async _loadIds(ids:number[]):Promise<T[]>;\n    protected abstract async _loadId(id:number):Promise<T>;\n}\n","import { env } from './env';\n\nexport class LocalData {\n    user = env.localDb.child('user');\n    guest = env.localDb.child('guest');\n    unit = env.localDb.child('unit');\n\n    private _user:string;\n    private _guest:string;\n    private _unit:string;\n    readToMemory() {\n        this._user = this.user.get();\n        this._guest = this.guest.get();\n        this._unit = this.unit.get();\n    }\n    saveToLocalStorage() {\n        this.user.set(this._user);\n        this.guest.set(this._guest);\n        this.unit.set(this._unit);\n    }\n\n    logoutClear() {\n        [\n            this.user,\n            this.unit,\n        ].forEach(d => d.remove());\n    }\n}\n","export function getObjPropIgnoreCase(obj:any, prop:string):any {\n\tif (!obj) return;\n\tif (!prop) return;\n\tlet keys = Object.keys(obj);\n\tprop = prop.toLowerCase();\n\tfor (let key of keys) {\n\t\tif (key.toLowerCase() === prop) return obj[key];\n\t}\n\treturn;\n}\n","import * as React from 'react';\nimport {nav} from '../nav';\n\nexport interface PageHeaderProps {\n    back?: 'back' | 'close' | 'none';\n    center: string | JSX.Element;\n    right?: JSX.Element;\n    logout?: boolean | (()=>Promise<void>);\n    className?: string;\n\tafterBack?: () => void;\n\tex?: JSX.Element;\n}\n\nexport class PageHeader extends React.Component<PageHeaderProps> {\n    private back = async () => {\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\n\t\tlet {afterBack} = this.props;\n\t\tif (afterBack) afterBack();\n    }\n    openWindow() {\n        window.open(document.location.href);\n    }\n    private logoutClick = () => {\n        nav.showLogout(this.logout);\n    }\n    private logout = async () => {\n        let {logout} = this.props;\n        if (typeof logout === 'function') {\n            await logout(); \n        }\n        await nav.logout(undefined);\n    }\n    render() {\n        let b = nav.level > 1 || window.self !== window.top;\n        let {right, center, logout, className, ex} = this.props;\n        let back:any, debugLogout:any;\n        if (logout !== undefined && window.self === window.top) {\n            if ((typeof logout === 'boolean' && logout === true)\n                || typeof logout === 'function')\n            {\n                let {user} = nav;\n                if (user !== undefined) {\n                    let {nick, name} = user;\n                    debugLogout = <div className=\"d-flex align-items-center\">\n                        <small className=\"text-light\">{nick || name}</small>\n                        {\n                            // eslint-disable-next-line\n                            <div className=\"ml-2 py-2 px-3 cursor-pointer\"\n                                role=\"button\"\n                                onClick={this.logoutClick}>\n                                <i className=\"fa fa-sign-out fa-lg\" />\n                            </div>\n                        }\n                    </div>;\n                }\n            }\n        }\n        if (b) {\n            switch (this.props.back) {\n                case 'none':\n                    back = undefined;\n                    break;\n                default:\n                case 'back':\n                    back = <nav onClick={this.back}><i className=\"fa fa-angle-left\" /></nav>;\n                    break;\n                case 'close':\n                    back = <nav onClick={this.back}><i className=\"fa fa-close\" /></nav>;\n                    break;\n            }\n        }\n        if (window.self !== window.top) {\n            console.log(document.location.href);\n            // pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\n        }\n        if (back === undefined && typeof center === 'string') {\n            center = <div className=\"px-3\">{center}</div>;\n        }\n\t\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\n\t\tlet header = <header className={className}>\n\t\t\t<nav>\n\t\t\t\t{back}\n\t\t\t\t{/*pop 弹出window暂时停止作用 */}\n\t\t\t\t<div>{center}</div>\n\t\t\t\t{rightView}\n\t\t\t</nav>\n\t\t\t{ex}\n\t\t</header>;\n        return <>\n\t\t\t<section className=\"tv-page-header\">{header}</section>\n\t\t\t{header}\n\t\t</>;\n\t\t/*\n\t\t\t<header className={className}>\n\t\t\t<section>\n\t\t\t\t<header>\n\t\t\t\t\t{back}\n\t\t\t\t\t<div>{center}</div>\n\t\t\t\t\t{rightView}\n\t\t\t\t</header>\n\t\t\t</section>\n            {back}\n            <div>{center}</div>\n            {rightView}\n        </header>;*/\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport {PageHeader} from './pageHeader';\nimport { TabsProps, TabsView } from './tabs';\nimport { ScrollProps, ScrollView } from './scrollView';\n\nexport interface IVPage {\n\tcontent():JSX.Element;\n\theader():JSX.Element;\n\tfooter():JSX.Element;\n}\n\n\nexport interface PageProps extends ScrollProps {\n    back?: 'close' | 'back' | 'none';\n    header?: boolean | string | JSX.Element;\n    right?: JSX.Element;\n    footer?: JSX.Element;\n    logout?: boolean | (()=>Promise<void>);\n\theaderClassName?: string;\n\tclassName?: string;\n\tafterBack?: () => void;\n\ttabsProps?: TabsProps;\n}\n\n@observer\nexport class Page extends React.Component<PageProps> {\n\tprivate tabsView: TabsView;\n    constructor(props: PageProps) {\n\t\tsuper(props);\n\t\tlet {tabsProps} = props;\n\t\tif (tabsProps) {\n\t\t\tthis.tabsView = new TabsView(tabsProps);\n\t\t}\n\t}\n\n\tprivate renderHeader() {\n\t\tconst {back, header, right, headerClassName, afterBack} = this.props;\n\t\tlet pageHeader = header !== false && <PageHeader \n\t\t\tback={back} \n\t\t\tcenter={header as any}\n\t\t\tright={right}\n\t\t\tlogout={this.props.logout}\n\t\t\tclassName={headerClassName}\n\t\t\tafterBack={afterBack}\n\t\t\t/>;\n\t\treturn pageHeader;\n\t}\n\n\tprivate renderFooter() {\n\t\tconst {footer} = this.props;\n\t\tif (footer) {\n\t\t\tlet elFooter = <footer>{footer}</footer>;\n\t\t\treturn <>\n\t\t\t\t<section className=\"tv-page-footer\">{elFooter}</section>\n\t\t\t\t{elFooter}\n\t\t\t</>;\n\t\t}\n\t}\n\n    render() {\n\t\tif (this.tabsView) {\n\t\t\treturn React.createElement(this.tabsView.content);\n\t\t}\n\t\tconst {onScroll, onScrollTop, onScrollBottom, children, className} = this.props;\n\t\treturn <ScrollView\n\t\t\tonScroll={onScroll}\n\t\t\tonScrollTop={onScrollTop}\n\t\t\tonScrollBottom={onScrollBottom}\n\t\t\tclassName={className}\n\t\t>\n\t\t\t{this.renderHeader()}\n\t\t\t<main>{children}</main>\n\t\t\t{this.renderFooter()}\n\t\t</ScrollView>;\n\t}\n}\n","import _ from 'lodash';\nimport {nav} from '../components';\nimport {uid} from '../tool/uid';\nimport {uqTokenApi, callCenterapi, centerToken, setCenterToken} from './uqApi';\nimport {setSubAppWindow} from './wsChannel';\nimport { host } from './host';\n\nexport interface UqToken {\n    name: string;\n    db: string;\n    url: string;\n    token: string;\n}\nconst uqTokens:{[uqName:string]: UqToken}  = {};\nexport function logoutUqTokens() {\n    for (let i in uqTokens) {\n        uqTokens[i] = undefined;\n    }\n}\n\nexport interface AppInFrame {\n    hash: string;\n    unit: number;       // unit id\n    page?: string;\n    param?: string[];\n    predefinedUnit?: number;  // 比如像Cart这样的应用，直接让用户访问的，就需要在unit.json里面定义unitName\n}\nconst appsInFrame:{[key:string]:AppInFrame} = {};\n\nclass AppInFrameClass implements AppInFrame {\n    hash: string;\n    private _unit: number;\n    get unit(): number {return this._unit;}       // unit id\n    set unit(val:number) { this._unit=val;}\n    page?: string;\n    param?: string[];\n}\n\nexport let appInFrame:AppInFrame = new AppInFrameClass();\n/* {\n    hash: undefined,\n    get unit():number {return } undefined, //debugUnitId,\n    page: undefined;\n    param: undefined,\n}*/\n\nexport function isBridged():boolean {\n    return window.self !== window.parent;\n}\n\nwindow.addEventListener('message', async function(evt) {\n    var message = evt.data;\n    switch (message.type) {\n        case 'sub-frame-started':\n            subFrameStarted(evt);\n            break;\n        case 'ws':\n            //wsBridge.receive(message.msg);\n            await nav.onReceive(message.msg);\n            break;\n        case 'init-sub-win':\n            await initSubWin(message);\n            break;\n        case 'pop-app':\n            window.console.log('///\\\\\\\\\\\\ pop-app');\n            nav.navBack();\n            break;\n        case 'center-api':\n            await callCenterApiFromMessage(evt.source as Window, message);\n            break;\n        case 'center-api-return':\n            bridgeCenterApiReturn(message);\n            break;\n        case 'app-api':\n            let ret = await onReceiveAppApiMessage(message.hash, message.apiName);\n            (evt.source as Window).postMessage({\n                type: 'app-api-return', \n                apiName: message.apiName,\n                db: ret.db,\n                url: ret.url,\n                token: ret.token} as any, \"*\");\n            break;\n        case 'app-api-return':\n            console.log(\"app-api-return: %s\", JSON.stringify(message));\n            console.log('await onAppApiReturn(message);');\n            await onAppApiReturn(message);\n            break;\n        default:\n\t\t\tif ((message.source as string)?.startsWith('react-devtools') === true) break;\n            window.console.log('message: %s', JSON.stringify(message));\n            break;\n    }\n});\n\nfunction subFrameStarted(evt:any) {\n    var message = evt.data;\n    let subWin = evt.source as Window;\n    setSubAppWindow(subWin);\n    hideFrameBack(message.hash);\n    let msg:any = _.clone(nav.user);\n    msg.type = 'init-sub-win';\n    subWin.postMessage(msg, '*');\n}\nfunction hideFrameBack(hash:string) {\n    let el = document.getElementById(hash);\n    if (el !== undefined) el.hidden = true;\n}\nasync function initSubWin(message:any) {\n    console.log('initSubWin: set nav.user', message);\n    let user = nav.user = message; // message.user;\n    setCenterToken(user.id, user.token);\n    await nav.showAppView();\n}\nasync function onReceiveAppApiMessage(hash: string, apiName: string): Promise<UqToken> {\n    let appInFrame = appsInFrame[hash];\n    if (appInFrame === undefined) return {name:apiName, db:undefined, url:undefined, token:undefined};\n    //let unit = getUnit();\n    let {unit, predefinedUnit} = appInFrame;\n    unit = unit || predefinedUnit;\n    if (!unit) {\n        console.error('no unit defined in unit.json or in index.html, or not logined in', unit);\n    }\n    let parts = apiName.split('/');\n    let param = {unit: unit, uqOwner: parts[0], uqName: parts[1], appOwner: parts[2], appName:parts[3]};\n    console.log('uqTokenApi.uq onReceiveAppApiMessage', param);\n    let ret = await uqTokenApi.uq(param);\n    let {db, url, token} = ret;\n    return {name: apiName, db:db, url: url, token: token};\n}\n\nasync function onAppApiReturn(message:any) {\n    let {apiName, db, url, urlTest, token} = message;\n    let action = uqTokenActions[apiName];\n    if (action === undefined) {\n        throw new Error('error app api return');\n        //return;\n    }\n    let realUrl = host.getUrlOrTest(db, url, urlTest);\n    console.log('onAppApiReturn(message:any): url=' + url + ', real=' + realUrl);\n    //action.url = realUrl;\n    //action.token = token;\n    action.resolve({\n        name: apiName,\n        db: db,\n        url: realUrl,\n        token: token,\n    } as UqToken);\n}\n\nexport function setAppInFrame(appHash: string):AppInFrame {\n    if (appHash) {\n        let parts = appHash.split('-');\n        let len = parts.length;\n        if (len > 0) {\n            let p = 1;\n            appInFrame.hash = parts[p++];\n            if (len>0) appInFrame.unit = Number(parts[p++]);\n            if (len>1) appInFrame.page = parts[p++];\n            if (len>2) appInFrame.param = parts.slice(p++);\n        }\n    }\n    return appInFrame;\n}\n\nexport function getExHashPos():number {\n    let hash = document.location.hash;\n    if (hash !== undefined && hash.length > 0) {\n        let pos = hash.lastIndexOf('#tv-');\n        if (pos < 0) pos = hash.lastIndexOf('#tvdebug-');\n        return pos;\n    }\n    return -1;\n}\n\nexport function getExHash():string {\n    let pos = getExHashPos();\n    if (pos < 0) return undefined;\n    return document.location.hash.substring(pos);\n}\n\nexport function appUrl(url: string, unitId: number, page?:string, param?:any[]):{url:string; hash:string} {\n    let u:string;\n    for (;;) {\n        u = uid();\n        let a = appsInFrame[u];\n        if (a === undefined) {\n            appsInFrame[u] = {hash:u, unit:unitId};\n            break;\n        }\n    }\n    url += '#tv-' + u + '-' + unitId;\n    if (page !== undefined) {\n        url += '-' + page;\n        if (param !== undefined) {\n            for (let i=0; i<param.length; i++) {\n                url += '-' + param[i];\n            }\n        }\n    }\n    return {url: url, hash: u};\n}\n\nfunction getUnit():number {\n\tlet {unit, predefinedUnit} = appInFrame;\n    let realUnit = unit || predefinedUnit;\n    if (realUnit === undefined) {\n        throw new Error('no unit defined in unit.json or not logined in');\n\t}\n    return realUnit;\n}\n\ninterface UqTokenAction {\n    resolve: (value?: UqToken | PromiseLike<UqToken>) => void;\n    reject: (reason?: any) => void;\n}\nconst uqTokenActions:{[uq:string]: UqTokenAction} = {};\nexport async function buildAppUq(uq:string, uqOwner:string, uqName:string, appOwner:string, appName:string):Promise<void> {\n    if (!isBridged()) {\n        let unit = getUnit();\n        let uqToken = await uqTokenApi.uq({unit,  uqOwner, uqName, appOwner, appName});\n        if (uqToken.token === undefined) uqToken.token = centerToken;\n        let {db, url, urlTest} = uqToken;\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\n        console.log('realUrl: %s', realUrl);\n        uqToken.url = realUrl;\n        uqTokens[uq] = uqToken;\n        return uqToken;\n    }\n    console.log(\"**** before buildAppUq ****\", appInFrame);\n    let bp = uqTokenActions[uq];\n    if (bp !== undefined) return;\n    return new Promise<void>((resolve, reject) => {\n        uqTokenActions[uq] = {\n            resolve: async (at:any) => {\n                let {db, url, token} = await at;\n                uqTokens[uq] = {\n                    name: uq,\n                    db: db,\n                    url: url,\n                    token: token,\n                };\n                uqTokenActions[uq] = undefined;\n                console.log(\"**** after buildAppUq ****\", appInFrame);\n                resolve();\n            },\n            reject: reject,\n        };\n        (window.opener || window.parent).postMessage({\n            type: 'app-api',\n            apiName: uq,\n            hash: appInFrame.hash,\n        }, \"*\");\n    });\n}\n\nexport function appUq(uq:string):UqToken {\n    let uts = uqTokens;\n    return uts[uq];\n}\n\ninterface BridgeCenterApi {\n    id: string;\n    resolve: (value?:any)=>any;\n    reject: (reason?:any)=>void;\n}\nconst brideCenterApis:{[id:string]: BridgeCenterApi} = {};\nexport async function bridgeCenterApi(url:string, method:string, body:any):Promise<any> {\n    console.log('bridgeCenterApi: url=%s, method=%s', url, method);\n    return await new Promise<any>(async (resolve, reject) => {\n        let callId:string;\n        for (;;) {\n            callId = uid();\n            let bca = brideCenterApis[callId];\n            if (bca === undefined) {\n                brideCenterApis[callId] = {\n                    id: callId,\n                    resolve: resolve,\n                    reject: reject,\n                }\n                break;\n            }\n        }\n        (window.opener || window.parent).postMessage({\n            type: 'center-api',\n            callId: callId,\n            url: url,\n            method: method,\n            body: body\n        }, '*');\n    });\n}\n\nasync function callCenterApiFromMessage(from:Window, message:any):Promise<void> {\n    let {callId, url, method, body} = message;\n    let result = await callCenterapi.directCall(url, method, body);\n    from.postMessage({\n        type: 'center-api-return',\n        callId: callId,\n        result: result,\n    }, '*');\n}\n\nfunction bridgeCenterApiReturn(message:any) {\n    let {callId, result} = message;\n    let bca = brideCenterApis[callId];\n    if (bca === undefined) return;\n    brideCenterApis[callId] = undefined;\n    bca.resolve(result);\n}\n","//import _ from 'lodash';\nimport { Caller } from '../net';\nimport { Entity } from './entity';\nimport { Action } from './action';\nimport { Query } from './query';\n\ninterface UqResponseSchema {\n    uq: any;\n    entity: any;\n}\n\nexport abstract class EntityCaller<T> extends Caller<T> {\n    private tries: number;\n    protected _entity: Entity;\n\n    constructor(entity: Entity, params:T, waiting: boolean = true) {\n        super(params, waiting);\n        this.tries = 0;\n        this._entity = entity;\n    }\n\n    protected get entity(): Entity {return this._entity;}\n\n    //大多的entityCaller都不需要这个\n    //buildParams() {return this.entity.buildParams(this.params);}\n    \n    async request(): Promise<any> {\n        await this.entity.loadSchema();\n        let ret = await this.innerRequest();\n        return ret;\n    }\n\n    protected async innerCall(): Promise<any> {\n        return await this.entity.uqApi.xcall(this);\n    }\n\n    async innerRequest(): Promise<any> {\n        let jsonResult = await this.innerCall();\n        let {$uq, $modify, res} = jsonResult;\n        this.entity.uq.pullModify($modify);\n        if ($uq === undefined) {\n            //if (res === undefined) debugger;\n            let ret = this.xresult(res);\n            //if (ret === undefined) debugger;\n            return ret;\n        }\n        return await this.retry($uq);\n    }\n\n    xresult(res:any):any {return res}\n\n    get headers(): {[header:string]: string} {\n        let {ver, uq} = this.entity;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }\n\n    private async retry(schema: UqResponseSchema) {\n        ++this.tries;\n        if (this.tries > 5) throw new Error('can not get right uq response schema, 5 tries');\n        this.rebuildSchema(schema);\n        return await this.innerRequest();\n    }\n\n    private rebuildSchema(schema: UqResponseSchema) {\n        let {uq, entity} = schema;\n        if (uq !== undefined) {\n\t\t\tthis.entity.uq.buildEntities(uq);\n\t\t}\n        if (entity !== undefined) {\n\t\t\tthis.entity.setSchema(entity);\n\t\t}\n    }\n}\n\nexport abstract class ActionCaller extends EntityCaller<any> {\n    protected get entity(): Action {return this._entity as Action;}\n}\n\nexport class QueryQueryCaller extends EntityCaller<any> {\n    protected get entity(): Query {return this._entity as Query};\n    get path():string {return `query/${this.entity.name}`;}\n    xresult(res:any) {\n        let data = this.entity.unpackReturns(res);\n        return data;\n    }\n    buildParams() {return this.entity.buildParams(this.params);}\n}\n\nexport class QueryPageCaller extends EntityCaller<any> {\n    protected get params(): {pageStart:any; pageSize:number, params:any} {return this._params};\n\tprotected get entity(): Query {return this._entity as Query};\n\t//results: {[name:string]:any[]};\n\tget path():string {return `query-page/${this.entity.name}`;}\t\n    buildParams() {\n        let {pageStart, pageSize, params} = this.params;\n        let p:any;\n        if (params === undefined) {\n            p = {key: ''};\n        }\n        else {\n            p = this.entity.buildParams(params);\n        }\n        /*\n        switch (typeof params) {\n            case 'undefined': p = {key: ''}; break;\n            default: p = _.clone(params); break;\n        }\n        */\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        return p;\n    };\n    xresult(res:any): {[name:string]:any[]} {\n        let ret = this.entity.unpackReturns(res);\n\t\t//return this.results.$page;// as any[];\n\t\treturn ret;\n    }\n}\n","import { UqApi } from '../net';\nimport { LocalCache } from '../tool';\nimport { UqMan, Field, ArrFields, FieldMap } from './uqMan';\nimport { Tuid } from './tuid';\nimport { getObjPropIgnoreCase } from '../tool';\n\nconst tab = '\\t';\nconst ln = '\\n';\nconst chars = '\\\\ntbfvr';\nconst codeBackSlash = chars.charCodeAt(0);\nconst codeN = chars.charCodeAt(1);\nconst codeT = chars.charCodeAt(2);\nconst codeB = chars.charCodeAt(3);\nconst codeF = chars.charCodeAt(4);\nconst codeV = chars.charCodeAt(5);\nconst codeR = chars.charCodeAt(6);\n\nconst codes = '\\n\\t\\b\\f\\v\\r';\nconst codeBN = codes.charCodeAt(0);\nconst codeBT = codes.charCodeAt(1);\nconst codeBB = codes.charCodeAt(2);\nconst codeBF = codes.charCodeAt(3);\nconst codeBV = codes.charCodeAt(4);\nconst codeBR = codes.charCodeAt(5);\n\nexport abstract class Entity {\n    private jName: string;\n    schema: any;\n    ver: number = 0;\n    sys?: boolean;\n    readonly uq: UqMan;\n    readonly name: string;\n    readonly typeId: number;\n    readonly cache: LocalCache;\n    readonly uqApi: UqApi;\n    abstract get typeName(): string;\n    get sName():string {return this.jName || this.name}\n    fields: Field[];\n    arrFields: ArrFields[];\n    returns: ArrFields[];\n\n    constructor(uq:UqMan, name:string, typeId:number) {\n        this.uq = uq;\n        this.name = name;\n        this.typeId = typeId;\n        this.sys = this.name.indexOf('$') >= 0;\n        this.cache = this.uq.localMap.item(this.name); // new EntityCache(this);\n        this.uqApi = this.uq.uqApi;\n    }\n\n    public face: any;           // 对应字段的label, placeHolder等等的中文，或者语言的翻译\n\n    //getApiFrom() {return this.entities.uqApi;}\n\n    private fieldMaps: {[arr:string]: FieldMap} = {};\n    fieldMap(arr?:string): FieldMap {\n        if (arr === undefined) arr = '$';\n        let ret = this.fieldMaps[arr];\n        if (ret === undefined) {\n            let fields:Field[];\n            if (arr === '$') fields = this.fields;\n            else if (this.arrFields !== undefined) {\n                let arrFields = this.arrFields.find(v => v.name === arr);\n                if (arrFields !== undefined) fields = arrFields.fields;\n            }\n            else if (this.returns !== undefined) {\n                let arrFields = this.returns.find(v => v.name === arr);\n                if (arrFields !== undefined) fields = arrFields.fields;\n            }\n            if (fields === undefined) return {};\n            ret = {};\n            for (let f of fields) ret[f.name] = f;\n            this.fieldMaps[arr] = ret;\n        }\n        return ret;\n    }\n\n    public async loadSchema():Promise<void> {\n        if (this.schema !== undefined) return;\n        let schema = this.cache.get();\n        if (!schema) {\n            schema = await this.uq.loadEntitySchema(this.name);\n        }\n        this.setSchema(schema);\n\t\tthis.buildFieldsTuid();\n\t\tawait this.loadValues();\n\t}\n\t\n\tprotected async loadValues():Promise<any> {}\n\n    // 如果要在setSchema里面保存cache，必须先调用clearSchema\n    public clearSchema() {\n        this.schema = undefined;\n    }\n\n    public setSchema(schema:any) {\n        if (schema === undefined) return;\n        let {name, version} = schema;\n        this.ver = version || 0;\n\t\tthis.setJName(name);\n        this.cache.set(schema);\n\t\tthis.schema = schema;\n\t\tthis.buildFieldsTuid();\n\t}\n\t\n\tprotected setJName(name:string) {\n        if (name !== this.name) this.jName = name;\n\t}\n\n    public buildFieldsTuid() {\n        let {fields, arrs, returns} = this.schema;\n        this.uq.buildFieldTuid(this.fields = fields);\n        this.uq.buildArrFieldsTuid(this.arrFields = arrs, fields);\n        this.uq.buildArrFieldsTuid(this.returns = returns, fields);\n    }\n\n    schemaStringify():string {\n        return JSON.stringify(this.schema, (key:string, value:any) => {\n            if (key === '_tuid') return undefined;\n            return value;\n        }, 4);\n    }\n\n    tuidFromName(fieldName:string, arrName?:string):Tuid {\n        if (this.schema === undefined) return;\n        let {fields, arrs} = this.schema;\n        let entities = this.uq;\n        function getTuid(fn:string, fieldArr:Field[]) {\n            if (fieldArr === undefined) return;\n            let f = fieldArr.find(v => v.name === fn);\n            if (f === undefined) return;\n            return entities.getTuid(f.tuid);\n        }\n        let fn = fieldName.toLowerCase();\n        if (arrName === undefined) return getTuid(fn, fields);\n        if (arrs === undefined) return;\n        let an = arrName.toLowerCase();\n        let arr = (arrs as ArrFields[]).find(v => v.name === an);\n        if (arr === undefined) return;\n        return getTuid(fn, arr.fields);\n    }\n\n    buildParams(params:any):any {\n        let result:any = {};\n        let fields = this.fields;\n        if (fields !== undefined) this.buildFieldsParams(result, fields, params);\n        let arrs = this.arrFields;\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                let {name, fields} = arr;\n                let paramsArr:any[] = params[name];\n                if (paramsArr === undefined) continue;\n                let arrResult:any[] = [];\n                result[name] = arrResult;\n                for (let pa of params) {\n                    let rowResult = {};\n                    this.buildFieldsParams(rowResult, fields, pa);\n                    arrResult.push(rowResult);\n                }\n            }\n        }\n        return result;\n    }\n\n    private buildFieldsParams(result:any, fields:Field[], params:any) {\n        for (let field of fields) {\n            let {name, type} = field;            \n            let d = params[name];\n            let val:any;\n            switch (type) {\n\t\t\t\tcase 'datetime':\n                \tval = this.buildDateTimeParam(d);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'date':\n\t\t\t\t\tif (d instanceof Date) {\n\t\t\t\t\t\tval = `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tval = d;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tswitch (typeof d) {\n\t\t\t\t\t\tdefault: val = d; break;\n\t\t\t\t\t\tcase 'object':\n\t\t\t\t\t\t\tif (d instanceof Date) {\n\t\t\t\t\t\t\t\tval = d;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet tuid = field._tuid;\n\t\t\t\t\t\t\tif (tuid === undefined) val = d.id;\n\t\t\t\t\t\t\telse val = tuid.getIdFromObj(d);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n            }\n            result[name] = val;\n        }\n    }\n\n    buildDateTimeParam(val:any) {\n        let dt: Date;\n        switch (typeof val) {\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\n            case 'undefined': return '';\n            case 'object': dt = (val as Date); break;\n            case 'string':\n            case 'number': dt = new Date(val); break;\n        }\n        return Math.floor(dt.getTime()/1000);\n    }\n\n    buildDateParam(val:any) {\n        let dt: Date;\n        switch (typeof val) {\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\n            case 'undefined': return '';\n            case 'string': return val;\n            case 'object': dt = (val as Date); break;\n            case 'number': dt = new Date(val); break;\n        }\n        let ret = dt.toISOString();\n        let p = ret.indexOf('T');\n        return p>0? ret.substr(0, p) : ret;\n    }\n\n    pack(data:any):string {\n        let ret:string[] = [];\n        let fields = this.fields;\n        if (fields !== undefined) this.packRow(ret, fields, data);\n        let arrs = this.arrFields; \n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n\t\t\t\tlet {name, fields} = arr;\n\t\t\t\tlet arrData = getObjPropIgnoreCase(data, name);\n\t\t\t\t//if (!arrData) arrData = data[name.toLowerCase()];\n                this.packArr(ret, fields, arrData);\n            }\n        }\n        return ret.join('');\n    }\n\n    private escape(row:any, field:Field):any {\n        let d = row[field.name];\n        switch (field.type) {\n            case 'datetime':\n                return this.buildDateTimeParam(d);\n            default:\n                switch (typeof d) {\n                    default: return d;\n                    case 'object':\n                        let tuid = field._tuid;\n                        if (tuid === undefined) return d.id;\n                        return tuid.getIdFromObj(d);\n                    case 'string':\n                        let len = d.length;\n                        let r = '', p = 0;\n                        for (let i=0;i<len;i++) {\n                            let c:number = d.charCodeAt(i), ch:string;\n                            switch(c) {\n\t\t\t\t\t\t\t\tdefault: continue;\n\t\t\t\t\t\t\t\tcase codeBackSlash: ch = '\\\\\\\\'; break;\n                                case codeBT: ch = '\\\\t'; break;\n\t\t\t\t\t\t\t\tcase codeBN: ch = '\\\\n'; break;\n\t\t\t\t\t\t\t\tcase codeBF: ch = '\\\\f'; break;\n\t\t\t\t\t\t\t\tcase codeBV: ch = '\\\\v'; break;\n\t\t\t\t\t\t\t\tcase codeBB: ch = '\\\\b'; break;\n\t\t\t\t\t\t\t\tcase codeBR: ch = '\\\\r'; break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tr += d.substring(p, i) + ch;\n\t\t\t\t\t\t\tp = i+1;\n                        }\n                        return r + d.substring(p);\n                    case 'undefined': return '';\n                }\n        }\n    }\n\n    private packRow(result:string[], fields:Field[], data:any) {\n        let len = fields.length;\n        if (len === 0) return;\n        let ret = '';\n        ret += this.escape(data, fields[0]);\n        for (let i=1;i<len;i++) {\n            let f = fields[i];\n            ret += tab + this.escape(data, f);\n        }\n        result.push(ret + ln);\n    }\n\n    private packArr(result:string[], fields:Field[], data:any[]) {\n        if (data !== undefined) {\n\t\t\tif (data.length === 0) {\n\t\t\t\tresult.push(ln);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (let row of data) {\n\t\t\t\t\tthis.packRow(result, fields, row);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tresult.push(ln);\n\t\t}\n        result.push(ln);\n    }\n    protected cacheFieldsInValue(values:any, fields:Field[]) {\n        for (let f of fields as Field[]) {\n            let {name, _tuid} = f;\n            if (_tuid === undefined) continue;\n            let id = values[name];\n            //_tuid.useId(id);\n            values[name] = _tuid.boxId(id);\n        }\n    }\n\n    protected unpackTuidIdsOfFields(values:string[], fields: Field[]):any[] {\n        if (fields === undefined) return values as any[];\n        //if (this.fields === undefined) return values as any[];\n        let ret:any[] = []\n        for (let ln of values) {\n            if (!ln) continue;\n            let len = ln.length;\n            let p = 0;\n            while (p<len) {\n                let ch = ln.charCodeAt(p);\n                if (ch === 10) {\n                    ++p;\n                    break;\n                }\n                let row = {};\n                p = this.unpackRow(row, fields, ln, p);\n                ret.push(row);\n            }\n        }\n        return ret;\n    }\n\n    unpackSheet(data:string):any {\n        let ret = {} as any; //new this.newMain();\n        //if (schema === undefined || data === undefined) return;\n        let fields = this.fields;\n        let p = 0;\n        if (fields !== undefined) p = this.unpackRow(ret, fields, data, p);\n        let arrs = this.arrFields; //schema['arrs'];\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                p = this.unpackArr(ret, arr, data, p);\n            }\n        }\n        return ret;\n    }\n\n    unpackReturns(data:string):{[name:string]:any[]} {\n        if (data === undefined) debugger;\n        let ret = {} as any;\n        //if (schema === undefined || data === undefined) return;\n        //let fields = schema.fields;\n        let p = 0;\n        //if (fields !== undefined) p = unpackRow(ret, schema.fields, data, p);\n        let arrs = this.returns; //schema['returns'];\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                //let creater = this.newRet[arr.name];\n                p = this.unpackArr(ret, arr, data, p);\n            }\n        }\n        return ret;\n    }\n\n    protected unpackRow(ret:any, fields:Field[], data:string, p:number):number {\n        let ch0 = 0, ch = 0, c = p, i = 0, len = data.length, fLen = fields.length;\n        for (;p<len;p++) {\n            ch0 = ch;\n            ch = data.charCodeAt(p);\n            if (ch === 9) {\n                let f = fields[i];\n                let {name} = f;\n                if (ch0 !== 8) {\n                    if (p>c) {\n                        let v = data.substring(c, p);\n                        ret[name] = this.to(ret, v, f);\n                    }\n                }\n                else {\n                    ret[name] = null;\n                }\n                c = p+1;\n                ++i;\n                if (i>=fLen) {\n                    p = data.indexOf('\\n', c);\n                    if (p >= 0) ++p;\n                    else p = len;\n                    return p;\n                }\n            }\n            else if (ch === 10) {\n                let f = fields[i];\n                let {name} = f;\n                if (ch0 !== 8) {\n                    if (p>c) {\n                        let v = data.substring(c, p);\n                        ret[name] = this.to(ret, v, f);\n                    }\n                }\n                else {\n                    ret[name] = null;\n                }\n                ++p;\n                ++i;\n                return p;\n            }\n        }\n        let f = fields[i];\n        let {name} = f;\n        if (ch0 !== 8) {\n            let v = data.substring(c);\n            ret[name] = this.to(ret, v, f);\n        }\n        return len;\n    }\n\n    private to(ret:any, v:string, f:Field):any {\n        switch (f.type) {\n\t\t\tdefault: return v;\n\t\t\tcase 'text':\n\t\t\tcase 'char':\n\t\t\t\treturn this.reverseNT(v);\n            case 'datetime':\n            case 'time':\n\t\t\tcase 'timestamp':\n                let n = Number(v);\n                let date = isNaN(n) === true? new Date(v) : new Date(n*1000);\n                return date;\n            case 'date':\n                let parts = v.split('-');\n                return new Date(Number(parts[0]), Number(parts[1])-1, Number(parts[2]));\n            case 'tinyint':\n            case 'smallint':\n            case 'int':\n            case 'bigint':\n            case 'dec':\n                return Number(v);\n            case 'id':\n                let id = Number(v);\n                let {_tuid} = f;\n                if (_tuid === undefined) return id;\n                return _tuid.boxId(id);\n        }\n\t}\n\t\n\tprivate reverseNT(text:string):string {\n\t\tif (text === undefined) return;\n\t\tif (text === null) return;\n\t\tlet len = text.length;\n\t\tlet r = '';\n\t\tlet p = 0;\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet c = text.charCodeAt(i);\n\t\t\tif (c === codeBackSlash) {\n\t\t\t\tif (i===len-1) break;\n\t\t\t\tlet c1 = text.charCodeAt(i+1);\n\t\t\t\tlet ch:string;\n\t\t\t\tswitch (c1) {\n\t\t\t\t\tdefault: continue;\n\t\t\t\t\tcase codeBackSlash: ch = '\\\\'; break;\n\t\t\t\t\tcase codeN: ch = '\\n'; break;\n\t\t\t\t\tcase codeT: ch = '\\t'; break;\n\t\t\t\t\tcase codeB: ch = '\\b'; break;\n\t\t\t\t\tcase codeF: ch = '\\f'; break;\n\t\t\t\t\tcase codeV: ch = '\\v'; break;\n\t\t\t\t\tcase codeR: ch = '\\r'; break;\n\t\t\t\t}\n\t\t\t\tr += text.substring(p, i) + ch;\n\t\t\t\tp = i+2;\n\t\t\t\t++i;\n\t\t\t}\n\t\t}\n\t\tr += text.substring(p, len);\n\t\treturn r;\n\t}\n\n    private unpackArr(ret:any, arr:ArrFields, data:string, p:number):number {\n\t\tlet p0 = p;\n        let vals:any[] = [], len = data.length;\n        let {name, fields} = arr;\n        while (p<len) {\n            let ch = data.charCodeAt(p);\n            if (ch === 10) {\n\t\t\t\tif (p === p0) {\n\t\t\t\t\tch = data.charCodeAt(p);\n\t\t\t\t\tif (ch !== 10) {\n\t\t\t\t\t\tthrow new Error('upackArr: arr第一个字符是10，则必须紧跟一个10，表示整个arr的结束')\n\t\t\t\t\t}\n\t\t\t\t\t++p;\n\t\t\t\t}\n                ++p;\n                break;\n            }\n            let val = {} as any; //new creater();\n            vals.push(val);\n            p = this.unpackRow(val, fields, data, p);\n        }\n        ret[name] = vals;\n        return p;\n    }\n}\n","import * as React from 'react';\nimport { ItemSchema, UiItem, UiSelectBase } from '../schema';\nimport { nav } from '../nav';\nimport { observable } from 'mobx';\nimport { FieldRule } from '../form/rules';\nimport { Image } from '../image';\n\nexport abstract class ItemEdit {\n\tprotected name: string;\n\tprotected _itemSchema: ItemSchema;\n    get itemSchema(): ItemSchema {return this._itemSchema}\n    protected _uiItem:UiItem;\n    get uiItem():UiItem {return this._uiItem}\n    value: any;\n    label: string;\n\n    @observable protected error: string;\n    @observable protected isChanged: boolean = false;\n    protected newValue: any;\n\n    constructor(itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) {\n        this._itemSchema = itemSchema;\n        this._uiItem = uiItem\n        this.value = value;\n        let {name} = itemSchema;\n        this.name = name;\n        this.label = label;\n\t}\n\t\n\tinit() {\t\t\n\t}\n\n    async start():Promise<any> {\n        return await this.internalStart();\n    }\n\n    protected abstract internalStart():Promise<any>;\n\n    async end():Promise<any> {\n        await this.internalEnd()\n    }\n\n\trenderContent() {\t\t\n        let {name, type} = this._itemSchema;\n        let divValue:any;\n        let uiItem = this._uiItem;\n        let label:string, labelHide:boolean;\n        if (uiItem === undefined) {\n            label = name;\n        }\n        else {\n\t\t\tlabel = uiItem.label;\n\t\t\tlabelHide = uiItem.labelHide;\n            let templet = uiItem.Templet;\n            if (templet !== undefined) {\n                if (typeof templet === 'function') {\n\t\t\t\t\tif (this.value !== undefined) divValue = templet(this.value);\n\t\t\t\t}\n                else {\n\t\t\t\t\tdivValue = {templet};\n\t\t\t\t}\n            }\n            else if (this.value !== undefined) {\n                switch (uiItem.widget) {\n                    case 'radio':\n                    case 'select':\n                        let {list} = uiItem as UiSelectBase;\n                        divValue = <b>{list.find(v => v.value === this.value).title}</b>;\n                        break;\n                    case 'id':\n                        divValue = <b>no templet for {name}={this.value}</b>\n                        break;\n                }\n            }\n        }\n        if (divValue === undefined) {\n            switch (type) {\n                default:\n                    divValue = this.value? \n\t\t\t\t\t\t<b>{this.value}</b> \n\t\t\t\t\t\t:\n\t\t\t\t\t\t<small className=\"text-muted\">[{labelHide===true? label:'无'}]</small>;\n                    break;\n                case 'image':\n                    divValue = <Image className=\"w-4c h-4c\" src={this.value} />;\n                    break;\n            }\n\t\t}\n\t\treturn divValue;\n\t}\n\n    protected async internalEnd():Promise<void> {nav.pop()}\n\n    protected verifyValue() {\n        if (this.uiItem === undefined) return;\n        let {rules} = this.uiItem;\n        if (rules === undefined) return;\n        let nv = this.newValue;\n        function verifyRule(rule:FieldRule, value: any):string {\n            let error = rule(nv);\n            if (error !== undefined) {\n                if (typeof error !== 'object')\n                    return error;\n                else\n                    return JSON.stringify(error);\n            }\n        }\n        if (Array.isArray(rules)) {\n            for (let rule of rules) {\n                let error = verifyRule(rule as FieldRule, nv);\n                if (error !== undefined) {\n                    this.error = error;\n                    break;\n                }\n            }\n        }\n        else {\n            this.error = verifyRule(rules as FieldRule, nv);\n        }\n    }\n}\n","import {bridgeCenterApi, isBridged} from './appBridge';\nimport {FetchError} from './fetchError';\nimport {HttpChannelUI} from './httpChannelUI';\nimport {nav} from '../components/nav';\nimport { Caller } from './caller';\nimport { env } from '../tool';\n\n/*\nexport async function httpGet(url:string, params?:any):Promise<any> {\n    let channel = new HttpChannel(false, url, undefined, undefined);\n    let ret = await channel.get('', params);\n    return ret;\n}\n\nexport async function httpPost(url:string, params?:any):Promise<any> {\n    let channel = new HttpChannel(false, url, undefined, undefined);\n    let ret = await channel.post('', params);\n    return ret;\n}\n*/\n\nconst methodsWithBody = ['POST', 'PUT'];\n\nexport abstract class HttpChannel {\n    private timeout: number;\n    protected ui?: HttpChannelUI;\n    protected hostUrl: string;\n    protected apiToken: string;\n\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\n        this.hostUrl = hostUrl;\n        this.apiToken = apiToken;\n        this.ui = ui;\n        this.timeout = env.isDevelopment === true? 500000:50000;\n    }\n\n    private startWait = (waiting: boolean) => {\n        if (waiting === true) {\n            if (this.ui !== undefined) this.ui.startWait();\n        }\n    }\n\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\n        if (this.ui !== undefined) this.ui.endWait();\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\n    }\n\n    private showError = async (error:FetchError) => {\n        if (this.ui !== undefined) await this.ui.showError(error);\n    }\n\n    used() {\n        this.post('', {});\n    }\n\n    async xcall(urlPrefix:string, caller:Caller<any>): Promise<void> {\n        let options = this.buildOptions();\n        let {headers, path, method} = caller;\n        if (headers !== undefined) {\n            let h = options.headers;\n            for (let i in headers) {\n                h.append(i, encodeURI(headers[i]));\n            }\n        }\n        options.method = method;\n        let p = caller.buildParams();\n        if (methodsWithBody.indexOf(method) >= 0 && p !== undefined) {\n            options.body = JSON.stringify(p)\n        }\n        return await this.innerFetch(urlPrefix + path, options, caller.waiting);\n    }\n\n    private async innerFetchResult(url: string, options: any, waiting: boolean): Promise<any> {\n        let ret = await this.innerFetch(url, options, waiting);\n        return ret.res;\n    }\n\n    async get(url: string, params: any = undefined, waiting?: boolean): Promise<any> {\n        if (params) {\n            let keys = Object.keys(params);\n            if (keys.length > 0) {\n                let c = '?';\n                for (let k of keys) {\n                    let v = params[k];\n                    if (v === undefined) continue;\n                    url += c + k + '=' + params[k];\n                    c = '&';\n                }\n            }\n        }\n        let options = this.buildOptions();\n        options.method = 'GET';\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async post(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'POST';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async put(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'PUT';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async delete(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'DELETE';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n    async fetch(url: string, options: any, waiting: boolean, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\n        let that = this;\n        this.startWait(waiting);\n        let path = url;\n        function buildError(err: any, ex?: string) {\n            switch (typeof err) {\n                case 'string':\n                    if (ex !== undefined) err += ' ' + ex;\n                    break;\n                case 'object':\n                    let keys = Object.keys(err);\n                    let retErr:any = {\n                        ex: ex,\n                    };\n                    for (let key of keys) {\n                        retErr[key] = err[key];\n                    }\n                    err = retErr;\n                    break;\n            }\n            return {\n                channel: that,\n                url: path,\n                options: options,\n                resolve: resolve,\n                reject: reject,\n                error: err,\n            }\n        }\n        try {\n            console.log('%s-%s %s', options.method, path, options.body || '');\n            let now = Date.now();\n            let timeOutHandler = env.setTimeout(\n                undefined, //'httpChannel.fetch',\n                () => {\n                    that.endWait(url + ' timeout endWait: ' + (Date.now() - now) + 'ms', reject);\n                },\n                this.timeout);\n            let res = await fetch(encodeURI(path), options);\n            if (res.ok === false) {\n                env.clearTimeout(timeOutHandler);\n                console.log('ok false endWait');       \n                that.endWait();\n                console.log('call error %s', res.statusText);\n                throw res.statusText;\n            }\n            let ct = res.headers.get('content-type');\n            if (ct && ct.indexOf('json')>=0) {\n                return res.json().then(async retJson => {\n                    env.clearTimeout(timeOutHandler);\n                    that.endWait();\n                    if (retJson.ok === true) {\n                        if (typeof retJson !== 'object') {\n                            debugger;\n                        }\n                        else if (Array.isArray(retJson) === true) {\n                            debugger;\n                        }\n                        return resolve(retJson);\n                    }\n                    let retError = retJson.error;\n                    if (retError === undefined) {\n                        await that.showError(buildError('not valid tonva json'));\n                    }\n                    else {\n                        await that.showError(buildError(retError, 'retJson.error'));\n                        reject(retError);\n                    }\n                }).catch(async error => {\n                    await that.showError(buildError(error, 'catch res.json()'));\n                });\n            }\n            else {\n                let text = await res.text();\n                env.clearTimeout(timeOutHandler);\n                console.log('text endWait');\n                that.endWait();\n                resolve(text);\n            }\n        }\n        catch(error) {\n            this.endWait(url, reject);\n            if (typeof error === 'string') {\n                let err = error.toLowerCase();\n                if (err.startsWith('unauthorized') === true) {\n                    nav.logout();\n                    return;\n                }\n            }\n            console.error('fecth error (no nav.showError): ' + url);\n            // await this.showError(buildError(error, 'catch outmost'));\n        };\n    }\n\n    protected abstract async innerFetch(url: string, options: any, waiting: boolean): Promise<any>;\n\n    async callFetch(url:string, method:string, body:any):Promise<any> {\n        let options = this.buildOptions();\n        options.method = method;\n        options.body = body;\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(url, options, true, resolve, reject);\n        });\n    }\n\n    private buildOptions(): {method:string; headers:Headers; body:any} {\n        let headers = this.buildHeaders();\n        let options = {\n            headers: headers,\n            method: undefined as any,\n            body: undefined as any,\n            // cache: 'no-cache',\n        };\n        return options;\n    }\n\n    protected buildHeaders():Headers {\n        let {language, culture} = nav;\n        let headers = new Headers();\n        //headers.append('Access-Control-Allow-Origin', '*');\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\n        let lang = language;\n        if (culture) lang += '-' + culture;\n        headers.append('Accept-Language', lang);\n        if (this.apiToken) { \n            headers.append('Authorization', this.apiToken); \n        }\n        return headers;\n    }\n}\n\nexport class CenterHttpChannel extends HttpChannel {\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\n        let u = this.hostUrl + url;\n        if (this.apiToken === undefined && isBridged())\n            return await bridgeCenterApi(u, options.method, options.body);\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(u, options, waiting, resolve, reject);\n        });\n    }\n}\n\nexport class UqHttpChannel extends HttpChannel {\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\n        let u = this.hostUrl + url;\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(u, options, waiting, resolve, reject);\n        });\n    }\n}\n","import {nav} from '../components/nav';\nimport {FetchError} from './fetchError';\n\nexport interface HttpChannelUI {\n    startWait():void;\n    endWait():void;\n    showError(error:FetchError):Promise<void>;\n    showUpgradeUq(uq:string, version:number):Promise<void>;\n}\n\nexport class HttpChannelNavUI implements HttpChannelUI {\n    startWait() {\n        nav.startWait();\n    }\n    endWait() {\n        nav.endWait();\n    }\n    async showError(error:FetchError):Promise<void> {\n        nav.endWait();\n        /*\n        if (error.name === 'SyntaxError') {\n            error = {\n                name: error.name,\n                message: error.message,\n            }\n        }*/\n        await nav.onError(error);\n    }\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        await nav.showUpgradeUq(uq, version);\n    }\n}\n\n","import _ from 'lodash';\nimport {HttpChannel, CenterHttpChannel, UqHttpChannel} from './httpChannel';\nimport {HttpChannelNavUI} from './httpChannelUI';\nimport {appUq, logoutUqTokens, buildAppUq} from './appBridge';\nimport {ApiBase} from './apiBase';\nimport { host } from './host';\nimport { LocalMap, env } from '../tool';\nimport {decodeUserToken} from '../tool/user';\n\nlet channelUIs:{[name:string]: HttpChannel} = {};\nlet channelNoUIs:{[name:string]: HttpChannel} = {};\n\nexport function logoutApis() {\n    channelUIs = {};\n    channelNoUIs = {};\n    logoutUnitxApis();\n    logoutUqTokens();\n}\n\ninterface UqLocal {\n    user: number;\n    unit: number;\n    value: any;\n    tick?: number;\n    isNet?: boolean;\n}\ninterface UqLocals {\n    user: number;\n    unit: number;\n    uqs: {[uq:string]: UqLocal};\n}\n/*\nconst uqLocalEntities = 'uqLocalEntities';\nclass CacheUqLocals {\n    private local:UqLocals;\n\n    async loadAccess(uqApi: UqApi):Promise<any> {\n        try {\n            let {uqOwner, uqName} = uqApi;\n            if (this.local === undefined) {\n                let ls = null; // localStorage.getItem(uqLocalEntities);\n                if (ls !== null) {\n                    this.local = JSON.parse(ls);\n                }\n            }\n            if (this.local !== undefined) {\n                let {user, uqs} = this.local;\n                if (user !== loginedUserId || uqs === undefined) {\n                    this.local = undefined;\n                }\n                else {\n                    for (let i in uqs) {\n                        let ul = uqs[i];\n                        ul.isNet = undefined;\n                    }\n                }\n            }\n            if (this.local === undefined) {\n                this.local = {\n                    user: loginedUserId,\n                    unit: undefined,\n                    uqs: {}\n                };\n            }\n\n            let ret: any;\n            let un = uqOwner+'/'+uqName;\n            let uq = this.local.uqs[un];\n            if (uq !== undefined) {\n                let {value} = uq;\n                ret = value;\n            }\n            if (ret === undefined) {\n                ret = await uqApi.__loadAccess();\n                //this.saveLocal(un, ret);\n            }\n            return _.cloneDeep(ret);\n        }\n        catch (err) {\n            this.local = undefined;\n            localStorage.removeItem(uqLocalEntities);\n            throw err;\n        }\n    }\n\n    private saveLocal(uqName:string, accessValue: any) {\n        this.local.uqs[uqName] = {\n            value: accessValue,\n            isNet: true,\n        }\n        let str = JSON.stringify(this.local);\n        localStorage.setItem(uqLocalEntities, str);\n    }\n\n    async checkAccess(uqApi: UqApi):Promise<boolean> {\n        if (this.local === undefined) return false;\n        let {uqOwner, uqName} = uqApi;\n        let un = uqOwner+'/'+uqName;\n        let uq = this.local.uqs[un];\n        if (uq === undefined) return false;\n        let {isNet, value} = uq;\n        if (isNet === true) return true;\n        let ret = await uqApi.__loadAccess();\n        let isMatch = _.isMatch(value, ret);\n        if (isMatch === false) {\n            this.saveLocal(un, ret);\n            return false;\n        }\n        uq.isNet = true;\n        return true;\n    }\n}\n\nconst localUqs = new CacheUqLocals;\n*/\nexport class UqApi extends ApiBase {\n    private access:string[];\n    appOwner:string;\n    appName:string;\n    uqOwner: string;\n    uqName: string;\n    uq: string;\n\n    constructor(basePath:string, appOwner:string, appName:string, uqOwner:string, uqName:string, access:string[], showWaiting?: boolean) {\n        super(basePath, showWaiting);\n        this.appOwner = appOwner;\n        this.appName = appName;\n        if (uqName) {\n            this.uqOwner = uqOwner;\n            this.uqName = uqName;\n            this.uq = uqOwner + '/' + uqName;\n        }\n        this.access = access;\n        this.showWaiting = showWaiting;\n    }\n\n    //setUqVersion(uqVersion:number) {this.uqVersion = undefined}\n\n    async init() {\n        await buildAppUq(this.uq, this.uqOwner, this.uqName, this.appOwner, this.appName);\n    }\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        let channels: {[name:string]: HttpChannel};\n        let channelUI: HttpChannelNavUI;\n        if (this.showWaiting === true || this.showWaiting === undefined) {\n            channels = channelUIs;\n            channelUI = new HttpChannelNavUI();\n        }\n        else {\n            channels = channelNoUIs;\n        }\n        let channel = channels[this.uq];\n        if (channel !== undefined) return channel;\n        let uqToken = appUq(this.uq); //, this.uqOwner, this.uqName);\n        if (!uqToken) {\n            //debugger;\n            await this.init();\n            uqToken = appUq(this.uq);\n        }\n        let {url, token} = uqToken;\n        this.token = token;\n        channel = new UqHttpChannel(url, token, channelUI);\n        return channels[this.uq] = channel;\n    }\n\n    /*async update():Promise<string> {\n        return await this.get('update');\n    }*/\n\n    /*\n    async __loadAccess():Promise<any> {\n        let acc = this.access === undefined?\n            '' :\n            this.access.join('|');\n        let ret = await this.get('access', {acc:acc});\n        return ret;\n    }\n    */\n    async loadAccess():Promise<any> {\n        //return await localUqs.loadAccess(this);\n        let acc = this.access === undefined?\n            '' :\n            this.access.join('|');\n        let ret = await this.get('access', {acc:acc});\n        return ret;\n    }\n\n    /*async loadEntities():Promise<any> {\n        return await this.get('entities');\n    }*/\n\n    /*\n    async checkAccess():Promise<boolean> {\n        return await localUqs.checkAccess(this);\n    }\n    */\n\n    async schema(name:string):Promise<any> {\n        return await this.get('schema/' + name);\n    }\n\n    async queueModify(start:number, page:number, entities:string) {\n        return await this.post('queue-modify', {start:start, page:page, entities:entities});\n    }\n\n    /*async schemas(names:string[]):Promise<any[]> {\n        return await this.post('schema', names);\n    }*/\n\n    /*\n    async tuidGet(name:string, id:number):Promise<any> {\n        return await this.get('tuid/' + name + '/' + id);\n    }\n\n    async tuidGetAll(name:string):Promise<any[]> {\n        return await this.get('tuid-all/' + name + '/');\n    }\n\n    async tuidSave(name:string, params:any):Promise<any> {\n        return await this.post('tuid/' + name, params);\n    }\n\n    async tuidSearch(name:string, arr:string, owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        let ret = await this.post('tuids/' + name, {\n            arr: arr,\n            owner: owner,\n            key: key,\n            pageStart: pageStart,\n            pageSize: pageSize\n        });\n        return ret;\n    }\n    async tuidArrGet(name:string, arr:string, owner:number, id:number):Promise<any> {\n        return await this.get('tuid-arr/' + name + '/' + owner + '/' + arr + '/' + id);\n    }\n    async tuidArrGetAll(name:string, arr:string, owner:number):Promise<any[]> {\n        return await this.get('tuid-arr-all/' + name + '/' + owner + '/' + arr + '/');\n    }\n    async tuidArrSave(name:string, arr:string, owner:number, params:any):Promise<any> {\n        return await this.post('tuid-arr/' + name + '/' + owner + '/' + arr + '/', params);\n    }\n    async tuidArrPos(name:string, arr:string, owner:number, id:number, order:number):Promise<any> {\n        return await this.post('tuid-arr-pos/' + name + '/' + owner + '/' + arr + '/', {\n            id: id,\n            $order: order\n        });\n    }\n\n    async tuidIds(name:string, arr:string, ids:number[]):Promise<any[]> {\n        try {\n            let url = 'tuidids/' + name + '/';\n            if (arr !== undefined) url += arr;\n            else url += '$';\n            let ret = await this.post(url, ids);\n            return ret;\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n    */\n    /*async sheetSave(name:string, data:object):Promise<any> {\n        return await this.post('sheet/' + name, data);\n    }*/\n\n    /*async sheetAction(name:string, data:object) {\n        return await this.put('sheet/' + name, data);\n    }*/\n\n    /*async stateSheets(name:string, data:object) {\n        return await this.post('sheet/' + name + '/states', data);\n    }*/\n\n    /*async stateSheetCount(name:string):Promise<any> {\n        return await this.get('sheet/' + name + '/statecount');\n    }*/\n\n    /*async mySheets(name:string, data:object) {\n        return await this.post('sheet/' + name + '/my-sheets', data);\n    }*/\n\n    /*async getSheet(name:string, id:number):Promise<any> {\n        return await this.get('sheet/' + name + '/get/' + id);\n    }*/\n\n    /*async sheetArchives(name:string, data:object):Promise<any> {\n        return await this.post('sheet/' + name + '/archives', data);\n    }\n\n    async sheetArchive(name:string, id:number):Promise<any> {\n        return await this.get('sheet/' + name + '/archive/' + id);\n    }*/\n\n    /*async action(name:string, data:object):Promise<any> {\n        return await this.post('action/' + name, data);\n    }\n\n    async actionReturns(name:string, data:object):Promise<any[][]> {\n        return await this.post('action/' + name + '/returns', data);\n    }\n\n    async page(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p:any;\n        switch (typeof params) {\n            case 'undefined': p = {key: ''}; break;\n            default: p = _.clone(params); break;\n        }\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        return await this.post('query-page/' + name, p);\n    }\n\n    async query(name:string, params:any):Promise<any> {\n        let ret = await this.post('query/' + name, params);\n        return ret;\n    }\n    */\n/*\n    async history(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p = _.clone(params);\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        let ret = await this.post('history/' + name, p);\n        return ret;\n    }\n\n    async book(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p = _.clone(params);\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        let ret = await this.post('history/' + name, p);\n        return ret;\n    }\n*/\n    /*async user():Promise<any> {\n        return await this.get('user');\n    }*/\n}\n\nlet channels:{[unitId:number]: HttpChannel} = {};\n\nexport function logoutUnitxApis() {\n    channels = {};\n}\n\nexport class UnitxApi extends UqApi {\n    private unitId:number;\n    constructor(unitId:number) {\n        super('tv/', undefined, undefined, undefined, undefined, undefined, true);\n        this.unitId = unitId;\n    }\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        let channel = channels[this.unitId];\n        if (channel !== undefined) return channel;\n        return channels[this.unitId] = await this.buildChannel();\n    }\n\n    private async buildChannel():Promise<HttpChannel> {\n        let channelUI = new HttpChannelNavUI();\n        let centerAppApi = new CenterAppApi('tv/', undefined);\n        let ret = await centerAppApi.unitxUq(this.unitId);\n        let {token, db, url, urlTest} = ret;\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\n        this.token = token;\n        return new UqHttpChannel(realUrl, token, channelUI);\n    }\n}\n\nlet centerHost:string;\n\nexport function setCenterUrl(url:string) {\n    console.log('setCenterUrl %s', url);\n    centerHost = url;\n    //centerToken = undefined;\n    centerChannel = undefined;\n    centerChannelUI = undefined;\n}\n\nexport let centerToken:string|undefined = undefined;\n\nlet loginedUserId:number = 0;\nexport function setCenterToken(userId:number, t?:string) {\n    loginedUserId = userId;\n    centerToken = t;\n    console.log('setCenterToken %s', t);\n    centerChannel = undefined;\n    centerChannelUI = undefined;\n}\n\nlet centerChannelUI:HttpChannel;\nlet centerChannel:HttpChannel;\nfunction getCenterChannelUI():HttpChannel {\n    if (centerChannelUI !== undefined) return centerChannelUI;\n    return centerChannelUI = new CenterHttpChannel(centerHost, centerToken, new HttpChannelNavUI());\n}\nfunction getCenterChannel():HttpChannel {\n    if (centerChannel !== undefined) return centerChannel;\n    return centerChannel = new CenterHttpChannel(centerHost, centerToken);\n}\n\nexport abstract class CenterApiBase extends ApiBase {\n    /*\n    constructor(path: string, showWaiting?: boolean) {\n        super(path, showWaiting);\n    }*/\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        return (this.showWaiting === true || this.showWaiting === undefined)?\n            getCenterChannelUI():\n            getCenterChannel();\n    }\n}\n\nconst uqTokensName = 'uqTokens';\nexport class UqTokenApi extends CenterApiBase {\n    private localMap: LocalMap = env.localDb.map(uqTokensName);\n\n    async uq(params: {unit:number, uqOwner:string, uqName:string, appOwner:string, appName:string}):Promise<any> {\n        let {uqOwner, uqName} = params;\n        let un = uqOwner+'/'+uqName;\n        let localCache = this.localMap.child(un);\n        try {\n            let uqToken:UqLocal = localCache.get();\n            if (uqToken !== undefined) {\n                let {unit, user} = uqToken;\n                if (unit !== params.unit || user !== loginedUserId) {\n                    localCache.remove();\n                    uqToken = undefined;\n                }\n            }\n            let nowTick = Math.floor(Date.now() / 1000);\n            if (uqToken !== undefined) {\n                let {tick, value} = uqToken;\n                if (value !== undefined && (nowTick - tick) < 24*3600) {\n                    return _.clone(value);\n                }\n            }\n            let appUqParams:any = _.clone(params);\n            appUqParams.testing = host.testing;\n            let ret = await this.get('app-uq', appUqParams);\n            if (ret === undefined) {\n                let {unit, uqOwner, uqName} = params;\n                let err = `center get app-uq(unit=${unit}, '${uqOwner}/${uqName}') - not exists or no unit-service`;\n                throw err;\n            }\n\n            uqToken = {\n                unit: params.unit,\n                user: loginedUserId,\n                tick: nowTick,\n                value: ret,\n            }\n            localCache.set(uqToken);\n            return _.clone(ret);\n        }\n        catch (err) {\n            localCache.remove();\n            throw err;\n        }\n    }\n}\n\nexport const uqTokenApi = new UqTokenApi('tv/tie/', undefined);\n\nexport class CallCenterApi extends CenterApiBase {\n    directCall(url:string, method:string, body:any):Promise<any> {\n        return this.call(url, method, body);\n    }\n}\nexport const callCenterapi = new CallCenterApi('', undefined);\n\nexport interface UqAppData {\n    appName: string;\n    appOwner: string;\n    id: number;\n    version: string;        // AppUI version\n    uqs: UqData[];\n}\n\nexport interface UqData {\n    id: number;\n    uqOwner: string;\n    uqName: string;\n    access: string;\n    newVersion: boolean;\n}\n\nexport interface UqServiceData {\n    id: number;\n    db: string;\n    url: string;\n    urlTest: string;\n    token: string;\n}\n\n//const appUqsName = 'appUqs';\n\nexport class CenterAppApi extends CenterApiBase {\n    //private local: LocalCache = env.localDb.item(appUqsName);\n    //private cachedUqs: UqAppData;\n    async uqs(appOwner:string, appName:string):Promise<UqAppData> {\n        let ret:UqAppData = await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\n        return ret;\n        /*\n        let ret:UqAppData;\n        let appUqs = this.local.get();\n        if (appUqs) {\n            let {appOwner:rAppOwner, appName:rAppName} = appUqs;\n            if (appOwner === rAppOwner && appName === rAppName) ret = appUqs;\n        }\n        if (ret === undefined) {\n            ret = await this.uqsPure(appOwner, appName);\n            ret.appName = appName;\n            ret.appOwner = appOwner;\n            //localStorage.setItem(JSON.stringify(obj));\n            this.local.set(ret);\n        }\n        //return this.cachedUqs = _.cloneDeep(ret);\n        return ret;\n        */\n    }\n    private async uqsPure(appOwner:string, appName:string):Promise<UqAppData> {\n        return await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\n    }\n    /*\n    private async isOkCheckUqs(appOwner:string, appName:string):Promise<boolean> {\n        let ret = await this.uqsPure(appOwner, appName);\n        let {id:cachedId, uqs:cachedUqs} = this.local.get(); //.cachedUqs;\n        let {id:retId, uqs:retUqs} = ret;\n        if (cachedId !== retId) return false;\n        if (cachedUqs.length !== retUqs.length) return false;\n        let len = cachedUqs.length;\n        for (let i=0; i<len; i++) {\n            if (_.isMatch(cachedUqs[i], retUqs[i]) === false) return false;\n        }\n        return true;\n    }\n    async checkUqs(appOwner:string, appName:string):Promise<boolean> {\n        let ret = await this.isOkCheckUqs(appOwner, appName);\n        if (ret === false) {\n            this.local.remove();\n            nav.start();\n        }\n        return ret;\n    }\n    */\n    async unitxUq(unit:number):Promise<UqServiceData> {\n        return await this.get('tie/unitx-uq', {unit:unit});\n    }\n    async changePassword(param: {orgPassword:string, newPassword:string}) {\n        return await this.post('tie/change-password', param);\n    }\n}\n\nexport async function loadAppUqs(appOwner:string, appName:string): Promise<UqAppData> {\n    let centerAppApi = new CenterAppApi('tv/', undefined);\n    //let unit = meInFrame.unit;\n    let ret = await centerAppApi.uqs(appOwner, appName);\n    //await centerAppApi.checkUqs(appOwner, appName);\n    /*\n    .then(v => {\n        if (v === false) {\n            localStorage.removeItem(appUqs);\n            nav.start();\n        }\n    });\n    */\n    return ret;\n}\n\n//import { nav } from '../ui';\n\nexport interface RegisterParameter {\n    nick:string, \n    user:string, \n    pwd:string,\n    country:number, \n    mobile:number, \n    mobileCountry:number,\n    email:string,\n    verify:string,\n};\n\nexport class UserApi extends CenterApiBase {\n    async login(params: {user: string, pwd: string, guest: number}): Promise<any> {\n        //(params as any).device = nav.local.device.get();\n        let ret = await this.get('user/login', params);\n        switch (typeof ret) {\n            default: return;\n            case 'string': return decodeUserToken(ret);\n            case 'object':\n                let token = ret.token;\n                let user = decodeUserToken(token);\n                let {nick, icon} = ret;\n                if (nick) user.nick = nick;\n                if (icon) user.icon = icon;\n                return user;\n        }\n        // !== undefined) return decodeToken(token);\n    }\n    async register(params: RegisterParameter): Promise<any>\n    {\n        return await this.post('user/register', params);\n    }\n\n    async sendVerify(account:string, type:'mobile'|'email', oem:string) {\n        return await this.post('user/set-verify', {account:account, type:type, oem:oem});\n    }\n\n    async checkVerify(account:string, verify:string) {\n        return await this.post('user/check-verify', {account:account, verify:verify});\n    }\n\n    async isExists(account:string) {\n        return await this.get('user/is-exists', {account:account});\n    }\n\n    async resetPassword(account:string, password:string, verify:string, type:'mobile'|'email'):Promise<any[]> {\n        return await this.post('user/reset-password', {account:account, password, verify, type});\n    }\n    \n    async userSetProp(prop:string, value:any) {\n        await this.post('tie/user-set-prop', {prop:prop, value:value});\n    }\n\n    async me():Promise<any> {\n        return await this.get('tie/me');\n    }\n\n    async user(id:number): Promise<any> {\n        return await this.get('tie/user', {id:id});\n\t}\n\t\n\tasync fromKey(key:string): Promise<{id:number, name:string, nick:string, icon:string}> {\n\t\treturn await this.get('tie/user-from-key', {key});\n\t}\n}\n\nexport const userApi = new UserApi('tv/', undefined);\n","import _ from 'lodash';\n\nexport interface KeyValueRes {\n    [key:string]: any;\n}\n\nexport interface Res<T extends KeyValueRes> {\n    [lang:string]: T | {[district:string]: T};\n}\n\nexport const resOptions:{\n\tlang: string;\n\t$lang: string;\n\tdistrict: string;\n\t$district: string;\n} = {\n\tlang: undefined,\n\t$lang: undefined,\n\tdistrict: undefined,\n\t$district: undefined,\n}\n\nexport function setResOptions(lang:string, district:string) {\n\tresOptions.lang = lang;\n\tresOptions.$lang = '$' + lang;\n    resOptions.district = district;\n    resOptions.$district = '$' + district;\n}\n\n(function() {\n    let lang: string, district: string;\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\n        || navigator.language; // ||   // All browsers\n    //navigator.userLanguage; // IE <= 10\n    if (!language) {\n        lang = 'zh';\n        district = 'CN';\n    }\n    else {\n        let parts = language.split('-');\n        lang = parts[0];\n        if (parts.length > 1) district = parts[1].toUpperCase();\n    }\n    setResOptions(lang, district);\n}());\n\nexport function resLang<T extends KeyValueRes>(res:Res<T>):T {\n    let {lang, district} = resOptions;\n    let ret:T = {} as T;\n    if (res === undefined) return ret;\n    _.merge(ret, res._);\n    let l = res[lang];\n    if (l === undefined) return ret;\n    _.merge(ret, l._);\n    let d = l[district];\n    if (d === undefined) return ret;\n    _.merge(ret, d);\n    let {entity} = ret;\n    if (entity !== undefined) {\n        for (let i in entity) {\n            entity[i.toLowerCase()] = entity[i];\n        }\n    }\n    return ret;\n}\n\nconst resGlobal:any = {};\nexport function setRes(target: any, res: any):(str:string)=>any {\n\tif (res === undefined) return;\n\tlet {$lang, $district} = resOptions;\n\t_.merge(target, res);\n\tif ($lang !== undefined) {\n\t\tlet l = res[$lang];\n\t\tif (l !== undefined) {\n\t\t\t_.merge(target, l);\n\t\t\tlet d = l[$district];\n\t\t\tif (d !== undefined) {\n\t\t\t\t_.merge(target, d);\n\t\t\t}\n\t\t}\n\t}\n\treturn function(str:string) {\n\t\treturn target[str] || str;\n\t}\n}\nexport function setGlobalRes(res: any) {\n\tsetRes(resGlobal, res);\n}\nexport function t(str:string):any {\n\treturn resGlobal[str] || str;\n}\n","import * as React from 'react';\nimport _ from 'lodash';\nimport {nav, Page, resOptions} from '../components';\nimport { User, env } from '../tool';\nimport { VPage } from './vpage';\nimport { View } from './view';\nimport { messageHub } from '../net';\n\nexport interface ConfirmOptions {\n    caption?: string;\n    message: string | JSX.Element;\n    classNames?: string;\n    ok?: string;\n    yes?: string;\n    no?: string;\n}\n\nexport abstract class Controller {\n    readonly res: any;\n\treadonly x: any;\n\tprivate _t: any = {};\n\treadonly t: (str:string)=>any;\n    icon: string|JSX.Element;\n    label:string;\n    readonly isDev:boolean = env.isDevelopment;\n    get user():User {return nav.user}\n    get isLogined():boolean {\n        let {user} = nav;\n        if (user === undefined) return false;\n        return user.id > 0;\n    }\n    constructor(res:any) {\n        this.res = res || {};\n\t\tthis.x = this.res.x || {};\n\t\tthis.t = (str:string):any => this.internalT(str) || str;\n\t}\n\n\tinit(...param: any[]) {}\n\n\tinternalT(str:string):any {\n\t\treturn this._t[str];\n\t}\n\t\n\tprotected setRes(res:any) {\n\t\tif (res === undefined) return;\n\t\tlet {$lang, $district} = resOptions;\n\t\t_.merge(this._t, res);\n\t\tif ($lang !== undefined) {\n\t\t\tlet l = res[$lang];\n\t\t\tif (l !== undefined) {\n\t\t\t\t_.merge(this._t, l);\n\t\t\t\tlet d = l[$district];\n\t\t\t\tif (d !== undefined) {\n\t\t\t\t\t_.merge(this._t, d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\n\t}\n\n    private receiveHandlerId:number;\n    //private disposer:()=>void;\n\n    protected dispose = () => {\n        // message listener的清理\n\t\t//nav.unregisterReceiveHandler(this.receiveHandlerId);\n\t\tmessageHub.unregisterReceiveHandler(this.receiveHandlerId);\n        this.onDispose();\n    }\n\n    protected onDispose() {\n\t}\n\t\n\tget isRouting() {return nav.isRouting;}\n\n\tisMe(id:any):boolean {\n\t\tif (id === null) return false;\n\t\tlet {user} = this;\n\t\tlet userId = user.id;\n\t\tswitch (typeof id) {\n\t\t\tdefault: return false;\n\t\t\tcase 'string': return Number(id) === userId;\n\t\t\tcase 'number': return id === userId;\n\t\t\tcase 'object': return id.id === userId;\n\t\t}\n\t}\n\n    protected async openVPage<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:(ret:any)=>void):Promise<void> {\n        await (new vp((this as any) as C)).open(param, afterBack);\n    }\n\n    protected renderView<C extends Controller>(view: new (controller: C)=>View<C>, param?:any) {\n        return (new view((this as any) as C)).render(param);\n    }\n\n    async event(type:string, value:any) {\n        await this.onEvent(type, value);\n    }\n\n    protected async onEvent(type:string, value:any) {\n    }\n\n    protected msg(text:string) {\n        alert(text);\n    }\n    protected errorPage(header:string, err:any) {\n        this.openPage(<Page header=\"App error!\">\n            <pre>\n                {typeof err === 'string'? err : err.message}\n            </pre>\n        </Page>);\n    }\n\n    protected onMessage(message:any):Promise<void> {\n        return;\n    }\n\n    private onMessageReceive = async (message:any):Promise<void> => {\n        await this.onMessage(message);\n    }\n\n    protected async beforeStart():Promise<boolean> {\n        /*\n        console.log('this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);');\n        this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);\n        console.log('return true');\n        */\n        return true;\n\t}\n\tprotected async afterStart():Promise<void> {\n\t}\n    protected registerReceiveHandler() {\n        this.receiveHandlerId = messageHub.registerReceiveHandler(this.onMessageReceive);\n    }\n\n    protected abstract internalStart(param?:any, ...params:any[]):Promise<void>;\n    async start(param?:any, ...params:any[]):Promise<void> {\n        //this.disposer = this.dispose;\n\t\tthis.registerReceiveHandler();\n        let ret = await this.beforeStart();\n        if (ret === false) return;\n\t\tawait this.internalStart(param, ...params);\n\t\tawait this.afterStart();\n    }\n\n    get isCalling():boolean {return this._resolve_$ !== undefined}\n\n    private _resolve_$:((value:any) => void)[];\n    async call<T>(param?:any, ...params:any[]):Promise<T> {\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\n        return new Promise<T> (async (resolve, reject) => {\n            this._resolve_$.push(resolve);\n            await this.start(param, ...params);\n        });\n    }\n\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\n        return new Promise<any> (async (resolve, reject) => {\n            this._resolve_$.push(resolve);\n            await (new vp(this as any)).open(param);\n        });\n    }\n\n    returnCall(value:any) {\n        if (this._resolve_$ === undefined) return;\n        let resolve = this._resolve_$.pop();\n        if (resolve === undefined) {\n            alert('the Controller call already returned, or not called');\n            return;\n        }\n        resolve(value);\n    }\n\n    openPage(page:JSX.Element, onClosePage?: (ret:any)=>void) {\n\t\tlet disposer: ()=>void;\n\t\tif (onClosePage !== undefined) {\n\t\t\tdisposer = () => {\n\t\t\t\t//if (this.disposer) this.disposer();\n\t\t\t\tonClosePage(undefined);\n\t\t\t}\n\t\t}\n\n        nav.push(page, disposer);\n        //this.disposer = undefined;\n    }\n\n    replacePage(page:JSX.Element, onClosePage?: ()=>void) {\n        nav.replace(page, onClosePage);\n        //this.disposer = undefined;\n    }\n\n    backPage() {\n        nav.back();\n    }\n\n    closePage(level?:number) {\n        nav.pop(level);\n    }\n\n    ceasePage(level?:number) {\n        nav.ceaseTop(level);\n\t}\n\t\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tnav.go(showPage, url, absolute);\n\t}\n\n    removeCeased() {\n        nav.removeCeased();\n    }\n\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        nav.regConfirmClose(confirmClose);\n\t}\n\n\tprivate topPageKey:any;\n\tprotected startAction() {\n\t\tthis.topPageKey = nav.topKey();\n\t}\n\tpublic popToTopPage() {\n\t\tnav.popTo(this.topPageKey);\n\t}\n\n    async confirm(options: ConfirmOptions): Promise<'ok'|'yes'|'no'|undefined> {\n        return new Promise<'ok'|'yes'|'no'|undefined> (async (resolve, reject) => {\n            let {caption, message, ok, yes, no, classNames} = options;\n            let close = (res:'ok'|'yes'|'no'|undefined) => {\n                this.closePage();\n                resolve(res);\n            }\n            let buttons:any[] = [];\n            if (ok !== undefined) {\n                buttons.push(<button key=\"ok\" className=\"btn btn-primary mr-3\" onClick={()=>close('ok')}>{ok}</button>);\n            }\n            if (yes !== undefined) {\n                buttons.push(<button key=\"yes\" className=\"btn btn-success mr-3\" onClick={()=>close('yes')}>{yes}</button>);\n            }\n            if (no !== undefined) {\n                buttons.push(<button key=\"no\" className=\"btn btn-outline-danger mr-3\" onClick={()=>close('no')}>{no}</button>);\n            }\n            this.openPage(<Page header={caption || '请确认'} back=\"close\">\n                <div className={classNames || \"rounded bg-white m-5 p-3 border\"}>\n                    <div className=\"d-flex align-items-center justify-content-center\">\n                        {message}\n                    </div>\n                    <div className=\"mt-3 d-flex align-items-center justify-content-center\">\n                        {buttons}\n                    </div>\n                </div>\n            </Page>);\n            nav.regConfirmClose(async ():Promise<boolean> => {\n                resolve(undefined);\n                return true;\n            });\n        });\n    }\n}\n","import * as React from 'react';\nimport { Page, Image, UserView } from '../components';\nimport { env, User } from '../tool';\nimport { Controller } from './controller';\nimport { VPage } from './vpage';\n\nexport abstract class View<C extends Controller> {\n    protected controller: C;\n    protected readonly res: any;\n\tprotected readonly x: any;\n\tprotected readonly t: (str:string)=>any;\n\n    constructor(controller: C) {\n        this.controller = controller;\n        this.res = controller.res;\n\t\tthis.x = controller.x;\n\t\tthis.t = controller.t;\n    }\n\n\tprotected get isDev() {return  env.isDevelopment}\n\tprotected isMe(id:any) {return this.controller.isMe(id)}\n    abstract render(param?:any): JSX.Element;\n\n    protected renderVm(vm: new (controller: C)=>View<C>, param?:any) {\n        return (new vm(this.controller)).render(param);\n    }\n\n    protected async openVPage(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:()=>Promise<void>):Promise<void> {\n        await (new vp(this.controller)).open(param, afterBack);\n    }\n\n    protected async event(type:string, value?:any) {\n        await this.controller.event(type, value);\n\t}\n\t\n\tprotected go(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tthis.controller.go(showPage, url, absolute);\n\t}\n\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\n        return await this.controller.vCall(vp, param);\n    }\n\n    protected returnCall(value:any) {\n        this.controller.returnCall(value);\n    }\n\n\tprotected renderUser(user:any, imageClassName?:string, textClassName?:string) {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image src={icon} className={imageClassName || 'w-1c h-1c mr-2'} />\n\t\t\t\t<span className={textClassName}>{nick || name}</span>\n\t\t\t</>;\n\t\t}\n\t\treturn <UserView user={user} render={renderUser} />\n\t}\n\n\tprotected renderUserText(user:any) {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick} = user;\n\t\t\treturn <>{nick || name}</>;\n\t\t}\n\t\treturn <UserView user={user} render={renderUser} />\n\t}\n\n\tprotected renderMe(imageClassName?:string, textClassName?:string) {\n\t\tlet {user} = this.controller;\n\t\tif (!user) return;\n\t\treturn this.renderUser(user.id, imageClassName, textClassName);\n\t}\n\n    protected openPage(view: React.StatelessComponent<any>, param?:any, onClosePage?:(ret:any)=>void) {\n        let type = typeof param;\n        if (type === 'object' || type === 'undefined') {\n            this.controller.openPage(React.createElement(view, param), onClosePage);\n        }\n        else {\n            this.controller.openPage(<Page header=\"param type error\">\n                View.openPage param must be object, but here is {type}\n            </Page>, onClosePage);\n        }\n    }\n\n    protected replacePage(view: React.StatelessComponent<any>, param?:any) {\n        this.controller.replacePage(React.createElement(view, param));\n    }\n\n    protected openPageElement(page: JSX.Element, onClosePage?: ()=>void) {\n        this.controller.openPage(page, onClosePage);\n    }\n\n    protected replacePageElement(page: JSX.Element) {\n        this.controller.replacePage(page);\n    }\n\n    protected backPage() {\n        this.controller.backPage();\n    }\n\n    protected closePage(level?:number) {\n        this.controller.closePage(level);\n    }\n\n    protected ceasePage(level?:number) {\n        this.controller.ceasePage(level);\n    }\n\n    protected removeCeased() {\n        this.controller.removeCeased();\n    }\n\n    protected regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        this.controller.regConfirmClose(confirmClose);\n\t}\n\n\tprotected popToTopPage() {\n\t\tthis.controller.popToTopPage();\n\t}\n}\n","import * as React from 'react';\nimport { Page, Scroller, TabsProps } from \"../components\";\nimport { View } from \"./view\";\nimport { Controller } from \"./controller\";\n\nexport abstract class VPage<C extends Controller> extends View<C> {\n\tprotected retOnClosePage: any;\n\n    open(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\n\t\tthis.init(param);\n\t\tlet _onClosePage: ()=>void;\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\n\t\tthis.openPageElement(this.renderPage(), _onClosePage);\n\t\treturn;\n\t}\n\n\trender(param?:any):JSX.Element {\n\t\tthis.init(param);\n\t\treturn this.renderPage();\n\t}\n\n\tinit(param?:any):void {return;}\n\n\theader():string|boolean|JSX.Element {return null;}\n\tright():JSX.Element {return null;}\n\tcontent():JSX.Element {return null;}\n\tfooter():JSX.Element {return null;}\n\tlogout(): boolean | (()=>Promise<void>) {return false;}\n\tprotected renderPage():JSX.Element {\n\t\tlet header = this.header();\n\t\tif (!header) header = false;\n\t\treturn <Page\n\t\t\theader={header} right={this.right()} footer={this.footer()}\n\t\t\tonScroll={(e:any)=>this.onPageScroll(e)}\n\t\t\tonScrollTop={(scroller: Scroller) => this.onPageScrollTop(scroller)}\n\t\t\tonScrollBottom={(scroller: Scroller) => this.onPageScrollBottom(scroller)}\n\t\t\tback={this.back}\n\t\t\theaderClassName={this.headerClassName}\n\t\t\tclassName={this.className}\n\t\t\tafterBack={()=>this.afterBack()}\n\t\t\ttabsProps={this.tabsProps}\n\t\t\tlogout={this.logout()}\n\t\t>\n\t\t\t{this.content()}\n\t\t</Page>;\n\t}\n\n\tprotected onPageScroll(e:any) {}\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {return false;}\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {return;}\n\tprotected afterBack():void {}\n\tprotected get back(): 'close' | 'back' | 'none' {return 'back'}\n\tprotected get headerClassName(): string {return null;}\n\tprotected get className(): string {return null;}\n\tprotected get tabsProps(): TabsProps {return null;}\n}\n","const ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\nconst ID_LENGTH = 8;\n\nexport function uid():string {\n    let len = ALPHABET.length;\n    let rtn = '';\n    for (let i = 0; i < ID_LENGTH; i++) {\n        rtn += ALPHABET.charAt(Math.floor(Math.random() * len));\n    }\n    return rtn;\n}\n","export * from './uqMan';\nexport * from './entity';\nexport * from './action';\nexport * from './query';\nexport * from './sheet';\nexport * from './tuid';\nexport * from './book';\nexport * from './map';\nexport * from './history';\nexport * from './pending';\nexport * from './uqsMan';\nexport * from './tag/tag';\n","import _ from 'lodash';\nimport {observable, IObservableArray} from 'mobx';\nimport { PageItems } from '../tool';\nimport {Field, ArrFields} from './uqMan';\nimport {Entity} from './entity';\nimport { QueryQueryCaller, QueryPageCaller } from './caller';\n\nexport type QueryPageApi = (name:string, pageStart:any, pageSize:number, params:any) => Promise<string>;\n\nexport class QueryPager<T extends any> extends PageItems<T> {\n\tprivate query: Query;\n\tprivate $page: any;\n\tprotected idFieldName: any;\n    constructor(query: Query, pageSize?: number, firstSize?: number, itemObservable?:boolean) {\n        super(itemObservable);\n        this.query = query;\n        if (pageSize !== undefined) this.pageSize = pageSize;\n\t\tif (firstSize !== undefined) this.firstSize = firstSize;\n\t}\n\n\tsetReverse() {\n\t\tthis.appendPosition = 'head';\n\t}\n\n    protected async onLoad() {\n\t\tif (this.$page) return;\n        let {schema} = this.query;\n        if (schema === undefined) {\n\t\t\tawait this.query.loadSchema();\n\t\t\tschema = this.query.schema;\n\t\t}\n\t\tif (schema === undefined) return;\n\t\tlet $page = this.$page = (schema.returns as any[]).find(v => v.name === '$page');\n\t\tif ($page === undefined) return;\n\t\tthis.sortOrder = $page.order;\n\t\tlet fields = $page.fields;\n\t\tif (fields !== undefined) {\n\t\t\tlet field = fields[0];\n\t\t\tif (field) this.idFieldName = field.name;\n\t\t}\n    }\n\n    protected async loadResults(param:any, pageStart:number, pageSize:number):Promise<{[name:string]:any[]}> {\n\t\tlet ret = await this.query.page(param, pageStart, pageSize);\n\t\treturn ret;\n\t}\n\tprotected getPageId(item:T) {\n\t\tif (item === undefined) return;\n\t\tif (typeof item === 'number') return item;\n\t\tlet start = (item as any)[this.idFieldName];\n\t\tif (start === null) return;\n\t\tif (start === undefined) return;\n\t\tif (typeof start === 'object') {\n\t\t\tlet id = start.id;\n\t\t\tif (id !== undefined) return id;\n\t\t}\n\t\treturn start;\n\t}\n\tasync refreshItems(item:T) {\n\t\tlet index = this._items.indexOf(item);\n\t\tif (index < 0) return;\n\t\tlet startIndex:number;\n\t\tif (this.appendPosition === 'tail') {\n\t\t\tstartIndex = index - 1;\n\t\t}\n\t\telse {\n\t\t\tstartIndex = index + 1;\n\t\t}\n\t\tlet pageStart = this.getPageId(this._items[startIndex]);\n\t\tlet pageSize = 1;\n        let ret = await this.load(\n\t\t\tthis.param, \n\t\t\tpageStart,\n\t\t\tpageSize);\n\t\tlet len = ret.length;\n\t\tif (len === 0) {\n\t\t\tthis._items.splice(index, 1);\n\t\t\treturn;\n\t\t}\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet newItem = ret[i];\n\t\t\tif (!newItem) continue;\n\t\t\tlet newId = newItem[this.idFieldName];\n\t\t\tif (newId === undefined || newId === null) continue;\n\t\t\tif (typeof newId === 'object') newId = newId.id;\n\t\t\tlet oldItem = this._items.find(v => {\n\t\t\t\tlet oldId = (v as any)[this.idFieldName];\n\t\t\t\tif (oldId === undefined || oldId === null) return false;\n\t\t\t\tif (typeof oldId === 'object') oldId = oldId.id;\n\t\t\t\treturn oldId = newId;\n\t\t\t});\n\t\t\tif (oldItem) {\n\t\t\t\t_.merge(oldItem, newItem);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class Query extends Entity {\n    get typeName(): string { return 'query';}\n    private pageStart: any;\n    private pageSize:number;\n    private params:any;\n    private more: boolean;\n    private startField: Field;\n    @observable list:IObservableArray; // = observable.array([], {deep: false});\n    returns: ArrFields[];\n    isPaged: boolean;\n\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        let {returns} = schema;\n        //this.returns = returns;\n        this.isPaged = returns && (returns as any[]).find(v => v.name === '$page') !== undefined;\n    }\n\n    resetPage(size:number, params:any) {\n        this.pageStart = undefined;\n        this.pageSize = size;\n        this.params = params;\n        this.more = false;\n        this.list = undefined;\n    }\n    get hasMore() {return this.more;}\n    async loadPage():Promise<void> {\n        if (this.pageSize === undefined) {\n            throw new Error('call resetPage(size:number, params:any) first');\n        }\n        let pageStart:any;\n        if (this.pageStart !== undefined) {\n            switch (this.startField.type) {\n                default: pageStart = this.pageStart; break;\n                case 'date':\n                case 'time':\n                case 'datetime': pageStart = (this.pageStart as Date).getTime(); break;\n            }\n        }\n\t\tlet ret = await this.page(this.params, pageStart, this.pageSize+1);\n\t\tlet page = ret.$page;\n        /*\n        await this.loadSchema();\n        let res = await this.tvApi.page(this.name, pageStart, this.pageSize+1, this.params);\n        let data = await this.unpackReturns(res);\n        let page = data['$page'] as any[];\n        */\n        this.list = observable.array([], {deep: false});\n        if (page !== undefined) {\n            if (page.length > this.pageSize) {\n                this.more = true;\n                page.pop();\n                let ret = this.returns.find(r => r.name === '$page');\n                this.startField = ret.fields[0];\n                this.pageStart = page[page.length-1][this.startField.name];\n            }\n            else {\n                this.more = false;\n            }\n            this.list.push(...page);\n        }\n        //this.loaded = true;\n    }\n\n    protected pageCaller(params: any, showWaiting: boolean = true): QueryPageCaller {\n        return new QueryPageCaller(this, params, showWaiting);\n    }\n\n    async page(params:any, pageStart:any, pageSize:number, showWaiting: boolean = true):Promise<{[name:string]:any[]}> {\n        let p = {pageStart, pageSize, params};\n        let res = await this.pageCaller(p, showWaiting).request();\n        return res;\n    }\n    protected queryCaller(params: any, showWaiting: boolean = true): QueryQueryCaller {\n        return new QueryQueryCaller(this, params, showWaiting);\n    }\n    async query(params:any, showWaiting:boolean = true):Promise<any> {\n        let res = await this.queryCaller(params, showWaiting).request();\n        return res;\n    }\n    async table(params:any, showWaiting:boolean = true): Promise<any[]> {\n        let ret = await this.query(params, showWaiting);\n        for (let i in ret) {\n            return ret[i];\n        }\n    }\n    async obj(params:any, showWaiting:boolean = true):Promise<any> {\n        let ret = await this.table(params, showWaiting);\n        if (ret.length > 0) return ret[0];\n    }\n    async scalar(params:any, showWaiting:boolean = true):Promise<any> {\n        let ret = await this.obj(params, showWaiting);\n        for (let i in ret) return ret[i];\n    }\n}\n","import { messageHub } from \"./messageHub\";\n\nlet subAppWindow:Window;\nfunction postWsToSubApp(msg:any) {\n    if (subAppWindow === undefined) return;\n    subAppWindow.postMessage({\n        type: 'ws',\n        msg: msg\n    }, '*');\n}\n\nexport function setSubAppWindow(win:Window) {\n    subAppWindow = win;\n}\n\nexport function postWsToTop(msg:any) {\n    window.top.postMessage({\n        type: 'ws',\n        msg: msg\n    }, '*');\n}\n\nexport abstract class WsBase {\n\tprivate messageHub = messageHub;\n\t/*\n    wsBaseId:string;\n    private handlerSeed = 1;\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\n\tprivate msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\n\t*/\n\t/*\n    onWsReceiveAny(handler:(msg:any)=>Promise<void>):number {\n        let seed = this.handlerSeed++;\n        this.anyHandlers[seed] = handler;\n        return seed;\n    }\n    onWsReceive(type:string, handler:(msg:any)=>Promise<void>):number {\n        let seed = this.handlerSeed++;\n        this.msgHandlers[seed] = {type:type, handler: handler};\n        return seed;\n    }\n    endWsReceive(handlerId:number) {\n        delete this.anyHandlers[handlerId];\n        delete this.msgHandlers[handlerId];\n\t}\n\t*/\n    async receive(msg:any) {\n\t\tthis.messageHub.dispatch(msg);\n\t\t/*\n        let {$type} = msg;\n        for (let i in this.anyHandlers) {\n            await this.anyHandlers[i](msg);\n        }\n        for (let i in this.msgHandlers) {\n            let {type, handler} = this.msgHandlers[i];\n            if (type !== $type) continue;\n            await handler(msg);\n\t\t}\n\t\t*/\n    }\n}\n\nlet wsBaseSeed = 1;\nexport class WsBridge extends WsBase {\n    wsBaseId:string = 'WsBridge seed ' + wsBaseSeed++;\n}\n\nexport const wsBridge = new WsBridge();\n\nexport class WSChannel extends WsBase {\n    wsBaseId:string = 'WSChannel seed ' + wsBaseSeed++;\n    static centerToken:string;\n    private wsHost: string;\n    private token: string;\n    private ws: WebSocket;\n\n    constructor(wsHost: string, token: string) {\n        super();\n        this.wsHost = wsHost;\n        this.token = token;\n    }\n\n    static setCenterToken(token?: string) {\n        WSChannel.centerToken = token;\n    }\n    \n    connect():Promise<void> {\n        //this.wsHost = wsHost;\n        //this.token = token || WSChannel.centerToken;\n        if (this.ws !== undefined) return;\n        let that = this;\n        return new Promise((resolve, reject) => {\n            let ws = new WebSocket(this.wsHost, this.token || WSChannel.centerToken);\n            console.log('connect webSocket %s', this.wsHost);\n            ws.onopen = (ev) => {\n                console.log('webSocket connected %s', this.wsHost);\n                that.ws = ws;\n                resolve();\n            };\n            ws.onerror = (ev) => {\n                reject('webSocket can\\'t open!');\n            };\n            ws.onmessage = async (msg) => await that.wsMessage(msg);\n            ws.onclose = (ev) => {\n                that.ws = undefined;\n                console.log('webSocket closed!');\n            }\n        });\n    }\n    close() {\n        if (this.ws !== undefined) {\n            this.ws.close();\n            this.ws = undefined;\n        }\n    }\n    private async wsMessage(event:any):Promise<void> {\n        try {\n            console.log('websocket message: %s', event.data);\n            let msg = JSON.parse(event.data);\n            postWsToSubApp(msg);\n            await this.receive(msg);\n        }\n        catch (err) {\n            console.log('ws msg error: ', err);\n        }\n    }\n    sendWs(msg:any) {\n        let netThis = this;\n        this.connect().then(() => {\n            netThis.ws.send(msg);\n        });\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { nav } from './nav';\n\nexport interface ImageProps {\n    src: string;\n    className?: string;\n    style?: React.CSSProperties;\n    altImage?: string;\n}\n\n// src = .src, 表示fontawesome Icon\nexport function Image(props: ImageProps) {\n\tlet {className, style, src, altImage} = props;\n\tlet icon:string;\n    if (src) {\n\t\tif (src.indexOf('.') !== 0) {\n\t\t\tif (src.startsWith(':') === true) {\n\t\t\t\tsrc = nav.resUrl + src.substr(1);\n\t\t\t}\n\t\t\treturn <img src={src} className={className} alt=\"img\"\n\t\t\t\tstyle={style}\n\t\t\t\tonError={evt=>{\n\t\t\t\t\tif (altImage) evt.currentTarget.src=altImage;\n\t\t\t\t\telse evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\n\t\t\t\t}} />;\n\t\t}\n\t\ticon = src.substr(1);\n\t}\n\telse {\n\t\ticon = 'file-o'\n\t}\n\treturn <span className={classNames(className, 'image-none')} style={style}>\n\t\t<i className={'fa fa-' + icon} />\n\t</span>;\n}\n","import jwtDecode from 'jwt-decode';\n\nexport interface Unit {\n    id: number;\n    name: string;\n}\n\nexport interface Guest {\n    id: number;             // id = 0\n    guest: number;\n    token: string;\n}\n\nexport interface User extends Guest {\n    id: number;\n    name: string;\n    nick?: string;\n    icon?: string;\n}\n\nexport function decodeUserToken(token: string): User {\n    let ret:any = jwtDecode(token);\n    let user: User = {\n        id: ret.id,\n        name: ret.name,\n        guest: ret.guest,\n        token: token,\n    };\n    return user;\n}\n\nexport function decodeGuestToken(token: string): Guest {\n    let ret:any = jwtDecode(token);\n    let guest: Guest = {\n        id: 0,\n        guest: ret.guest,\n        token: token,\n    };\n    return guest;\n}\n","import { env } from '../tool';\n\nconst centerHost = process.env['REACT_APP_CENTER_HOST'];\nconst centerDebugHost = 'localhost:3000'; //'192.168.86.64';\nconst resHost = process.env['REACT_APP_RES_HOST'] || centerHost;\nconst resDebugHost = 'localhost:3015'; //'192.168.86.63';\nconst uqDebugHost = 'localhost:3015'; //'192.168.86.63';\nconst uqDebugBuilderHost = 'localhost:3009';\ninterface HostValue {\n    value: string;\n    local: boolean;\n}\nconst hosts:{[name:string]:HostValue} = {\n    centerhost: {\n        value: process.env['REACT_APP_CENTER_DEBUG_HOST'] || centerDebugHost, \n        local: false\n    },\n    reshost: {\n        value: process.env['REACT_APP_RES_DEBUG_HOST'] || resDebugHost,\n        local: false\n    },\n    uqhost: {\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \n        local: false\n    },\n    unitxhost: {\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \n        local: false\n    },\n    \"uq-build\": {\n        value: process.env['REACT_APP_UQ_DEBUG_BUILDER_HOST'] || uqDebugBuilderHost, \n        local: false\n    }\n}\n\nconst httpArr = ['https://', 'http://'];\nfunction isAbsoluteUrl(url:string):boolean {\n    for (let str of httpArr) {\n        if (url.startsWith(str) === true) return true;\n    }\n    return false;\n}\n\nfunction urlFromHost(host:string):string {\n    if (isAbsoluteUrl(host) === true) {\n        if (host.endsWith('/')) return host;\n        return host + '/';\n    }\n    return `http://${host}/`;\n}\n\nfunction centerUrlFromHost(host:string):string {\n    return urlFromHost(host);\n}\nfunction centerWsFromHost(host:string) {\n    let https = 'https://';\n    if (host.startsWith(https) === true) {\n        host = host.substr(https.length);\n        if (host.endsWith('/') === true) host = host.substr(0, host.length-1);\n        return 'wss://' + host + '/tv/';\n    }\n    return `ws://${host}/tv/`\n}\nexport function resUrlFromHost(host:string) {\n\tif (!host) return;\n    let url = urlFromHost(host);\n    return url + 'res/';\n}\n\nconst fetchOptions = {\n    method: \"GET\",\n    mode: \"no-cors\", // no-cors, cors, *same-origin\n    headers: {\n        \"Content-Type\": \"text/plain\"\n    },\n};\n\nclass Host {\n    testing: boolean;\n    url: string;\n    ws: string;\n    resHost: string;\n\n    async start(testing:boolean) {\n        this.testing = testing;\n        if (env.isDevelopment === true) {\n            await this.tryLocal();\n        }\n        let host = this.getCenterHost();\n        this.url = centerUrlFromHost(host);\n        this.ws = centerWsFromHost(host);\n        this.resHost = this.getResHost();\n    }\n\n    private debugHostUrl(host:string) {return `http://${host}/hello`}\n    private async tryLocal() {\n        let promises:PromiseLike<any>[] = [];\n        let hostArr:string[] = [];\n        for (let i in hosts) {\n            let hostValue = hosts[i];\n            let {value} = hostValue;\n            if (hostArr.findIndex(v => v === value) < 0) hostArr.push(value);\n        }\n\n        for (let host of hostArr) {\n            let fetchUrl = this.debugHostUrl(host);\n            promises.push(localCheck(fetchUrl));\n        }\n        let results = await Promise.all(promises);\n        let len = hostArr.length;\n        for (let i=0; i<len; i++) {\n            let local = results[i];\n            let host = hostArr[i];\n            for (let j in hosts) {\n                let hostValue = hosts[j];\n                if (hostValue.value === host) {\n                    hostValue.local = local;\n                }\n            }\n        }\n        /*\n        let p = 0;\n        for (let i in hosts) {\n            let hostValue = hosts[i];\n            hostValue.local = results[p];\n            ++p;\n        }\n        */\n    }\n\n    private getCenterHost():string {\n        let {value, local} = hosts.centerhost;\n        let hash = document.location.hash;\n        if (hash.includes('sheet_debug') === true) {\n            return value;\n        }\n        if (env.isDevelopment === true) {\n            if (local === true) return value;\n        }\n        return centerHost;\n    }\n\n    private getResHost():string {\n        let {value, local} = hosts.reshost;\n        let hash = document.location.hash;\n        if (hash.includes('sheet_debug') === true) {\n            return value;\n        }\n        if (env.isDevelopment === true) {\n            if (local === true) return value;\n        }\n        return resHost;\n    }\n\n    getUrlOrDebug(url:string, debugHost:string = 'uqhost'):string {\n        if (env.isDevelopment === false) return url;\n        let host = hosts[debugHost];\n        if (host === undefined) return url;\n        let {value, local} = host;\n        if (local === false) return url;\n        return `http://${value}/`;\n    }\n    getUrlOrTest(db:string, url:string, urlTest:string):string {\n\t\tlet path:string;\n\t\tif (!urlTest) {\n\t\t\turlTest = url;\n\t\t\tif (!urlTest) {\n\t\t\t\tconsole.error('no server set for ' + db);\n\t\t\t\tdebugger;\t\t\t\t\n\t\t\t}\n\t\t}\n        if (this.testing === true) {\n            if (urlTest !== '-') url = urlTest;\n            path = 'uq/test/' + db + '/';\n        }\n        else {\n            path = 'uq/prod/' + db + '/';\n        }\n\t\turl = this.getUrlOrDebug(url);\n\t\tif (url.endsWith('/') === false) {\n\t\t\turl += '/';\n\t\t}\n        return url + path;\n    }\n\n    async localCheck(urlDebug: string):Promise<boolean> {\n        return await localCheck(urlDebug);\n    }\n}\n\nexport const host:Host = new Host();\n\n// 因为测试的都是局域网服务器，甚至本机服务器，所以一秒足够了\n// 网上找了上面的fetch timeout代码。\n// 尽管timeout了，fetch仍然继续，没有cancel\n\n// 实际上，一秒钟不够。web服务器会自动停。重启的时候，可能会比较长时间。也许两秒甚至更多。\n//const timeout = 2000;\nconst timeout = 200;\n\nfunction fetchLocalCheck(url:string):Promise<any> {\n    return new Promise((resolve, reject) => {\n      fetch(url, fetchOptions as any)\n      .then(v => {\n          v.text().then(resolve).catch(reject);\n      })\n      .catch(reject);\n      const e = new Error(\"Connection timed out\");\n      env.setTimeout('fetchLocalCheck', reject, timeout, e);\n    });\n}\n\nasync function localCheck(url:string):Promise<boolean> {\n    try {\n        await fetchLocalCheck(url);\n        return true;\n    }\n    catch (err) {\n        return false;\n    }\n}\n\n/*\nexport interface IUqForChannel {\n    uq: string;\n    uqVersion: number;\n}\n*/","import { Entity } from './entity';\nimport { ActionCaller } from './caller';\n\nexport class Action extends Entity {\n    get typeName(): string { return 'action';}\n    async submit(data:object, waiting: boolean = true) {\n\t\tlet caller = new ActionSubmitCaller(this, data)\n\t\tlet ret = await caller.request();\n\t\treturn ret;\n    }\n    async submitReturns(data:object):Promise<{[ret:string]:any[]}> {\n       return await new SubmitReturnsCaller(this, data).request();\n    }\n    async submitConvert(data:object) {\n        return await new SubmitConvertCaller(this, data).request();\n    }\n}\n\nexport class ActionSubmitCaller extends ActionCaller {\n    get path():string {return 'action/' + this.entity.name;}\n    buildParams():any {\n\t\treturn {data: this.entity.pack(this.params)}\n\t}\n}\n\nclass SubmitReturnsCaller extends ActionSubmitCaller {\n    get path():string {return 'action/' + this.entity.name + '/returns';}\n    xresult(res:any):any {\n        let {returns} = this.entity;\n        let len = returns.length;\n        let ret:{[r:string]:any[]} = {};\n        for (let i=0; i<len; i++) {\n            let retSchema = returns[i];\n            ret[retSchema.name] = res[i];\n        }\n        return ret;\n    }\n}\n\nclass SubmitConvertCaller extends ActionSubmitCaller {\n    get path():string {return 'action-convert/' + this.entity.name;}\n    buildParams():any {\n        return {\n            data: this.params\n        };\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\nimport '../../css/va-lmr.css';\n\nexport interface LMRProps {\n    className?: string | string[];\n    left?: string|JSX.Element;\n    right?: string|JSX.Element;\n    onClick?: ()=>void;\n}\n\n@observer\nexport class LMR extends React.Component<LMRProps> {\n    render() {\n        let {className, left, children, right, onClick} = this.props;\n        let l, r;\n        if (left !== undefined) l = <header>{left}</header>;\n        if (right !== undefined) r = <footer>{right}</footer>;\n        let cursor;\n        if (onClick !== undefined) cursor = 'cursor-pointer';\n        return <div className={classNames('va-lmr', className, cursor)} onClick={onClick}>\n            {l}\n            <div>{children}</div>\n            {r}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\nimport '../../css/va-badge.css';\n\nexport interface BadgeProps {\n    className?: string;\n    badge?: string|number;\n    size?: 'xs' | 'sm' | 'lg';\n    color?: 'secondary'|'success'|'danger'|'primary'|'info'|'warning';\n    badgeAlign?: 'left'|'center'|'right';\n    badgeVertical?: 'top'|'middle'|'bottom';\n}\n\n@observer\nexport class Badge extends React.Component<BadgeProps> {\n    render() {\n        let {className, badge, size, color, badgeAlign, badgeVertical, children} = this.props;\n        let cn = classNames(\n            className,\n            'va-badge',\n            size && 'va-badge-'+size,\n            'va-badge-' + (color||'secondary'),\n            badgeAlign && 'va-badg-'+badgeAlign,\n            badgeVertical && 'va-badg-'+badgeVertical,\n        );\n        let b;\n        if (badge) b = <b>{badge}</b>;\n        return <div className={cn}>\n            {children}\n            {b}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport interface FAProps {\n    name: string;\n    className?: string;\n    size?: 'lg'|'2x'|'3x'|'4x'|'5x';\n    spin?: boolean;\n    fixWidth?: boolean;\n    border?: boolean;\n    pull?: 'left'|'right';\n    pulse?: boolean;\n    rotate?: 90|180|270;\n    flip?: 'horizontal'|'vertical';\n    inverse?: boolean;\n}\n\nexport class FA extends React.Component<FAProps> {\n    render() {\n        let {name, className, size, spin, fixWidth, border, pull, pulse, rotate, flip, inverse} = this.props;\n        let cn = classNames(className, 'fa',\n            name && ('fa-' + name),\n            size && 'fa-'+size,\n            fixWidth && 'fa-fw',\n            border && 'fa-border',\n            pull && 'fa-pull-' + pull,\n            spin && 'fa-spin',\n            pulse && 'fa-pulse',\n            rotate && 'fa-rotate-' + rotate,\n            flip && 'fa-flip-' + flip,\n            inverse && 'fa-inverse',\n        );\n        return <i className={cn} />\n    }\n}\n\nexport interface StackedFAProps {\n    className?: string;\n    size?: 'lg',\n}\nexport class StackedFA extends React.Component<StackedFAProps> {\n    render() {\n        let {className, size, children} = this.props;\n        let cn = classNames(\n            'fa-stack',\n            className,\n            size && 'fa-' + size);\n        return <span className={cn}>\n            {children}\n        </span>;\n    }\n}\n","import * as React from 'react';\nimport {FA} from './FA';\n\nexport interface IconTextProps {\n    icon: string;\n    iconClass?: string;\n    text: string;\n    textClass?: string;\n}\n\nexport class IconText extends React.Component<IconTextProps> {\n    render() {\n        let {icon, iconClass, text, textClass} = this.props;\n        return <div className=\"py-2\">\n            <FA className={iconClass} name={icon} fixWidth={true} />\n            <span className={textClass}>{text}</span>\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport const Muted = (props:any) => \n<small className={classNames('text-muted', props.className)} style={props.style}>\n    {props.children}\n</small>;\n","import _ from 'lodash';\n\nclass _LocalStorage {\n    getItem(key:string) {\n        return localStorage.getItem(key)\n    }\n    setItem(key:string, value:string) {\n        localStorage.setItem(key, value);\n    }\n    removeItem(key:string) {\n        localStorage.removeItem(key);\n    }\n}\n\nconst __ls = new _LocalStorage(); // new Ls;\n\nexport class LocalCache {\n    private readonly local: Local;\n    //private value: T;\n    readonly key: string|number;\n\n    constructor(local:Local, key:string|number) {\n        this.local = local;\n        this.key = key;\n    }\n    get():any {\n        try {\n            // 下面缓冲的内容不能有，可能会被修改，造成circular引用\n            //if (this.value !== undefined) return this.value;\n            let text = this.local.getItem(this.key);\n            if (text === null) return;\n            if (text === undefined) return undefined;\n            //return this.value = \n            return JSON.parse(text);\n        }\n        catch (err) {\n            this.local.removeItem(this.key);\n            return;\n        }\n    }\n    set(value:any) {\n\t\tlet t = JSON.stringify(value, (key, value) => {\n\t\t\tif (key !== '_tuid') return value;\n\t\t});\n\t\tthis.local.setItem(this.key, t);\n    }\n    remove(local?:Local) {\n        if (local === undefined) {\n            this.local.removeItem(this.key);\n        }\n        else {\n            this.local.removeLocal(local);\n        }\n    }\n    child(key:string|number):LocalCache {\n        return this.local.child(key);\n    }\n    arr(key:string|number):LocalArr {\n        return this.local.arr(key);\n    }\n    map(key:string|number):LocalMap {\n        return this.local.map(key);\n    }\n}\n\nabstract class Local {\n    private readonly caches: {[key:string]:LocalCache};\n    private readonly locals: {[key:string]:Local};\n    protected readonly name: string;\n    constructor(name: string) {\n        this.name = name;\n        this.caches = {};\n        this.locals = {};\n    }\n\n    protected abstract keyForGet(key:string|number):string;\n    protected abstract keyForSet(key:string|number):string;\n    protected abstract keyForRemove(key:string|number):string;\n    abstract removeAll():void;\n    getItem(key:string|number):string {\n        let k = this.keyForGet(key);\n        if (k === undefined) return;\n        return __ls.getItem(k);\n    }\n    setItem(key:string|number, value: string):void {\n        let k = this.keyForSet(key);\n        __ls.setItem(k, value);\n    }\n    removeItem(key:string|number):void {\n        let k = this.keyForSet(key);\n        if (k === undefined) return;\n        localStorage.removeItem(k);\n    }\n    arr(key:string|number):LocalArr {\n        let sk = String(key);\n        let arr = this.locals[sk] as LocalArr;\n        if (arr === undefined) {\n            let k = this.keyForSet(key);\n            this.locals[sk] = arr = new LocalArr(k);\n        }\n        return arr;\n    }\n    map(key:string|number):LocalMap {\n        let sk = String(key);\n        let map = this.locals[sk] as LocalMap;\n        if (map === undefined) {\n            let k = this.keyForSet(key);\n            this.locals[sk] = map = new LocalMap(k);\n        }\n        return map;\n    }\n    removeLocal(local:Local) {\n        let sk = local.name;\n        let k = this.keyForRemove(sk);\n        if (k === undefined) return;\n        let arr = this.locals[sk];\n        if (arr === undefined) arr = new LocalArr(k);\n        else this.locals[sk] = undefined;\n        arr.removeAll();\n    }\n    child(key:string|number):LocalCache {\n        let ks = String(key);\n        let ret = this.caches[ks];\n        if (ret !== undefined) return ret;\n        return this.caches[ks] =ret = new LocalCache(this, key);\n    }\n}\n\nconst maxArrSize = 500;\nexport class LocalArr extends Local {\n    private readonly index: number[];\n    constructor(name: string) {\n        super(name);\n        let index = __ls.getItem(this.name);\n        this.index = index === null? [] : index.split('\\n').map(v => Number(v));\n    }\n    private saveIndex() {\n        __ls.setItem(this.name, this.index.join('\\n'));\n    }\n    protected keyForGet(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i < 0) return undefined;\n        return `${this.name}.${key}`;\n    }\n    protected keyForSet(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i<0) {\n            this.index.unshift(key);\n            if (this.index.length > maxArrSize) this.index.pop();\n        }\n        else {\n            this.index.splice(i, 1);\n            this.index.unshift(key)\n        }\n        this.saveIndex();\n        return `${this.name}.${key}`;\n    }\n    protected keyForRemove(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i<0) return;\n        this.index.splice(i, 1);\n        this.saveIndex();\n        return `${this.name}.${key}`;\n    }\n    removeAll():void {\n        for (let i of this.index) {\n            __ls.removeItem(`${this.name}.${i}`);\n        }\n        __ls.removeItem(this.name);\n        this.index.splice(0);\n    }\n    item(index:number):LocalCache {\n        return this.child(index);\n    }\n}\n\nexport class LocalMap extends Local {\n    private readonly index: {[key:string]:number};\n    private max: number;\n    constructor(name: string) {\n        super(name);\n        this.max = 0;\n        this.index = {};\n        let index = __ls.getItem(this.name);\n        if (index !== null) {\n            let ls = index.split('\\n');\n            ls.forEach(l => {\n                let p = l.indexOf('\\t');\n                if (p<0) return;\n                let key = l.substr(0, p);\n                let i = Number(l.substr(p+1));\n                if (isNaN(i) === true) return;\n                this.index[key] = i;\n                if (i>this.max) this.max = i;\n            });\n        }\n    }\n    private saveIndex() {\n        let ls:string[] = [];\n        for (let k in this.index) {\n            let v = this.index[k];\n            if (v === undefined) continue;\n            ls.push(`${k}\\t${v}`);\n        }\n        __ls.setItem(this.name, ls.join('\\n'));\n    }\n    protected keyForGet(key:number):string {\n        let i = this.index[key];\n        if (i === undefined) return undefined;\n        return `${this.name}.${i}`;\n    }\n    protected keyForSet(key:number):string {\n        let i = this.index[key];\n        if (i === undefined) {\n            ++this.max;\n            i = this.max;\n            this.index[key] = i;\n            this.saveIndex();\n        }\n        return `${this.name}.${i}`;\n    }\n    protected keyForRemove(key:string|number):string {\n        let i = this.index[key];\n        if (i===undefined) return;\n        this.index[key] = undefined;\n        this.saveIndex();\n        return `${this.name}.${i}`;\n    }\n    removeAll():void {\n        for (let i in this.index) {\n            __ls.removeItem(`${this.name}.${this.index[i]}`);\n            this.index[i] = undefined;\n        }\n        __ls.removeItem(this.name);\n        this.max = 0;\n    }\n    item(key:string):LocalCache {\n        return this.child(key);\n    }\n}\n","import * as React from 'react';\nimport { BoxId } from './boxId';\nimport { Tuid } from './tuid';\nimport { observer } from 'mobx-react';\n\nconst TuidContent = (tuidName:string, values:any, x?:any) => {\n    return <>{tuidName}: {uqStringify(values)}</>;\n};\n\nexport function uqStringify(values: any): string {\n    let s = '{';\n    if (values === undefined) return 'undefined';\n    for (let i in values) {\n        let v = values[i];\n        s += i + ': ';\n        if (v === undefined) {\n            s += 'undefined';\n        }\n        else if (v === null) {\n            s += 'null';\n        }\n        else {\n            switch (typeof v) {\n                default:\n                    s += v;\n                    break;\n                case 'function':\n                    s += 'function';\n                    break;\n                case 'object':\n                    s += '{obj}';\n                    break;\n            }\n        }\n        s += ', ';\n    }\n    return s + '}';\n}\n\nexport class ReactBoxId implements BoxId {\n    readonly id: number;\n    protected tuid: Tuid;\n    protected ui: (values:any) => JSX.Element;\n    readonly isUndefined:boolean;\n    constructor(id: number, tuid: Tuid, ui: (values:any) => JSX.Element) {\n        this.id = Number(id);\n        this.tuid = tuid;\n        this.ui = ui;\n        this.isUndefined = (this.tuid === undefined);\n    }\n\n    get obj():any {\n        return this.tuid.valueFromId(this.id);\n    }\n\n    equ(id:BoxId|number): boolean {\n        if (id === undefined || id === null) return false;\n        if (typeof id === 'object') return this.id === id.id;\n        return this.id === id;\n    }\n\n    render(ui:TvTemplet, x:any):JSX.Element {\n        if (this.id === undefined || this.id === null || isNaN(this.id) === true) return;\n        let boxName = this.boxName; // this.tuid.name;\n        let val = this.obj; // this.tuid.valueFromId(this.id);\n        if (this.isUndefined === true) {\n            if (ui !== undefined) return ui(val, x);\n            return TuidContent(boxName, val, x);\n        }\n        switch (typeof val) {\n            case 'undefined':\n                return <span className=\"text-black-50\">{boxName} undefined</span>;\n            case 'number':\n                return <span className=\"text-light\">{boxName} {this.id}</span>;\n        }\n        if (ui === undefined) {\n            ui = this.ui;\n        }\n        if (ui !== undefined) {\n            if (typeof ui !== 'function') {\n                ui = (ui as any).content;\n            }\n            if (ui !== undefined) {\n                let ret = ui(val/*, this.tuidUR.res*/);\n                if (ret !== undefined) return ret;\n                return <span className=\"text-danger\">{boxName} {this.id}</span>;\n            }\n        }\n\n        return TuidContent(boxName, val);\n    }\n\n    get boxName():string {return this.tuid.name}\n    // ui(): TvTemplet {return this.tuid.ui}\n    // res(): any {return this.tuid.res}\n\n    async assure(): Promise<BoxId> {\n        await this.tuid.assureBox(this.id);\n        return this;\n    }\n}\n\nfunction boxIdContent(bi: number|BoxId, ui:TvTemplet, x:any) {\n    let logContent:any;\n    let boxId:ReactBoxId = bi as ReactBoxId;\n    switch(typeof bi) {\n        case 'undefined': logContent = <>boxId undefined</>; break;\n        case 'number': logContent = <>id:{bi}</>; break;\n        default:\n            if (typeof boxId.render !== 'function') {\n                if (ui === undefined) {\n                    logContent = TuidContent(boxId.boxName, bi, x);\n                }\n                else {\n                    return ui(bi, x);\n                }\n            }\n            break;\n    }\n    if (logContent !== undefined) {\n        return <del className=\"text-danger\">{logContent}</del>;\n    }\n    return boxId.render(ui, x);\n}\n\nexport type TvTemplet = (values?:any, x?:any) => JSX.Element;\n\ninterface Props {\n    tuidValue: number|BoxId, \n    ui?: TvTemplet,\n    x?: any,\n    nullUI?: ()=>JSX.Element\n}\n\nconst Tv = observer(({tuidValue, ui, x, nullUI}:Props) => {\n    if (tuidValue === undefined) {\n        if (nullUI === undefined) return <small className=\"text-muted\">[无]</small>;\n        return nullUI();\n    }\n    if (tuidValue === null) {\n        if (nullUI === undefined) return <>[null]</>;\n        return nullUI();\n    }\n    let ttv = typeof tuidValue;\n    switch (ttv) {\n        default:\n            if (ui === undefined)\n                return <>{ttv}-{tuidValue}</>;\n            else {\n                let ret = ui(tuidValue, x);\n                if (ret !== undefined) return ret;\n                return <>{tuidValue}</>;\n            }\n        case 'object':\n            let divObj = boxIdContent(tuidValue, ui, x);\n            if (divObj !== undefined) return divObj;\n            return nullUI === undefined? <>id null</>: nullUI();\n        case 'number':\n            return <>id...{tuidValue}</>;\n    }\n});\n\nexport const tv = (tuidValue:number|BoxId, ui?:TvTemplet, x?:any, nullUI?:()=>JSX.Element):JSX.Element => {\n    return <Tv tuidValue={tuidValue} ui={ui} x={x} nullUI={nullUI} />;\n};\n","import React from 'react';\nimport classNames from 'classnames';\n\nconst scrollAfter = 20; // 20ms之后，scroll执行\nexport class Scroller {\n    private el: HTMLBaseElement;\n    constructor(el: HTMLBaseElement) {\n        this.el = el;\n    }\n\n    scrollToTop():void {\n        setTimeout(() => this.el.scrollTo(0, 0), scrollAfter);\n    }\n    scrollToBottom():void {\n        setTimeout(() => this.el.scrollTo(0, this.el.scrollTop + this.el.offsetHeight), scrollAfter);\n    }\n}\n\nexport interface ScrollProps {\n    onScroll?: (e:any) => void;\n    onScrollTop?: (scroller: Scroller) => Promise<boolean>;\n\tonScrollBottom?: (scroller: Scroller) => Promise<void>;\n\tclassName?: string;\n}\ninterface ScrollViewProps extends ScrollProps {\n\tclassName?: string;\n\tstyle?: React.CSSProperties;\n}\nconst scrollTimeGap = 100;\nexport class ScrollView extends React.Component<ScrollViewProps, null> {\n    private bottomTime:number = 0;\n\tprivate topTime:number = 0;\n\tprivate div: HTMLDivElement;\n\n\tprivate refDiv = (div:HTMLDivElement) => {\n\t\tif (!div) {\n\t\t\tif (this.div) {\n\t\t\t\tthis.div.removeEventListener('resize', this.onResize)\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tthis.div = div;\n\t\tthis.div.addEventListener('resize', this.onResize);\n\t}\n\n\tprivate onResize = (ev:UIEvent) => {\n\t\tconsole.error('div resize');\n\t};\n\n    private onScroll = async (e:any) => {\n        let {onScroll, onScrollTop, onScrollBottom} = this.props;\n        if (onScroll) this.props.onScroll(e);\n        let el = e.target as HTMLBaseElement;\n        let scroller = new Scroller(el);\n        if (el.scrollTop < 30) {\n            if (onScrollTop !== undefined) {\n                let topTime = new Date().getTime();\n                if (topTime-this.topTime > scrollTimeGap) {\n                    this.topTime = topTime;\n\t\t\t\t\tonScrollTop(scroller).then(ret => {\n\t\t\t\t\t\t // has more\n\t\t\t\t\t\tif (ret === true) {\n\t\t\t\t\t\t\tlet sh = el.scrollHeight;\n\t\t\t\t\t\t\tlet top = 200;\n\t\t\t\t\t\t\tif (top > sh) top = sh;\n\t\t\t\t\t\t\tel.scrollTop = top;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n                }\n            }\n        }\n        if (el.scrollTop + el.offsetHeight > el.scrollHeight - 30) {\n            //this.eachChild(this, 'bottom');\n            if (onScrollBottom !== undefined) {\n                let bottomTime = new Date().getTime();\n                if (bottomTime - this.bottomTime > scrollTimeGap) {\n                    this.bottomTime = bottomTime;\n                    onScrollBottom(scroller);\n                }\n            }\n        }\n    }\n    private eachChild(c:any, direct:'top'|'bottom') {\n        let { props } = c;\n        if (props === undefined)\n            return;\n        let { children } = props;\n        if (children === undefined)\n            return;\n        React.Children.forEach(children, (child, index) => {\n            let {_$scroll} = child as any;\n            if (_$scroll) _$scroll(direct);\n            console.log(child.toString());\n            this.eachChild(child, direct);\n        });\n\t}\n\t\n    render() {\n\t\tlet {className, style} = this.props;\n\t\treturn <div ref={this.refDiv} className={classNames('tv-page')}\n\t\t\tonScroll={this.onScroll} style={style}>\n\t\t\t<article className={className}>\n\t\t\t\t{this.props.children}\n\t\t\t</article>\n\t\t</div>;\n    }\n}\n\n","import * as React from 'react';\n\nexport function Loading() {\n    return <div className=\"d-flex h-100 align-items-center justify-content-center\">\n        <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />\n    </div>;\n}\n","import { LocalMap } from './localDb';\n\nconst testingTags:string[] = ['/test', '/test/', '-test', '-test/'];\nfunction isTesting():boolean {\n    let {pathname} = document.location;\n    let pn = pathname.toLowerCase();\n    for (let item of testingTags) {\n        if (pn.endsWith(item) === true) return true;\n    }\n    return false;\n}\n\nexport const env = (function () {\n    let testing = isTesting();\n    let localDb = new LocalMap(testing===true? '$$':'$');\n    return {\n        testing: testing,\n        isDevelopment: process.env.NODE_ENV === 'development',\n        localDb: localDb,\n        setTimeout: (tag:string, callback: (...args: any[]) => void, ms: number, ...args: any[]):NodeJS.Timer => {\n            //if (tag !== undefined) console.log('setTimeout ' + tag);\n            return global.setTimeout(callback, ms, ...args);\n        },\n        clearTimeout: (handle:NodeJS.Timer):void => {\n            global.clearTimeout(handle);\n        },\n        setInterval: (callback: (...args: any[]) => void, ms: number, ...args: any[]): NodeJS.Timer => {\n            return global.setInterval(callback, ms, ...args);\n        },\n        clearInterval: (handle:NodeJS.Timer):void => {\n            global.clearInterval(handle);\n        }\n    }\n}());\n","\nexport * from './boxId';\nexport * from './tuid';\nexport { TuidsCache } from './tuidsCache';\nexport { tv, ReactBoxId, uqStringify } from './reactBoxId';","import {HttpChannel} from './httpChannel';\nimport { Caller } from './caller';\n\nexport async function refetchApi(channel:HttpChannel, url:string, options:any, \n    resolve:(values:any)=>any, reject:(reason:any)=>void)\n{\n    await channel.fetch(url, options, false, resolve, reject);\n}\n\nexport abstract class ApiBase {\n    protected token: string;\n    protected path: string;\n    protected showWaiting: boolean;\n\n    constructor(path: string, showWaiting: boolean) {\n        this.path = path || '';\n        this.showWaiting = showWaiting;\n    }\n\n    protected abstract async getHttpChannel(): Promise<HttpChannel>;\n\n    async xcall(caller:Caller<any>):Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.xcall(this.path, caller);\n    }\n\n    public async call(url:string, method:string, body:any):Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.callFetch(url, method, body);\n    }\n\n    public async get(path:string, params:any=undefined): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.get(this.path + path, params);\n    }\n\n    public async post(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.post(this.path + path, params);\n    }\n\n    public async put(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.put(this.path + path, params);\n    }\n\n    public async delete(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.delete(this.path + path, params);\n    }\n}\n","import * as React from 'react';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { UiImageItem } from '../schema';\nimport { ImageUploader } from '../resUploader';\nimport { nav } from '../nav';\nimport { ItemEdit } from './itemEdit';\n\nexport class ImageItemEdit extends ItemEdit {\n    get uiItem(): UiImageItem {return this._uiItem as UiImageItem}\n    @observable private resId: string;\n\n    protected async internalStart():Promise<any> {\n        this.resId = this.value;\n        return new Promise<any>((resolve, reject) => {\n            nav.push(React.createElement(this.page, {resolve:resolve, reject:reject}), ()=>reject());\n        });\n    }\n\n    /*\n    private upload = async () => {\n        if (!this.resUploader) return;\n        let ret = await this.resUploader.upload();\n        if (ret === null) {\n            this.overSize = true;\n            env.setTimeout('imageItemEdit upload', () => this.overSize = false, 3000);\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.value);\n    }\n    */\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let size:any = this.uiItem && this.uiItem.size;\n\n        /*\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>resolve(this.resId)}>保存</button>;\n        let overSize:any;\n        if (this.overSize === true) {\n            overSize = <div className=\"text-danger\">\n                <i className=\"fa fa-times-circle\" /> 图片文件大小超过2M，无法上传\n            </div>;\n        }\n        */\n        return <ImageUploader \n            label={'更改' + this.label}\n            id={this.resId}\n            size={size}\n            onSaved={(resId):Promise<void>=>{resolve(resId); return;}} />;\n        /*\n        return <Page header={'更改' + this.label} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div>上传图片：</div>\n                    <div className=\"my-3\">\n                        <ResUploader ref={v=>this.resUploader=v} multiple={false} maxSize={2048} />\n                    </div>\n                    <div>\n                        <button className=\"btn btn-primary\" onClick={this.upload}>上传</button>\n                    </div>\n                </div>\n                {overSize}\n                <div className=\"small muted my-4\">支持JPG、GIF、PNG格式图片，不超过2M。</div>\n                <div className=\"d-flex\">\n                    <div className=\"w-12c h-12c mr-4\"\n                        style={{border: '1px dotted gray', padding: '8px'}}>\n                        <Image className=\"w-100 h-100\" src={this.resId} />\n                    </div>\n                    <div>\n                        <div className=\"small\">图片预览</div>\n                        <Image className=\"w-4c h-4c mt-3\" src={this.resId} />\n                    </div>\n                </div>\n            </div>\n        </Page>;\n        */\n    })\n}\n","//import _ from 'lodash';\nimport { KeyValueRes, Res } from './res';\n\nexport interface FormRes extends KeyValueRes {\n    required: string;\n    number: string;\n    integer: string;\n    min: string;\n    max: string;\n}\n\n/*eslint no-template-curly-in-string: 0*/\nexport const formRes:Res<FormRes> = {\n    _: {\n        required: 'required',\n        number: 'not valid number',\n        integer: 'not valid integer',\n        min: 'min value is ${min}',\n        max: 'max value is ${max}',\n    },\n    zh: {\n        _: {\n            required: '必须填',\n            number: '需要数字',\n            integer: '需要整数',\n            min: '不能小于${min}',\n            max: '不能大于${max}',\n        }\n    },\n}\n","import { KeyValueRes, Res } from './res';\n\nexport interface ListRes extends KeyValueRes {\n    none: string;\n}\n\n/*eslint no-template-curly-in-string: 0*/\nexport const listRes:Res<ListRes> = {\n    _: {\n        none: '[none]',\n    },\n    zh: {\n        _: {\n            none: '[无]',\n        }\n    },\n}\n","import { Res } from '../res';\n\nexport interface LoginRes {\n    a: string;\n}\n\nexport const loginRes: Res<LoginRes> = {\n    _: {\n        a: 'd',\n    }\n}\n","import { Res } from '../res';\n\nexport interface RegisterRes {\n    a: string;\n}\n\nexport const registerRes: Res<RegisterRes> = {\n    _: {\n        a: 'd',\n    }\n}\n","import _ from 'lodash';\nimport {observable, IObservableArray, computed} from 'mobx';\n\nexport abstract class PageItems<T> {\n    constructor(itemObservable:boolean = false) {\n        this._items = observable.array<T>([], {deep:itemObservable});\n    }\n\tprivate isFirst: boolean = true;\n\tprivate pageItemAction: (item:T, results:{[name:string]:any[]}) => void;\n\tprivate itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T;\n    @observable loading: boolean = false;\n    @observable private beforeLoad: boolean = true;\n    @observable protected loaded: boolean = false;\n    protected _items:IObservableArray<T>;\n    @observable allLoaded: boolean = false;\n    @computed get items():IObservableArray<T> {\n        if (this.beforeLoad === true) return null;\n        if (this.loaded === false) return undefined;\n        return this._items;\n\t}\n\t\n\tsetEachPageItem(pageItemAction: (item:T, results:{[name:string]:any[]}) => void) {\n\t\tthis.pageItemAction = pageItemAction;\n\t}\n\n\tsetItemConverter(itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T) {\n\t\tthis.itemConverter = itemConverter;\n\t}\n\n    @observable topDiv:string = '$$top';\n    @observable bottomDiv:string = '$$bottom';\n    scrollToTop = () => {\n\t\tthis.scrollIntoView(this.topDiv);\n\t\t//let id = '$$top'+uid();\n\t\t//this.topDiv = id;\n\t\t/*\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(this.topDiv);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t\t*/\n    }\n    scrollToBottom = () => {\n\t\tthis.scrollIntoView(this.bottomDiv);\n\t\t//let id = '$$bottom'+uid();\n\t\t//this.bottomDiv = id;\n\t\t/*\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(this.bottomDiv);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t\t*/\n\t}\n\tprivate scrollIntoView(divId:string) {\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(divId);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t}\n\n    protected param: any;\n    protected firstSize = 100;\n    protected pageStart:any = undefined;\n    protected pageSize = 30;\n    protected appendPosition:'head'|'tail' = 'tail';\n\n\tprotected sortOrder:'asc'|'desc';\n\tprotected abstract async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}>;\n\tprotected getPageId(item:T):any {return;}\n\tprotected setPageStart(item:T) {\n\t\tthis.pageStart = this.getPageId(item);\n\t}\n\t\n\tprotected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\n\t\tlet results = await this.loadResults(param, pageStart, pageSize);\n\t\tlet pageList = results.$page;\n\t\tif (this.itemConverter) {\n\t\t\tlet ret:T[] = [];\n\t\t\tlet len = pageList.length;\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tlet item = this.itemConverter(pageList[i], results);\n\t\t\t\tret.push(item);\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\tif (this.pageItemAction !== undefined) {\n\t\t\tlet len = pageList.length;\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tthis.pageItemAction(pageList[i], results);\n\t\t\t}\n\t\t}\n\t\treturn pageList;\n\t}\n\n    reset() {\n        this.isFirst = true;\n        this.beforeLoad = true;\n        this.loaded = false;\n        this.param = undefined;\n\t\tthis.allLoaded = false;\n\t\tthis.pageStart = undefined;\n        this._items.clear();\n        //this.setPageStart(undefined);\n    }\n\n    append(item:T) {\n        if (this.appendPosition === 'tail')\n            this._items.unshift(item);\n        else\n            this._items.push(item);\n    }\n\n    async first(param:any):Promise<void> {\n        this.reset();\n        this.beforeLoad = false;\n        this.param = param;\n        await this.more();\n\t}\n\n\tprivate changing = false;\n\tasync attach(): Promise<void> {\n\t\tif (this.sortOrder === undefined) {\n\t\t\tconsole.error('没有定义增减序，无法attach');\n\t\t\treturn;\n\t\t}\n\t\tif (this.changing === true) return;\n\t\tthis.changing = true;\n\t\tlet items = this._items;\n\t\tlet isAsc = this.sortOrder === 'asc';\n\t\t//let isTail:boolean, \n\t\tlet endItem:T;\n\t\tlet scrollToEnd:() => void;\n\t\tlet pushItem:(item:T) => void;\n\t\tif (this.appendPosition === 'tail') {\n\t\t\t//isTail = true;\n\t\t\tendItem = items[0];\n\t\t\tscrollToEnd = this.scrollToTop;\n\t\t\tpushItem = (item:T) => items.unshift(item);\n\n\t\t}\n\t\telse {\n\t\t\t//isTail = false;\n\t\t\tlet endIndex = items.length;\n\t\t\tendItem = items[endIndex-1];\n\t\t\tscrollToEnd = this.scrollToBottom;\n\t\t\tpushItem = (item:T) => items.splice(endIndex, 0, item);\n\t\t}\n\t\tlet startId = this.getPageId(endItem);\n\t\tlet pid = undefined;\n\t\tlet sum = 0, max = 50;\n\t\tfor (;sum < max;) {\n\t\t\tlet ret = await this.load(this.param, pid, 3);\n\t\t\tlet len = ret.length;\n\t\t\tif (len === 0) break;\n\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tlet item = ret[i];\n\t\t\t\tpid = this.getPageId(item);\n\t\t\t\tif (isAsc === true) {\n\t\t\t\t\tif (pid >= startId) {\n\t\t\t\t\t\tmax = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (pid <= startId) {\n\t\t\t\t\t\tmax = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpushItem(item);\n\t\t\t\t/*\n\t\t\t\tif (isTail === true) {\n\t\t\t\t\tthis._items.unshift(item);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\t++sum;\n\t\t\t}\n\t\t}\n\t\tthis.changing = false;\n\t\tif (sum > 0) {\n\t\t\tscrollToEnd();\n\t\t\t/*\n\t\t\tif (isTail === true) this.scrollToTop();\n\t\t\telse this.scrollToBottom();\n\t\t\t*/\n\t\t}\n\t}\n\n\tasync refresh(): Promise<void> {\n\t\tif (this.changing === true) return;\n\t\tthis.changing = true;\n\t\tlet ret = await this.load(this.param, undefined, this.firstSize>this.pageSize? this.firstSize:this.pageSize);\n\t\tthis._items.clear();\n\t\tthis.setLoaded(ret);\n\t\t/*\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet item = ret[i];\n\t\t\tlet pid = this.getRefreshPageId(item);\n\t\t\tlet index = this._items.findIndex(v => this.getRefreshPageId(v) === pid);\n\t\t\t//let index = _.sortedIndexBy(this._items, item, v=>this.getRefreshPageId(v));\n\t\t\t//let oldItem = this._items[index];\n\t\t\t//let oid = this.getRefreshPageId(oldItem);\n\t\t\tif (index >= 0) {\n\t\t\t\t_.merge(this._items[index], item);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.splice(0, 0, item);\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.changing = false;\n\t}\n\n\tprotected getRefreshPageId(item:T) {\n\t\treturn this.getPageId(item);\n\t}\n\n    protected async onLoad(): Promise<void> {}\n    protected async onLoaded(): Promise<void> {}\n\n    async more():Promise<boolean> {\n        if (this.allLoaded === true) return false;\n\t\tif (this.loading === true) return true;\n\t\tif (this.changing === true) return true;\n\t\tthis.loading = true;\n\t\tthis.changing = true;\n        await this.onLoad();\n        if (this.pageStart === undefined) this.setPageStart(undefined);\n        let pageSize = this.pageSize + 1;\n        if (this.isFirst === true) {\n            if (this.firstSize > this.pageSize) pageSize = this.firstSize+1;\n        }\n        let ret = await this.load(\n                this.param, \n                this.pageStart,\n\t\t\t\tpageSize);\n        this.loaded = true;\n\t\tlet len = ret.length;\n        if ((this.isFirst===true && len>this.firstSize) ||\n            (this.isFirst===false && len>this.pageSize))\n        {\n            this.allLoaded = false;\n            --len;\n            ret.splice(len, 1);\n        }\n        else {\n            this.allLoaded = true;\n\t\t}\n\t\t/*\n        if (len === 0) {\n\t\t\tthis.setPageStart(undefined);\n            this._items.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.setPageStart(ret[len-1]);\n\t\t\tif (this.appendPosition === 'tail') {\n\t\t\t\tthis._items.push(...ret);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.unshift(...ret.reverse());\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.setLoaded(ret);\n\t\tthis.isFirst = false;\n\t\tthis.onLoaded();\n\t\tthis.changing = false;\n\t\tthis.loading = false;\n\t\treturn !this.allLoaded;\n\t}\n\t\n\tprivate setLoaded(data:any[]) {\n\t\tlet len = data.length;\n        if (len === 0) {\n\t\t\tthis.setPageStart(undefined);\n            this._items.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.setPageStart(data[len-1]);\n\t\t\tif (this.appendPosition === 'tail') {\n\t\t\t\tthis._items.push(...data);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.unshift(...data.reverse());\n\t\t\t}\n\t\t}\n\t}\n\n\tfindItem(item:any):T {\n\t\tlet pid = this.getPageId(item);\n\t\tlet index = _.findIndex(this._items, v => this.getPageId(v) === pid);\n\t\tif (index < 0) return;\n\t\treturn this._items[index];\n\t\t//let oldItem = this._items[index];\n\t\t//let oid = this.getPageId(oldItem);\n\t\t//if (pid === oid) return oldItem;\n\t}\n}\n","class MessageHub {\n    private handlerSeed = 1;\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\n    private msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\n\tregisterReceiveHandler(handler:(msg:any)=>Promise<void>):number;\n\tregisterReceiveHandler(type:string, handler:(msg:any)=>Promise<void>):number;\t\n    registerReceiveHandler(...args:any[]):number {\n\t\tlet seed = this.handlerSeed++;\n\t\tlet args0 = args[0];\n\t\tlet handler:(msg:any)=>Promise<void>;\n\t\tswitch (typeof args0) {\n\t\t\tcase 'string':\n\t\t\t\thandler = args[1];\n\t\t\t\tthis.msgHandlers[seed] = {type:args0, handler};\n\t\t\t\tbreak;\n\t\t\tcase 'function':\n\t\t\t\tthis.anyHandlers[seed] = args0;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn seed;\n    }\n    unregisterReceiveHandler(handlerId:number) {\n        delete this.anyHandlers[handlerId];\n        delete this.msgHandlers[handlerId];\n    }\n    async dispatch(msg:any) {\n        let {$type} = msg;\n        for (let i in this.anyHandlers) {\n            await this.anyHandlers[i](msg);\n        }\n        for (let i in this.msgHandlers) {\n            let {type, handler} = this.msgHandlers[i];\n            if (type !== $type) continue;\n            await handler(msg);\n        }\n    }\n}\n\nexport const messageHub = new MessageHub();\n","// typescript version of krasimir/navigo\n\nexport type RouteFunc = (params?:string|{[name:string]:string}, query?:string) => void;\n\nexport interface NamedRoute {\n\tas: string;\n\tuses: RouteFunc;\n\thooks?: Hooks;\n}\nexport interface Hooks {\n\tbefore: (done:()=>void, params:object) => void;\n\tafter: (params:object) => void;\n\tleave: (params:object) => void;\n\talready: (params:object) => void;\n}\ninterface Handler {\n\thandler: RouteFunc;\n\thooks: Hooks;\n}\ninterface LastResolved {\n\turl: string;\n\tquery: string;\n\thooks: Hooks;\n\tparams?: {[name:string]:string};\n\tname?: string;\n}\ninterface Route {\n\troute: string|RegExp;\n\thandler: RouteFunc,\n\tname: string,\n\thooks: Hooks\n}\n\nexport class Navigo {\n\tprivate static PARAMETER_REGEXP = /([:*])(\\w+)/g;\n\tprivate static WILDCARD_REGEXP = /\\*/g;\n\tprivate static REPLACE_VARIABLE_REGEXP = '([^\\\\/]+)';   \t// 单\\，编译错误 ([^\\/]+)\n\tprivate static REPLACE_WILDCARD = `(?:.*)`;\n\tprivate static FOLLOWED_BY_SLASH_REGEXP = '(?:\\\\/$|$)';\t\t// 单\\，编译错误 (?:\\/$|$)\n\tprivate static MATCH_REGEXP_FLAGS = '';\n\n\tprivate static isPushStateAvailable() {\n\t\treturn !!(\n\t\t  typeof window !== 'undefined' &&\n\t\t  window.history &&\n\t\t  window.history.pushState\n\t\t);\n\t}\n\t\n\tprivate static clean(s:string|RegExp) {\n\t\tif (s instanceof RegExp) return s;\n\t\treturn Navigo.cleanUrl(s);\n\t}\n\tprivate static cleanUrl(s:string) {\n\t\treturn s.replace(/\\/+$/, '').replace(/^\\/+/, '^/');\n\t}\n\n\tprivate static regExpResultToParams(match:any[], names:string[]) {\n\t\tif (names.length === 0) return null;\n\t\tif (!match) return null;\n\t\treturn match\n\t\t  .slice(1, match.length)\n\t\t  .reduce((params, value, index) => {\n\t\t\t\tif (params === null) params = {};\n\t\t\t\tparams[names[index]] = decodeURIComponent(value);\n\t\t\t\treturn params;\n\t\t  }, null);\n\t}\n\t  \n\tprivate static replaceDynamicURLParts(route:string|RegExp) {\n\t\tlet paramNames:string[] = [], regexp:RegExp;\n\t  \n\t\tif (route instanceof RegExp) {\n\t\t\tregexp = route;\n\t\t}\n\t\telse {\n\t\t\tregexp = new RegExp(\n\t\t\t\troute.replace(Navigo.PARAMETER_REGEXP, function (full, dots, name) {\n\t\t\t\t\t\tparamNames.push(name);\n\t\t\t\t\t\treturn Navigo.REPLACE_VARIABLE_REGEXP;\n\t\t\t\t\t})\n\t\t\t\t\t.replace(Navigo.WILDCARD_REGEXP, Navigo.REPLACE_WILDCARD) + Navigo.FOLLOWED_BY_SLASH_REGEXP\n\t\t\t\t, Navigo.MATCH_REGEXP_FLAGS);\n\t\t}\n\t\treturn { regexp, paramNames };\n\t}\n\t  \n\tprivate static getUrlDepth(url:string):number {\n\t\treturn url.replace(/\\/$/, '').split('/').length;\n\t}\n\t  \n\tprivate static compareUrlDepth(urlA:string, urlB:string) {\n\t\treturn Navigo.getUrlDepth(urlB) - Navigo.getUrlDepth(urlA);\n\t}\n\t  \n\tprivate static findMatchedRoutes(url:string, routes:Route[] = []) {\n\t\treturn routes.map(route => {\n\t\t\tlet { regexp, paramNames } = Navigo.replaceDynamicURLParts(Navigo.clean(route.route));\n\t\t\tlet match = url.replace(/^\\/+/, '/').match(regexp);\n\t\t\tlet params = Navigo.regExpResultToParams(match, paramNames);\n\t\t\treturn match ? { match, route, params } : false;\n\t\t}).filter(m => m);\n\t}\n\t  \n\tprivate static match(url:string, routes:Route[]) {\n\t\treturn Navigo.findMatchedRoutes(url, routes)[0] || false;\n\t}\n\t  \n\tprivate static root(url:string, routes:Route[]) {\n\t\tconst colonExp = RegExp('\\\\/:\\\\D(\\\\w*)', 'g');\n\t\tconst exp = ''; // '($|\\\\/)';  // 单\\，编译报错 ($|\\/)\n\t\tlet matched = routes.map(\n\t\t\troute => {\n\t\t\t\tlet r = route.route;\n\t\t\t\tif (r === '' || r === '*') return url;\n\t\t\t\tif (typeof r === 'string') {\n\t\t\t\t\tr = r.replace(colonExp, '\\\\/\\\\w+');\n\t\t\t\t}\n\t\t\t\tlet routeExp = r + exp;\n\t\t\t\tlet ret = url.split(new RegExp(routeExp))[0];\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t);\n\t\tlet fallbackURL = Navigo.cleanUrl(url);\n\t\tlet len = matched.length;\n\t\tif (len === 0) return fallbackURL;\n\t\tlet matched0 = matched[0];\n\t\tif (len === 1) return matched0;\n\t\treturn matched.reduce((result, url) => {\n\t\t\tif (result.length > url.length) result = url;\n\t\t\treturn result;\n\t\t}, matched0);\n\t}\n\t  \n\tprivate static isHashChangeAPIAvailable() {\n\t\treturn typeof window !== 'undefined' && 'onhashchange' in window;\n\t}\n\t  \n\tprivate static extractGETParameters(url:string):string {\n\t\treturn url.split(/\\?(.*)?$/).slice(1).join('');\n\t}\n\t  \n\tprivate static getOnlyURL(url:string, useHash:boolean, hash:string) {\n\t\tlet onlyURL = url, split:string[];\n\t\tvar cleanGETParam = (str:string) => str.split(/\\?(.*)?$/)[0];\n\t  \n\t\tif (typeof hash === 'undefined') {\n\t\t\t// To preserve BC\n\t\t\thash = '#';\n\t\t}\n\t  \n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\n\t\t  \tonlyURL = cleanGETParam(url).split(hash)[0];\n\t\t}\n\t\telse {\n\t\t\tsplit = url.split(hash);\n\t\t\tonlyURL = split.length > 1 ? cleanGETParam(split[1]) : cleanGETParam(split[0]);\n\t\t}\n\t\treturn onlyURL;\n\t}\n\t  \n\tprivate static manageHooks(handler:RouteFunc, hooks:Hooks, params?:any, exHooks?:Hooks) {\n\t\tif (hooks && typeof hooks === 'object') {\n\t\t\tif (hooks.before) {\n\t\t\t\thooks.before((shouldRoute = true) => {\n\t\t\t\tif (!shouldRoute) return;\n\t\t\t\thandler();\n\t\t\t\thooks.after && hooks.after(params);\n\t\t\t\t}, params);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (hooks.after) {\n\t\t\t\thandler();\n\t\t\t\thooks.after && hooks.after(params);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\thandler();\n\t}\n\t  \n\tprivate static isHashedRoot(url:string, useHash:boolean, hash:string) {\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\n\t\t  return false;\n\t\t}\n\t  \n\t\tif (!url.match(hash)) {\n\t\t  return false;\n\t\t}\n\t  \n\t\tlet split = url.split(hash);\n\t  \n\t\treturn split.length < 2 || split[1] === '';\n\t}\n\t\n\tprivate root:string;\n\tprivate _routes:Route[] = [];\n\tprivate _useHash:boolean;\n\tprivate _hash:string;\n\tprivate _paused:boolean;\n\tprivate _destroyed:boolean;\n\tprivate _lastRouteResolved:LastResolved;\n\tprivate _notFoundHandler:Handler;\n\tprivate _defaultHandler:Handler;\n\tprivate _usePushState:boolean;\n\tprivate _genericHooks:Hooks;\n\tprivate _historyUpdateMethod: 'pushState' | 'replaceState'; // HistoryUpdateMethod;\n\tprivate timout: any; //NodeJS.Timeout;\n\n\tconstructor(r:string = null, useHash:boolean = false, hash:string = '#') {\n\t\tthis.root = null;\n\t\tthis._useHash = useHash;\n\t\tthis._hash = (!hash)? '#' : hash;\n\t\tthis._paused = false;\n\t\tthis._destroyed = false;\n\t\tthis._lastRouteResolved = null;\n\t\tthis._notFoundHandler = null;\n\t\tthis._defaultHandler = null;\n\t\tthis._usePushState = !useHash && Navigo.isPushStateAvailable();\n\t\t//this._onLocationChange = this._onLocationChange.bind(this);\n\t\tthis._genericHooks = null;\n\t\tthis._historyUpdateMethod = 'pushState';\n\t\n\t\tif (r) {\n\t\t\tthis.root = useHash ? r.replace(/\\/$/, '/' + this._hash) : r.replace(/\\/$/, '');\n\t\t} else if (useHash) {\n\t\t\tthis.root = this._cLoc().split(this._hash)[0].replace(/\\/$/, '/' + this._hash);\n\t\t}\n\t\n\t\tthis._listen();\n\t\tthis.updatePageLinks();\n\t}\n  \n\tnavigate(path:string, absolute:boolean = false):Navigo {\n\t\tlet to:string;\n\t\tpath = path || '';\n\t\tif (this._usePushState) {\n\t\t\tto = (!absolute ? this._getRoot() + '/' : '') + path.replace(/^\\/+/, '/');\n\t\t\tto = to.replace(/([^:])(\\/{2,})/g, '$1/');\n\t\t\tthis._historyUpdate({}, '', to);\n\t\t\tthis.resolve();\n\t\t}\n\t\telse if (typeof window !== 'undefined') {\n\t\t\tpath = path.replace(new RegExp('^' + this._hash), '');\n\t\t\tlet {location} = window;\n\t\t\tlocation.href = location.href\n\t\t\t\t.replace(/#$/, '')\n\t\t\t\t.replace(new RegExp(this._hash + '.*$'), '') + this._hash + path;\n\t\t}\n\t\treturn this;\n\t}\n\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\ton(...args:any[]):Navigo {\n\t\tlet arg0 = args[0];\n\t\tlet arg1 = args[1];\n\t\tswitch (typeof arg0) {\n\t\t\tcase 'function':\n\t\t\t\tthis._defaultHandler = { handler: arg0, hooks: arg1 };\n\t\t\t\tif (!this._notFoundHandler) {\n\t\t\t\t\tthis._notFoundHandler = this._defaultHandler;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\tlet orderedRoutes = Object.keys(arg0).sort(Navigo.compareUrlDepth);\n\t\t\t\torderedRoutes.forEach(route => this.on(route, arg0[route]));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (args.length < 2) break;\n\t\t\t\tif (arg0 === '/') {\n\t\t\t\t\tthis._defaultHandler = { \n\t\t\t\t\t\thandler: typeof arg1 === 'object'? arg1.uses : arg1, \n\t\t\t\t\t\thooks: args[2],\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis._add(arg0, arg1, args[2]);\n\t\t\t\tbreak;\n\t\t}\n\t\treturn this;\n\t}\n\n\toff(handler:RouteFunc):Navigo {\n\t\tif (this._defaultHandler !== null && handler === this._defaultHandler.handler) {\n\t\t\tthis._defaultHandler = null;\n\t\t}\n\t\telse if (this._notFoundHandler !== null && handler === this._notFoundHandler.handler) {\n\t\t\tthis._notFoundHandler = null;\n\t\t}\n\t\tthis._routes = this._routes.reduce((result, r) => {\n\t\t\tif (r.handler !== handler) result.push(r);\n\t\t\treturn result;\n\t\t}, []);\n\t\treturn this;\n\t}\n\n\tnotFound(handler:RouteFunc, hooks:Hooks):Navigo {\n\t\tthis._notFoundHandler = { handler, hooks };\n\t\treturn this;\n\t}\n\n\tresolve(current?:string) {\n\t\tlet c = current || this._cLoc();\n\t\tlet root = this._getRoot();\n\t\tlet url = c.replace(root, '');\n\t\n\t\tif (this._useHash) {\n\t\t\tconst exp = '^\\\\/';  // 单\\，编译报错 ^\\/\n\t\t\turl = url.replace(new RegExp(exp + this._hash), '/');\n\t\t}\n\t\n\t\tlet GETParameters = Navigo.extractGETParameters(current || this._cLoc());\n\t\tlet onlyURL = Navigo.getOnlyURL(url, this._useHash, this._hash);\n\t\n\t\tif (this._paused) return false;\n\t\n\t\tif (\n\t\t\tthis._lastRouteResolved &&\n\t\t\tonlyURL === this._lastRouteResolved.url &&\n\t\t\tGETParameters === this._lastRouteResolved.query\n\t\t) {\n\t\t\tif (this._lastRouteResolved.hooks && this._lastRouteResolved.hooks.already) {\n\t\t\t\tthis._lastRouteResolved.hooks.already(this._lastRouteResolved.params);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\n\t\tlet matched = Navigo.match(onlyURL, this._routes);\n\t\n\t\tlet manageHooks = (handler:Handler) => {\n\t\t\tNavigo.manageHooks(() => {\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tthis._callLeave();\n\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\tquery: GETParameters, \n\t\t\t\t\t\thooks: handler.hooks\n\t\t\t\t\t};\n\t\t\t\t\thandler.handler(GETParameters);\n\t\t\t\t}, handler.hooks);\n\t\t\t}, this._genericHooks);\n\t\t}\n\n\t\tif (matched === false) {\n\t\t\tif (this._defaultHandler && (\n\t\t\t\tonlyURL === '' ||\n\t\t\t\tonlyURL === '/' ||\n\t\t\t\tonlyURL === this._hash ||\n\t\t\t\tNavigo.isHashedRoot(onlyURL, this._useHash, this._hash)\n\t\t\t)) {\n\t\t\t\t/*\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\t\tthis._callLeave();\n\t\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\t\tquery: GETParameters, \n\t\t\t\t\t\t\thooks: this._defaultHandler.hooks\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._defaultHandler.handler(GETParameters);\n\t\t\t\t\t}, this._defaultHandler.hooks);\n\t\t\t\t}, this._genericHooks);\n\t\t\t\t*/\n\t\t\t\tmanageHooks(this._defaultHandler);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (this._notFoundHandler) {\n\t\t\t\t/*\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\t\tthis._callLeave();\n\t\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\t\tquery: GETParameters,\n\t\t\t\t\t\t\thooks: this._notFoundHandler.hooks\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._notFoundHandler.handler(GETParameters);\n\t\t\t\t\t}, this._notFoundHandler.hooks);\n\t\t\t\t}, this._genericHooks);\n\t\t\t\t*/\n\t\t\t\tmanageHooks(this._notFoundHandler);\n\t\t\t}\n\t\t\treturn false;\t\n\t\t}\n\t\tlet m = matched;\n\t\tif (m) {\n\t\t\tthis._callLeave();\n\t\t\tthis._lastRouteResolved = {\n\t\t\t\turl: onlyURL,\n\t\t\t\tquery: GETParameters,\n\t\t\t\thooks: m.route.hooks,\n\t\t\t\tparams: m.params,\n\t\t\t\tname: m.route.name\n\t\t\t};\n\t\t\tlet handler = m.route.handler;\n\t\t\tNavigo.manageHooks(() => {\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tm.route.route instanceof RegExp ?\n\t\t\t\t\thandler(...(m.match.slice(1, m.match.length))) :\n\t\t\t\t\thandler(m.params, GETParameters);\n\t\t\t\t}, m.route.hooks, m.params, this._genericHooks);\n\t\t\t}, this._genericHooks, m.params);\n\t\t\treturn m;\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis._routes = [];\n\t\tthis._destroyed = true;\n\t\tthis._lastRouteResolved = null;\n\t\tthis._genericHooks = null;\n\t\tclearTimeout(this.timout);\n\t\tif (typeof window !== 'undefined') {\n\t\t\twindow.removeEventListener('popstate', this._onLocationChange);\n\t\t\twindow.removeEventListener('hashchange', this._onLocationChange);\n\t\t}\n\t}\n\n\tupdatePageLinks() {\n\t\t//var self = this;\n\t\tif (typeof document === 'undefined') return;\n\t\t\tthis._findLinks().forEach(link => {\n\t\t\tif (!link.hasListenerAttached) {\n\t\t\t\tlink.addEventListener('click', (e: React.MouseEvent<HTMLElement>) => {\n\t\t\t\t\tif((e.ctrlKey || e.metaKey) && e.currentTarget.tagName.toLowerCase() === 'a'){ return false; }\n\t\t\t\t\tvar location = this.getLinkPath(link);\n\t\t\n\t\t\t\t\tif (!this._destroyed) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.navigate(location.replace(/\\/+$/, '').replace(/^\\/+/, '/'));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlink.hasListenerAttached = true;\n\t\t\t}\n\t\t});\n\t}\n\n\tgenerate(name:string, data:any = {}) {\n\t\tlet result = this._routes.reduce((result, route) => {\n\t\t\tif (route.name === name) {\n\t\t\t\tresult = route.route.toString();\n\t\t\t\tfor (let key in data) {\n\t\t\t\t\tresult = result.replace(':' + key, data[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}, '');\n\t\n\t\treturn this._useHash ? this._hash + result : result;\n\t}\n\n\tlink(path:string) {\n\t\treturn this._getRoot() + path;\n\t}\n\n\tpause(status:boolean = true) {\n\t\tthis._paused = status;\n\t\tif (status) {\n\t\t\tthis._historyUpdateMethod = 'replaceState';\n\t\t}\n\t\telse {\n\t\t\tthis._historyUpdateMethod = 'pushState';\n\t\t}\n\t}\n\n\tresume() {\n\t\tthis.pause(false);\n\t}\n\n\thistoryAPIUpdateMethod(value:'pushState' | 'replaceState') {\n\t\tif (typeof value === 'undefined') return this._historyUpdateMethod;\n\t\tthis._historyUpdateMethod = value;\n\t\treturn value;\n\t}\n\n\tdisableIfAPINotAvailable() {\n\t\tif (!Navigo.isPushStateAvailable()) {\n\t\t\tthis.destroy();\n\t\t}\n\t}\n\n\tlastRouteResolved() {\n\t\treturn this._lastRouteResolved;\n\t}\n\n\tgetLinkPath(link:any) {\n\t\treturn link.getAttribute('href');\n\t}\n\n\thooks(hooks:Hooks) {\n\t\tthis._genericHooks = hooks;\n\t}\n\n\tprivate _add(route:string|RegExp, handler:RouteFunc|NamedRoute, hooks:Hooks) {\n\t\tif (typeof route === 'string') {\n\t\t\troute = encodeURI(route);\n\t\t}\n\t\tthis._routes.push(\n\t\t\ttypeof handler === 'object' ?\n\t\t\t{\n\t\t\t\troute,\n\t\t\t\thandler: handler.uses,\n\t\t\t\tname: handler.as,\n\t\t\t\thooks: hooks || handler.hooks\n\t\t\t} \n\t\t\t:\n\t\t\t{\n\t\t\t\troute,\n\t\t\t\thandler, \n\t\t\t\tname: undefined,\n\t\t\t\thooks,\n\t\t\t}\n\t\t);\n\t\treturn this._add;\n\t}\n\n\tprivate _historyUpdate(data:any, title:string, url?:string) {\n\t\tswitch (this._historyUpdateMethod) {\n\t\t\tdefault: throw Error('unknow history method ' + this._historyUpdateMethod);\n\t\t\tcase 'pushState': window.history.pushState(data, title, url); return;\n\t\t\tcase 'replaceState': window.history.replaceState(data, title, url); return;\n\t\t}\n\t}\n\n\tprivate _getRoot() {\n\t\tif (this.root !== null) return this.root;\n\t\tlet cLoc = this._cLoc();\n\t\tlet cLocRoot = cLoc.split('?')[0];\n\t\tthis.root = Navigo.root(cLocRoot, this._routes);\n\t\treturn this.root;\n\t}\n\n\tprivate _listen() {\n\t\tif (this._usePushState) {\n\t\t\twindow.addEventListener('popstate', this._onLocationChange);\n\t\t}\n\t\telse if (Navigo.isHashChangeAPIAvailable()) {\n\t\t\twindow.addEventListener('hashchange', this._onLocationChange);\n\t\t}\n\t\telse {\n\t\t\tlet cached = this._cLoc();\n\t\n\t\t\tlet check = () => {\n\t\t\t\tlet current = this._cLoc();\n\t\t\t\tif (cached !== current) {\n\t\t\t\t\tcached = current;\n\t\t\t\t\tthis.resolve();\n\t\t\t\t}\n\t\t\t\tif (this.timout) clearTimeout(this.timout);\n\t\t\t\tthis.timout = setTimeout(check, 200);\n\t\t\t};\n\t\t\tcheck();\n\t\t}\n\t}\n\n\tprivate _cLoc() {\n\t\tif (typeof window !== 'undefined') {\n\t\t\t//if (typeof window.__NAVIGO_WINDOW_LOCATION_MOCK__ !== 'undefined') {\n\t\t\t//\treturn window.__NAVIGO_WINDOW_LOCATION_MOCK__;\n\t\t\t//}\n\t\t\treturn Navigo.cleanUrl(window.location.href);\n\t\t}\n\t\treturn '';\n\t}\n\n\tprivate _findLinks() {\n\t\treturn [].slice.call(document.querySelectorAll('[data-navigo]'));\n\t}\n\n\tprivate _onLocationChange = () => {\n\t\tconsole.log('_onLocationChange');\n\t\tthis.resolve();\n\t}\n\n\tprivate _callLeave() {\n\t\tconst lastRouteResolved = this._lastRouteResolved;\t\n\t\tif (lastRouteResolved) {\n\t\t\tlet {params, hooks} = lastRouteResolved;\n\t\t\tif (hooks) {\n\t\t\t\tif (hooks.leave) {\n\t\t\t\t\thooks.leave(params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n//export default Navigo;\nexport const navigo = new Navigo();\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport classNames from 'classnames';\nimport { IVPage } from './page';\nimport { IObservableValue } from 'mobx/lib/internal';\nimport '../../css/va-tab.css';\nimport { ScrollView } from './scrollView';\n\nexport type TabCaption = (selected:boolean) => JSX.Element;\n\nexport interface TabProp {\n    name: string;\n    caption: TabCaption;\n\tcontent?: () => JSX.Element;\n\tpage?: IVPage;\n    notify?: IObservableValue<number>;\n    load?: () => Promise<void>;\n\tonShown?: () => Promise<void>;\n\tisSelected?: boolean;\n\tonScroll?: () => void;\n\tonScrollTop?: () => Promise<boolean>;\n\tonScrollBottom?: () => Promise<void>;\n\tclassName?: string;\n}\n\nexport interface TabsProps {\n    tabs: TabProp[];\n    tabPosition?: 'top' | 'bottom';\n    size?: 'sm' | 'lg' | 'md';\n    tabBg?: string;\n    contentBg?: string;\n    sep?: string;\n    selected?: string;\n    borderColor?: string;\n    borderWidth?: string;\n}\n\nclass Tab {\n\t@observable private loaded: boolean = false;\n    name: string;\n    @observable selected: boolean;\n    caption: TabCaption;\n\tcontentBuilder: ()=>JSX.Element;\n\tpage: IVPage;\n    notify: IObservableValue<number>;\n    load?: () => Promise<void>;\n\tonShown?: () => Promise<void>;\n\tonScroll?: () => void;\n\tonScrollTop?: () => Promise<boolean>;\n\tonScrollBottom?: () => Promise<void>;\n\tclassName?: string;\n\n    private _content: JSX.Element;\n    \n    get content(): JSX.Element {\n\t\tif (this.load && this.loaded === false) return null;\n\t\tif (this.selected === false) return this._content;\n\t\tif (!this._content) {\n\t\t\tif (this.contentBuilder !== undefined) {\n\t\t\t\tthis._content = this.contentBuilder();\n\t\t\t}\n\t\t\telse if (this.page !== undefined) {\n\t\t\t\tthis._content = this.page.content();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._content = <div className=\"p-5\">tab 应该定义content或者page</div>;\n\t\t\t}\n\t\t}\n\t\treturn this._content;\n    }\n\n    async shown() {\n        if (this.onShown !== undefined) {\n            await this.onShown();\n        }\n        if (this.load !== undefined) {\n\t\t\tif (this.loaded === false) {\n\t\t\t\tawait this.load();\n\t\t\t\tthis.loaded = true;\n\t\t\t}\n        }\n    }\n}\n\nexport const TabCaptionComponent = (label:string, icon:string, color:string) => <div \n    className={'d-flex justify-content-center align-items-center flex-column cursor-pointer ' + color}>\n    <div><i className={'fa fa-lg fa-' + icon} /></div>\n    <small>{label}</small>\n</div>;\n\nexport const TabCaption = TabCaptionComponent;\n\nexport class TabsView {\n\tprivate props: TabsProps;\n    private size: string;\n    private tabBg: string;\n    //private contentBg: string;\n    private sep: string;\n    @observable private selectedTab: Tab;\n    @observable private tabArr: Tab[];\n\n    constructor(props: TabsProps) {\n\t\tthis.props = props;\n\t\tlet {size, tabs, tabBg: tabBack, sep, selected} = props;\n\t\tthis.size = size || 'md';\n        this.tabArr = tabs.map(v => {\n            let tab = new Tab();\n            let {name, caption, content, page, notify, load, onShown, isSelected, onScroll, onScrollTop, onScrollBottom, className} = v;\n\t\t\ttab.name = name;\n\t\t\tif (isSelected === true || name === selected) {\n\t\t\t\tthis.selectedTab = tab;\n\t\t\t}\n\t\t\ttab.selected = false;\n\t\t\ttab.caption = caption;\n\t\t\tif (content !== undefined) {\n\t\t\t\ttab.contentBuilder = content;\n\t\t\t}\n\t\t\telse if (page !== undefined) {\n\t\t\t\ttab.page = page;\n\t\t\t\t//contentBuilder = () => {return page.content()};\n\t\t\t}\n            tab.notify = notify;\n            tab.load = load;\n\t\t\ttab.onShown = onShown;\n\t\t\ttab.onScroll = onScroll;\n\t\t\ttab.onScrollTop = onScrollTop;\n\t\t\ttab.onScrollBottom = onScrollBottom;\n\t\t\ttab.className = className;\n            return tab;\n        });\n        this.tabBg = tabBack;\n        //this.contentBg = contentBack;\n        this.sep = sep;\n        if (this.selectedTab === undefined) {\n\t\t\tthis.selectedTab = this.tabArr[0];\n\t\t}\n        this.selectedTab.selected = true;\n    }\n\n    tabClick = async (tab:Tab) => {\n\t\tif (!tab) {\n\t\t\ttab = this.selectedTab;\n\t\t\tif (tab === undefined) {\n\t\t\t\tif (this.tabArr === undefined) return;\n\t\t\t\tif (this.tabArr.length === 0) return;\n\t\t\t\ttab = this.tabArr[0];\n\t\t\t}\n\t\t}\n\n        this.selectedTab.selected = false;\n        tab.selected = true;\n\t\tthis.selectedTab = tab;\n\t\t\n\t\tawait tab.shown();\n    }\n\n\t/*\n    showTab(tabName: string) {\n        let tab = this.tabs.find(v => v.name === tabName);\n        if (tab === undefined) return;\n        if (this.selectedTab !== undefined) this.selectedTab.selected = false;\n        tab.selected = true;\n        this.selectedTab = tab;\n\t}\n\t*/\n\n\tprivate tabs = observer(() => {\n        let {tabPosition, borderColor} = this.props;\n        let bsCur:React.CSSProperties, bsTab:React.CSSProperties\n        if (borderColor) {\n            bsCur = {\n                borderColor: borderColor,\n                borderStyle: 'solid',\n                borderTopWidth: 1,\n                borderLeftWidth: 1,\n                borderRightWidth: 1,\n                borderBottomWidth: 1,\n            }\n            bsTab = {\n                borderColor: borderColor,\n                borderStyle: 'solid',\n                borderTopWidth: 1,\n                borderBottomWidth: 1,\n                borderLeftWidth: 0,\n                borderRightWidth: 0,\n            }\n            if (tabPosition === 'top') {\n                bsCur.borderBottomWidth = 0;\n                bsCur.borderTopLeftRadius = 10;\n                bsCur.borderTopRightRadius = 10;\n                bsTab.borderTopWidth = 0;\n            }\n            else {\n                bsCur.borderTopWidth = 0;\n                bsCur.borderBottomLeftRadius = 10;\n                bsCur.borderBottomRightRadius = 10;\n                bsTab.borderBottomWidth = 0;\n            }\n        }\n\t\tlet cn = classNames('tv-tabs', this.tabBg, this.sep, 'tv-tabs-' + this.size);\n\t\tlet tabs = <div className={cn}>\n            {this.tabArr.map((v,index) => {\n                let {selected, caption, notify} = v;\n                let notifyCircle:any;\n                if (notify !== undefined) {\n                    let num = notify.get();\n                    if (num !== undefined) {\n                        if (num > 0) notifyCircle = <u>{num>99?'99+':num}</u>;\n                        else if (num < 0) notifyCircle = <u className=\"dot\" />;\n                    }\n                }\n                return <div key={index} onClick={()=>this.tabClick(v)} style={selected===true? bsCur:bsTab}>\n\t\t\t\t\t<div>\n\t\t\t\t\t{notifyCircle}\n\t\t\t\t\t{caption(selected)}\n\t\t\t\t\t</div>\n                </div>\n            })}\n\t\t</div>;\n\t\treturn tabs;\n\t});\n\n\tcontent = observer(() => {\n\t\tlet displayNone:React.CSSProperties = {visibility: 'hidden'};\n\t\treturn <>\n\t\t\t{this.tabArr.map((v,index) => {\n\t\t\t\tlet {tabPosition} = this.props;\n\t\t\t\tlet {content, page, onScroll, onScrollTop, onScrollBottom, className} = v;\n\t\t\t\tlet tabs = React.createElement(this.tabs);\n\t\t\t\tlet pageHeader:any, pageFooter:any;\n\t\t\t\tif (page !== undefined) {\n\t\t\t\t\tpageHeader = page.header();\n\t\t\t\t\tpageFooter = page.footer();\n\t\t\t\t}\n\t\t\t\tlet header:any, footer:any;\n\t\t\t\tlet visibility:React.CSSProperties = {visibility:'hidden'};\n\t\t\t\tif (tabPosition === 'top') {\n\t\t\t\t\theader = <>\n\t\t\t\t\t\t<section className=\"tv-page-header\">\n\t\t\t\t\t\t\t<header>{tabs}{pageHeader}</header>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t\t<header style={visibility}>{tabs}{pageHeader}</header>\n\t\t\t\t\t</>;\n\t\t\t\t\tif (pageFooter !== undefined) {\n\t\t\t\t\t\tfooter = <>\n\t\t\t\t\t\t\t<footer style={visibility}>{pageFooter}</footer>\n\t\t\t\t\t\t\t<section className=\"tv-page-footer\">\n\t\t\t\t\t\t\t\t<footer>{pageFooter}</footer>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (pageHeader !== undefined) {\n\t\t\t\t\t\theader = <>\n\t\t\t\t\t\t\t<section className='tv-page-header'>\n\t\t\t\t\t\t\t\t<header>{pageHeader}</header>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t\t<header style={visibility}>{pageHeader}</header>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t}\n\t\t\t\t\tfooter = <>\n\t\t\t\t\t\t<footer style={visibility}>{pageFooter}{tabs}</footer>\n\t\t\t\t\t\t<section className='tv-page-footer'>\n\t\t\t\t\t\t\t<footer>{pageFooter}{tabs}</footer>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t</>;\n\t\t\t\t}\n\n\t\t\t\tlet style:React.CSSProperties;\n\t\t\t\tif (v.selected===false) style = displayNone;\n\t\t\t\treturn <ScrollView key={index} className={className}\n\t\t\t\t\tstyle={style}\n\t\t\t\t\tonScroll={onScroll} onScrollTop={onScrollTop} onScrollBottom={onScrollBottom}>\n\t\t\t\t\t{header}\n\t\t\t\t\t{content}\n\t\t\t\t\t{footer}\n\t\t\t\t</ScrollView>;\n\t\t\t})}\n\t\t</>;\n\t});\n\n    render() {\n\t\tlet {tabPosition} = this.props;\n\t\tlet tabs = React.createElement(this.tabs);\n\t\tlet header:any, footer:any;\n\t\tlet visibility:React.CSSProperties = {display:'none'};\n\t\tif (tabPosition === 'top') {\n\t\t\theader = <header>{tabs}</header>;\n\t\t}\n\t\telse {\n\t\t\tfooter = <footer>{tabs}</footer>;\n\t\t}\n\t\treturn <>\n\t\t\t{header}\n\t\t\t{this.tabArr.map((v,index) => {\n\t\t\t\tlet style:React.CSSProperties;\n\t\t\t\tif (v.selected===false) style = visibility;\n\t\t\t\treturn <div key={index} className={classNames(v.className)} style={style}>\n\t\t\t\t\t{v.content}\n\t\t\t\t</div>;\n\t\t\t})}\n\t\t\t{footer}\n\t\t</>;\n    }\n};\n\n@observer export class Tabs extends React.Component<TabsProps> {\n\tprivate readonly tabsView: TabsView;\n    constructor(props: TabsProps) {\n\t\tsuper(props);\n\t\tthis.tabsView = new TabsView(props);\n\t\tsetTimeout(() => {\n\t\t\tthis.tabsView.tabClick(undefined);\n\t\t}, 100);\n    }\n\n    render() {\n\t\treturn this.tabsView.render();\n    }\n};\n\n@observer export class RootTabs extends React.Component<TabsProps> {\n\tprivate readonly tabsView: TabsView;\n    constructor(props: TabsProps) {\n\t\tsuper(props);\n\t\tthis.tabsView = new TabsView(props);\n\t\tsetTimeout(() => {\n\t\t\tthis.tabsView.tabClick(undefined);\n\t\t}, 100);\n    }\n\n    render() {\n\t\treturn React.createElement(this.tabsView.content);\n    }\n};\n","import * as React from 'react';\nimport { nav } from './nav';\nimport { Loading } from './loading';\nimport { Image as ImageControl } from './image';\nimport { Page } from './page/page';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { LMR } from './simple';\n\nexport interface ResUploaderProps {\n    className?: string;\n    label?: string;\n    multiple?: boolean;\n    maxSize?: number;\n    onFilesChange?: (evt: React.ChangeEvent<HTMLInputElement>) => void;\n}\n\n@observer\nexport class ResUploader extends React.Component<ResUploaderProps> {\n    private fileInput: HTMLInputElement;\n    @observable private fileName: string;\n\n    buildFormData():FormData {\n        let {maxSize} = this.props;\n        if (maxSize === undefined || maxSize <= 0) \n            maxSize = 100000000000;\n        else\n            maxSize = maxSize * 1024;\n        var files:FileList = this.fileInput.files;\n        var data = new FormData();\n        let len = files.length;\n        for (let i=0; i<len; i++) {\n            let file = files[i];\n            if (file.size > maxSize) return null;\n            data.append('files[]', file, file.name);\n        }\n    }\n\n    getFile0(): File {\n        return this.fileInput.files[0];\n    }\n\n    upload = async (formData?: FormData):Promise<string|{error:any}> => {\n        let resUrl = nav.resUrl + 'upload';\n        if (!formData) formData = this.buildFormData();\n        try {\n            nav.startWait();\n            let headers = new Headers();\n            headers.append('Access-Control-Allow-Origin', '*');\n            //2019-12-18：因为 vivo按oppo某些版本不支持，暂时先不要 \n            //let abortController = new AbortController();\n            let res = await fetch(resUrl, {\n                method: \"POST\",\n                body: formData,\n                headers: headers,\n                //signal: abortController.signal,\n            });\n            let json = await res.json();\n            return ':' + json.res.id;\n        }\n        catch (err) {\n            console.error('%s %s', resUrl, err);\n            return {error:err};\n        }\n        finally {\n            nav.endWait();\n        }\n    }\n\n    private onFilesChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        let {onFilesChange} = this.props;\n        if (onFilesChange) onFilesChange(evt);\n        let files = evt.target.files;\n        let len = files.length;\n        let names:string[] = [];\n        for (let i=0; i<len; i++) {\n            names.push(files.item(i).name);\n        }\n        this.fileName = names.join(', ');\n    }\n\n    render() {\n        let {className, multiple, label} = this.props;\n        return <div>\n                <label className=\"btn btn-outline-success\">\n                    {label || '选择文件'} \n                    <input \n                        className={className}\n                        ref={t=>this.fileInput=t} \n                        onChange={this.onFilesChange}\n                        type='file' name='file' \n                        multiple={multiple} style={{display:'none'}} />\n                </label>\n                &nbsp;\n                {this.fileName}\n            </div>\n    }\n}\n\nfunction formatSize(size:number, pointLength:number=2, units?:string[]) {\n    var unit;\n    units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n    while ( (unit = units.shift()) && size > 1024 ) {\n        size = size / 1024;\n    }\n    return (unit === 'B' ? size : size.toFixed( pointLength === undefined ? 2 : pointLength)) + unit;\n}\n\ninterface ImageUploaderProps {\n    id?: string;\n    label?: string;\n    size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw';\n\tonSaved?: (imageId:string) => Promise<void>;\n\timageTypes?: string[];\n}\n\nconst xlargeSize = 1600;\nconst largeSize = 800;\nconst mediumSize = 400;\nconst smallSize = 180;\n\n@observer\nexport class ImageUploader extends React.Component<ImageUploaderProps> {\n\tprivate static imageTypes = ['gif', 'jpg', 'jpeg', 'png', 'svg', 'apng', 'bmp', 'ico', 'cur', 'tiff', 'tif', 'webp'];\n\tprivate imgBaseSize: number;\n\tprivate imageTypes: string[];\n    private suffix: string;\n    private resUploader: ResUploader;\n    @observable private file: File;    \n    @observable private desImgWidth: number;\n    @observable private desImgHeight: number;\n    @observable private desImgSize: number;\n    @observable private srcImgWidth: number;\n    @observable private srcImgHeight: number;\n    @observable private isChanged: boolean = false;\n    @observable private resId: string;\n    @observable private enableUploadButton: boolean = false;\n    @observable private srcImage: string;\n    @observable private desImage: string;\n    @observable private fileError: string;\n    @observable private uploaded: boolean = false;\n\n    constructor(props: ImageUploaderProps) {\n        super(props);\n\t\tthis.resId = props.id;\n\t\tthis.imageTypes = props.imageTypes || ImageUploader.imageTypes;\n    }\n\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.fileError = undefined;\n        this.uploaded = false;\n        this.enableUploadButton = evt.target.files.length > 0;\n        if (this.enableUploadButton) {\n            this.file = evt.target.files[0];\n            let pos = this.file.name.lastIndexOf('.');\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\n            if(this.imageTypes.indexOf(this.suffix) < 0){\n                this.fileError = `图片类型必须是 ${this.imageTypes.join(', ')} 中的一种`;\n                return;\n            }\n            let reader = new FileReader();\n            reader.readAsDataURL(this.file);\n            reader.onload = async () => {\n\t\t\t\tthis.srcImage = reader.result as string;\n\t\t\t\tswitch (this.suffix ) {\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tawait this.setSize(this.props.size);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'svg':\n\t\t\t\t\t\tthis.imgBaseSize = mediumSize;\n\t\t\t\t\t\tthis.desImgSize = this.srcImage.length;\n\t\t\t\t\t\tthis.desImage = this.srcImage;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n            };\n        }\n    }\n\n    private async setSize(size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw') {\n        switch (size) {\n            default:\n            case 'sm':\n                this.imgBaseSize = smallSize; break;\n            case 'md':\n                this.imgBaseSize = mediumSize; break;\n            case 'lg':\n\t\t\t\tthis.imgBaseSize = largeSize; break;\n\t\t\tcase 'xl':\n\t\t\t\tthis.imgBaseSize = xlargeSize; break;\n\t\t\tcase 'raw':\n\t\t\t\tthis.imgBaseSize = -1; break;\n\t\t}\n\t\tthis.desImage = await this.compress();\n    }\n\n    private compress = ():Promise<string> => {\n        return new Promise<string>((resolve, reject) => {\n            var img = new Image();\n            img.src = this.srcImage;\n            img.onload = () => {\n                //var that = this;\n                // 默认按比例压缩\n                let {width, height} = img;\n                this.srcImgWidth = width;\n                this.srcImgHeight = height;\n                let scale = width / height;\n\t\t\t\tlet w:number, h:number;\n\t\t\t\tif (this.imgBaseSize < 0) {\n\t\t\t\t\tw = width;\n\t\t\t\t\th = height;\n\t\t\t\t}\n                else if (width <= this.imgBaseSize && height <= this.imgBaseSize) {\n                    w = width;\n                    h = height;\n                }\n                else if (scale < 0) {\n                    w = this.imgBaseSize;\n                    h = w / scale;\n                }\n                else {\n                    h = this.imgBaseSize;\n                    w = h * scale;\n                }\n                this.desImgWidth = Math.round(w);\n                this.desImgHeight = Math.round(h);\n                var quality = 0.7;  // 默认图片质量为0.7\n                //生成canvas\n                var canvas = document.createElement('canvas');\n                var ctx = canvas.getContext('2d');\n                // 创建属性节点\n                var anw = document.createAttribute(\"width\");\n                anw.nodeValue = String(w);\n                var anh = document.createAttribute(\"height\");\n                anh.nodeValue = String(h);\n                canvas.setAttributeNode(anw);\n                canvas.setAttributeNode(anh);\n                ctx.drawImage(img, 0, 0, w, h);\n                let base64 = canvas.toDataURL('image/' + this.suffix , quality);\n                let blob = this.convertBase64UrlToBlob(base64);\n                this.desImgSize = blob.size;\n                if (this.desImgSize > 3*1024*1024) {\n                    this.fileError = \"图片大于3M，无法上传\";\n                    this.enableUploadButton = false;\n                }\n                resolve(base64);\n            }\n        });\n    }\n\n    private convertBase64UrlToBlob(urlData: string):Blob {\n        let arr = urlData.split(',');\n        let mime = arr[0].match(/:(.*?);/)[1];\n        let bstr = atob(arr[1]);\n        let n = bstr.length;\n        let u8arr = new Uint8Array(n);\n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], {type:mime});\n    }\n\n    private upload = async () => {\n        if (!this.resUploader) return;\n        let formData = new FormData();\n        let blob = this.convertBase64UrlToBlob(this.desImage);\n        formData.append('image', blob, this.file.name);\n        let ret = await this.resUploader.upload(formData);\n        if (typeof ret === 'object') {\n            let {error} = ret;\n            let type = typeof error;\n            let err:string;\n            switch (type) {\n                case 'undefined': err = 'error: undefined'; break;\n                case 'string': err = error; break;\n                case 'object': err = error.message; break;\n                default: err = String(err); break;\n            }\n            this.fileError = 'error: ' + type + ' - ' + err;\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.props.id);\n        this.uploaded = true;\n    }\n\n    private onSaved = (): Promise<void> => {\n        let {onSaved} = this.props;\n        onSaved && onSaved(this.resId);\n        return;\n    }\n\n    private showOrgImage = () => {\n        nav.push(<Page header=\"原图\">\n            <div className=\"p-3 text-center\">\n                <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.srcImage} />\n            </div>\n        </Page>);\n    }\n\n    private levelDiv() {\n        if (this.props.size) return;\n        let arr = [{caption:'小图', size:'sm'}];\n        if (this.srcImgHeight > mediumSize || this.srcImgWidth > mediumSize) {\n            arr.push({caption:'中图', size:'md'});\n        }\n        if (this.srcImgHeight > largeSize || this.srcImgWidth > largeSize) {\n            arr.push({caption:'大图', size:'lg'});\n        }\n        if (this.srcImgHeight > xlargeSize || this.srcImgWidth > xlargeSize) {\n\t\t\tarr.push({caption:'超大图', size:'xl'});\n\t\t\tarr.push({caption:'原图', size:'raw'});\n        }\n        if (arr.length < 2) return;\n        return <div>{arr.map((v, index) => {\n            let {caption, size} = v;\n            return <label key={index} className=\"mr-3\"><input type=\"radio\" name=\"size\" \n                onChange={()=>this.setSize(size as any)}\n                defaultChecked={index===0} /> {caption}</label>;\n        })}</div>\n    }\n\n    render() {\n        let {label} = this.props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={this.onSaved}>保存</button>;\n        return <Page header={label || '更改图片'} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div className=\"mb-3\">\n                        <ResUploader ref={v=>this.resUploader=v} \n                            multiple={false} maxSize={2048} \n                            label=\"选择图片文件\"\n                            onFilesChange={this.onFileChange} />\n                        <div className=\"small text-muted\">支持 {this.imageTypes.join(', ')} 格式图片。</div>\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\n                    </div>\n                    <LMR left=\n                    {\n                        this.uploaded === true? \n                            <div className=\"text-success p-2\">上传成功！</div>\n                            :\n                            this.file && this.desImgSize > 0 && <div className=\"mb-3 d-flex align-items-end\">\n                                <div className=\"mr-5\">\n                                    {this.levelDiv()}\n                                    <div>分辨率：{this.desImgWidth} x {this.desImgHeight}\n                                    &nbsp; &nbsp;\n                                    文件大小：{formatSize(this.desImgSize)}\n                                    </div>\n                                </div>\n                                <button className=\"btn btn-primary\" \n                                    disabled={!this.enableUploadButton}\n                                    onClick={this.upload}>上传</button>\n                            </div>\n                    }\n                    right={this.desImage && \n                        <button className=\"btn btn-link btn-sm text-right mb-3\" onClick={this.showOrgImage}>\n                            原图大小: {formatSize(this.file.size)}<br/>\n                            分辨率：{this.srcImgWidth} x {this.srcImgHeight}\n                        </button>\n                    }\n                    ></LMR>\n                </div>\n                <div className=\"text-center\" \n                    style={{\n                        border: (this.uploaded===true? '2px solid green' : '1px dotted gray'),\n                        padding: '8px'\n                    }}>\n                    <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.desImage} />\n                </div>\n            </div>\n        </Page>;\n    }\n}\n\ninterface AudioUploaderProps {\n    id?: string;\n    label?: string;\n    onSaved?: (imageId:string) => Promise<void>;\n}\n\n@observer\nexport class AudioUploader extends React.Component<AudioUploaderProps> {\n\tprivate static audioTypes = ['mp3', 'wav'];\n\n    private suffix: string;\n\tprivate resUploader: ResUploader;\n\t@observable private content: string;\n\t@observable private file: File;    \n\t@observable private fileSize: number;\n\n    @observable private isChanged: boolean = false;\n    @observable private resId: string;\n    @observable private enableUploadButton: boolean = false;\n    @observable private fileError: string;\n\t@observable private uploaded: boolean = false;\n\t@observable private uploading: boolean = false;\n\n    constructor(props: AudioUploaderProps) {\n        super(props);\n        this.resId = props.id;\n    }\n\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.fileError = undefined;\n        this.uploaded = false;\n        this.enableUploadButton = evt.target.files.length > 0;\n        if (this.enableUploadButton) {\n            this.file = evt.target.files[0];\n            let pos = this.file.name.lastIndexOf('.');\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\n            if(AudioUploader.audioTypes.indexOf(this.suffix) < 0){\n                this.fileError = `音频类型必须是 ${AudioUploader.audioTypes.join(', ')} 中的一种`;\n                return;\n            }\n            let reader = new FileReader();\n            reader.readAsDataURL(this.file);\n            reader.onload = async () => {\n\t\t\t\tthis.content = reader.result as string;\n\t\t\t\tthis.fileSize = this.content.length;\n            };\n        }\n    }\n\n    private convertBase64UrlToBlob(urlData: string):Blob {\n        let arr = urlData.split(',');\n        let mime = arr[0].match(/:(.*?);/)[1];\n        let bstr = atob(arr[1]);\n        let n = bstr.length;\n        let u8arr = new Uint8Array(n);\n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], {type:mime});\n    }\n\n    private upload = async () => {\n\t\tif (!this.resUploader) return;\n\t\tthis.uploading = true;\n        let formData = new FormData();\n        let blob = this.convertBase64UrlToBlob(this.content);\n        formData.append('image', blob, this.file.name);\n        let ret = await this.resUploader.upload(formData);\n        if (typeof ret === 'object') {\n            let {error} = ret;\n            let type = typeof error;\n            let err:string;\n            switch (type) {\n                case 'undefined': err = 'error: undefined'; break;\n                case 'string': err = error; break;\n                case 'object': err = error.message; break;\n                default: err = String(err); break;\n            }\n            this.fileError = 'error: ' + type + ' - ' + err;\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.props.id);\n        this.uploaded = true;\n    }\n\n    private onSaved = (): Promise<void> => {\n        let {onSaved} = this.props;\n        onSaved && onSaved(this.resId);\n        return;\n    }\n\n    render() {\n        let {label} = this.props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={this.onSaved}>保存</button>;\n        return <Page header={label || '更改文件'} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div className=\"mb-3\">\n                        <ResUploader ref={v=>this.resUploader=v} \n                            multiple={false} maxSize={2048} \n                            label=\"选择音频文件\"\n                            onFilesChange={this.onFileChange} />\n                        <div className=\"small text-muted\">支持 {AudioUploader.audioTypes.join(', ')} 格式。</div>\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\n                    </div>\n                </div>\n            </div>\n\t\t\t<LMR left=\n                    {\n                        this.uploaded === true? \n                            <div className=\"text-success p-2\">上传成功！</div>\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\tthis.uploading === true?\n\t\t\t\t\t\t\t\t<div className=\"m-3\"><Loading /></div>\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\tthis.file && this.content && <div className=\"m-3\">\n\t\t\t\t\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t\t\t\t\t文件大小：{formatSize(this.fileSize)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary\" \n\t\t\t\t\t\t\t\t\t\tdisabled={!this.enableUploadButton}\n\t\t\t\t\t\t\t\t\t\tonClick={this.upload}>上传</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t/>\n        </Page>;\n    }\n}\n","import _ from 'lodash';\nimport { UqApi, UqData, UnitxApi, appInFrame } from '../net';\nimport { Tuid, TuidDiv, TuidImport, TuidInner, TuidBox, TuidsCache } from './tuid';\nimport { Action } from './action';\nimport { Sheet } from './sheet';\nimport { Query } from './query';\nimport { Book } from './book';\nimport { History } from './history';\nimport { Map } from './map';\nimport { Pending } from './pending';\nimport { CreateBoxId, BoxId } from './tuid';\nimport { LocalMap, LocalCache } from '../tool';\nimport { UQsMan } from './uqsMan';\nimport { ReactBoxId } from './tuid/reactBoxId';\nimport { Tag } from './tag/tag';\n\nexport type FieldType = 'id' | 'tinyint' | 'smallint' | 'int' | 'bigint' | 'dec' | 'char' | 'text'\n    | 'datetime' | 'date' | 'time' | 'timestamp';\n\nexport function fieldDefaultValue(type:FieldType) {\n    switch (type) {\n        case 'tinyint':\n        case 'smallint':\n        case 'int':\n        case 'bigint':\n        case 'dec':\n            return 0;\n        case 'char':\n        case 'text':\n            return '';\n        case 'datetime':\n        case 'date':\n            return '2000-1-1';\n        case 'time':\n            return '0:00';\n    }\n}\n\nexport interface Field {\n    name: string;\n    type: FieldType;\n    tuid?: string;\n    arr?: string;\n    null?: boolean;\n    size?: number;\n    owner?: string;\n    _tuid: TuidBox;\n}\nexport interface ArrFields {\n    name: string;\n    fields: Field[];\n    id?: string;\n    order?: string;\n}\nexport interface FieldMap {\n    [name:string]: Field;\n}\nexport interface SchemaFrom {\n    owner:string;\n    uq:string;\n}\nexport interface TuidModify {\n    max: number;\n    seconds: number;\n}\n\nexport class UqMan {\n    private readonly actions: {[name:string]: Action} = {};\n    private readonly sheets: {[name:string]: Sheet} = {};\n    private readonly queries: {[name:string]: Query} = {};\n    private readonly books: {[name:string]: Book} = {};\n    private readonly maps: {[name:string]: Map} = {};\n    private readonly histories: {[name:string]: History} = {};\n\tprivate readonly pendings: {[name:string]: Pending} = {};\n\tprivate readonly tags: {[name:string]: Tag} = {};\n    private readonly tuidsCache: TuidsCache;\n    private readonly localAccess: LocalCache;\n    private readonly tvs:{[entity:string]:(values:any)=>JSX.Element};\n    readonly localMap: LocalMap;\n    readonly localModifyMax: LocalCache;\n    readonly tuids: {[name:string]: Tuid} = {};\n    readonly createBoxId: CreateBoxId;\n    readonly newVersion: boolean;\n    readonly uqOwner: string;\n    readonly uqName: string;\n    readonly name: string;\n    readonly uqApi: UqApi;\n    readonly id: number;\n\n    uqVersion: number;\n\n    constructor(uqs:UQsMan, uqData: UqData, createBoxId:CreateBoxId, tvs:{[entity:string]:(values:any)=>JSX.Element}) {\n        this.createBoxId = createBoxId;\n        if (createBoxId === undefined) {\n            this.createBoxId = this.createBoxIdFromTVs;\n            this.tvs = tvs || {};\n        }\n        let {id, uqOwner, uqName, access, newVersion: clearTuids} = uqData;\n        this.newVersion = clearTuids;\n        this.uqOwner = uqOwner;\n        this.uqName = uqName;\n        this.id = id;\n        this.name = uqOwner + '/' + uqName;\n        this.uqVersion = 0;\n        this.localMap = uqs.localMap.map(this.name);\n        this.localModifyMax = this.localMap.child('$modifyMax');\n        this.localAccess = this.localMap.child('$access');\n        //let hash = document.location.hash;\n        let baseUrl = 'tv/';\n\n        let acc: string[];\n        if (access === null || access === undefined || access === '*') {\n            acc = [];\n        }\n        else {\n            acc = access.split(';').map(v => v.trim()).filter(v => v.length > 0);\n        }\n        if (this.name === '$$$/$unitx') {\n            // 这里假定，点击home link之后，已经设置unit了\n            // 调用 UnitxApi会自动搜索绑定 unitx service\n            this.uqApi = new UnitxApi(appInFrame.unit);\n        }\n        else {\n            let {appOwner, appName} = uqs;\n            this.uqApi = new UqApi(baseUrl, appOwner, appName, uqOwner, uqName, acc, true);\n        }\n        this.tuidsCache = new TuidsCache(this);\n    }\n\n    get entities() {\n        return _.merge({}, \n            this.actions, this.sheets, this.queries, this.books,\n\t\t\tthis.maps, this.histories, this.pendings, this.tuids,\n\t\t\tthis.tags,\n        );\n    }\n\n    private createBoxIdFromTVs:CreateBoxId = (tuid:Tuid, id:number):BoxId =>{\n        let {name} = tuid;\n        /*\n        let tuidUR = this.tuidURs[name];\n        if (tuidUR === undefined) {\n            let {ui, res} = this.getUI(tuid);\n            this.tuidURs[name] = tuidUR = new TuidWithUIRes(tuid, ui, res);\n        }\n        */\n        return new ReactBoxId(id, tuid, this.tvs[name]);\n    }\n\n    tuid(name:string):Tuid {return this.tuids[name.toLowerCase()]}\n    tuidDiv(name:string, div:string):TuidDiv {\n        let tuid = this.tuids[name.toLowerCase()]\n        return tuid && tuid.div(div.toLowerCase());\n    }\n    action(name:string):Action {return this.actions[name.toLowerCase()]}\n    sheet(name:string):Sheet {return this.sheets[name.toLowerCase()]}\n    query(name:string):Query {return this.queries[name.toLowerCase()]}\n    book(name:string):Book {return this.books[name.toLowerCase()]}\n    map(name:string):Map {return this.maps[name.toLowerCase()]}\n    history(name:string):History {return this.histories[name.toLowerCase()]}\n    pending(name:string):Pending {return this.pendings[name.toLowerCase()]}\n\n    sheetFromTypeId(typeId:number):Sheet {\n        for (let i in this.sheets) {\n            let sheet = this.sheets[i];\n            if (sheet.typeId === typeId) return sheet;\n        }\n    }\n\n    readonly tuidArr: Tuid[] = [];\n    readonly actionArr: Action[] = [];\n    readonly sheetArr: Sheet[] = [];\n    readonly queryArr: Query[] = [];\n    readonly bookArr: Book[] = [];\n    readonly mapArr: Map[] = [];\n    readonly historyArr: History[] = [];\n    readonly pendingArr: Pending[] = [];\n    readonly tagArr: Tag[] = [];\n\n    async init() {\n        await this.uqApi.init();\n    }\n\n    async loadEntities(): Promise<string> {\n        try {\n            let accesses = this.localAccess.get();\n            if (!accesses) {\n                accesses = await this.uqApi.loadAccess();\n            }\n            if (!accesses) return;\n            this.buildEntities(accesses);\n        }\n        catch (err) {\n            return err;\n        }\n    }\n\n\tbuildEntities(entities:any) {\n        if (entities === undefined) {\n            debugger;\n        }\n        this.localAccess.set(entities);\n        let {access, tuids, version} = entities;\n        this.uqVersion = version;\n        this.buildTuids(tuids);\n        this.buildAccess(access);\n\t}\n\t\n    private buildTuids(tuids:any) {\n        for (let i in tuids) {\n            let schema = tuids[i];\n            let {typeId, from} = schema;\n            let tuid = this.newTuid(i, typeId, from);\n            tuid.sys = true;\n        }\n        for (let i in tuids) {\n            let schema = tuids[i];\n            let tuid = this.getTuid(i);\n            tuid.setSchema(schema);\n        }\n        for (let i in this.tuids) {\n            let tuid = this.tuids[i];\n            tuid.buildFieldsTuid();\n        }\n\t}\n\n    async loadEntitySchema(entityName: string): Promise<any> {\n        return await this.uqApi.schema(entityName);\n    }\n\n    getTuid(name:string): Tuid {\n        return this.tuids[name];\n    }\n\n    private buildAccess(access:any) {\n        for (let a in access) {\n            let v = access[a];\n            switch (typeof v) {\n                case 'string': this.fromType(a, v); break;\n                case 'object': this.fromObj(a, v); break;\n            }\n        }\n    }\n\n    cacheTuids(defer:number) {\n        this.tuidsCache.cacheTuids(defer);\n    }\n\n    newAction(name:string, id:number):Action {\n        let action = this.actions[name];\n        if (action !== undefined) return action;\n        action = this.actions[name] = new Action(this, name, id)\n        this.actionArr.push(action);\n        return action;\n    }\n    private newTuid(name:string, id:number, from:SchemaFrom):Tuid {\n        let tuid = this.tuids[name];\n        if (tuid !== undefined) return tuid;\n        if (from !== undefined)\n            tuid = new TuidImport(this, name, id, from);\n        else\n            tuid = new TuidInner(this, name, id);\n        this.tuids[name] = tuid;\n        this.tuidArr.push(tuid);\n        return tuid;\n    }\n    newQuery(name:string, id:number):Query {\n        let query = this.queries[name];\n        if (query !== undefined) return query;\n        query = this.queries[name] = new Query(this, name, id)\n        this.queryArr.push(query);\n        return query;\n    }\n    private newBook(name:string, id:number):Book {\n        let book = this.books[name];\n        if (book !== undefined) return book;\n        book = this.books[name] = new Book(this, name, id);\n        this.bookArr.push(book);\n        return book;\n    }\n    private newMap(name:string, id:number):Map {\n        let map = this.maps[name];\n        if (map !== undefined) return map;\n        map = this.maps[name] = new Map(this, name, id)\n        this.mapArr.push(map);\n        return map;\n    }\n    private newTag(name:string, id:number):Tag {\n        let tag = this.tags[name];\n        if (tag !== undefined) return tag;\n        tag = this.tags[name] = new Tag(this, name, id)\n        this.tagArr.push(tag);\n        return tag;\n    }\n    private newHistory(name:string, id:number):History {\n        let history = this.histories[name];\n        if (history !== undefined) return;\n        history = this.histories[name] = new History(this, name, id)\n        this.historyArr.push(history);\n        return history;\n    }\n    private newPending(name:string, id:number):Pending {\n        let pending = this.pendings[name];\n        if (pending !== undefined) return;\n        pending = this.pendings[name] = new Pending(this, name, id)\n        this.pendingArr.push(pending);\n        return pending;\n    }\n    newSheet(name:string, id:number):Sheet {\n        let sheet = this.sheets[name];\n        if (sheet !== undefined) return sheet;\n        sheet = this.sheets[name] = new Sheet(this, name, id);\n        this.sheetArr.push(sheet);\n        return sheet;\n    }\n    private fromType(name:string, type:string) {\n        let parts = type.split('|');\n        type = parts[0];\n        let id = Number(parts[1]);\n        switch (type) {\n            //case 'uq': this.id = id; break;\n            case 'tuid':\n                // Tuid should not be created here!;\n                //let tuid = this.newTuid(name, id);\n                //tuid.sys = false;\n                break;\n            case 'action': this.newAction(name, id); break;\n            case 'query': this.newQuery(name, id); break;\n            case 'book': this.newBook(name, id); break;\n            case 'map': this.newMap(name, id); break;\n            case 'history': this.newHistory(name, id); break;\n            case 'sheet':this.newSheet(name, id); break;\n\t\t\tcase 'pending': this.newPending(name, id); break;\n\t\t\tcase 'tag': this.newTag(name, id); break;\n        }\n    }\n    private fromObj(name:string, obj:any) {\n        switch (obj['$']) {\n            case 'sheet': this.buildSheet(name, obj); break;\n        }\n    }\n    private buildSheet(name:string, obj:any) {\n        let sheet = this.sheets[name];\n        if (sheet === undefined) sheet = this.newSheet(name, obj.id);\n        sheet.build(obj);\n    }\n    buildFieldTuid(fields:Field[], mainFields?:Field[]) {\n        if (fields === undefined) return;\n        for (let f of fields) {\n            let {tuid} = f;\n            if (tuid === undefined) continue;\n            let t = this.getTuid(tuid);\n            if (t === undefined) continue;\n            f._tuid = t.buildTuidBox();\n        }\n        for (let f of fields) {\n            let {owner} = f;\n            if (owner === undefined) continue;\n            let ownerField = fields.find(v => v.name === owner);\n            if (ownerField === undefined) {\n                if (mainFields !== undefined) {\n                    ownerField = mainFields.find(v => v.name === owner);\n                }\n                if (ownerField === undefined) {\n                    debugger;\n                    throw new Error(`owner field ${owner} is undefined`);\n                }\n            }\n            let {arr, tuid} = f;\n            let t = this.getTuid(ownerField._tuid.tuid.name);\n            if (t === undefined) continue;\n            let div = t.div(arr || tuid);\n            f._tuid = div && div.buildTuidDivBox(ownerField);\n            if (f._tuid === undefined) {\n                debugger;\n                throw new Error(`owner field ${owner} is not tuid`);\n            }\n        }\n    }\n    buildArrFieldsTuid(arrFields:ArrFields[], mainFields:Field[]) {\n        if (arrFields === undefined) return;\n        for (let af of arrFields) {\n            let {fields} = af;\n            if (fields === undefined) continue;\n            this.buildFieldTuid(fields, mainFields);\n        }\n    }\n\n    pullModify(modifyMax:number) {\n        this.tuidsCache.pullModify(modifyMax);\n    }\n}\n","import { Entity } from './entity';\nimport { PageItems } from '../tool/pageItems';\nimport { EntityCaller } from './caller';\n\nexport interface SheetState {\n    name: string;\n    actions: SheetAction[];\n}\n\nexport interface SheetAction {\n    name: string;\n}\n\nexport interface StateCount {\n    state: string;\n    count: number;\n}\n\nexport class Sheet extends Entity {\n    get typeName(): string { return 'sheet';}\n    states: SheetState[];\n\n    /*\n    setStates(states: SheetState[]) {\n        for (let state of states) {\n            this.setStateAccess(this.states.find(s=>s.name==state.name), state);\n        }\n    }*/\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.states = schema.states;\n    }\n    build(obj:any) {\n        this.states = [];\n        for (let op of obj.ops) {\n            this.states.push({name: op, actions:undefined});\n        }\n        /*\n        for (let p in obj) {\n            switch(p) {\n                case '#':\n                case '$': continue;\n                default: this.states.push(this.createSheetState(p, obj[p])); break;\n            }\n        }*/\n    }\n    private createSheetState(name:string, obj:object):SheetState {\n        let ret:SheetState = {name:name, actions:[]};\n        let actions = ret.actions;\n        for (let p in obj) {\n            let action:SheetAction = {name: p};\n            actions.push(action);\n        }\n        return ret;\n    }\n    /*\n    private setStateAccess(s:SheetState, s1:SheetState) {\n        if (s === undefined) return;\n        for (let action of s1.actions) {\n            let acn = action.name;\n            let ac = s.actions.find(a=>a.name === acn);\n            if (ac === undefined) continue;\n            s.actions.push(action);\n        }\n    }*/\n    async save(discription:string, data:any):Promise<any> {\n        /*\n        await this.loadSchema();\n        let {id} = this.uq;\n        let text = this.pack(data);\n\n        let ret = await this.uqApi.sheetSave(this.name, );\n        return ret;\n        */\n        let {id} = this.uq;\n        //let text = this.pack(data);\n        let params = {app: id, discription: discription, data:data};\n        return await new SaveCaller(this, params).request();\n        /*\n        let {id, state} = ret;\n        if (id > 0) this.changeStateCount(state, 1);\n        return ret;\n        */\n    }\n    async action(id:number, flow:number, state:string, action:string) {\n        /*\n        await this.loadSchema();\n        return await this.uqApi.sheetAction(this.name, {id:id, flow:flow, state:state, action:action});\n        */\n        return await new ActionCaller(this, {id:id, flow:flow, state:state, action:action}).request();\n    }\n    private unpack(data:any):any {\n        //if (this.schema === undefined) await this.loadSchema();\n        let ret = data[0];\n        let brief = ret[0];\n        let sheetData = this.unpackSheet(brief.data);\n        let flows = data[1];\n        return {\n            brief: brief,\n            data: sheetData,\n            flows: flows,\n        }\n    }\n    async getSheet(id:number):Promise<any> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.getSheet(this.name, id);\n        */\n        let ret = await new GetSheetCaller(this, id).request();\n        if (ret[0].length === 0) return await this.getArchive(id);\n        return this.unpack(ret);\n    }\n    async getArchive(id:number):Promise<any> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.sheetArchive(this.name, id)\n        return this.unpack(ret);\n        */\n        let ret = await new SheetArchiveCaller(this, id).request();\n        return this.unpack(ret);\n    }\n\n    async getArchives(pageStart:number, pageSize:number) {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.sheetArchives(this.name, {pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {pageStart:pageStart, pageSize:pageSize};\n        return await new SheetArchivesCaller(this, params).request();\n    }\n\n    async getStateSheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.stateSheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\n        return await new StateSheetsCaller(this, params).request();\n    }\n    createPageStateItems<T>(): PageStateItems<T> {return new PageStateItems<T>(this);}\n\n    async stateSheetCount():Promise<StateCount[]> {\n        /*\n        await this.loadSchema();\n        let ret:StateCount[] = await this.uqApi.stateSheetCount(this.name);\n        return this.states.map(s => {\n            let n = s.name, count = 0;\n            let r = ret.find(v => v.state === n);\n            if (r !== undefined) count = r.count;\n            return {state: n, count: count} \n        });\n        */\n        return await new StateSheetCountCaller(this, undefined).request();\n    }\n\n    async userSheets(state:string, user:number, pageStart:number, pageSize:number):Promise<any[]> {\n        let params = {state:state, user:user, pageStart:pageStart, pageSize:pageSize};\n        return await new UserSheetsCaller(this, params).request();\n    }\n\n    async mySheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.mySheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\n        return await new MySheetsCaller(this, params).request();\n    }\n}\n\n\nabstract class SheetCaller<T> extends EntityCaller<T> {\n    protected get entity(): Sheet {return this._entity as Sheet;}\n    protected readonly suffix:string;\n    get path():string {return `sheet/${this.entity.name}/${this.suffix}`;}\n}\n\nclass SaveCaller extends SheetCaller<{app:number; discription:string; data:any}> {\n    get path():string {return `sheet/${this.entity.name}`;}\n    buildParams() {\n        let {app, discription, data} = this.params;\n        return {\n            app: app,\n            discription: discription,\n            data: this.entity.pack(data)\n        };\n    }\n}\n\nclass ActionCaller extends SheetCaller<{id:number, flow:number, state:string, action:string}> {\n    method = 'PUT';\n    get path():string {return `sheet/${this.entity.name}`;}\n    //buildParams() {return this.entity.buildParams(this.params);}\n}\n\nclass GetSheetCaller extends SheetCaller<number> {\n    //protected readonly params: number;  // id\n    method = 'GET';\n    //private id:number;\n    //protected readonly suffix = 'archive';\n    buildParams() {}\n    get path():string {return `sheet/${this.entity.name}/get/${this.params}`;}\n}\n\nclass SheetArchiveCaller extends SheetCaller<number> {\n    //protected readonly params: number;  // id\n    method = 'GET';\n    //protected readonly suffix = 'archive';\n    buildParams() {}\n    get path():string {return `sheet/${this.entity.name}/archive/${this.params}`;}\n}\n\nclass SheetArchivesCaller extends SheetCaller<{pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'archives';\n}\n\nclass StateSheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'states';\n}\n\nclass StateSheetCountCaller extends SheetCaller<undefined> {\n    method = 'GET';\n    protected readonly suffix = 'statecount';\n    xresult(res:any):any {\n        let {states} = this.entity;\n        return states.map(s => {\n            let n = s.name, count = 0;\n            let r = (res as any[]).find(v => v.state === n);\n            if (r !== undefined) count = r.count;\n            return {state: n, count: count} \n        });\n    }\n}\n\nclass UserSheetsCaller extends SheetCaller<{state:string, user:number, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'user-sheets';\n    xresult(res:any):any {\n        return res;\n    }\n}\n\nclass MySheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'my-sheets';\n    xresult(res:any):any {\n        return res;\n    }\n}\n\nexport class PageStateItems<T> extends PageItems<T> {\n    private sheet: Sheet;\n    constructor(sheet: Sheet) {\n        super(true);\n        this.sheet = sheet;\n        this.pageSize = 10;\n\t}\n\tprotected async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\n\t\tlet ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\n\t\treturn {$page: ret};\n\t}\n\t/*\n    protected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\n        let ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\n        return ret;\n\t}\n\t*/\n\tprotected getPageId(item:T) {\n\t\treturn item === undefined? 0 : (item as any).id;\n\t}\n\t/*\n    protected setPageStart(item:any) {\n        this.pageStart = item === undefined? 0 : item.id;\n\t}\n\t*/\n}\n","import {Query} from './query';\nimport { QueryQueryCaller } from './caller';\n\nexport class Book extends Query {\n    get typeName(): string { return 'book';}\n    protected queryApiName = 'book';\n\n    protected queryCaller(params: any): QueryQueryCaller {\n        return new BookQueryCaller(this, params);\n    }\n}\n\nexport class BookQueryCaller extends QueryQueryCaller {\n    get path():string {return `book/${this.entity.name}`;}\n}\n","import {Query} from './query';\n\nexport class History extends Query {\n    get typeName(): string { return 'history';}\n    protected queryApiName = 'history';\n}\n","import { Entity } from './entity';\nimport { Action, ActionSubmitCaller } from './action';\nimport { Query } from './query';\nimport { Field } from './uqMan';\nimport { EntityCaller, QueryPageCaller, QueryQueryCaller } from './caller';\n\ninterface MapActions {\n    add: Action;\n    del: Action;\n}\ninterface MapQueries {\n    all: Query;\n    page: Query;\n    query: Query;\n}\n\nexport class Map extends Entity {\n    get typeName(): string { return 'map';}\n    keys: Field[];\n    actions: MapActions = {} as any;\n    queries: MapQueries = {} as any;\n    schemaFrom: {owner:string; uq:string};\n\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.schemaFrom = this.schema.from;\n        let {actions, queries, keys} = schema;\n        this.uq.buildFieldTuid(this.keys = keys);\n        for (let i in actions) {\n            let actionSchema = actions[i];\n            let {name} = actionSchema;\n            let action = this.uq.newAction(name, undefined);\n            action.setSchema(actionSchema);\n            action.buildFieldsTuid();\n            (this.actions as any)[i] = action;\n        }\n        for (let i in queries) {\n            let querySchema = queries[i];\n            let {name} = querySchema;\n            let query = this.uq.newQuery(name, undefined);\n            query.setSchema(querySchema);\n            query.buildFieldsTuid();\n            (this.queries as any)[i] = query;\n        }\n    }\n\n    async add(param:any) {\n        let ret = await new AddCaller(this, param).request();\n        return ret;\n    }\n\n    async del(param:any) {\n        let ret = await new DelCaller(this, param).request();\n        return ret;\n    }\n\n    async all() {\n        let ret = await new AllCaller(this, undefined).request();\n        return ret;\n    }\n\n    async page(param:any, pageStart:any, pageSize: number) {\n        let ret = await new PageCaller(this, {pageStart:pageStart, pageSize:pageSize, param:param}).request();\n        return ret;\n    }\n\n    async query(param:any) {\n       let qc = new QueryCaller(this, param);\n       let ret = await qc.request();\n       return ret;\n   }\n    async table(params:any): Promise<any[]> {\n        let ret = await this.query(params);\n        for (let i in ret) {\n            return ret[i];\n        }\n    }\n    async obj(params:any):Promise<any> {\n        let ret = await this.table(params);\n        if (ret.length > 0) return ret[0];\n    }\n    async scalar(params:any):Promise<any> {\n        let ret = await this.obj(params);\n        for (let i in ret) return ret[i];\n    }\n}\n\nabstract class MapCaller extends EntityCaller<any> {\n    protected get entity(): Map {return this._entity as Map;}\n    get path():string {return undefined;}\n\n    protected abstract getCaller(param: any):EntityCaller<any>;\n\n    protected async innerCall(): Promise<any> {\n        let caller = this.getCaller(this.params);\n        let res = await this.entity.uqApi.xcall(caller);\n        let ret = caller.xresult(res.res);\n        return {res: ret};\n    }\n\n    buildParams() {\n        let p = super.buildParams();\n        return p;\n    }\n}\n\nclass AddCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapAddCaller(this.entity, this.entity.actions.add, param);\n    }\n}\n\nclass DelCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapDelCaller(this.entity, this.entity.actions.add, param);\n    }\n}\n\nclass AllCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapAllCaller(this.entity, this.entity.queries.all, param);\n    }\n}\n\nclass PageCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapPageCaller(this.entity, this.entity.queries.page, param);\n    }\n}\n\nclass QueryCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapQueryCaller(this.entity, this.entity.queries.query, param);\n    }\n}\n\nclass MapAddCaller extends ActionSubmitCaller {\n    private map: Map;\n    constructor(map:Map, action:Action, params:any) {\n        super(action, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/add`}\n    get headers(): {[header:string]: string} {return undefined;}\n}\n\nclass MapDelCaller extends ActionSubmitCaller {\n    private map: Map;\n    constructor(map:Map, action:Action, params:any) {\n        super(action, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/del`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapAllCaller extends QueryPageCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/all`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapPageCaller extends QueryPageCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/page`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapQueryCaller extends QueryQueryCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/query`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n","import {Query} from './query';\n\nexport class Pending extends Query {\n    get typeName(): string { return 'pending';}\n    protected queryApiName = 'pending';\n}\n","import * as React from 'react';\nimport { IValuesView, IValuesViewRenderOptions } from '../../components';\nimport { Tag, TagValue } from './tag';\n\nconst radioStyle:React.CSSProperties = {height: 'auto'};\n\nexport class TagView implements IValuesView {\n\tprivate tag: Tag;\n\tconstructor(tag: Tag) {\n\t\tthis.tag = tag;\n\t}\n\trender(values: number|string):JSX.Element {\n\t\tlet names:string[];\n\t\tif (typeof values === 'number') {\n\t\t\tnames = [this.tag.nameFromId(values)];\n\t\t}\n\t\telse {\n\t\t\tnames = this.tag.namesFromIds(values);\n\t\t}\n\t\treturn <div className=\"d-flex flex-wrap \">{names.map((name, index)=>{\n\t\t\treturn <div key={index} className=\"mx-2 border border-muted rounded px-3 bg-light\">{name}</div>\n\t\t})}</div>;\n\t}\n\trenderRadios(value: number, options: IValuesViewRenderOptions): JSX.Element {\n        let content = this.tag.values.map((item,index) => {\n\t\t\treturn <div className=\"col\" key={index}>{this.renderRadio(item, value, options)}</div>;\n        });\n\t\treturn this.renderView(options, content);\n\t}\n\trenderChecks(values: string, options: IValuesViewRenderOptions): JSX.Element {\n\t\tlet arr = values===undefined? undefined : values.split('|').map(v => Number(v));\n\t\tlet content = this.tag.values.map((item,index) => {\n\t\t\tlet checked: boolean = arr===undefined? undefined : arr.indexOf(item.id)>=0;\n\t\t\treturn <div className=\"col\" key={index}>{this.renderCheck(item, checked, options)}</div>\n\t\t});\n\t\treturn this.renderView(options, content);\n\t}\n\tprivate renderView(options: IValuesViewRenderOptions, content:any) {\n\t\tlet {className, wrapClassName} = options;\n\t\twrapClassName = wrapClassName?\n\t\t\t'row ' + wrapClassName\n\t\t\t:\n\t\t\t'row row-cols-2 row-cols-sm-3 row-cols-md-4';\n\t\treturn <div className={className} style={radioStyle}>\n\t\t\t<div className={wrapClassName}>\n                {content}\n\t\t\t</div>\n        </div>;\n\t}\n\tprivate renderRadio(item:TagValue, value: number, options: IValuesViewRenderOptions):JSX.Element {\n\t\tlet {id, name} = item;\n\t\tlet {inputs, inputName, onInputChange} = options;\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\n\t\treturn <label className=\"form-radio-inline\">\n\t\t\t<input ref={ref} type=\"radio\" name={inputName}\n\t\t\t\tvalue={id} defaultChecked={value===id}\n\t\t\t\tonChange={onInputChange} />\n\t\t\t{name}\n\t\t</label>;\n\t}\n\n\tprivate renderCheck(item:TagValue, checked: boolean, options: IValuesViewRenderOptions):JSX.Element {\n\t\tlet {id, name} = item;\n\t\tlet {inputs, onInputChange} = options;\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\n\t\treturn <label className=\"form-radio-inline\">\n\t\t\t<input ref={ref} type=\"checkbox\"\n\t\t\t\tvalue={id} defaultChecked={checked}\n\t\t\t\tonChange={onInputChange} />\n\t\t\t{name}\n\t\t</label>;\n\t}\n}\n","import { Entity } from \"../entity\";\nimport { TagView } from \"./tagView\";\n\nexport interface TagValue {\n\tid: number;\n\tname: string;\n\text: string;\n}\n\nexport class Tag extends Entity {\n    get typeName(): string { return 'tag';}\n\tvalues: TagValue[];\n\tprivate coll: {[id:number]: TagValue} = {};\n\n\tprivate _view: TagView;\n\tget view(): TagView { \n\t\tif (this._view !== undefined) return this._view; \n\t\treturn this._view = new TagView(this);\n\t}\n\n\tnameFromId(id:number) {\n\t\tlet c = this.coll[id]; \n\t\treturn c===undefined? undefined : c.name;\n\t}\n\n\tnamesFromIds(ids:string):string[] {\n\t\tlet ret:string[] = [];\n\t\tfor (let id of ids.split('|')) {\n\t\t\tlet c = this.coll[Number(id)];\n\t\t\tlet name = c===undefined? undefined : c.name;\n\t\t\tif (name !== undefined) ret.push(name);\n\t\t}\n\t\treturn ret;\n\t}\n\n\tasync loadValues():Promise<TagValue[]> {\n\t\tif (this.values !== undefined) return this.values;\n\t\tthis.values = [];\n\t\tlet ret = await this.uqApi.get('tag/values/' + this.name);\n\t\tif (ret === undefined) return;\n\t\tlet lines = (ret as string).split('\\n');\n\t\tfor (let line of lines) {\n\t\t\tif (line.length === 0) continue;\n\t\t\tlet parts = line.split('\\t');\n\t\t\tlet id = Number(parts[0]);\n\t\t\tlet val = {\n\t\t\t\tid: id,\n\t\t\t\tname: parts[1],\n\t\t\t\text: parts[2],\n\t\t\t};\n\t\t\tthis.values.push(val);\n\t\t\tthis.coll[id] = val;\n\t\t}\n\t\treturn this.values;\n\t}\n}\n","export * from './page';\nexport * from './tabs';\nexport * from './scrollView';\n","export * from './schema';\nexport * from './uiSchema';\nexport * from './toUiSelectItems';\nexport * from './IValuesView';","\nexport const mobileRegex = /^[0-9]*$/;\nexport const emailRegex = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\n// /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/\n\nexport const EmailFieldRule = (value:any): string|string[] => {\n    if (emailRegex.test(value as string) === false) return '电子邮件格式错误';\n}\n\nexport const MobileFieldRule = (value:any): string|string[] => {\n    if (emailRegex.test(value as string) === false) return '手机格式错误';\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport interface DropdownAction {\n    icon?: string;\n    caption?: string;\n\taction?: () => void;\n\ticonClass?: string;\n\tcaptionClass?: string;\n}\n\nexport interface DropdownActionsProps {\n    icon?: string;\n    actions: DropdownAction[];\n    isRight?: boolean;\n\tclassName?: string;\n\titemIconClass?: string;\n\titemCaptionClass?: string;\n}\n\nexport interface DropdownActionsState {\n    dropdownOpen: boolean;\n}\n\nexport class DropdownActions extends React.Component<DropdownActionsProps, DropdownActionsState> {\n    private menu: HTMLDivElement;\n    private button: HTMLElement;\n    constructor(props:DropdownActionsProps) {\n        super(props);\n        this.state = {\n            dropdownOpen: false\n        };\n    }\n\n    componentDidMount() {\n        document.addEventListener('click', this.handleDocumentClick);\n        document.addEventListener('touchstart', this.handleDocumentClick);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('click', this.handleDocumentClick);\n        document.removeEventListener('touchstart', this.handleDocumentClick);\n    }\n\n    private handleDocumentClick = (evt:any) => {\n        if (this.state.dropdownOpen === false) return;\n        if (this.button && this.button.contains(evt.target)) return;\n        if (!this.menu) return;\n        //if (!this.menu.contains(evt.target)) \n        this.toggle();\n    }\n\n    private toggle = () => {\n        this.setState({\n            dropdownOpen: !this.state.dropdownOpen\n        });\n    }\n\n    render() {\n        let {icon, actions, isRight, className, itemIconClass, itemCaptionClass} = this.props;\n        if (isRight === undefined) isRight = true;\n        let hasIcon = actions.some(v => v.icon!==undefined);\n        let {dropdownOpen} = this.state;\n\t\t//isOpen={this.state.dropdownOpen} toggle={this.toggle}\n\t\tlet cn = className || 'cursor-pointer dropdown-toggle btn btn-sm';\n\t\t//if (className) cn += className;\n        return <div className={'dropdown'}>\n\t\t\t<button ref={v=>this.button=v} \n\t\t\t\tclassName={cn}\n                data-toggle=\"dropdown\"\n                aria-expanded={dropdownOpen}\n                onClick={this.toggle}>\n                <i className={classNames('fa fa-fw ', 'fa-'+(icon||'ellipsis-v'))} />\n            </button>\n            <div ref={v => this.menu=v} className={classNames({\"dropdown-menu\":true, \"dropdown-menu-right\":isRight, \"show\":dropdownOpen})}>\n                {\n                    actions.map((v,index) => {\n\t\t\t\t\t\tif (!v) {\n                            return <div className=\"dropdown-divider\" key={index}/>;\n\t\t\t\t\t\t}\n                        let {icon, caption, action, iconClass, captionClass} = v;\n                        if (icon === undefined && caption === undefined) \n                            return <div className=\"dropdown-divider\" />;\n                        let i:any;\n                        if (hasIcon === true) {\n                            if (icon !== undefined) icon = 'fa-' + icon;\n\t\t\t\t\t\t\ti = <i className={classNames('mr-2', 'fa', icon, 'fa-fw', iconClass || itemIconClass)}\n\t\t\t\t\t\t\t\taria-hidden={true}></i>;\n                        }\n                        if (action === undefined) \n                            return <h6 className=\"dropdown-header\">{i} {caption}</h6>;\n                        let onMenuItemClick = (evt:React.MouseEvent<HTMLAnchorElement>)=>{\n                            evt.preventDefault();\n                            action();\n                        }\n                        let onTouchStart = (evt: React.TouchEvent<HTMLAnchorElement>) => {\n                            action();\n                        }\n                            // eslint-disable-next-line\n                        return <a className=\"dropdown-item\" key={index} href=\"#/\" \n                            onClick={onMenuItemClick} onTouchStart={onTouchStart}\n                            >{i} <span className={captionClass || itemCaptionClass}>{caption}</span></a>\n                    })\n                }\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport { setRes } from '../../components';\n\nexport interface EasyDateProps {\n    date: Date | number;\n}\n\n//type YMD = (year:number, month:number, date:number) => string;\n//type MD = (month:number, date:number) => string;\n\nconst timeRes:{[prop:string]:any} = {\n\tmd: (month:number, date:number) => `${month}-${date}`,\n\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\n\tyesterday: 'Yday',\n\ttoday: 'Today',\n\ttomorrow: 'Tmw',\n\t$zh: {\n\t\tmd: (month:number, date:number) => `${month}月${date}日`,\n\t\tymd: (year:number, month:number, date:number) => `${year}年${month}月${date}日`,\n\t\tyesterday: '昨天',\n\t\ttoday: '今天',\n\t\ttomorrow: '明天',\n\t},\n\t$en: {\n\t\tmd: (month:number, date:number) => `${month}-${date}`,\n\t\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\n\t\tyesterday: 'Yday',\n\t\ttoday: 'Today',\n\t\ttomorrow: 'Tmw',\n\t}\n}\n\nsetRes(timeRes, timeRes);\n\nfunction tt(str:string):any {\n\treturn timeRes[str];\n}\n\nfunction renderDate(vDate:Date|number, withTime:boolean, always:boolean = false) {\n    if (!vDate) return null;\n    let date: Date;\n    switch (typeof vDate) {\n        default: date = vDate as Date; break;\n        case 'string': date = new Date(vDate); break;\n        case 'number': date = new Date((vDate as number)*1000); break;\n    }\n\n    let now = new Date();\n    let tick:number, nDate:number, _date:number, month:number, year:number, nowYear:number;\n    let d = date;\n    tick = now.getTime() - d.getTime();\n    let hour=d.getHours(), minute=d.getMinutes();\n    nDate=now.getDate();\n    _date=d.getDate();\n    month=d.getMonth()+1;\n    year=d.getFullYear();\n\tnowYear = now.getFullYear();\n\n\tlet appendTime:boolean = false;\n\tlet dPart:string = (function() {\n\t\tif (tick < -24*3600*1000) {\n\t\t\tif (year === nowYear) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt('md')(month, _date);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt('ymd')(year, month, _date);\n\t\t\t}\n\t\t}\n\t\tif (tick < 24*3600*1000) {\n\t\t\tif (_date!==nDate) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt(tick < 0? 'tomorrow' : 'yesterday');\n\t\t\t}\n\t\t\tif (withTime===true) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn tt('today');\n\t\t}\n\t\tif (year === nowYear) {\n\t\t\treturn tt('md')(month, _date);\n\t\t}\n\t\treturn tt('ymd')(year, month, _date);\n\t})();\n\n\tlet hm = hour + ((minute<10?':0':':') + minute);\n\n\t/*\n    if (tick < -24*3600*1000) {\n        if (year === nowYear)\n            return tt('md')(month, _date) + ' ' + hm;\n        else\n            return tt('ymd')(year, month, _date) + ' ' + hm;\n    }\n    if (always === true || tick < 24*3600*1000) {\n        return _date!==nDate? \n            tt(tick < 0? 'tomorrow' : 'yesterday') + ' ' + hm \n            : withTime===true? hm : tt('today');\n    }\n    if (year === nowYear) {\n        return tt('md')(month, _date);\n    }\n\treturn tt('ymd')(year, month, _date);\n\t*/\n\tif (appendTime === true || always === true) {\n\t\treturn dPart + ' ' + hm;\n\t}\n\treturn dPart;\n}\n\n\nexport class EasyDate extends React.Component<EasyDateProps> {\n    render() {\n        return renderDate(this.props.date, false);\n    }\n}\n\ninterface EasyTimeProps extends EasyDateProps {\n\talways?: boolean;\n}\nexport class EasyTime extends React.Component<EasyTimeProps> {\n    render() {\n\t\tlet {date, always} = this.props;\n        return renderDate(date, true, always);\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Image } from '.';\n\nexport interface MediaProps {\n    icon: string;\n    main: string|JSX.Element;\n    discription?: string | JSX.Element;\n    px?: number;\n    py?: number;\n}\n\nexport class Media extends React.Component<MediaProps> {\n    render() {\n        let {icon, main, discription, px, py} = this.props;\n        let disp:any;\n        if (typeof discription === 'string')\n            disp = <div>{discription}</div>;\n        else\n            disp = discription;\n        let cn = classNames(\n            'media', \n            px===undefined? 'px-0':'px-'+px, \n            py===undefined? 'py-2':'py-'+py);\n        return <div className={cn}>\n            <Image className=\"mr-3 w-4c h-4c\" src={icon} />\n            <div className=\"media-body\">\n                <h5 className=\"mt-0\">{main}</h5>\n                {disp}\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observable } from 'mobx';\n\nexport interface SearchBoxProps {\n    className?: string;\n    label?: string;\n    initKey?: string;\n    placeholder?: string;\n    buttonText?: string;\n    maxLength?: number;\n    size?: 'sm' | 'md' | 'lg';\n    inputClassName?: string;\n    onSearch: (key:string)=>Promise<void>;\n    onFocus?: ()=>void;\n    allowEmptySearch?: boolean;\n}\n\n/*\nexport interface SearchBoxState {\n    disabled: boolean;\n}*/\n\nexport class SearchBox extends React.Component<SearchBoxProps> { //}, SearchBoxState> {\n    private input: HTMLInputElement;\n    private key: string = null;\n    @observable private disabled: boolean;\n\n    private onChange = (evt: React.ChangeEvent<any>) => {\n        this.key = evt.target.value;\n        if (this.key !== undefined) {\n            this.key = this.key.trim();\n            if (this.key === '') this.key = undefined;\n        }\n        if (this.props.allowEmptySearch !== true) {\n            this.disabled = !this.key;\n        }\n    }\n    private onSubmit = async (evt: React.FormEvent<any>) => {\n        evt.preventDefault();\n        if (this.key === null) this.key = this.props.initKey || '';\n        if (this.props.allowEmptySearch !== true) {\n            if (!this.key) return;\n            if (this.input) this.input.disabled = true;\n        }\n        await this.props.onSearch(this.key);\n        if (this.input) this.input.disabled = false;\n    }\n    clear() {\n        if (this.input) this.input.value = '';\n    }\n    render() {\n        let {className, inputClassName, onFocus,\n            label, placeholder, buttonText, maxLength, size} = this.props;\n        let inputSize:string;\n        switch (size) {\n            default:\n            case 'sm': inputSize = 'input-group-sm'; break;\n            case 'md': inputSize = 'input-group-md'; break;\n            case 'lg': inputSize = 'input-group-lg'; break;\n        }\n        return <form className={className} onSubmit={this.onSubmit} >\n            <div className={classNames(\"input-group\", inputSize)}>\n                {label && <div className=\"input-group-addon align-self-center mr-2\">{label}</div>}\n                <input ref={v=>this.input=v} onChange={this.onChange}\n                    type=\"text\"\n                    name=\"key\"\n                    onFocus={onFocus}\n                    className={classNames('form-control', inputClassName || 'border-primary')}\n                    placeholder={placeholder}\n                    defaultValue={this.props.initKey}\n                    maxLength={maxLength} />\n                <div className=\"input-group-append\">\n                    <button className=\"btn btn-primary\"\n                        type=\"submit\"\n                        disabled={this.disabled}>\n                        <i className='fa fa-search' />\n                        <i className=\"fa\"/>\n                        {buttonText}\n                    </button>\n                </div>\n            </div>\n        </form>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { nav } from './nav';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { userApi } from '../net';\nimport { User } from '../tool';\n\nexport type UserLoader = (userId:number)=>Promise<any>;\n\nexport class UserCache<T> {\n\tprivate loader: UserLoader;\n\tprivate onLoaded: (user:User) => void;\n\tprivate map = observable(new Map<number, T|number>());\n\n\tconstructor(loader: UserLoader) {\n\t\tif (loader === undefined) loader = (userId:number)=>userApi.user(userId);\n\t\tthis.loader = loader;\n\t}\n\n\tuse(id:number|any, onLoaded?:(user:User)=>void) {\t\t\n\t\tif (!id) return;\n\t\tif (typeof id === 'object') id = id.id;\n\t\tif (!id) return;\n\t\tthis.onLoaded = onLoaded;\n\t\tid = Number(id);\n\t\tlet ret = this.map.get(id);\n\t\tif (ret === undefined) {\n\t\t\tthis.map.set(id, id);\n\t\t}\n\t}\n\n\tgetValue(id:number|any):any {\n\t\tif (!id) return;\n\t\tswitch (typeof(id)) {\n\t\t\tcase 'object': \n\t\t\t\tid = id.id; \n\t\t\t\tif (!id) return;\n\t\t\t\tbreak;\n\t\t}\n\t\tlet ret = this.map.get(id);\n\t\tif (!ret) return;\n\t\tswitch (typeof(ret)) {\n\t\tdefault:\n\t\t\treturn ret;\n\t\tcase 'number':\n\t\t\tif (ret < 0) return id;\n\t\t\tthis.map.set(id, -id);\n\t\t\tthis.loader(id).then(v => {\n\t\t\t\tif (!v) v = null;\n\t\t\t\tthis.map.set(id, v);\n\t\t\t\tif (this.onLoaded) this.onLoaded(v);\n\t\t\t}).catch(reason => {\n\t\t\t\tconsole.error(reason);\n\t\t\t});\n\t\t\treturn id;\n\t\t}\n\t}\n}\n\nconst userCache = new UserCache(undefined);\n\nexport interface UserIconProps {\n    id: number;\n    className?: string;\n    style?: React.CSSProperties;\n    altImage?: string;\n    noneImage?: any;\n}\n\nexport const UserIcon = observer((props: UserIconProps):JSX.Element => {\n    let {className, style, id, altImage, noneImage} = props;\n    let user = userCache.getValue(id);\n    switch (typeof user) {\n\tcase 'undefined':\n\tcase 'number':\n        return <div className={classNames(className, 'image-none')} style={style}>\n            {noneImage || <i className=\"fa fa-file-o\" />}\n        </div>;\n    }\n    let {icon} = user;\n    if (!icon) {\n        return <div className={classNames(className, 'image-none')} style={style}>\n            <i className=\"fa fa-file-o\" />\n        </div>;\n    }\n    if (icon.startsWith(':') === true) {\n        icon = nav.resUrl + icon.substr(1);\n    }\n    return <img src={icon} className={className} alt=\"img\"\n        style={style}\n        onError={evt=>{\n            if (altImage) evt.currentTarget.src=altImage;\n            else evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\n        }} />;\n});\n\nexport interface UserViewProps {\n\tid?: number;\n\tuser?: number|User;\n\trender: (user:User) => JSX.Element;\n\tonLoaded?: (user:User) => void\n}\n\nexport const UserView = observer((props: UserViewProps):JSX.Element => {\n\tlet {id:idProp, user, render, onLoaded} = props;\n\tif (user === null) return <>null</>;\n\tswitch (typeof user) {\n\t\tcase 'undefined': \n\t\t\tuser = userCache.getValue(idProp);\n\t\t\tbreak;\n\t\tcase 'object': \n\t\t\tlet {/*obj, */id} = user as any;\n\t\t\t//if (typeof obj !== 'object') {\n\t\t\t\tuseUser(id, onLoaded);\n\t\t\t\tuser = userCache.getValue(id);\n\t\t\t//}\n\t\t\tbreak;\n\t\tcase 'number':\n\t\t\tuseUser(user as number, onLoaded);\n\t\t\tuser = userCache.getValue(user as number);\n\t\t\tbreak;\n\t\tcase 'string':\n\t\t\tuseUser(Number(user), onLoaded);\n\t\t\tuser = userCache.getValue(Number(user));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tuser = undefined;\n\t\t\tbreak;\n\t}\n    switch (typeof user) {\n\t\tcase 'undefined':\n\t\tcase 'number':\n        \treturn <>{user}</>;\n    }\n    return render(user);\n});\n\nexport function useUser(id: number|object, onLoaded?: (user:User)=>void) {\n\tif (!id) return;\n\tif (typeof(id) === 'object') {\n\t\tid = (id as any).id;\n\t}\n\tuserCache.use(id, onLoaded);\n}\n","import { UqMan, TuidModify } from '../uqMan';\nimport { Tuid } from \"./tuid\";\nimport { env } from '../../tool';\n\ninterface Modify {\n    id: number;\n    entity: string;\n    key: string;\n}\n\nexport class TuidsCache {\n    private readonly uq: UqMan;\n    private modifyMax: TuidModify;\n    private cacheTimer: any;\n    constructor(uq: UqMan) {\n        this.uq = uq;\n    }\n\n    cacheTuids(defer:number) {\n        this.clearCacheTimer();\n        this.cacheTimer = env.setTimeout('TuidsCache.cacheTuids', this.loadIds, defer);\n    }\n    private clearCacheTimer() {\n        if (this.cacheTimer === undefined) return;\n        env.clearTimeout(this.cacheTimer);\n        this.cacheTimer = undefined;\n    }\n    private loadIds = () => {\n        this.clearCacheTimer();\n        let {tuids} = this.uq;\n        for (let i in tuids) {\n            let tuid = tuids[i];\n            tuid.cacheIds();\n        }\n    }\n    \n    pullModify(modifyMax:number) {\n        if (modifyMax === undefined) return;\n        let now = Math.floor(Date.now() / 1000);\n        if (this.modifyMax === undefined) {\n            this.modifyMax = this.uq.localModifyMax.get();\n            if (this.modifyMax === undefined) {\n                this.modifyMax = {\n                    max: modifyMax,\n                    seconds: now,\n                };\n                this.uq.localModifyMax.set(this.modifyMax);\n            }\n        }\n        let {max, seconds} = this.modifyMax;\n        let lockGap = 3600;\n        if (now - seconds < lockGap) return;\n        if (modifyMax <= max) return;\n        let tuidCached:string[] = [];\n        let {tuids} = this.uq;\n        for (let i in tuids) {\n            //if (tuids[i].cached === true) \n            tuidCached.push(i);\n        }\n        if (tuidCached.length === 0) return;\n        this.modifyMax.seconds = now;\n        this.innerPullModify(tuidCached.join('\\t'));\n    }\n\n    private async innerPullModify(tuidLists:string):Promise<void> {\n        let {uqApi, tuids} = this.uq;\n        let {max} = this.modifyMax;\n        let ret:{queue:Modify[], queueMax:number} = await uqApi.queueModify(max, 30, tuidLists);\n        let group:{[entity:string]: {tuid:Tuid; ids: string[]}} = {};\n        let modifyMax:number = 0;\n        for (let modify of ret.queue) {\n\t\t\tlet {id, entity, key} = modify;\n\t\t\tif (!key) continue;\n            let tuid = tuids[entity];\n            if (tuid === undefined) continue;\n            let item = group[entity];\n            if (item === undefined) {\n                item = group[entity] = {tuid: tuid, ids:[]};\n            }\n            item.ids.push(key);\n            if (id > modifyMax) modifyMax = id;\n        }\n        for (let i in group) {\n            let {tuid, ids} = group[i];\n            await tuid.modifyIds(ids);\n        }\n        let now = Math.floor(Date.now() / 1000);\n        this.modifyMax = {\n            max: modifyMax,\n            seconds: now,\n        }\n        this.uq.localModifyMax.set(this.modifyMax);\n    }\n}\n","import { LocalMap, LocalCache, env } from '../tool';\nimport { UqData, UqAppData, loadAppUqs } from '../net';\nimport { UqMan } from './uqMan';\nimport { TuidImport, TuidInner } from './tuid';\nimport { nav } from '../components';\n\nexport interface TVs {\n    [uqName:string]: {\n        [tuidName: string]: (values: any) => JSX.Element;\n    }\n}\n\nexport class UQsMan {\n\tstatic _uqs: any;\n\tstatic value: UQsMan;\n\tstatic errors: string[];\n\n\tstatic async load(tonvaAppName:string, version:string, tvs:TVs) {\n\t\tlet uqsMan = UQsMan.value = new UQsMan(tonvaAppName, tvs);\n        let {appOwner, appName} = uqsMan;\n        let {localData} = uqsMan;\n        let uqAppData:UqAppData = localData.get();\n        if (!uqAppData || uqAppData.version !== version) {\n\t\t\tuqAppData = await loadAppUqs(appOwner, appName);\n\t\t\tif (!uqAppData.id) {\n\t\t\t\treturn [\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\n\t\t\t\t];\n\t\t\t}\n            uqAppData.version = version;\n            localData.set(uqAppData);\n            // \n            for (let uq of uqAppData.uqs) uq.newVersion = true;\n        }\n        let {id, uqs} = uqAppData;\n        uqsMan.id = id;\n        await uqsMan.init(uqs);\n        let retErrors = await uqsMan.load();\n        if (retErrors.length === 0) {\n            retErrors.push(...uqsMan.setTuidImportsLocal());\n            if (retErrors.length === 0) {\n                UQsMan._uqs = uqsMan.buildUQs();\n                return;\n            }\n        }\n        UQsMan.errors = retErrors;\n\t}\n\n    private collection: {[uqName: string]: UqMan};\n    private readonly tvs: TVs;\n\n    readonly name: string;\n    readonly appOwner: string;\n    readonly appName: string;\n    readonly localMap: LocalMap;\n    readonly localData: LocalCache;\n    id: number;\n\n    private constructor(tonvaAppName:string, tvs:TVs) {\n        this.tvs = tvs || {};\n        this.buildTVs();\n        this.collection = {};\n        let parts = tonvaAppName.split('/');\n        if (parts.length !== 2) {\n            throw new Error('tonvaApp name must be / separated, owner/app');\n        }\n        this.appOwner = parts[0];\n        this.appName = parts[1];\n        this.localMap = env.localDb.map(tonvaAppName);\n        this.localData = this.localMap.child('uqData');\n    }\n\n    // to be removed in the future\n    addUq(uq: UqMan) {\n        this.collection[uq.name] = uq;\n    }\n\n    private buildTVs() {\n        for (let i in this.tvs) {\n            let uqTVs = this.tvs[i];\n            if (uqTVs === undefined) continue;\n            let l = i.toLowerCase();\n            if (l === i) continue;\n            this.tvs[l] = uqTVs;\n            for (let j in uqTVs) {\n                let en = uqTVs[j];\n                if (en === undefined) continue;\n                let lj = j.toLowerCase();\n                if (lj === j) continue;\n                uqTVs[lj] = en;\n            }\n        }\n    }\n\n    async init(uqsData:UqData[]):Promise<void> {\n        let promiseInits: PromiseLike<void>[] = [];\n        for (let uqData of uqsData) {\n            let {uqOwner, uqName} = uqData;\n            let uqFullName = uqOwner + '/' + uqName;\n            //let uqUI = this.ui.uqs[uqFullName] as UqUI || {};\n            //let cUq = this.newCUq(uqData, uqUI);\n            //this.cUqCollection[uqFullName] = cUq;\n            //this.uqs.addUq(cUq.uq);\n            let uq = new UqMan(this, uqData, undefined, this.tvs[uqFullName] || this.tvs[uqName]);\n            this.collection[uqFullName] = uq;\n            let lower = uqFullName.toLowerCase();\n            if (lower !== uqFullName) {\n                this.collection[lower] = uq;\n            }\n            promiseInits.push(uq.init());\n        }\n        await Promise.all(promiseInits);\n    }\n\n    async load(): Promise<string[]> {\n        let retErrors:string[] = [];\n        let promises: PromiseLike<string>[] = [];\n        for (let i in this.collection) {\n            let uq = this.collection[i];\n            promises.push(uq.loadEntities());\n\t\t}\t\t\n        let results = await Promise.all(promises);\n        for (let result of results)\n        {\n            let retError = result; // await cUq.loadSchema();\n            if (retError !== undefined) {\n                retErrors.push(retError);\n                continue;\n            }\n\t\t}\n        return retErrors;\n    }\n\n    buildUQs(): any {\n        let that = this;\n        let uqs:any = {};\n        for (let i in this.collection) {\n            let uqMan = this.collection[i];\n            //let n = uqMan.name;\n            let uqName = uqMan.uqName;\n            let l = uqName.toLowerCase();\n            let entities = uqMan.entities;\n            let keys = Object.keys(entities);\n            for (let key of keys) {\n                let entity = entities[key];\n                let {name} = entity;\n                //if (name !== sName) \n                //entities[sName] = entity;\n                entities[name.toLowerCase()] = entity;\n            }\n            //uqs[i] = entities;\n            //uqs[uqName] = entities;\n            //if (l !== uqName) \n            uqs[l] = new Proxy(entities, {\n                get: function(target, key, receiver) {\n                    let lk = (key as string).toLowerCase();\n                    let ret = target[lk];\n                    if (ret !== undefined) return ret;\n\t\t\t\t\tdebugger;\n\t\t\t\t\tlet err = `entity ${uqName}.${String(key)} not defined`;\n                    console.error(err);\n                    that.showReload('UQ错误：' + err);\n                    return undefined;\n                }\n            });\n        }\n        //let uqs = this.collection;\n        return new Proxy(uqs, {\n            get: function (target, key, receiver) {\n                let lk = (key as string).toLowerCase();\n                let ret = target[lk];\n                if (ret !== undefined) return ret;\n                /*\n                for (let i in uqs) {\n                    if (i.toLowerCase() === lk) {\n                        return uqs[i];\n                    }\n                }*/\n                debugger;\n                console.error('error in uqs');\n                that.showReload(`代码错误：新增 uq ${String(key)}`);\n                return undefined;\n            },\n        });\n    }\n\n    private showReload(msg: string) {\n        this.localMap.removeAll();\n        nav.showReloadPage(msg);\n    }\n\n    setTuidImportsLocal():string[] {\n        let ret:string[] = [];\n        for (let i in this.collection) {\n            let uq = this.collection[i];\n            for (let tuid of uq.tuidArr) {\n                if (tuid.isImport === true) {\n                    let error = this.setInner(tuid as TuidImport);\n                    if (error) ret.push(error);\n                }\n            }\n        }\n        return ret;\n    }\n\n    private setInner(tuidImport: TuidImport):string {\n        let {from} = tuidImport;\n        let fromName = from.owner + '/' + from.uq;\n        let uq = this.collection[fromName];\n        if (uq === undefined) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} is not loaded`;\n        }\n        let iName = tuidImport.name\n        let tuid = uq.tuid(iName);\n        if (tuid === undefined) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} has no Tuid ${iName}`;\n        }\n        if (tuid.isImport === true) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} Tuid ${iName} is import`;\n        }\n        tuidImport.setFrom(tuid as TuidInner);\n    }\n}\n","import _ from 'lodash';\nimport { Context } from '../context';\nimport { FormRes } from '../../../res/formRes';\n\nexport abstract class Rule {\n    abstract check(defy:string[], value:any):void;\n}\n\nexport type ContextRule = (context:Context)=>{[target:string]:string[]|string} | string[] | string;\nexport type FieldRule = (value:any) => string[] | string;\n\nexport class RuleCustom extends Rule {\n    private func: FieldRule;\n    constructor(func: FieldRule) {\n        super();\n        this.func = func;\n    }\n    check(defy:string[], value:any) {\n        let ret = this.func(value);\n        if (ret === undefined) return;\n        switch (typeof ret) {\n            case 'undefined': return;\n            case 'string': defy.push(ret as string); return;\n            default: defy.push(...ret); return;\n        }        \n    }\n}\n\nexport abstract class RulePredefined extends Rule {\n    protected res: FormRes;\n    constructor(res: FormRes) {\n        super();\n        this.res = res;\n    }\n}\n\nexport class RuleRequired extends RulePredefined {\n    check(defy:string[], value:any) {\n        switch (typeof value) {\n            default:\n            case 'boolean': return;\n            case 'object':\n                if (value !== null) return;\n                break;\n            case 'string':\n                if ((value as string).trim().length > 0) return;\n                break;\n            case 'number':\n                if (isNaN(value as number) === false) return;\n                break;\n            case 'undefined':\n                break;\n        }\n        defy.push(this.res.required);\n    }\n}\n\nexport class RuleNum extends RulePredefined {\n    private minMsg: _.TemplateExecutor;\n    private maxMsg: _.TemplateExecutor;\n    protected min: number;\n    protected max: number\n    constructor(res: FormRes, min?: number, max?: number) {\n        super(res);\n        this.minMsg = _.template(res.min);\n        this.maxMsg = _.template(res.max);\n        this.min = min;\n        this.max = max;\n    }\n    check(defy:string[], value:any) {\n        if (value === undefined || value === null) return;\n        let n = Number(value);\n        if (isNaN(n) === true) {\n            defy.push(this.res.number);\n        }\n        else {\n            this.checkMore(defy, n);\n        }\n    }\n\n    protected checkMore(defy:string[], value: number) {\n        if (this.min !== undefined && Number(value) < this.min) {\n            defy.push(this.minMsg({min:this.min}));\n        }\n        if (this.max !== undefined && Number(value) > this.max) {\n            defy.push(this.maxMsg({max:this.max}));\n        }\n    }\n}\n\nexport class RuleInt extends RuleNum {\n    protected checkMore(defy:string[], n: number) {\n        super.checkMore(defy, n);\n        if (Number.isInteger(n) === false) {\n            defy.push(this.res.integer);\n        }\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { UiItem, ChangingHandler, ChangedHandler } from '../../schema';\nimport { FieldProps } from '../field';\nimport { Context } from '../context';\nimport { ItemSchema } from '../../schema';\nimport { Rule, RuleRequired, RuleCustom, FieldRule } from '../rules';\nimport { computed, observable } from 'mobx';\nimport { observer } from 'mobx-react';\n\nexport abstract class Widget {\n    name: string;\n    protected context: Context;\n    protected fieldProps:FieldProps;\n    protected children: React.ReactNode;\n    protected _itemSchema: ItemSchema;\n    protected _ui: UiItem;\n    protected defaultValue: any;\n    protected value: any;\n    protected rules: Rule[];\n    @observable errors: string[] = [];\n    @observable protected contextErrors: string[] = [];\n    @computed protected get hasError():boolean {return (this.errors.length + this.contextErrors.length)>0}\n    protected readOnly:boolean;\n    protected disabled:boolean;\n    @observable visible:boolean;\n\n    constructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\n        this.context = context;\n        let {name} = itemSchema;\n        this.name = name;\n        this._itemSchema = itemSchema;\n        this.fieldProps = fieldProps;\n        this.children = children;\n        this._ui = context.getUiItem(name);\n        if (this.ui === undefined) {\n            this.readOnly = false;\n            this.disabled = false;\n            this.visible = true;\n        }\n        else {\n            let {readOnly, disabled, visible} = this.ui;\n            this.readOnly = (readOnly === true);\n            this.disabled = (disabled === true);\n            this.visible = !(visible === false);            \n        }\n        this.value = this.defaultValue =  context.getValue(name); //defaultValue;\n        // this.init();\n    }\n\n    protected get itemSchema(): ItemSchema {return this._itemSchema};\n    protected get ui(): UiItem {return this._ui};\n\n    init() {\n        this.rules = [];\n        if (this.itemSchema.required === true) {\n            this.rules.push(new RuleRequired(this.context.form.res));\n        }\n        this.buildRules();\n        if (this.ui === undefined) return;\n        let {rules} = this.ui;\n        if (rules === undefined) return;\n        if (Array.isArray(rules) === false) {\n            this.rules.push(new RuleCustom(rules as FieldRule));\n            return;\n        }\n        for (let rule of rules as FieldRule[]) {\n            this.rules.push(new RuleCustom(rule));\n        }\n    }\n\n    protected buildRules() {\n    }\n\n    checkRules() {\n        let defy:string[] = [];\n        for (let r of this.rules) r.check(defy, this.value);\n        if (defy.length === 0) {\n            this.context.removeErrorWidget(this);\n        }\n        else {\n            this.context.addErrorWidget(this);\n            this.errors.push(...defy);\n        }\n    }\n\n    @computed get isOk() {\n        return this.errors.length ===0;\n    }\n\n    setError(err:string | string[]) {\n        if (err === undefined) return;\n        if (typeof err === 'string') this.errors.push(err);\n        else this.errors.push(...err);\n    }\n\n    setContextError(err:string | string[]) {\n        if (err === undefined) return;\n        if (typeof err === 'string') this.contextErrors.push(err);\n        else this.contextErrors.push(...err);\n    }\n\n    clearError() {\n        this.errors.splice(0);\n    }\n\n    clearContextError() {\n        this.contextErrors.splice(0);\n    }\n\n    protected parse(value:any):any {return value}\n\n    protected setElementValue(value:any) {}\n    protected setDataValue(value:any) {\n        if (this.isChanging === true) return;\n        this.context.initData[this.name] = this.value = this.parse(value);\n    }\n\n    setValue(value:any) {\n        if (this.isChanging === true) return;\n        //this.setDataValue(value);\n        //this.setElementValue(value);\n        this.changeValue(value, false);\n    }\n\n    getValue() {\n        return this.context.getValue(this.name);\n    }\n\n    getReadOnly():boolean {return this.readOnly}\n    getDisabled():boolean {return this.disabled}\n    getVisible():boolean {return this.visible}\n    setReadOnly(value:boolean) {this.readOnly = value}\n    setDisabled(value:boolean) {this.disabled = value}\n    setVisible(value:boolean) {this.visible = value}\n\n    private isChanging: boolean;\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n        this.changeValue(evt.target.value, true);\n    }\n\n    protected changeValue(newValue: any, fromElement: boolean) {\n        let prev = this.value;\n        let onChanging: ChangingHandler;\n        let onChanged: ChangedHandler;\n        if (this.ui !== undefined) {\n            onChanging = this.ui.onChanging;\n            onChanged = this.ui.onChanged;\n        }\n        let allowChange = true;\n        if (onChanging !== undefined) {\n            this.isChanging = true;\n            allowChange = onChanging(this.context, this.value, prev);\n            this.isChanging = false;\n        }\n        if (allowChange === true) {\n            this.setDataValue(newValue);\n            if (fromElement !== true) this.setElementValue(newValue);\n            if (onChanged !== undefined) {\n                this.isChanging = true;\n                onChanged(this.context, this.value, prev);\n                this.isChanging = false;\n            }\n        }\n    }\n\n    protected get className():string {\n        let fieldClass:string;\n        if (this.context.inNode === false) fieldClass = 'form-control';\n        return classNames(fieldClass, this.context.form.FieldClass, this.ui && this.ui.className);\n    }\n\n    protected abstract render():JSX.Element;\n\n    protected renderBody():JSX.Element {\n        let elDiscription;\n        if (this.hasError === false && this.ui) {\n            let {discription, discriptionClassName} = this.ui;\n            if (discriptionClassName === undefined) discriptionClassName = 'small text-muted';\n            elDiscription = <span className={discriptionClassName}>\n                {discription}\n            </span>;\n        }\n        return <>\n            {this.render()}\n            {elDiscription}\n        </>;\n    }\n\n    container = observer(():JSX.Element => {\n        if (this.visible === false) return null;\n        let {form, inNode} = this.context;\n        if (inNode === true) return this.render();\n        let label:any = this.label;\n        if (this.itemSchema.required === true && form.props.requiredFlag !== false) {\n            if (label !== null) label = <>{label}&nbsp;<span className=\"text-danger\">*</span></>;\n        }\n        return form.FieldContainer(label, this.renderBody());\n    })\n\n    protected get label():string {\n        let label:any;\n        if (this.ui === undefined) {\n            label = this.name;\n        }\n        else {\n            let uiLabel = this.ui.label;\n            if (uiLabel === null) label = null;\n            else label = uiLabel || this.name;\n        }\n        return label;\n    }\n\n    protected renderTemplet():JSX.Element | undefined {\n        if (this.children !== undefined) {\n            return <>{this.children}</>;\n        }\n        if (this.ui === undefined) return undefined;\n        let {Templet} = this.ui;\n        if (typeof Templet === 'function') return Templet(this.value);\n        return Templet;\n    }\n\n    protected renderErrors() {\n        let errorList:string[] = [...this.errors, ...this.contextErrors];\n        if (errorList.length === 0) return null;\n        let {inNode} = this.context;\n        let tag = inNode === true? 'span' : 'div';\n        return errorList.map(err => React.createElement(tag, \n            {\n                key: err, \n                className: 'text-danger d-inline-block my-2 ml-3'\n            },\n            <><i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}</>\n        ));\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTextItem, StringSchema } from '../../schema';\nimport { observable } from 'mobx';\n\nexport class TextWidget extends Widget {\n    protected inputType = 'text';\n    protected get ui(): UiTextItem {return this._ui as UiTextItem};\n    protected input: HTMLInputElement;\n    @observable protected hasFocus: boolean;\n\n    protected setElementValue(value:any) {\n        if (this.input === null) return;\n        this.input.value = value;\n    }\n    protected get placeholder() {return (this.ui && this.ui.placeholder) || this.name}\n    protected onKeyDown = async (evt:React.KeyboardEvent<HTMLInputElement>) => {\n        this.internalOnKeyDown(evt);\n        if (evt.keyCode !== 13) return;\n        let {onEnter} = this.context.form.props;\n        if (onEnter === undefined) return;\n\n        this.changeValue(evt.currentTarget.value, true);\n\n        //this.checkRules();\n        //this.context.checkContextRules();\n        this.input.blur();\n\n        let ret = await onEnter(this.name, this.context);\n        if (ret !== undefined) {\n            this.context.setError(this.name, ret);\n        }\n    }\n\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\n    }\n\n    protected onBlur = (evt: React.FocusEvent<any>) => {\n        this.onInputChange(evt);\n        this.checkRules();\n\t\tthis.context.checkContextRules();\n\t\tthis.hasFocus = false;\n    }\n    protected onFocus = (evt: React.FocusEvent<any>) => {\n        this.clearError();\n        this.context.removeErrorWidget(this);\n        this.context.clearErrors();\n\t\tthis.hasFocus = true;\n    }\n    protected onChange(evt: React.ChangeEvent<any>) {\n    }\n\n    setReadOnly(value:boolean) {\n        if (this.input === null) return;\n        this.input.readOnly = this.readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        if (this.input === null) return;\n        this.input.disabled = this.disabled = value;\n    }\n\n    render() {\n        let renderTemplet = this.renderTemplet();\n        if (renderTemplet !== undefined) return renderTemplet;\n        let cn:any = {\n            //'form-control': true,\n        };\n        if (this.hasError === true) {\n            cn['is-invalid'] = true;\n        }\n        else {\n            cn['required-item'] = this.itemSchema.required === true;\n        }\n        return <><input ref={input=>this.input = input}\n            className={classNames(this.className, cn)}\n            type={this.inputType}\n            defaultValue={this.value}\n            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\n            placeholder={this.placeholder}\n            readOnly={this.readOnly}\n            disabled={this.disabled}\n            onKeyDown = {this.onKeyDown}\n            onFocus = {this.onFocus}\n            onBlur={this.onBlur}\n            maxLength={(this.itemSchema as StringSchema).maxLength} />\n            {this.renderErrors()}\n        </>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTextAreaItem } from '../../schema';\nimport { StringSchema } from '../../schema';\n\nexport class TextAreaWidget extends Widget {\n    protected get itemSchema(): StringSchema {return this._itemSchema as StringSchema};\n    protected input: HTMLTextAreaElement;\n    protected get ui(): UiTextAreaItem {return this._ui as UiTextAreaItem};\n\n    protected setElementValue(value:any) {this.input.value = value}\n    protected onInputChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.setValue(evt.currentTarget.value);\n    }\n\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n\tprotected onBlur = (evt: React.FocusEvent<any>) => {\n        this.onInputChange(evt);\n        this.checkRules();\n        this.context.checkContextRules();\n    }\n    protected onFocus = (evt: React.FocusEvent<any>) => {\n        this.clearError();\n        this.context.removeErrorWidget(this);\n        this.context.clearErrors();\n    }\n\n    render() {\n        let renderTemplet = this.renderTemplet();\n        if (renderTemplet !== undefined) return renderTemplet;\n        let cn:any = {};\n        if (this.hasError === true) {\n            cn['is-invalid'] = true;\n        }\n        else {\n            cn['required-item'] = this.itemSchema.required === true;\n        }\n        return <>\n\t\t\t<textarea ref={(input) => this.input=input}\n\t\t\t\tonBlur={this.onBlur} \n\t\t\t\tonFocus={this.onFocus}\n                className={classNames(this.className, cn)}\n                rows={this.ui && this.ui.rows}\n                maxLength={this.itemSchema.maxLength}\n                defaultValue={this.defaultValue} onChange={this.onInputChange} />\n            {this.renderErrors()}\n        </>;\n    }\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\n\nexport class PasswordWidget extends TextWidget {\n    protected inputType = 'password';\n}\n\nexport class UrlWidget extends TextWidget {\n    protected inputType = 'url';\n}\n\nexport class EmailWidget extends TextWidget {\n    protected inputType = 'email';\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\nimport { RuleNum, RuleInt } from '../rules';\nimport { NumBaseSchema } from '../../schema';\n\nexport class NumberWidget extends TextWidget {\n    protected inputType = 'number';\n    protected get itemSchema(): NumBaseSchema {return this._itemSchema as NumBaseSchema};\n\n    protected buildRules() {\n        super.buildRules();\n        let res = this.context.form.res;\n        let {min, max} = this.itemSchema;\n        this.rules.push(\n            this.itemSchema.type === 'integer'?\n                new RuleNum(res, min, max) :\n                new RuleInt(res, min, max)\n        );\n        /*\n        if (this.itemSchema.type === 'integer') {\n            this.rules.push(new RuleInt);\n        }\n        let {min, max} = this.itemSchema;\n        if (min !== undefined) this.rules.push(new RuleMin(min));\n        if (max !== undefined) this.rules.push(new RuleMax(max));\n        */\n    }\n\n    protected parse(value:any):any {\n        if (value === undefined || value === null) return;\n        return Number(value);\n    }\n}\n","import * as React from 'react';\nimport { NumberWidget } from './numberWidget';\n\nexport class UpdownWidget extends NumberWidget {\n    protected inputType = 'number';\n\n    protected isValidKey(key:number):boolean {\n        return key===46 || key===8 || key===37 || key===39\n            || (key>=48 && key<=57)\n            || (key>=96 && key<=105)\n            || key===109 || key===189;\n    }\n    \n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\n        let key = evt.keyCode;\n        window.event.returnValue = this.isValidKey(key);\n    }\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\n\nexport class DateWidget extends TextWidget {\n    protected inputType = 'date';\n}\n\nexport class DateTimeWidget extends TextWidget {\n    protected inputType = 'datetime';\n}\n\nexport class TimeWidget extends TextWidget {\n    protected inputType = 'time';\n}\n\nexport class MonthWidget extends TextWidget {\n    protected inputType = 'month';\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiCheckItem } from '../../schema';\n\nexport class CheckBoxWidget extends Widget {\n    protected input: HTMLInputElement;\n    protected get ui(): UiCheckItem {return this._ui as UiCheckItem};\n    protected trueValue: any;\n    protected falseValue: any;\n\n    init() {\n        super.init();\n        if (this.ui !== undefined) {\n            let {trueValue, falseValue} = this.ui;\n            if (trueValue === undefined) this.trueValue = true;\n            else this.trueValue = trueValue;\n            if (falseValue === undefined) this.falseValue = false;\n            else this.falseValue = falseValue;\n        }\n        else {\n            this.trueValue = true;\n            this.falseValue = false;\n        }\n    }\n    protected setElementValue(value:any) {\n        this.input.checked = value === this.trueValue;\n    }\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        let v = evt.target.checked === true? this.trueValue : this.falseValue;\n        this.setDataValue(v);\n    }\n\n    protected onClick = () => {\n        this.context.clearErrors();\n    }\n\n    render() {\n        let cn = classNames(this.className, 'form-check-inline p-0');\n        let input = <input\n            ref={(input)=>this.input = input}\n            className={'align-self-center'}\n            type=\"checkbox\"\n            defaultChecked={this.defaultValue} \n            onChange={this.onInputChange}\n            onClick={this.onClick} />;\n        if (this.context.inNode === true) {\n            return <label className={cn}>\n                {input} {(this.ui&&this.ui.label) || this.name}\n            </label>\n        }\n        else {\n            return <div className={cn}>\n                <label className=\"w-100 h-100 mb-0 d-flex justify-content-center\">{input}</label>\n            </div>;\n        }\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observable } from 'mobx';\nimport { Widget } from './widget';\nimport { UiSelect } from '../../schema';\n\nexport class SelectWidget extends Widget {\n    protected select: HTMLSelectElement;\n    protected get ui(): UiSelect {return this._ui as UiSelect};\n    @observable protected readOnly: boolean;\n\n    protected setElementValue(value:any) {this.select.value = value}\n    protected onInputChange = (evt:React.ChangeEvent<HTMLSelectElement>) => {\n        this.setDataValue(evt.target.value);\n    }\n\n    setReadOnly(value:boolean) {this.select.disabled = this.readOnly = !value}\n    setDisabled(value:boolean) {this.select.disabled = this.disabled = value}\n\n    render() {\n        if (this.readOnly === true) {\n            let option = this.ui.list.find(v => v.value === this.value);\n            let title = (option === undefined)? '(???)' : option.title;\n            return <span className=\"form-control w-min-6c\">{title}</span>;\n        }\n        return <select\n            ref={(select)=>this.select = select}\n            className={classNames(this.className, 'form-control')}\n            defaultValue={this.defaultValue} \n            onChange={this.onInputChange}>\n            {this.ui.list.map((v,index) => {\n                let {title, value} = v;\n                let cn:string;\n                //if (value === undefined || value === null) cn = 'text-light small';\n                //else cn = 'text-danger';\n                return <option className={cn} key={index} value={value}>{title || value}</option>\n            })}\n        </select>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n//import { TextWidget } from './textWidget';\nimport { Widget } from './widget';\nimport { UiRadio } from '../../schema';\nimport { RowContext } from '../context';\n\n\nconst radioStyle:React.CSSProperties = {height: 'auto'};\n\nexport class RadioWidget extends Widget {\n    protected inputs: {[index:number]: HTMLInputElement} = {};\n    protected get ui(): UiRadio {return this._ui as UiRadio};\n\n    protected setElementValue(value:any) {\n        for (let i in this.inputs) {\n            let input = this.inputs[i];\n            input.checked = value === input.value;\n        }\n    }\n    setReadOnly(value:boolean) {\n        this.readOnly = value;\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        this.disabled = value;\n        for (let i in this.inputs) this.inputs[i].disabled = value\n    }\n\n    /*\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n        this.changeValue(evt.target.value, true);\n    }\n    */\n\n    render() {\n        let {defaultValue, list} = this.ui;\n        let {isRow} = this.context;\n        let rowKey:number;\n        if (isRow === true) {\n            rowKey = (this.context as RowContext).rowKey;\n        }\n        let cn = classNames(this.className, 'py-0');\n        return <span className={cn} style={radioStyle}>\n                {list.map((v,index) => {\n                    let {value, title} = v;\n                    let name = this.name;\n                    if (rowKey !== undefined) name += '-' + rowKey;\n                    return <label key={index} className=\"form-radio-inline\">\n                        <input ref={input=>this.inputs[index]=input} type=\"radio\" name={name}\n                            value={value} defaultChecked={(this.defaultValue || defaultValue)===value}\n                            onChange={this.onInputChange} />\n                        {title || value}\n                    </label>;\n                    //</span>\n                })}\n            </span>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { UiRange } from '../../schema';\nimport { Widget } from './widget';\n\nexport class RangeWidget extends Widget {\n    protected inputType = 'range';\n    protected input: HTMLInputElement;\n    protected get ui(): UiRange {return this._ui as UiRange};\n\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n    render() {\n        let {min, max, step} = this.ui;\n        return <><input ref={input=>this.input = input}\n            className={classNames(this.className, 'form-control', 'w-min-6c')}\n            type={this.inputType}\n            defaultValue={this.defaultValue} \n            onChange={this.onInputChange}\n            max={max}\n            min={min}\n            step={step}\n            />\n        </>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiIdItem, TempletType } from '../../schema';\nimport { observable } from 'mobx';\n\nconst none = <small className=\"text-muted\">[无]</small>;\n\nexport class IdWidget extends Widget {\n    protected get ui(): UiIdItem {return this._ui as UiIdItem};\n    @observable protected value:number;\n    setReadOnly(value:boolean) {this.readOnly = value}\n    setDisabled(value:boolean) {this.disabled = value}    \n\n    protected onClick = async () => {\n        let pickId = this.ui && this.ui.pickId;\n        if (pickId === undefined) {\n            alert('no pickId defined!');\n            return;\n        }\n        let id = await pickId(this.context, this.name, this.value);        \n        this.setDataValue(id);\n        this.clearError();\n        this.clearContextError();\n        this.checkRules();\n    }\n\n    render() {\n        let placeholder:string|JSX.Element, Templet: TempletType;\n        if (this.ui !== undefined) {\n            placeholder = this.ui.placeholder;\n            Templet = this.ui.Templet;\n        }\n        let cn:any = {\n            'form-control': true,\n            'required-item': this.itemSchema.required === true,\n            'cursor-pointer': true,\n            'is-invalid': this.hasError,\n        };\n        let content;\n        if (this.value === undefined || this.value === null) {\n            content = placeholder || none;\n            cn['text-muted'] = true;\n        }\n        else if (Templet === undefined) {\n            let c: any;\n            if (this.value === null) {\n                c = 'null';\n            }\n            else {\n                switch (typeof this.value) {\n                    case 'undefined': c = none; break;\n                    case 'object': c = (this.value as any).id; break;\n                    default: c = this.value; break;\n                }\n            }\n            content = <>{c}</>;\n        }\n        else if (typeof Templet === 'function') {\n            content = Templet(this.value);\n        }\n        else {\n            content = Templet;\n        }\n        return <>\n            <div className={classNames(cn)} onClick={this.onClick}>{content}</div>\n            {this.renderErrors()}\n        </>;\n    }\n}\n","import * as React from 'react';\nimport { DataType } from '../../schema';\nimport { UiType } from '../../schema';\n\nexport const Unknown = (dataType:DataType, uiType:UiType, dataTypes:DataType[]) => {\n    return <span className=\"text-danger\">!!data type {dataType} only support {(dataTypes || []).join(', ')}, can't use ui {uiType}!!</span>;\n};\n","import * as React from 'react';\nimport { UiButton, TempletType } from '../../schema';\nimport { Unknown } from './unknown';\nimport { Widget } from './widget';\nimport { observer } from 'mobx-react';\n\nexport class ButtonWidget extends Widget {\n    protected get ui(): UiButton {return this._ui as UiButton};\n\n    protected onClick = async () => {\n        this.clearError();\n        this.clearContextError();\n        let {name, type} = this.itemSchema;\n        if (type === 'submit') {\n            await this.context.submit(name);\n        }\n        /*\n        let {onButtonClick} = this.context.form.props;\n        if (onButtonClick === undefined) {\n            alert(`button ${name} clicked. you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(name, this.context);\n        if (ret === undefined) return;\n        this.context.setError(name, ret);\n        */\n    }\n\n    private observerRender = observer(() => {\n        let {name, type} = this.itemSchema;\n        let Templet:TempletType, cn:string, caption:string;\n        if (this.ui !== undefined) {\n            let {widget:widgetType} = this.ui;\n            if (widgetType !== 'button') return Unknown(type, widgetType, ['button']);\n            Templet = this.ui.Templet;\n            cn = this.ui.className;\n            caption = this.ui.label;\n        }\n        let {form, hasError} = this.context;\n        let context = this.context;\n        let disabled = type==='submit' && hasError;\n        let content:any;\n        if (this.children !== undefined) content = this.children;\n        else if (typeof Templet === 'function') content = Templet();\n        else if (Templet !== undefined) content = Templet;\n        else content = caption; \n        let button = <button \n            className={cn} \n            type=\"button\"\n            disabled={disabled}\n            onClick={this.onClick}>\n            {content || name}\n        </button>;\n        if (context.inNode === true) return <>{button}{this.renderErrors()}</>;\n        return <div className={form.ButtonClass}>\n            <div>{this.renderErrors()}</div>\n            {button}\n        </div>;\n    });\n    \n    protected get label():string {return null}\n\n    render() {\n        return React.createElement(this.observerRender);\n    }\n}\n","import * as React from 'react';\nimport { Form } from './form';\nimport { UiSchema, UiArr, UiItem } from '../schema';\nimport { ArrSchema, ItemSchema } from '../schema';\nimport { Widget } from './widgets/widget';\n//import { ArrRow } from './arrRow';\nimport { observable, computed } from 'mobx';\nimport { ContextRule } from './rules';\nimport { observer } from 'mobx-react';\n\nexport abstract class Context {\n    private subContexts:{[name:string]:{[rowKey:string]:Context}};\n    readonly form: Form;\n    readonly uiSchema: UiSchema;\n    readonly initData: any;\n    readonly inNode: boolean;           // true: 在</> 流中定义Field\n    readonly widgets: {[name:string]: Widget} = {};\n    readonly rules: ContextRule[];\n    readonly isRow: boolean;\n    @observable errors: string[] = [];\n    @observable errorWidgets:Widget[] = [];\n\n    constructor(form: Form, uiSchema: UiSchema, data: any, inNode: boolean, isRow: boolean) {\n        this.form = form;\n        this.uiSchema = uiSchema;\n        this.initData = data;\n        this.inNode = inNode;\n        this.isRow = isRow;\n        if (uiSchema !== undefined) {\n            let {rules} = uiSchema;\n            if (rules !== undefined) {\n                this.rules = [];\n                if (Array.isArray(rules) === false)\n                    this.rules.push(rules as ContextRule);\n                else\n                    this.rules.push(...rules as ContextRule[]);\n            }\n        }\n    }\n\n    getArrRowContexts(arrName: string) {\n        if (this.subContexts === undefined) this.subContexts = {};\n        let arrRowContexts = this.subContexts[arrName];\n        if (arrRowContexts === undefined) this.subContexts[arrName] = arrRowContexts = {};\n        return arrRowContexts;\n    }\n\n    abstract get data():any;\n    abstract getItemSchema(itemName:string):ItemSchema;\n    abstract getUiItem(itemName:string):UiItem;\n    get arrName():string {return undefined}\n    getValue(itemName:string):any {return this.initData[itemName]}\n    setValue(itemName:string, value:any) {\n        this.initData[itemName] = value;\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setValue(value);\n    }\n    getDisabled(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) return widget.getDisabled();\n        return undefined;\n    }\n    setDisabled(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setDisabled(value);\n    }\n    getReadOnly(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.getReadOnly();\n        return undefined;\n    }\n    setReadOnly(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setReadOnly(value);\n    }\n    getVisible(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.getVisible();\n        return undefined;\n    }\n    setVisible(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setVisible(value);\n    }\n\n    async submit(buttonName: string) {\n        this.checkRules()\n        if (this.hasError === true) {\n            let err = '';\n            for (let ew of this.errorWidgets) {\n                err += ew.name + ':\\n' + ew.errors.join('\\n');\n            }\n            console.error(err);\n            return;\n        }\n        let {onButtonClick} = this.form.props;\n        if (onButtonClick === undefined) {\n            alert(`button ${buttonName} clicked. you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(buttonName, this);\n        if (ret === undefined) return;\n        this.setError(buttonName, ret);\n\n    }\n\n    checkFieldRules() {\n        for (let i in this.widgets) {\n            this.widgets[i].checkRules();\n        }\n        if (this.subContexts === undefined) return;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                arrRowContexts[j].checkFieldRules();\n            }\n        }\n    }\n\n    checkContextRules() {\n        this.clearErrors();\n        if (this.rules === undefined) return;\n        for (let rule of this.rules) {\n            let ret = rule(this);\n            if (ret === undefined) continue;\n            if (Array.isArray(ret) === true) {\n                this.errors.push(...ret as string[]);\n            }\n            else if (typeof ret === 'string') {\n                this.errors.push(ret as string);\n            }\n            else {\n                for (let i in ret as object) this.setError(i, (ret as any)[i]);\n            }\n        }\n        if (this.subContexts === undefined) return;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                let rowContext = arrRowContexts[j];\n                rowContext.clearErrors();\n                rowContext.checkContextRules();\n            }\n        }\n    }\n\n    setError(itemName:string, error:string) {\n        let widget = this.widgets[itemName];\n        if (widget === undefined) return;\n        widget.setContextError(error);\n        this.addErrorWidget(widget);\n    }\n\n    clearContextErrors() {\n        for (let i in this.widgets) {\n            let widget = this.widgets[i];\n            if (widget === undefined) continue;\n            widget.clearContextError();\n        }\n    }\n\n    clearWidgetsErrors() {\n        for (let i in this.widgets) {\n            let widget = this.widgets[i];\n            if (widget === undefined) continue;\n            widget.clearError();\n        }\n    }\n\n    checkRules() {\n        this.clearErrors();\n        this.clearWidgetsErrors();\n        this.checkFieldRules();\n        if (this.hasError === true) return;\n        this.checkContextRules();\n    }\n\n    addErrorWidget(widget:Widget) {\n        let pos = this.errorWidgets.findIndex(v => v === widget);\n        if (pos < 0) this.errorWidgets.push(widget);\n    }\n    removeErrorWidget(widget:Widget) {\n        let pos = this.errorWidgets.findIndex(v => v === widget);\n        if (pos >= 0) this.errorWidgets.splice(pos, 1);\n    }\n\n    protected checkHasError():boolean {\n        let ret = (this.errorWidgets.length + this.errors.length) > 0;\n        if (ret === true) return true;\n        if (this.subContexts === undefined) return false;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                if (arrRowContexts[j].hasError === true) return true;\n            }\n        }\n        return false;\n    }\n\n    @computed get hasError():boolean {\n        return this.checkHasError();\n    };\n\n    clearErrors() {\n        this.errors.splice(0);\n        this.errorWidgets.splice(0);\n        this.clearContextErrors();\n    }\n\n    renderErrors = observer((): JSX.Element => {\n        let {errors} = this;\n        if (errors.length === 0) return null;\n        return <>\n            {errors.map(err => <span key={err} className=\"text-danger inline-block my-1 ml-3\">\n                <i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}\n            </span>)}\n        </>\n    });\n}\n\nlet rowKeySeed:number = 1;\nexport class RowContext extends Context {\n    readonly parentContext: Context;\n    readonly arrSchema: ArrSchema;\n    readonly rowKey: number;\n\treadonly data: any;\n    //readonly uiSchema: UiArr;\n\t\n    constructor(parentContext:Context, arrSchema: ArrSchema, data: any, inNode: boolean) {\n        let uiArr:UiArr;\n        let {uiSchema} = parentContext;\n        if (uiSchema !== undefined) {\n            let {items} = uiSchema;\n            if (items !== undefined) uiArr = items[arrSchema.name] as UiArr;\n        }\n        super(parentContext.form, uiArr, data, inNode, true);\n        this.parentContext = parentContext;\n        this.arrSchema = arrSchema;\n        this.rowKey = rowKeySeed++;\n        this.data = data;\n    }\n    getItemSchema(itemName:string):ItemSchema {return this.arrSchema.itemSchemas[itemName]}\n    getUiItem(itemName:string):UiItem {\n        if (this.uiSchema === undefined) return undefined;\n        let {items} = this.uiSchema;\n        if (items === undefined) return undefined;\n        return items[itemName]\n    }\n    get arrName():string {return this.arrSchema.name}\n    clearErrors() {\n        super.clearErrors();\n        this.parentContext.clearErrors();\n    }\n\n    get parentData():any {return this.parentContext.data;}\n}\n\nexport class FormContext extends Context {\n    constructor(form:Form, inNode:boolean) {\n        super(form, form.uiSchema, form.data, inNode, false);\n    }\n    get data():any {return this.form.data}\n    getItemSchema(itemName:string):ItemSchema {return this.form.itemSchemas[itemName]}\n    getUiItem(itemName:string):UiItem {\n        let {uiSchema} = this.form;\n        if (uiSchema === undefined) return undefined;\n        let {items} = uiSchema;\n        if (items === undefined) return undefined;\n        return items[itemName];\n    }\n}\n\nexport const ContextContainer = React.createContext<Context>({} as any);\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\n//import { ArrRow } from '../arrRow';\nimport { Context, RowContext, ContextContainer } from '../context';\nimport { ArrSchema } from '../../schema';\nimport { UiArr, TempletType } from '../../schema';\nimport { Unknown } from './unknown';\nimport { factory } from './factory';\n\nexport const ArrComponent = observer((\n    {parentContext, arrSchema, children}:{parentContext: Context, arrSchema: ArrSchema, children: React.ReactNode}) => \n{\n    let {name, arr} = arrSchema;\n    let data = parentContext.initData[name] as any[];\n    let {form} = parentContext;\n    let arrRowContexts = parentContext.getArrRowContexts(name);\n    let ui = parentContext.getUiItem(name) as UiArr;\n    let arrLabel = name;\n    let Templet:TempletType;\n    let selectable:boolean, deletable:boolean, restorable:boolean;\n    let {ArrContainer, RowContainer, RowSeperator, uiSchema} = form;\n    if (uiSchema !== undefined) {\n        let {selectable:formSelectable, deletable:formDeletable, restorable:formRestorable} = uiSchema;\n        if (selectable !== true) selectable = formSelectable;\n        if (deletable !== true) deletable = formDeletable;\n        if (restorable !== true) restorable = formRestorable;\n    }\n    if (ui !== undefined) {\n        let {widget:widgetType, label, \n            selectable:arrSelectable, deletable:arrDeletable, restorable:arrRestorable,\n            ArrContainer:ac, RowContainer:rc, RowSeperator:rs\n        } = ui;\n        if (arrSelectable !== undefined) selectable = arrSelectable;\n        if (arrDeletable !== undefined) deletable = arrDeletable;\n        if (arrRestorable !== undefined) restorable = arrRestorable;\n        if (ac !== undefined) ArrContainer = ac;\n        if (rc !== undefined) RowContainer = rc;\n        if (rs !== undefined) RowSeperator = rs;\n        Templet = ui.Templet;\n        if (widgetType !== 'arr') return Unknown(arrSchema.type, widgetType, ['arr']);\n        arrLabel = label || arrLabel;\n    }\n    let first = true;\n    return ArrContainer(arrLabel, <>\n        {data.map((row:any, index) => {\n            let rowContext: RowContext;\n            let rowContent: JSX.Element;\n            let sep = undefined;\n            if (first === false) sep = RowSeperator;\n            else first = false;\n            if (children !== undefined) {\n                rowContext = new RowContext(parentContext, arrSchema, row, true);\n                rowContent = <>{children}</>;\n            }\n            else {\n                let typeofTemplet = typeof Templet;\n                if (typeofTemplet === 'function') {\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\n                    rowContent = React.createElement(observer(Templet as React.StatelessComponent), row);\n                }\n                else if (typeofTemplet === 'object') {\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\n                    rowContent = Templet as JSX.Element;\n                }\n                else {\n                    rowContext = new RowContext(parentContext, arrSchema, row, false);\n                    rowContent = <>{\n                        arr.map((v, index) => {\n                            return <React.Fragment key={v.name}>\n                                {factory(rowContext, v, undefined)}\n                            </React.Fragment>\n                        })}\n                    </>;\n                }\n            }\n            let {rowKey} = rowContext;\n            arrRowContexts[rowKey] = rowContext;\n\n            let selectCheck:JSX.Element, deleteIcon:JSX.Element;\n            if (selectable === true) {\n                let onClick = (evt: React.MouseEvent<HTMLInputElement>)=>{\n                    let {checked} = (evt.target as HTMLInputElement);\n                    row.$isSelected = checked;\n                    let {$source} = row;\n                    if ($source !== undefined) $source.$isSelected = checked;\n                    rowContext.clearErrors();\n                }\n                selectCheck = <div className=\"form-row-checkbox\">\n                    <input type=\"checkbox\" onClick={onClick} defaultChecked={row.$isSelected} />\n                </div>;\n            }\n            let isDeleted = !(row.$isDeleted===undefined || row.$isDeleted===false);\n            if (deletable === true) {\n                let icon = isDeleted? 'fa-undo' : 'fa-trash';\n                let onDelClick = () => {\n                    if (restorable === true) {\n                        row.$isDeleted = !isDeleted;\n                        let {$source} = row;\n                        if ($source !== undefined) $source.$isDeleted = !isDeleted;\n                    }\n                    else {\n                        let p = data.indexOf(row);\n                        if (p>=0) data.splice(p, 1);\n                    }\n                    rowContext.clearErrors();\n                }\n                deleteIcon = <div className=\"form-row-edit text-info\" onClick={onDelClick}>\n                    <i className={classNames('fa', icon, 'fa-fw')} />\n                </div>;\n            }\n            let editContainer = selectable===true || deletable===true?\n                (content:any) => <fieldset disabled={isDeleted}><div className={classNames('d-flex', {'deleted':isDeleted, 'row-selected':row.$isSelected})}>\n                    {selectCheck}\n                    <div className={selectable===true && deletable===true? \"form-row-content\":\"form-row-content-1\"}>{content}</div>\n                    {deleteIcon}\n                </div></fieldset>\n                :\n                (content:any) => content;\n\n            return <ContextContainer.Provider key={rowKey} value={rowContext}>\n                {sep}\n                {RowContainer(editContainer(<><rowContext.renderErrors />{rowContent}</>))}\n            </ContextContainer.Provider>;\n        })}\n    </>);\n});\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiImageItem } from '../../schema';\nimport { Image } from '../../image';\nimport { ImageItemEdit } from '../../edit/imageItemEdit';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\n\nexport class ImageWidget extends Widget {\n    protected input: HTMLInputElement;\n    protected get ui(): UiImageItem {return this._ui as UiImageItem};\n    @observable private imageSrc: string;\n\n    init() {\n        super.init();\n        this.imageSrc = this.value;\n    }\n\n    protected onClick = async () => {\n        let edit = new ImageItemEdit(this.itemSchema, this.ui, this.ui.label, this.value);\n        let ret = await edit.start();\n        if (ret !== null) {\n            this.setValue(ret);\n            this.imageSrc = ret;\n        }\n        await edit.end();\n    }\n\n    render() {\n        return React.createElement(this.observerRender);\n    }\n\n    private observerRender = observer(() => {\n        let cn = [\n            'bg-white p-1 d-flex justify-content-center',\n        ];\n        let onClick: any;\n        if (!this.readOnly && !this.disabled) {\n            cn.push('cursor-pointer');\n            onClick = this.onClick;\n        }\n        return <div className={classNames(cn)} onClick={onClick}>\n            <Image src={this.imageSrc} className=\"w-4c h-4c\"/>\n        </div>;\n    });\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTag, IValuesViewRenderOptions } from '../../schema';\nimport { RowContext } from '../context';\n\nabstract class TagWidget extends Widget {\n    protected inputs: {[index:number]: HTMLInputElement} = {};\n    protected get ui(): UiTag {return this._ui as UiTag};\n\n    protected setElementValue(value:any) {\n        for (let i in this.inputs) {\n            let input = this.inputs[i];\n            input.checked = value === input.value;\n        }\n    }\n    setReadOnly(value:boolean) {\n        this.readOnly = value;\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        this.disabled = value;\n        for (let i in this.inputs) this.inputs[i].disabled = value\n\t}\n\t\n\tabstract render():JSX.Element;\n}\n\nexport class TagSingleWidget extends TagWidget {\n\trender() {\n\t\tlet {valuesView, wrapClassName} = this.ui;\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\n        let {isRow} = this.context;\n        let rowKey:number;\n        if (isRow === true) {\n            rowKey = (this.context as RowContext).rowKey;\n        }\n        let cn = classNames(this.className, 'py-0');\n\t\tlet name = this.name;\n\t\tif (rowKey !== undefined) name += '-' + rowKey;\n\t\tlet options:IValuesViewRenderOptions = {\n\t\t\tclassName: cn,\n\t\t\tinputName: name,\n\t\t\twrapClassName,\n\t\t\tonInputChange: this.onInputChange\n\t\t}\n\t\treturn valuesView.renderRadios(this.defaultValue, options);\n    }\n}\n\nexport class TagMultiWidget extends TagWidget {\n\tprivate defaultArr:number[];\n\tinit() {\n\t\tsuper.init();\n\t\tlet def = this.defaultValue;\n\t\tswitch (typeof def) {\n\t\t\tdefault:\n\t\t\t\tthis.defaultArr = [];\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\tthis.defaultArr = def.split('|').map(v => Number(v));\n\t\t\t\tbreak;\n\t\t}\n\t}\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n\t\tlet values:string[] = [];\n\t\tfor (let i in this.inputs) {\n\t\t\tlet input = this.inputs[i];\n\t\t\tif (input.checked === true) values.push(input.value);\n\t\t}\n        this.changeValue(values.join('|'), true);\n\t}\n\trender() {\n\t\tlet {valuesView, wrapClassName} = this.ui;\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\n        let cn = classNames(this.className, 'py-0');\n\t\tlet options:IValuesViewRenderOptions = {\n\t\t\tclassName: cn,\n\t\t\tinputs: this.inputs,\n\t\t\twrapClassName,\n\t\t\tonInputChange: this.onInputChange\n\t\t}\n\t\treturn valuesView.renderChecks(this.defaultValue, options);\n    }\n}\n","import * as React from 'react';\nimport { ArrSchema, DataType, ItemSchema } from '../../schema';\nimport { TypeWidget, UiCustom } from '../../schema';\nimport { TextWidget } from './textWidget';\nimport { TextAreaWidget } from './textareaWidget';\nimport { PasswordWidget, UrlWidget, EmailWidget } from './passwordWidget';\nimport { UpdownWidget } from './updownWidget';\nimport { NumberWidget } from './numberWidget';\nimport { DateWidget, DateTimeWidget, TimeWidget, MonthWidget } from './dateWidget';\nimport { CheckBoxWidget } from './checkBoxWidget';\nimport { FieldProps } from '../field';\nimport { Context } from '../context';\nimport { SelectWidget } from './selectWidget';\nimport { RadioWidget } from './radioWidget';\nimport { RangeWidget } from './rangeWidget';\nimport { IdWidget } from './idWidget';\nimport { ButtonWidget } from './buttonWidget';\nimport { ArrComponent } from './arrComponent';\nimport { ImageWidget } from './imageWidget';\nimport { TagSingleWidget, TagMultiWidget } from './tagWidget';\n\nconst widgetsFactory: {[type: string]: {widget?: TypeWidget, dataTypes?: DataType[]}} = {\n    id: {\n        dataTypes: ['id'],\n        widget: IdWidget,\n    },\n    text: {\n        dataTypes: ['integer', 'number', 'string'],\n        widget: TextWidget\n    },\n    textarea: {\n        dataTypes: ['string'],\n        widget: TextAreaWidget\n    },\n    password: {\n        dataTypes: ['string'],\n        widget: PasswordWidget\n    },\n    date: {\n        dataTypes: ['date'],\n        widget: DateWidget\n    },\n    datetime: {\n        dataTypes: ['date'],\n        widget: DateTimeWidget\n    },\n    time: {\n        dataTypes: ['date'],\n        widget: TimeWidget\n    },\n    month: {\n        dataTypes: ['date'],\n        widget: MonthWidget\n    },\n    select: {\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\n        widget: SelectWidget\n    },\n    url: {\n        dataTypes: ['string'],\n        widget: UrlWidget\n    },\n    email: {\n        dataTypes: ['string'],\n        widget: EmailWidget\n    },\n    number: {\n        dataTypes: ['integer', 'number'],\n        widget: NumberWidget\n    },\n    updown: {\n        dataTypes: ['integer', 'number'],\n        widget: UpdownWidget\n    },\n    color: {\n\n    },\n    checkbox: {\n        dataTypes: ['boolean', 'integer', 'number'],\n        widget: CheckBoxWidget\n    },\n    image: {\n        dataTypes: ['string'],\n        widget: ImageWidget,\n    },\n    checkboxes: {\n\n    },\n    radio: {\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\n        widget: RadioWidget\n\t},\n\ttagSingle: {\n\t\tdataTypes: ['integer'],\n\t\twidget: TagSingleWidget\n\t},\n\ttagMulti: {\n\t\tdataTypes: ['string'],\n\t\twidget: TagMultiWidget\n\t},\n    range: {\n        dataTypes: ['integer'],\n        widget: RangeWidget,\n    },\n    button: {\n        dataTypes: ['button', 'submit'],\n        widget: ButtonWidget,\n    }\n}\n\nexport function factory(context: Context, itemSchema: ItemSchema, children:React.ReactNode, fieldProps?: FieldProps):JSX.Element {\n    if (context === undefined) {\n        debugger;\n        return null;\n    }\n    if (itemSchema === undefined) return undefined;\n    let {name, type} = itemSchema;\n    switch (type) {\n    case 'arr':\n        let arrSchema = context.getItemSchema(name) as ArrSchema;\n        return <ArrComponent parentContext={context} arrSchema={arrSchema} children={children} />;\n    default:\n        break;\n    }\n\n    let typeWidget: TypeWidget;\n    let ui = context.getUiItem(name);\n    function getTypeWidget(t:DataType): TypeWidget {\n        switch(t) {\n        default: return TextWidget; \n        case 'id': return IdWidget;\n        case 'integer': return UpdownWidget;\n        case 'number': return NumberWidget; \n        case 'string': return TextWidget; \n        case 'date': return DateWidget; \n        case 'boolean': return CheckBoxWidget; \n        case 'button':\n        case 'submit': return ButtonWidget;\n        }\n    }\n    if (ui === undefined) { \n        typeWidget = getTypeWidget(type);\n    }\n    else {\n        let {widget:widgetType} = ui;\n        switch (widgetType) {\n        default:\n            if (widgetType !== undefined) {\n                let widgetFactory = widgetsFactory[widgetType];\n                typeWidget = widgetFactory.widget;\n            }\n            if (typeWidget === undefined) typeWidget = getTypeWidget(type);\n            break;\n        case 'custom':\n            typeWidget = (ui as UiCustom).WidgetClass;\n            break;\n        case 'group':\n            return <span>impletment group</span>;\n        }\n        //label = uiLabel || name;\n    }\n    \n    let {widgets} = context;\n    let widget = new typeWidget(context, itemSchema, fieldProps, children);\n    widget.init();\n    widgets[name] = widget;\n\n    return <widget.container />;\n    /*\n    if (isRow === false) {\n        let WidgetElement = observer(() => widget.container());\n        return <WidgetElement />;\n    }\n    else {\n        let widgetElement = widget.container();\n        return widgetElement;\n    }\n    */\n}\n\n","import * as React from 'react';\nimport {observable, IReactionDisposer, autorun} from 'mobx';\nimport classNames from 'classnames';\nimport { Schema, ItemSchema, ArrSchema } from '../schema';\nimport { UiSchema, TempletType } from '../schema';\nimport { factory } from './widgets';\nimport 'font-awesome/css/font-awesome.min.css';\nimport { ContextContainer, FormContext, Context } from './context';\nimport { FormRes, formRes } from '../../res';\nimport { resLang } from '../../res/res';\n\nexport type FormButtonClick = (name:string, context: Context) => Promise<any>;\nexport type InputEnter = (name:string, context: Context) => Promise<any>;\n\nexport interface FormProps {\n    className?: string;\n    schema: Schema;\n    uiSchema?: UiSchema;\n    formData?: any;\n    onButtonClick?: FormButtonClick;\n    onEnter?: InputEnter;\n    fieldLabelSize?: number;            // col-sm-2 for label\n    requiredFlag?: boolean;             // default=true\n    beforeShow?: (formContext:FormContext) => void;\n    res?: FormRes;\n\n    Container?: (content:JSX.Element) => JSX.Element;\n    FieldContainer?: (label:string|JSX.Element, content:JSX.Element) => JSX.Element;\n    FieldClass?: string;\n    ButtonClass?: string;\n}\n\nexport class Form extends React.Component<FormProps> {\n    readonly schema: Schema;\n    readonly itemSchemas: {[name:string]: ItemSchema};\n    readonly uiSchema: UiSchema;\n    readonly res?: FormRes;\n    protected formContext: FormContext;\n    private disposer: IReactionDisposer;\n    readonly data:any;\n\n    readonly Container: (content:JSX.Element) => JSX.Element;\n    readonly FieldContainer: (label:any, content:JSX.Element) => JSX.Element;\n    readonly FieldClass: string;\n    readonly ButtonClass: string;\n    \n    constructor(props:FormProps) {\n        super(props);\n        let {schema, uiSchema, \n            Container, FieldContainer, FieldClass, \n            ButtonClass, res,\n        } = props;\n        this.Container = Container || this.DefaultContainer;\n        this.FieldContainer = FieldContainer || this.DefaultFieldContainer;\n        this.FieldClass = FieldClass!==undefined && FieldClass!==''&&FieldClass!==null? FieldClass : this.DefaultFieldClass;\n        this.res = res || this.DefaultRes;\n        this.ButtonClass = ButtonClass || this.DefaultButtonClass;\n\n        this.schema = schema;\n        this.itemSchemas = {};\n        for (let itemSchema of this.schema) {\n            this.itemSchemas[itemSchema.name] = itemSchema;\n        }\n        this.uiSchema = uiSchema;\n\n        this.disposer = autorun(this.watch);\n        this.data = {};\n    }\n\n    private renderContent():any {\n        this.initData(this.props.formData);\n        let {children} = this.props;\n        if (children !== undefined) {\n            this.formContext = new FormContext(this, true);\n            return <>{children}</>;\n        }\n\n        let Templet: TempletType;\n        if (this.uiSchema !== undefined) {\n            Templet = this.uiSchema.Templet;\n        }\n        if (Templet !== undefined) {\n            this.formContext = new FormContext(this, true);\n            return typeof(Templet) === 'function'? Templet(this.data) : Templet;\n        }\n\n        this.formContext = new FormContext(this, false);\n        return <>{this.schema.map((v, index) => {\n            return <React.Fragment key={index}>{factory(this.formContext, v, children)}</React.Fragment>\n        })}</>;\n    }\n\n    private initData(formData: any) {\n        if (formData === undefined) formData = {};\n        if (this.uiSchema !== undefined) {\n            let {items} = this.uiSchema;\n            if (items !== undefined) {\n                for (let i in items) {\n                    let ui = items[i];\n                    let dv = ui.defaultValue;\n                    if (dv !== undefined) {\n                        if (formData[i] === undefined) {\n                            formData[i] = dv;\n                        }\n                    }\n                }\n            }\n        }\n        for (let itemSchema of this.schema) {\n            this.initDataItem(itemSchema, this.data, formData);\n        }\n    }\n\n    private initDataItem(itemSchema: ItemSchema, data:any, formData: any):any {\n        let {name, type} = itemSchema;\n        if (type === 'button') return;\n        if (type !== 'arr') {\n            data[name] = formData[name];\n            return;\n        }\n\n        let arrItem:ArrSchema = itemSchema as ArrSchema;\n        let {arr:arrItems} = arrItem;\n        if (arrItems === undefined) return;\n        let arrDict:any = arrItem.itemSchemas = {};\n        for (let item of arrItems) {\n            arrDict[item.name] = item;\n        }\n        let val:any[] = formData[name];\n        if (val === undefined) val = [];\n        else if (Array.isArray(val) === false) val = [val];\n        let arr:any[] = [];\n        for (let row of val) {\n            let {$isSelected, $isDeleted} = row;\n            let r = {\n                $source: row,\n                $isSelected: $isSelected,\n                $isDeleted: $isDeleted,\n            };\n            for (let item of arrItems) {\n                this.initDataItem(item, r, row);\n            }\n            arr.push(r);\n        }\n        // 如果没有observable，行删除标志点击不管用\n        // 不知道这里为什么要去掉observable。有可能会有别的问题\n        data[name] = observable(arr);\n        //data[name] = arr;\n        return;\n    }\n\n    private watch = () => {\n        let {formData} = this.props;\n        if (formData === undefined) return;\n        //this.initData(formData);\n        this.calcSelectOrDelete();\n    }\n    private calcSelectOrDelete() {\n        for (let itemSchema of this.schema) {\n            this.arrItemOperated(itemSchema);\n        }\n    }\n\n    private arrItemOperated(itemSchema: ItemSchema) {\n        let {name, type} = itemSchema;\n        if (type !== 'arr') return;\n        if (this.data === undefined) return;\n        let formArrVal = this.data[name];\n        if (formArrVal === undefined) return;\n        let {arr: arrItems} = itemSchema as ArrSchema;\n        for (let row of formArrVal) {\n            let {$source} = row;\n            if ($source === undefined) continue;\n            let {$isSelected, $isDeleted} = $source;\n            row.$isSelected = $isSelected;\n            row.$isDeleted = $isDeleted;\n            //console.log($isSelected, $isDeleted);\n            for (let item of arrItems) {\n                this.arrItemOperated(item);\n            }\n        }\n    }\n\n    componentDidMount() {\n        let {beforeShow} = this.props;\n        if (beforeShow !== undefined) beforeShow(this.formContext);\n    }\n\n    componentWillUnmount() {\n        if (this.disposer !== undefined) this.disposer();\n    }\n\n    render() {\n        let content = this.renderContent();\n        return <ContextContainer.Provider value={this.formContext}>\n            {React.createElement(this.formContext.renderErrors)}\n            {this.Container(content)}\n        </ContextContainer.Provider>;\n    }\n\n    async buttonClick(buttonName:string) {\n        this.formContext.checkRules()\n        if (this.formContext.hasError === true) return;\n\n        let {onButtonClick} = this.formContext.form.props;\n        if (onButtonClick === undefined) {\n            alert(`you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(buttonName, this.formContext);\n        if (ret === undefined) return;\n        this.formContext.setError(buttonName, ret);\n    }\n\n    protected DefaultContainer = (content:JSX.Element): JSX.Element => {\n        return <form className={classNames(this.props.className)} onSubmit={e=>e.preventDefault()}>\n            {content}\n        </form>;\n    }\n    protected DefaultFieldContainer = (label:string|JSX.Element, content:JSX.Element): JSX.Element => {\n        let {fieldLabelSize} = this.props;\n\n        if (fieldLabelSize > 0) {\n            let labelView:any;\n            if (label === null) {\n                fieldLabelSize = 0;\n            }\n            else {\n                labelView = <label className={classNames('col-sm-' + fieldLabelSize, 'col-form-label')}>{label}</label>\n            }\n            let fieldCol = 'col-sm-' + (12 - fieldLabelSize);\n            return <div className=\"form-group row\">\n                {labelView}\n                <div className={fieldCol}>{content}</div>\n            </div>;\n        }\n        return <div className=\"form-group\">\n            {label===null? null:<label className=\"col-form-label\">{label}</label>}\n            {content}\n        </div>;\n    }\n    protected DefaultFieldClass:string = undefined;\n    protected DefaultButtonClass = 'text-center py-2';\n    protected DefaultRes:FormRes = resLang<FormRes>(formRes);\n\n    ArrContainer = (label:any, content:JSX.Element): JSX.Element => {\n        return <div>\n            <div className={classNames('small text-muted text-center bg-light py-1 px-3 mt-4 mb-1')}>{label}</div>\n            {content}\n        </div>;\n    }\n    RowContainer = (content:JSX.Element): JSX.Element => {\n        let cn = classNames({\n            'py-3': true\n        });\n        return <div className={cn}>{content}</div>\n    }\n    RowSeperator = <div className=\"border border-gray border-top\" />;\n}\n","import * as React from 'react';\nimport { factory } from './widgets';\nimport { ContextContainer, Context } from './context';\n\nexport interface FieldProps {\n    name: string;\n}\n\nexport class FormField extends React.Component<FieldProps> {\n    static contextType = ContextContainer;\n    render() {\n        let {name, children } = this.props;\n        let context:Context = this.context;\n        if (context === undefined) return <span className=\"text-danger\">!only in Form!</span>;\n        let itemSchema = context.getItemSchema(name);\n        let content = factory(context, itemSchema, children, this.props);\n        if (content === undefined) {\n            return <span className=\"text-danger\">!!{name} is not defined!!</span>;\n        }\n        return content;\n    }\n}\n","import * as React from 'react';\nimport { UiTextItem } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class StringItemEdit extends ItemEdit {\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve, reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.verifyValue();\n    }\n\n    private onFocus = () => {\n        this.error = undefined;\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n\t\tlet {resolve} = props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tlet val = this.newValue;\n\t\t\t\tresolve(val);\t\t\t\t\n\t\t\t}\n\t\t}\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>;\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\tif (evt.keyCode === 13) onSave();\n\t\t}\n        return <Page header={this.label} right={right}>\n            <div className=\"m-3\">\n                <input type=\"text\" \n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n                    className=\"form-control\" \n                    defaultValue={this.value} />\n                {\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiRadio } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class RadioItemEdit extends ItemEdit {\n    get uiItem(): UiRadio {return this._uiItem as UiRadio}\n\n\tinit() {\n        if (this.value === undefined) {\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\n        }\n\t}\n\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (value: any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let {name} = this.itemSchema;\n        let {list} = this.uiItem;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>{\n                this.verifyValue();\n                if (this.error === undefined) resolve(this.newValue);\n            }}>保存</button>;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\n                    <input name={name} type=\"radio\" value={value} \n                        onClick={()=>this.onChange(value)} \n                        defaultChecked={value === this.value} /> {title || value} &nbsp;\n                </label></div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label} right={right}>\n            <div className=\"m-3\">\n\t\t\t\t<div className=\"row row-cols-2 row-cols-sm-3 row-cols-md-4\">{content}</div>\n\t\t\t</div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiSelect } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class SelectItemEdit extends ItemEdit {\n    get uiItem(): UiSelect {return this._uiItem as UiSelect}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (value:any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let {list} = this.uiItem;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\n                    {title || value}\n                </div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label}>\n            <div className=\"my-3\">\n                {content}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiIdItem } from '../schema';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class IdItemEdit extends ItemEdit {\n    get uiItem(): UiIdItem {return this._uiItem as UiIdItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>(async (resolve, reject) => {\n            //let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            //nav.push(element,reject);\n\n            let {pickId} = this.uiItem;\n            if (pickId === undefined) {\n                alert('IdItemEdit.pickId = undefined');\n                return;\n            }\n            let boxId = await pickId(undefined, undefined, this.value);\n            //if (typeof id === 'object') {\n            //    id = (id as any).id;\n            //}\n            this.onChange(boxId.id);\n            resolve(boxId);\n            //this.newValue = id;\n        });\n    }\n\n    protected async internalEnd():Promise<void> {}\n\n    private onChange = (value:any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        /*\n        let {resolve, reject} = props;\n        let {list} = this.uiItem;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\n                    {title || value}\n                </div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label}>\n            <div className=\"my-3\">\n                {content}\n            </div>\n        </Page>;\n        */\n        return <Page header={'更改' + this.label}>\n            ddd\n        </Page>\n    })\n}\n","import * as React from 'react';\nimport { UiTag } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nabstract class TagItemEdit extends ItemEdit {\n\tprotected inputs: {[index:number]: HTMLInputElement} = {};\n\tprotected inputType: 'checkbox' | 'radio';\n    get uiItem(): UiTag {return this._uiItem as UiTag};\n\n\tinit() {\n        if (this.value === undefined) {\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\n        }\n\t}\n\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n\t}\n\t\n\trenderContent() {\n\t\tlet valuesView = this.uiItem.valuesView;\n\t\tif (valuesView === undefined) return super.renderContent();\n\t\treturn valuesView.render(this.value);\n\t}\n\n\tprotected abstract renderInputs():JSX.Element;\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>{\n                this.verifyValue();\n                if (this.error === undefined) resolve(this.newValue);\n\t\t\t}}>保存</button>;\n\t\t/*\n        let content = list?\n            list.map((v, index:number) => {\n                let {name:itemName, id} = v;\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\n                    <input ref={input=>this.inputs[id] = input} name={name} type={this.inputType} value={id} \n\t\t\t\t\t\tonClick={(e)=>this.onChange(e.currentTarget.checked, id)}\n                        defaultChecked={this.defaultChecked(id)} /> {itemName} &nbsp;\n                </label></div>;\n            })\n            :\n\t\t\t<>no list defined</>;\n\t\t*/\n        return <Page header={'更改' + this.label} right={right}>\n\t\t\t<div className=\"p-3\">\n\t\t\t\t{this.renderInputs()}\n\t\t\t</div>\n        </Page>;\n    })\n}\n\nexport class TagSingleItemEdit extends TagItemEdit {\n\tprotected inputType:'radio'|'checkbox' = 'radio';\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet {currentTarget} = evt;\n\t\tif (currentTarget.checked === false) return;\n        this.newValue = Number(currentTarget.value);\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n\t}\n\t\n\tprotected renderInputs():JSX.Element {\n\t\tlet {valuesView} = this.uiItem;\n\t\tlet options = {\n\t\t\tinputs: this.inputs,\n\t\t\tonInputChange: this.onInputChange,\n\t\t};\n\t\treturn valuesView.renderRadios(this.value, options);\n\t}\n}\n\nexport class TagMultiItemEdit extends TagItemEdit {\n\t//private arr:number[];\n\tprotected inputType:'radio'|'checkbox' = 'checkbox';\n\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet values:string[] = [];\n\t\tfor (let i in this.inputs) {\n\t\t\tlet input = this.inputs[i];\n\t\t\tif (input.checked === true) values.push(input.value);\n\t\t}\n        this.newValue = values.join('|');\n        //this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n\t}\n\tprotected renderInputs():JSX.Element {\n\t\tlet {valuesView} = this.uiItem;\n\t\tlet options = {\n\t\t\tinputs: this.inputs,\n\t\t\tonInputChange: this.onInputChange\n\t\t};\n\t\treturn valuesView.renderChecks(this.value, options);\n\t}\n}\n","import * as React from 'react';\nimport { UiTextItem } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class TextAreaItemEdit extends ItemEdit {\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve, reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.verifyValue();\n    }\n\n    private onFocus = () => {\n        this.error = undefined;\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n\t\tlet {resolve} = props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tlet val = this.newValue;\n\t\t\t\tresolve(val);\t\t\t\t\n\t\t\t}\n\t\t}\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>;\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLTextAreaElement>) => {\n\t\t\t// if (evt.keyCode === 13) onSave();\n\t\t}\n        return <Page header={this.label} right={right}>\n            <div className=\"m-3\">\n                <textarea\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n                    className=\"form-control\" \n\t\t\t\t\tdefaultValue={this.value}\n\t\t\t\t\trows={6} />\n                {\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\n//import _ from 'lodash';\nimport { observer } from 'mobx-react';\nimport { Schema, UiSchema, ItemSchema, UiItem, UiRadio, UiTagSingle, UiTagMulti } from '../schema';\nimport { ItemEdit } from './itemEdit';\nimport { StringItemEdit } from './stringItemEdit';\nimport { ImageItemEdit } from './imageItemEdit';\nimport { RadioItemEdit } from './radioItemEdit';\nimport { SelectItemEdit } from './selectItemEdit';\nimport { IdItemEdit } from './idItemEdit';\nimport { TagSingleItemEdit, TagMultiItemEdit } from './tagItemEdit';\nimport { TextAreaItemEdit } from './textAreaItemEdit';\n\nexport interface EditProps {\n    className?: string;\n    schema: Schema;\n    data: any;\n    onItemClick?: (itemSchema: ItemSchema, uiItem: UiItem, value: any) => Promise<void>;\n    onItemChanged?: (itemSchema: ItemSchema, newValue:any, preValue:any) => Promise<void>;\n    stopEdit?: boolean;\n    uiSchema?: UiSchema;\n    sepClassName?: string;\n    topBorderClassName?: string;\n    bottomBorderClassName?: string;\n    rowContainerClassName?: string;\n}\n\n@observer\nexport class Edit extends React.Component<EditProps> {\n    private defaultSepClassName = 'border-top edit-sep-light-gray';\n    private defaultRowContainerClassName = 'd-flex px-3 py-2 bg-white align-items-center';\n    private topBorder:JSX.Element;\n    private bottomBorder:JSX.Element;\n    private rowContainerClassName?: string;\n    private sep:JSX.Element;\n\tprivate uiSchema: {[name:string]: UiItem};\n\n    constructor(props: EditProps) {\n        super(props);\n        let {topBorderClassName, bottomBorderClassName, sepClassName, rowContainerClassName, uiSchema, stopEdit} = props;\n        this.topBorder = <div className={topBorderClassName || this.defaultSepClassName} />;\n        this.bottomBorder = <div className={bottomBorderClassName || this.defaultSepClassName} />;\n        this.rowContainerClassName = rowContainerClassName || this.defaultRowContainerClassName;\n        if (stopEdit !== true) this.rowContainerClassName += ' cursor-pointer';\n        this.sep = <div className={sepClassName || this.defaultSepClassName} />;\n\t\tthis.uiSchema = (uiSchema && uiSchema.items) || {};\n    }\n\n    render() {\n        let {schema} = this.props;\n\t\tlet sep:any;\n        return <div>\n\t\t\t{this.topBorder}\n            {schema.map((itemSchema, index) => {\n\t\t\t\tlet {name} = itemSchema;\n\t\t\t\tlet uiItem = this.uiSchema===undefined? undefined : this.uiSchema[name];\n\t\t\t\tlet label:string, labelHide:any;\n\t\t\t\tif (uiItem !== undefined) {\n\t\t\t\t\tlabel = uiItem.label || name;\n\t\t\t\t\tlabelHide = uiItem.labelHide;\n\t\t\t\t};\n\t\t\t\tlet value = this.props.data[name];\n\t\t\t\tlet itemEdit = createItemEdit(itemSchema, uiItem, label, value);\n\n\t\t\t\tlet {required} = itemSchema;\n\t\t\t\tlet requireFlag = required===true && <span className=\"text-danger\">*</span>;\n\t\t\t\tlet divLabel:any, cn:string = 'flex-fill d-flex ';\n\t\t\t\tif (labelHide === true) {\n\t\t\t\t\tdivLabel = undefined;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdivLabel = <div>{label} {requireFlag}</div>;\n\t\t\t\t\tcn += 'justify-content-end';\n\t\t\t\t}\n\t\t\t\tlet ret = <React.Fragment key={index}>\n\t\t\t\t\t{sep}\n\t\t\t\t\t<div className={'d-flex align-items-center' + this.rowContainerClassName} \n\t\t\t\t\t\tonClick={async ()=>await this.rowClick(itemEdit)}>\n\t\t\t\t\t\t{divLabel}\n\t\t\t\t\t\t<div className={cn}>{\n\t\t\t\t\t\t\titemEdit===undefined? undefined: itemEdit.renderContent()\n\t\t\t\t\t\t}</div>\n\t\t\t\t\t\t{this.props.stopEdit!==true && <div className=\"w-2c text-right\"><i className=\"fa fa-angle-right\" /></div>}\n\t\t\t\t\t</div>\n\t\t\t\t</React.Fragment>;\n\t\t\t\tsep = this.sep;\n\t\t\t\treturn ret;\n\t\t\t})}\n\t\t\t{this.bottomBorder}\n\t\t</div>;\n    }\n\n\tprivate rowClick = async (itemEdit:ItemEdit) => {\n\t\tif (itemEdit === undefined) {\n\t\t\talert('item has no edit');\n\t\t\treturn;\n\t\t}\n\t\tlet {itemSchema, uiItem, value} = itemEdit;\n        let {onItemChanged, onItemClick, stopEdit} = this.props;\n        if (stopEdit === true) return;\n        let changeValue:any;\n        if (onItemClick !== undefined) {\n            await onItemClick(itemSchema, uiItem, value);\n            return;\n        }\n        //let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);\n        if (itemEdit === undefined) {\n            alert('undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);');\n            return;\n        }\n        try {\n            changeValue = await itemEdit.start();\n            if (changeValue !== value) {\n\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以移到这里来\n\t\t\t\tthis.props.data[itemSchema.name] = changeValue;\n                if (onItemChanged === undefined) {\n                    alert(`${itemSchema.name} value changed, new: ${changeValue}, pre: ${value}`);\n\t\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\n                    //this.props.data[itemSchema.name] = changeValue;\n                }\n                else {\n                    await onItemChanged(itemSchema, changeValue, value);\n                }\n            }\n            await itemEdit.end();\n        }\n        catch (err) {\n            // 如果直接back，会触发reject，就到这里了\n\t\t\tconsole.log('no value changed');\n\t\t\tconsole.error(err);\n        }\n    }\n}\n\ntype NewItemEdit = new (itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) => ItemEdit;\n\nfunction createItemEdit(itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any):ItemEdit {\n\tlet ie: ItemEdit;\n    let itemEdit: NewItemEdit;\n    if (uiItem !== undefined) {\n        switch (uiItem.widget) {\n            default: break;\n            case 'id': itemEdit = IdItemEdit; break;\n\t\t\tcase 'text': itemEdit = StringItemEdit; break;\n\t\t\tcase 'textarea': itemEdit = TextAreaItemEdit; break;\n            case 'image': itemEdit = ImageItemEdit; break;\n\t\t\tcase 'select': itemEdit = SelectItemEdit; break;\n\t\t\tcase 'range': itemEdit = StringItemEdit; break;\n            case 'radio': \n\t\t\t\tie = new RadioItemEdit(itemSchema, uiItem as UiRadio, label, value);\n\t\t\t\tbreak;\n\t\t\tcase 'tagSingle':\n\t\t\t\tie = new TagSingleItemEdit(itemSchema, uiItem as UiTagSingle, label, value);\n\t\t\t\tbreak;\n\t\t\tcase 'tagMulti':\n\t\t\t\tie = new TagMultiItemEdit(itemSchema, uiItem as UiTagMulti, label, value);\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\tif (ie === undefined) {\n\t\tif (itemEdit === undefined) {\n\t\t\tswitch (itemSchema.type) {\n\t\t\t\tcase 'string': itemEdit = StringItemEdit; break;\n\t\t\t\tcase 'image': itemEdit = ImageItemEdit; break;\n\t\t\t}\n\t\t}\n\t\tif (itemEdit === undefined) return;\n\t\tie = new itemEdit(itemSchema, uiItem, label, value);\n\t}\n\tie.init();\n\treturn ie;\n}\n","import {CenterApiBase} from '../net';\n\nexport class CenterApi extends CenterApiBase {\n    async userAppUnits(app:number):Promise<any[]> {\n        return await this.get('tie/user-app-units', {app:app});\n    }\n    async userFromId(userId:number):Promise<any> {\n        return await this.get('user/user-name-nick-icon-from-id', {userId:userId});\n\t}\n\tasync userFromKey(userName:string):Promise<any> {\n\t\treturn await this.get('tie/user-from-key', {key:userName});\n\t}\n}\n\nexport const centerApi = new CenterApi('tv/', undefined);\n","import * as React from 'react';\nimport { Page, FA, nav, LMR, List } from \"../components\";\nimport { VPage } from '../vm';\nimport { appInFrame } from '../net';\nimport { CAppBase } from \"./CAppBase\";\nimport { UQsMan } from '../uq';\n\n/*\nexport class VAppMain extends VPage<CMainBase> {\n    async open(param?:any) {\n        this.openPage(this.appPage);\n    }\n\n    render(param?:any) {\n        return this.appContent();\n    }\n\n    protected appPage = () => {\n        let {caption} = this.controller;\n        return <Page header={caption} logout={async()=>{appInFrame.unit = undefined}}>\n            {this.appContent()}\n        </Page>;\n    }\n\n    protected appContent = () => {\n        let {cUqArr} = this.controller;\n        let content:any;\n        if (cUqArr.length === 0) {\n            content = <div className=\"text-danger\">\n                <FA name=\"\" /> 此APP没有绑定任何的UQ\n            </div>;\n        }\n        else {\n            content = cUqArr.map((v,i) => <div key={i}>{v.render()}</div>);\n        }\n        return <>{content}</>;\n    };\n}\n*/\nexport class VUnsupportedUnit extends VPage<CAppBase> {\n    async open(predefinedUnit: number) {\n        this.openPage(this.page, {predefinedUnit:predefinedUnit});\n    }\n\n    private page = ({predefinedUnit}:{predefinedUnit: number}) => {\n        let {user} = nav;\n        let userName:string = user? user.name : '[未登录]';\n        let {appOwner, appName} = UQsMan.value;\n        return <Page header=\"APP无法运行\" logout={true}>\n            <div className=\"m-3 text-danger container\">\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">登录用户</div>\n                    <div className=\"col-sm text-body\">{userName}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">App</div>\n                    <div className=\"col-sm text-body\">{`${appOwner}/${appName}`}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">预设小号</div>\n                    <div className=\"col-sm text-body\">{predefinedUnit || <small className=\"\">[无预设小号]</small>}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">\n                        可能原因<FA name=\"exclamation-triangle\" />\n                    </div>\n                    <div className=\"col-sm text-body\">\n                        <ul className=\"p-0\">\n                            <li>没有小号运行 {appName}</li>\n                            <li>用户 <b>{userName}</b> 没有加入任何一个运行{appName}的小号</li>\n                            {\n                                predefinedUnit && \n                                <li>预设小号 <b>{predefinedUnit}</b> 没有运行App {appName}</li>\n                            }\n                        </ul>\n                    </div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">小号{predefinedUnit}</div>\n                    <div className=\"col-sm text-body\">\n                        预设小号定义在 public/unit.json 文件中。\n                        定义了这个文件的程序，只能由url直接启动。\n                        用户第一次访问app之后，会缓存在localStorage里。<br/>\n                        如果要删去缓存的预定义Unit，logout然后再login。\n                    </div>\n                </div>\n            </div>\n        </Page>;\n    }\n}\n\nexport class VUnitSelect extends VPage<CAppBase> {\n    async open() {\n        this.openPage(this.page);\n    }\n\n    private renderRow = (item: any, index: number):JSX.Element => {\n        let {id, nick, name} = item;\n        return <LMR className=\"px-3 py-2\" right={'id: ' + id}>\n            <div>{nick || name}</div>\n        </LMR>;\n    }\n    private onRowClick = async (item: any) => {\n        appInFrame.unit = item.id; // 25;\n        await this.controller.start();\n    }\n\n    private page = () => {\n        return <Page header=\"选择小号\" logout={true}>\n            <List items={this.controller.appUnits} item={{render: this.renderRow, onClick: this.onRowClick}}/>\n        </Page>\n    }\n}\n\nexport class VErrorsPage extends VPage<CAppBase> {\n    async open(errors:string[]) {\n        this.openPage(this.page, {errors:errors});\n    }\n\n    private page = (errors:{errors:string[]}) => {\n        return <Page header=\"ERROR\">\n            <div className=\"m-3\">\n\t\t\t\t<div className=\"p-3 d-flex justify-content-center align-items-center\">\n\t\t\t\t\t<button className=\"btn btn-danger\" onClick={nav.resetAll}>重启网页</button>\n\t\t\t\t</div>\n\n                <div>Load Uqs 发生错误：</div>\n                {errors.errors.map((r, i) => <div key={i}>{r}</div>)}\n            </div>\n        </Page>;\n    }\n}\n\nexport class VStartError extends VPage<CAppBase> {\n    async open(error:any) {\n        this.openPage(this.page, {error:error});\n    }\n\n    private page = ({error}:{error:any}) => {\n        return <Page header=\"App start error!\">\n            <pre>\n                {typeof error === 'string'? error : error.message}\n            </pre>\n        </Page>;\n    }\n}","import { nav, t, setGlobalRes, RouteFunc, Hooks, Navigo, NamedRoute } from \"../components\";\nimport { Controller } from '../vm';\nimport { UQsMan, TVs } from \"../uq\";\nimport { appInFrame } from \"../net\";\nimport { centerApi } from \"./centerApi\";\nimport { VUnitSelect, VErrorsPage, VStartError, VUnsupportedUnit } from \"./vMain\";\n\nexport interface IConstructor<T> {\n    new (...args: any[]): T;\n}\n\nexport interface AppConfig {\n    appName: string;        // 格式: owner/appName\n    version: string;        // 版本变化，缓存的uqs才会重载\n    tvs: TVs;\n    uqNameMap?: {[uqName:string]: string};      // uqName='owner/uq' 映射到内存简单名字：uq, 可以注明映射，也可以自动。有可能重\n    loginTop?: JSX.Element;\n    oem?: string;               // 用户注册发送验证码的oem厂家，默认同花\n\tprivacy?: string;\n\tnoUnit?: boolean;\t\t\t// app的运行，不跟unit绑定\n\thtmlTitle?: string;\n}\n\nexport interface Elements {\n\t[id:string]: (element: HTMLElement)=>void,\n}\n\nexport abstract class CAppBase extends Controller {\n\tprivate appConfig: AppConfig;\n    protected _uqs: any;\n\n    protected readonly name: string;\n\t//protected readonly version: string;\n\tprotected readonly noUnit: boolean;\n\n    //readonly uqsMan: UQsMan;\n    appUnits:any[];\n\n    // appName: owner/name\n    constructor(config?: AppConfig) {\n\t\tsuper(undefined);\n\t\tthis.appConfig = config || (nav.navSettings as AppConfig);\n        let {appName, noUnit} = this.appConfig;\n        this.name = appName;\n        if (appName === undefined) {\n            throw new Error('appName like \"owner/app\" must be defined in MainConfig');\n        }\n\t\tthis.noUnit = noUnit;\n\t\t//this._uqs = UQsMan._uqs;\n\t\t//this.version = version;\n        //this.uqsMan = new UQsMan(this.name, tvs);\n    }\n\n    get uqs(): any {return this._uqs;}\n\n\tinternalT(str:string):any {\n\t\treturn t(str);\n\t}\n\t\n\tprotected setRes(res:any) {\n\t\tsetGlobalRes(res);\n\t}\n\t\n\tprotected hookElements(elements: Elements) {\n\t\tif (elements === undefined) return;\n\t\t//nav.setSettings(appConfig);\n\t\t//let cApp:CApp = (await start(CApp, appConfig)) as CApp;\n\t\tfor (let i in elements) {\n\t\t\tlet el = document.getElementById(i);\n\t\t\tif (el) {\n\t\t\t\telements[i](el);\n\t\t\t}\n\t\t}\n\t};\n\t\n    protected async beforeStart():Promise<boolean> {\n        try {\n\t\t\tthis.onRoute();\n\t\t\tif (nav.isRouting === false) {\n\t\t\t\t//await nav.init();\n\t\t\t\tlet {appName, version, tvs} = this.appConfig;\n\t\t\t\tawait UQsMan.load(appName, version, tvs);\n\t\t\t}\n\t\t\tthis._uqs = UQsMan._uqs;\n\t\t\n            //let retErrors = await this.load();\n            //let app = await loadAppUqs(this.appOwner, this.appName);\n            // if (isDevelopment === true) {\n\t\t\t// 这段代码原本打算只是在程序员调试方式下使用，实际上，也可以开放给普通用户，production方式下\n\t\t\tlet retErrors = UQsMan.errors;\n            let {predefinedUnit} = appInFrame;\n            let {user} = nav;\n            if (user !== undefined && user.id > 0) {\n\t\t\t\tthis.appUnits = await centerApi.userAppUnits(UQsMan.value.id);\n\t\t\t\tif (this.noUnit === true) return true;\n                switch (this.appUnits.length) {\n                    case 0:\n                        this.showUnsupport(predefinedUnit);\n\t\t\t\t\t\treturn false;\n                    case 1:\n                        let appUnit = this.appUnits[0].id;\n                        if (appUnit === undefined || appUnit < 0 || \n                            (predefinedUnit !== undefined && appUnit !== predefinedUnit))\n                        {\n                            this.showUnsupport(predefinedUnit);\n                            return false;\n                        }\n                        appInFrame.unit = appUnit;\n                        break;\n                    default:\n                        if (predefinedUnit>0 && this.appUnits.find(v => v.id===predefinedUnit) !== undefined) {\n                            appInFrame.unit = predefinedUnit;\n                            break;\n                        }\n                        this.openVPage(VUnitSelect);\n                        return false;\n                }\n            }\n            if (retErrors !== undefined) {\n                this.openVPage(VErrorsPage, retErrors);\n                return false;\n            }\n            return true;\n        }\n        catch (err) {\n            this.openVPage(VStartError, err);\n            return false;\n        }\n    }\n\tprotected async afterStart():Promise<void> {\n\t\tnav.resolveRoute();\n\t}\n\n    async userFromId(userId:number):Promise<any> {\n        return await centerApi.userFromId(userId);\n    }\n\n\tprotected on(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\tprotected on(...args:any[]):Navigo {\n\t\treturn nav.on(args[0], args[1], args[2]);\n\t}\n\n\tprotected onRoute() {\n\t}\n\n\t/*\n    private async load(): Promise<string[]> {\n        let {appOwner, appName} = this.uqsMan;\n        let {localData} = this.uqsMan;\n        let uqAppData:UqAppData = localData.get();\n        if (!uqAppData || uqAppData.version !== this.version) {\n\t\t\tuqAppData = await loadAppUqs(appOwner, appName);\n\t\t\tif (!uqAppData.id) {\n\t\t\t\treturn [\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\n\t\t\t\t];\n\t\t\t}\n            uqAppData.version = this.version;\n            localData.set(uqAppData);\n            // \n            for (let uq of uqAppData.uqs) uq.newVersion = true;\n        }\n        let {id, uqs} = uqAppData;\n        this.uqsMan.id = id;\n        await this.uqsMan.init(uqs);\n        let retErrors = await this.uqsMan.load();\n        if (retErrors.length === 0) {\n            retErrors.push(...this.uqsMan.setTuidImportsLocal());\n            if (retErrors.length === 0) {\n                this._uqs = this.uqsMan.buildUQs();\n                return;\n            }\n        }\n        return retErrors;\n\t}\n\t*/\n\n    private showUnsupport(predefinedUnit: number) {\n        nav.clear();\n        this.openVPage(VUnsupportedUnit, predefinedUnit);\n    }\n}\n","import { AppConfig, CAppBase } from './CAppBase';\n\nexport async function start(CApp: new (config: AppConfig) => CAppBase, appConfig: AppConfig, isUserLogin?:boolean) {\t\n\tlet {htmlTitle} = appConfig;\n\tif (htmlTitle) {\n\t\tdocument.title = htmlTitle;\n\t}\n\tlet html = document.getElementsByTagName('html');\n\tlet html0 = html[0];\n\tif (html0) {\n\t\tlet version = html0?.getAttribute('data-version');\n\t\tif (version) appConfig.version = version;\n\t}\n\n\tlet cApp = new CApp(appConfig);\n    await cApp.start(isUserLogin);\n}\n","import { Controller } from \"../vm\";\nimport { IConstructor } from \"./CAppBase\";\n\nexport abstract class CBase extends Controller {\n    protected readonly _uqs: any;\n    protected readonly _cApp: any;\n\n    constructor(cApp: any) {\n        super(cApp.res);\n        this._cApp = cApp;\n        this._uqs = cApp && cApp.uqs;\n\t}\n\n    protected get uqs(): any {return this._uqs}\n\tget cApp(): any {return this._cApp}\n\n\tinternalT(str:string):any {\n\t\tlet r = super.internalT(str);\n\t\tif (r!==undefined) return r;\n\t\treturn this._cApp.internalT(str);\n\t}\n\n    protected newC<T extends CBase>(type: IConstructor<T>, param?:any):T {\n\t\tlet c = new type(this.cApp);\n\t\tc.init(param);\n\t\treturn c;\n    }\n\n    protected newSub<O extends CBase, T extends CSub<O>>(type: IConstructor<T>, param?:any):T {\n\t\tlet s = new type(this);\n\t\ts.init(param);\n\t\treturn s;\n    }\n}\n\nexport abstract class CSub<T extends CBase> extends CBase {\n    protected _owner: T;\n\n    constructor(owner: T) {\n        super(owner.cApp);\n        this._owner = owner;\n\t}\n\n\tinternalT(str:string):any {\n\t\tlet r = super.internalT(str);\n\t\tif (r!==undefined) return r;\n\t\treturn this._owner.internalT(str);\n\t}\n\n    protected get owner(): CBase {return this._owner}\n}\n","import * as React from 'react';\nimport { IObservableArray, computed } from 'mobx';\nimport { PageItems } from '../../tool/pageItems';\nimport {List} from './index';\n\nexport abstract class ListBase {\n    protected list: List;\n    constructor(list: List) {\n        this.list = list;\n    }\n    get isPaged():boolean {\n        let items = this.list.props.items;\n        return (items !== null && items !== undefined && Array.isArray(items) === false);\n    }\n    get items():any[]|IObservableArray<any> {\n        let items = this.list.props.items;\n        if (items === null) return null;\n        if (items === undefined) return undefined;\n        if (Array.isArray(items) === true)\n            return items as IObservableArray<any>;\n        else\n            return (items as PageItems<any>).items;\n    }\n    @computed get loading():boolean {\n        let items = this.list.props.items;\n        if (items === null) return false;\n        if (items === undefined) return true;\n        let pageItems = items as PageItems<any>;\n        if (pageItems.items === undefined) return false;\n        return pageItems.loading;\n    }\n    get selectedItems():any[] { return undefined; }\n    //updateProps(nextProps:any) {}\n    dispose() {};\n    abstract render: (item:any, index:number) => JSX.Element;\n    protected renderContent(item:any, index:number) {\n        let {render} = this.list.props.item;\n        if (render === undefined) return <div className=\"px-3 py-2\">{JSON.stringify(item)}</div>;\n        return render(item, index);\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {ListBase} from './base';\n\nexport class Clickable extends ListBase {\n    render = (item:any, index:number):JSX.Element => {\n        let {className, key, onClick} = this.list.props.item;\n        return <li key={key===undefined?index:key(item)} className={classNames('va-row-clickable', className)} onClick={()=>onClick && onClick(item)}>\n            {this.renderContent(item, index)}\n        </li>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { ListBase } from './base';\nimport { uid } from '../../tool/uid';\n\nexport class Static extends ListBase {\n    render = (item:any, index:number):JSX.Element => {\n        let {className, key} = this.list.props.item;\n        if (typeof item === 'string') {\n            let cn = classNames('va-list-gap', 'px-3', 'pt-1');\n            return <li key={uid()} className={cn}>{item}</li>;\n        }\n        return <li key={key===undefined?index:key(item)} className={classNames(className)}>\n            {this.renderContent(item, index)}\n        </li>\n    }\n}\n","import * as React from 'react';\nimport {observable, IObservableArray, isObservableArray, observe} from 'mobx';\nimport classNames from 'classnames';\nimport {ListBase} from './base';\nimport {uid} from '../../tool/uid';\nimport { PageItems } from '../../tool/pageItems';\nimport { List } from './index';\nimport { observer } from 'mobx-react';\n\nexport interface SelectableItem {\n    selected: boolean;\n    item: any;\n    labelId: string;\n}\n\nexport class Selectable extends ListBase {\n    @observable private _items: SelectableItem[];\n    private inputItems:{[uid:string]: HTMLInputElement} = {};\n\n    constructor(list: List) {\n        super(list);\n        this.buildItems();\n        this.listenArraySplice();\n    }    \n\n    private listenArraySplice() {\n        let {items} = this.list.props;\n        if (items === undefined) return;\n        if (items === null) return;\n        let itemsArray:any;\n        if (Array.isArray(items) === true) {\n            itemsArray = items as any;\n        }\n        else {\n            itemsArray = (items as PageItems<any>).items;\n        }\n        if (isObservableArray(items) === true) {\n            observe(itemsArray as IObservableArray<any>, (change) => {                \n                if (change.type === 'splice') {\n                    let {index, removedCount, added} = change;\n                    let _added = added && added.map(v => {\n                        return {\n                            selected: false, \n                            item: v, \n                            labelId:uid()\n                        }\n                    });\n                    this._items.splice(index, removedCount, ..._added);\n                    this.buildItems();\n                }\n            }, true);\n        }\n    }\n\n    private buildItems = () => {\n        let {items, isItemSelected, selectedItems, compare} = this.list.props;\n        let itemsArray:any[] | IObservableArray<any>;\n        if (items === undefined) {\n            this._items = undefined;\n            return;\n        }\n        if (items === null) {\n            this._items = null;\n            return;\n        }\n        \n        if (Array.isArray(items) === true) {\n            itemsArray = items as any;\n        }\n        else {\n            itemsArray = (items as PageItems<any>).items;\n        }\n\n\t\tif (isItemSelected) {\n\t\t\tlet retItems = itemsArray.map(v => {\n\t\t\t\treturn {\n\t\t\t\t\tselected: isItemSelected(v),\n\t\t\t\t\titem: v, \n\t\t\t\t\tlabelId:uid()\n\t\t\t\t};\n\t\t\t});\n\t\t\tthis._items = retItems;\n\t\t}\n\t\telse {\n\t\t\tlet comp: ((item:any, selectItem:any)=>boolean);\n\t\t\tif (compare === undefined) {\n\t\t\t\tcomp = (item:any, selectItem:any) => item === selectItem;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcomp = compare;\n\t\t\t}\n\t\t\tlet retItems = itemsArray.map(v => {\n\t\t\t\t//let isObserved = isObservable(v);\n\t\t\t\t//let obj = isObserved === true? toJS(v) : v;\n\t\t\t\t//let obj = v;\n\t\t\t\tlet selected = selectedItems === undefined?\n\t\t\t\t\tfalse\n\t\t\t\t\t: selectedItems.find(si => comp(v, si)) !== undefined;\n\t\t\t\treturn {\n\t\t\t\t\tselected: selected, \n\t\t\t\t\titem: v, \n\t\t\t\t\tlabelId:uid()\n\t\t\t\t};\n\t\t\t});\n\t\t\tthis._items = retItems;\n\t\t}\n    }\n\n    get items() {\n        //if (this._items === undefined) \n        //this.buildItems();\n        return this._items;\n    }\n    private checkAll(on: boolean) {\n        for (let i in this.inputItems) this.inputItems[i].checked = on;\n        for (let item of this._items) item.selected = on;\n    }\n    selectAll() {\n        //if (this._items) this._items.forEach(v => v.selected = true);\n        this.checkAll(true);\n        this.list.props.item.onSelect(undefined, true, this.anySelected);\n    }\n    unselectAll() {\n        // if (this._items) this._items.forEach(v => v.selected = false);\n        this.checkAll(false);\n        this.list.props.item.onSelect(undefined, false, this.anySelected);\n    }\n    /*\n    updateProps(nextProps:any) {\n        if (nextProps.selectedItems === this._selectedItems) return;\n        this.buildItems();\n    }\n    */\n    private get anySelected():boolean {return this._items.some(v => v.selected)}\n    private onSelect(item:SelectableItem, selected:boolean) {\n        item.selected = selected;\n        this.list.props.item.onSelect(item.item, selected, this.anySelected);\n    }\n    \n    get selectedItems():any[] {\n        return this._items.filter(v => v.selected === true).map(v => v.item);\n    }\n    /*\n    set selectedItems(value: any[]) {\n        if (value === undefined) return;\n        if (this._items === undefined) return;\n        let sLen = this._items.length;\n        let list = value.slice();\n        for (let n=0; n<sLen; n++) {\n            let sItem = this._items[n];\n            let len = list.length;\n            if (len === 0) break;\n            let item = sItem.item;\n            for (let i=0; i<len; i++) {\n                let v = list[i];\n                if (item === v) {\n                    sItem.selected = true;\n                    value.splice(i, 1);\n                    break;\n                }\n            }\n        };\n    }\n    */\n    //w-100 mb-0 pl-3\n    //m-0 w-100\n    render = (item:SelectableItem, index:number):JSX.Element => {\n        let {key} = this.list.props.item;\n\t\treturn React.createElement(this.row, {item, index, key:key===undefined?index:key(item)});\n    }\n\n    private row = observer((props: {item:SelectableItem, index:number}):JSX.Element => {\n        let {item, index} = props;\n        let {className} = this.list.props.item;\n        let {labelId, selected, item:obItem} = item;\n        return <li className={classNames(className)}>\n            <div className=\"d-flex align-items-center px-3\">\n                <input ref={input=>{if (input) this.inputItems[labelId] = input;}}\n                    className=\"\" type=\"checkbox\" value=\"\" id={labelId}\n                    defaultChecked={selected}\n                    onChange={(e)=>{\n                        this.onSelect(item, e.target.checked)} \n                    }/>\n                <label className=\"\" style={{flex:1, marginBottom:0}} htmlFor={labelId}>\n                    {this.renderContent(obItem, index)}\n                </label>\n            </div>\n        </li>\n    })\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {observer} from 'mobx-react';\nimport _ from 'lodash';\nimport {PageItems} from '../../tool/pageItems';\nimport {ListBase} from './base';\nimport {Clickable} from './clickable';\nimport {Static} from './static';\nimport {Selectable} from './selectable';\nimport '../../css/va-list.css';\nimport { IObservableArray } from 'mobx';\nimport { resLang } from '../../res/res';\nimport { ListRes, listRes } from '../../res';\n\ntype StaticRow = string|JSX.Element|(()=>string|JSX.Element);\ninterface ItemProps {\n\tclassName?: string|string[];\n\trender?: (item:any, index:number) => JSX.Element;\n\tonSelect?: (item:any, isSelected:boolean, anySelected:boolean)=>void;\n\tonClick?: (item:any)=>void;\n\tkey?: (item:any)=>string|number;\n}\n\nexport interface ListProps {\n    className?: string|string[];\n    items: any[] | IObservableArray<any> | PageItems<any>;\n    item: ItemProps;\n\tisItemSelected?: (item:any) => boolean;\n    compare?: (item:any, selectItem:any) => boolean;\n\tselectedItems?:any[];\n    header?: StaticRow;\n    footer?: StaticRow;\n    before?: StaticRow;\n    loading?: StaticRow;\n\tnone?: StaticRow;\n\tonFocus?: (evt: React.FocusEvent<HTMLUListElement>)=>void;\n}\n\n@observer\nexport class List extends React.Component<ListProps> {\n\tprivate static res:ListRes = resLang<ListRes>(listRes);\n\n\tprivate listBase: ListBase;\n\tprivate selectable: Selectable;\n    constructor(props:ListProps) {\n\t\tsuper(props);\n        this.buildBase();\n    }\n    _$scroll = (direct: 'top'|'bottom') => {\n        console.log('############### items scroll to ' + direct);\n    }\n    private buildBase() {\n        let {item} = this.props;\n        let {onClick, onSelect} = item;\n        if (onSelect !== undefined)\n            this.selectable = this.listBase = new Selectable(this);\n        else if (onClick !== undefined)\n            this.listBase = new Clickable(this);\n        else\n            this.listBase = new Static(this);\n\t}\n\tcomponentDidUpdate(prevProps: Readonly<ListProps>, prevState: Readonly<any>) {\n\t\tif (_.isEqual(this.props.item, prevProps.item) === false) {\n\t\t\tthis.buildBase();\n\t\t\tthis.forceUpdate();\n\t\t}\n\t}\n    componentWillUnmount() {\n        this.listBase.dispose();\n    }\n    selectAll() {\n        if (this.selectable) this.selectable.selectAll();\n    }\n    unselectAll() {\n        if (this.selectable) this.selectable.unselectAll();\n    }\n    get selectedItems():any[] {\n        return this.listBase.selectedItems;\n    }\n    render() {\n        let {className, header, footer, before, loading, none, onFocus} = this.props;\n        if (before === undefined) before = '-';\n        if (loading === undefined) loading = () => <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />;\n        if (none === undefined) none = List.res.none;\n        //this.listBase.selectedItems = selectedItems;\n        let {items, loading:isLoading} = this.listBase;\n        function staticRow(row:StaticRow, type:string) {\n            if (!row) return;\n            switch (typeof row) {\n                default:\n                case 'string': return <li className={\"va-list-\"+type}>{row}</li>;\n                case 'function': return <li className={\"va-list-\"+type}>{(row as ()=>string|JSX.Element)()}</li>;\n                case 'object': return <li>{row}</li>\n            } \n        }\n        let content:any, waitingMore:any;\n        if (items === null)\n            content = staticRow(before, 'before');\n        else if (items === undefined)\n            content = staticRow(loading, 'loading');\n        else if (items.length === 0)\n            content = staticRow(none, 'none');\n        else {\n            content = items.map((item, index) => {\n                return this.listBase.render(item, index);\n            });\n        }\n        if (isLoading === true && items) {\n            waitingMore = staticRow(loading, 'loading');\n\t\t}\n\t\tlet tabIndex:number;\n\t\tif (onFocus !== undefined) tabIndex = -1;\n        return <ul className={classNames('va-list', className)} onFocus={onFocus} tabIndex={tabIndex}>\n            {staticRow(header, 'header')}\n            {content}\n            {waitingMore}\n            {staticRow(footer, 'footer')}\n        </ul>;\n    }\n}\n","import * as React from 'react';\nimport className from 'classnames';\nimport {PropGridProps} from './PropGrid';\nimport {LabeledProp, StringProp, NumberProp, ListProp, ComponentProp} from './propView';\n\nexport abstract class PropRow {\n    setValues(values: any) {}\n    abstract render(key:string): any;\n}\n\nexport class PropBorder extends PropRow {\n    render(key:string): JSX.Element {\n        return <div key={'_b_' + key} className=\"\">\n            <div className=\"w-100\">\n                <div style={{borderTop: '1px solid #f0f0f0'}} />\n            </div>\n        </div>;\n    }\n}\n\nexport class PropGap extends PropRow {\n    private param: string;\n    constructor(param?: string) {\n        super();\n        this.param = param;\n    }\n    render(key:string): JSX.Element {\n        let w: string;\n        switch (this.param) {\n            default: w = 'py-2'; break;\n            case '=': w = 'py-1'; break;\n            case '-': w = 'pb-1'; break;\n        }\n        let cn = className(w);\n        return <div key={'_g_' + key} className={cn} />;\n    }\n}\n\nconst valueAlignStart = 'justify-content-start';\nconst valueAlignCenter = 'justify-content-center';\nconst valueAlignEnd = 'justify-content-end';\nexport abstract class LabeledPropRow extends PropRow {\n    protected gridProps: PropGridProps;\n    protected _prop: LabeledProp;\n    protected get prop():LabeledProp {return this._prop}\n    protected content: any;\n    protected col: string;\n    //protected values: any;\n    constructor(gridProps:PropGridProps, prop: LabeledProp) {\n        super();\n        this.gridProps = gridProps;\n        this._prop = prop;\n        this.col = gridProps.labelFixLeft === true? 'col' : 'col-sm';\n        //this.values = values;\n    }\n    render(key:string):any {\n        let {onClick, bk} = this.prop;\n        let cn = className({\n            \"cursor-pointer\": onClick !== undefined,\n            \"bg-white\": bk === undefined, \n            \"row\": true\n        });\n        return <div key={key} className={cn} onClick={onClick}>\n            {this.renderLabel()}\n            {this.renderProp()}\n        </div>;\n    }\n    protected renderLabel():any {\n        let {label} = this.prop;\n        if (label === undefined) return null;\n        return <label className={this.col + '-3 col-form-label'}>\n            {label}\n        </label>;\n    }\n    protected renderProp():any {\n        let {label} = this.prop;\n        let align, vAlign;\n        switch (this.gridProps.alignValue) {\n            case 'left': align = valueAlignStart; break;\n            case 'center': align = valueAlignCenter; break;\n            case 'right': align = valueAlignEnd; break;\n        }\n        switch (this.prop.vAlign) {\n            case 'top': vAlign = 'align-items-start'; break;\n            default:\n            case 'center': vAlign = 'align-items-center'; break;\n            case 'bottom': vAlign = 'align-items-end'; break;\n            case 'stretch': vAlign = 'align-items-stretch'; break;\n        }\n        let col:string = this.col + (label===undefined? '-12':'-9');\n        let cn = className(align, vAlign, col, 'd-flex');\n        return <div className={cn}>\n            {this.renderPropBody()}\n        </div>;\n    }\n    protected renderPropBody():any {\n        return <div className=\"form-control-plaintext\">\n            {this.renderPropContent()}\n        </div>;\n    }\n    protected renderPropContent():any {\n        return this.content;\n    }\n}\n\nexport class StringPropRow extends LabeledPropRow {\n    protected get prop(): StringProp {return this._prop as StringProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else this.content = values[this.prop.name];\n    }\n}\n\nexport class NumberPropRow extends LabeledPropRow {\n    protected get prop(): NumberProp {return this._prop as NumberProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else this.content = values[this.prop.name];\n    }\n}\n\nexport class ListPropRow extends LabeledPropRow {\n    protected get prop(): ListProp {return this._prop as ListProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else {\n            let list = this.prop.list;\n            if (typeof list === 'string') this.content = values[list];\n            else this.content = undefined;\n        }\n    }\n    protected renderPropBody() {\n        let {list, row} = this.prop;\n        let items:any[] = typeof list === 'string'? this.content : list;\n        if (items === undefined) return <div/>;\n        // new row(item)\n        return <div className=\"w-100\">\n            {\n                items.map((item, index) => <React.Fragment key={index}>\n                    {index===0? null: <div style={{width:'100%', borderBottom:'1px solid #f0f0f0'}} />}\n                    {React.createElement(row, item)}\n                </React.Fragment>)\n            }\n        </div>;\n    }\n}\n\nexport class ComponentPropRow extends LabeledPropRow {\n    protected get prop(): ComponentProp {return this._prop as ComponentProp;}\n    protected renderPropBody() {\n        let {component} = this.prop;\n        return component;\n    }\n    protected renderProp():any {\n        let {label, full} = this.prop;\n        let align, vAlign;\n        switch (this.gridProps.alignValue) {\n            case 'left': align = valueAlignStart; break;\n            case 'center': align = valueAlignCenter; break;\n            case 'right': align = valueAlignEnd; break;\n        }\n        switch (this.prop.vAlign) {\n            case 'top': vAlign = 'align-items-start'; break;\n            default:\n            case 'center': vAlign = 'align-items-center'; break;\n            case 'bottom': vAlign = 'align-items-end'; break;\n            case 'stretch': vAlign = 'align-items-stretch'; break;\n        }\n        let col:string;\n        if (full !== true)\n            col = this.col + (label===undefined? '-12':'-9');\n        else\n            col = 'w-100';\n        let cn = className(align, vAlign, col, 'd-flex');\n        return <div className={cn}>\n            {this.renderPropBody()}\n        </div>;\n    }\n}\n","import { PropGridProps } from './PropGrid';\nimport {\n    PropRow, PropBorder, PropGap, \n    StringPropRow, NumberPropRow, ListPropRow, ComponentPropRow\n} from './row';\n\nexport interface Format {\n\n}\n\nexport interface PropBase {\n    onClick?: () => void;\n}\n\nexport interface LabeledProp extends PropBase {\n    label?: string;\n    bk?: string;\n    vAlign?: 'top' | 'bottom' | 'center' | 'stretch';\n}\n\nexport interface StringProp extends LabeledProp {\n    type: 'string';\n    name: string;\n}\n\nexport interface NumberProp extends LabeledProp {\n    type: 'number';\n    name: string;\n}\n\nexport interface FormatProp extends LabeledProp {\n    type: 'format';\n    format: Format;\n}\n\nexport interface ListProp extends LabeledProp {\n    type: 'list';\n    list: string | any[];  // string 表示名字，否则就是值\n    row: new (props: any) => React.Component;\n}\n\nexport interface ComponentProp extends LabeledProp {\n    type: 'component';\n    full?: boolean;\n    component: any; //JSX.Element;\n}\n\nexport type Prop = StringProp | NumberProp | FormatProp | ListProp | ComponentProp | string;\n\nexport class PropView {\n    private gridProps: PropGridProps\n    private props: Prop[];\n    //private values:any;\n    private rows: PropRow[];\n\n    constructor(gridProps: PropGridProps, props: Prop[]) {\n        this.gridProps = gridProps;\n        this.props = props;\n        //this.values = values;\n        this.buildRows();\n    }\n\n    private buildRows() {\n        this.rows = [];\n        let isGap: boolean = true;\n        for (let prop of this.props) {\n            if (typeof prop === 'string') {\n                this.rows.push(new PropGap(prop));\n                isGap = true;\n            }\n            else {\n                if (!isGap) this.rows.push(new PropBorder());\n                let row;\n                switch (prop.type) {\n                    default: continue;\n                    case 'string': row = new StringPropRow(this.gridProps, prop); break;\n                    case 'number': row = new NumberPropRow(this.gridProps, prop); break;\n                    case 'list': row = new ListPropRow(this.gridProps, prop); break;\n                    case 'component': row = new ComponentPropRow(this.gridProps, prop); break;\n                }\n                this.rows.push(row);\n                isGap = false;\n            }\n        }\n    }\n\n    setValues(values: any) {\n        for (let r of this.rows) r.setValues(values);\n    }\n\n    render() {\n        return this.rows.map((row, index) => row.render(String(index)));\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {observer} from 'mobx-react';\nimport {Prop, PropView} from './propView';\n\nexport interface PropGridProps {\n    className?: string;\n    rows: Prop[];\n    values: any;\n    alignValue?: 'left'|'center'|'right';\n    labelFixLeft?: boolean;\n}\n\n@observer\nexport class PropGrid extends React.Component<PropGridProps> {\n    render() {\n        let {className, rows, values} = this.props;\n        let propView = new PropView(this.props, rows);\n        propView.setValues(values);\n        let cn = classNames('container-fluid', className);\n        return <div className={cn}>\n            {propView.render()}\n        </div>;\n    }\n}\n","import { observable } from 'mobx';\nimport { isNumber } from 'util';\nimport _ from 'lodash';\nimport { LocalArr } from '../../tool';\nimport { BoxId } from './boxId';\nimport { TuidInner, TuidDiv } from './tuid';\n\nconst maxCacheSize = 1000;\n\nexport class IdCache {\n    private queue: number[] = [];               // 每次使用，都排到队头\n\tprivate cache = observable.map({}, {deep: false});    // 已经缓冲的\n\tprivate loading:boolean = false;\n\n    protected localArr:LocalArr;\n    protected waitingIds: number[] = [];          // 等待loading的\n    protected tuidInner: TuidInner;\n\n    constructor(tuidLocal: TuidInner) {\n        this.tuidInner = tuidLocal;\n        this.initLocalArr();\n    }\n\n    protected initLocalArr() {\n        this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\n    }\n\n    useId(id:number, defer?:boolean) {\n        if (!id) return;\n        if (isNumber(id) === false) return;\n        if (this.cache.has(id) === true) {\n            this.moveToHead(id);\n            return;\n        }\n        this.tuidInner.cacheTuids(defer===true?70:20);\n        this.cache.set(id, id);\n        if (this.waitingIds.findIndex(v => v === id) >= 0) {\n            this.moveToHead(id);\n            return;\n        }\n\n        if (this.queue.length >= maxCacheSize) {\n            // 缓冲已满，先去掉最不常用的\n            let r = this.queue.shift();\n            if (r === id) {\n                // 如果移除的，正好是现在用的，则插入\n                this.queue.push(r);\n                return;\n            }\n\n            //let rKey = String(r);\n            if (this.cache.has(r) === true) {\n                // 如果移除r已经缓存\n                this.cache.delete(r);\n            }\n            else {\n                // 如果移除r还没有缓存\n                let index = this.waitingIds.findIndex(v => v === r);\n                this.waitingIds.splice(index, 1);\n            }\n        }\n        this.waitingIds.push(id);\n        this.queue.push(id);\n        return;\n    }\n\n    private moveToHead(id:number) {\n        let index = this.queue.findIndex(v => v === id);\n        this.queue.splice(index, 1);\n        this.queue.push(id);\n    }\n\n    getValue(id:number) {\n        return this.cache.get(id);\n    }\n\n    remove(id:number) {\n        this.cache.delete(id);\n        let index = this.queue.findIndex(v => v === id);\n\t\tthis.queue.splice(index, 1);\n\t\tthis.localArr.removeItem(id);\n    }\n\n    valueFromId(id:number|BoxId):any {\n        let _id:number;\n        switch (typeof id) {\n            case 'object': _id = (id as BoxId).id; break;\n            case 'number': _id = id as number; break;\n            default: return;\n        }\n        return this.getValue(_id);\n    }\n\n    resetCache(id:number) {\n        this.remove(id);\n        this.useId(id);\n    }\n\n    cacheValue(val:any):boolean {\n        if (val === undefined) return false;\n        let id = this.getIdFromObj(val);\n        if (id === undefined) return false;\n        let index = this.waitingIds.findIndex(v => v === id);\n        if (index>=0) this.waitingIds.splice(index, 1);\n        this.cache.set(id, val);\n        return true;\n    }\n    protected getIdFromObj(val:any) {return this.tuidInner.getIdFromObj(val)}\n\n    async cacheIds():Promise<void> {\n        if (this.waitingIds.length === 0) return;\n\t\tlet tuidValues = await this.loadIds();\n\t\tif (tuidValues === undefined || tuidValues.length === 0) {\n\t\t\tthis.waitingIds.splice(0, this.waitingIds.length);\n\t\t\treturn;\n\t\t}\n        this.cacheIdValues(tuidValues);\n    }\n\n    private cacheIdValues(tuidValues: any[]) {\n        if (tuidValues === undefined) return;\n        let tuids = this.unpackTuidIds(tuidValues);\n        for (let tuidValue of tuids) {\n            if (this.cacheValue(tuidValue) === false) continue;\n            this.cacheTuidFieldValues(tuidValue);\n        }\n    }\n    async modifyIds(ids:any[]):Promise<void> {\n        let tuidValues:string[] = await this.loadTuidIdsOrLocal(ids);\n        let localedValues = tuidValues.filter(v => {\n            let p = v.indexOf('\\t');\n            if (p<0) p = v.length;\n            let id = Number(v.substr(0, p));\n            let val = this.localArr.getItem(id);\n            return (val !== undefined);\n        });\n        if (localedValues.length === 0) return;\n        this.cacheIdValues(localedValues);\n    }\n    protected divName:string = undefined;\n    protected async loadIds(): Promise<any[]> {\n\t\tif (this.loading === true) return;\n\t\tthis.loading = true;\n\t\tlet ret = await this.loadTuidIdsOrLocal(this.waitingIds);\n\t\tthis.loading = false;\n        return ret;\n    }\n    protected unpackTuidIds(values:string[]):any[] {\n        return this.tuidInner.unpackTuidIds(values);\n    }\n    protected cacheTuidFieldValues(tuidValue: any) {\n        this.tuidInner.cacheTuidFieldValues(tuidValue);\n    }\n\n    async assureObj(id:number):Promise<void> {\n        let val = this.cache.get(id);\n        switch (typeof val) {\n            case 'object': return val;\n            case 'number': this.cache.set(id, id); break;\n        }\n        let ret = await this.loadTuidIdsOrLocal([id]);\n        this.cacheIdValues(ret);\n    }\n\n    private async loadTuidIdsOrLocal(ids:number[]):Promise<string[]> {\n        let ret:string[] = [];        \n        let netIds:number[] = [];\n        for (let id of ids) {\n            let value = this.localArr.getItem(id);\n            //if (value === undefined)\n            // 值不存在或者是空字符串，重新获取\n            if (!value)\n                netIds.push(id);\n            else\n                ret.push(value);\n        }\n        let len = netIds.length;\n        if (len > 0) {\n            let netRet = await this.tuidInner.loadTuidIds(this.divName, netIds);\n            for (let i=0; i<len; i++) {\n                //有些id可能没有内容，不会返回\n                //let id = netIds[i]; \n                let row:string = netRet[i];\n                if (!row) continue;\n                let p = row.indexOf('\\t');\n                if (p < 0) p = row.length;\n                let id = Number(row.substr(0, p));\n\t\t\t\t_.remove(netIds, v => v === id);\n                ret.push(row);\n                this.localArr.setItem(id, row);\n            }\n            len = netIds.length;\n            for (let i=0; i<len; i++) {\n                this.localArr.setItem(netIds[i], '');\n            }\n        }\n        return ret;\n    }\n}\n\nexport class IdDivCache extends IdCache {\n    private div: TuidDiv;\n    protected divName:string;\n\n    constructor(tuidLocal:TuidInner, div: TuidDiv) {\n        super(tuidLocal);\n        this.div = div;\n        this.divName = div.name;\n        this.localArr = tuidLocal.cache.arr(tuidLocal.name + '.ids.' + this.divName);\n    }\n\n    protected initLocalArr() {\n        // 这个不需要，必须去掉\n        // this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\n    }\n\n    protected getIdFromObj(val:any) {return this.div.getIdFromObj(val)}\n    protected unpackTuidIds(values:string[]):any[] {\n        return this.div.unpackTuidIds(values);\n    }\n    protected cacheTuidFieldValues(tuidValue: any) {\n        this.div.cacheTuidFieldValues(tuidValue);\n    }\n\n    /*\n    async cacheIds():Promise<void> {\n        if (this.waitingIds.length === 0) return;\n        let tuidValues = await this.loadIds();\n        if (tuidValues !== undefined) {\n            let tuids = this.tuidLocal.unpackTuidIds(tuidValues);\n            for (let tuidValue of tuids) {\n                if (this.cacheValue(tuidValue) === false) continue;\n                this.tuidLocal.cacheTuidFieldValues(tuidValue);\n                this.afterCacheValue(tuidValue);\n            }\n        }\n    }\n    */\n}\n","import _ from 'lodash';\nimport { LocalArr } from '../../tool';\nimport { Entity } from '../entity';\nimport { UqMan, ArrFields, Field, SchemaFrom } from '../uqMan';\nimport { EntityCaller } from '../caller';\nimport { BoxId } from './boxId';\nimport { IdCache, IdDivCache } from './idCache';\n\nexport interface TuidSaveResult {\n    id: number;\n    inId: number;\n}\n\nexport interface TuidNOResult {\n\tdate: string;\n\tno: number;\n}\n\nexport abstract class Tuid extends Entity {\n    protected noCache: boolean;\n    readonly typeName:string = 'tuid';\n    protected idName: string;\n    cached: boolean;\n    unique: string[];\n\n    public setSchema(schema:any) {\n        super.setSchema(schema);\n        let {id} = schema;\n        this.idName = id;\n    }\n\n    buildTuidBox(): TuidBox {\n        return new TuidBox(this);\n    }\n\n    getIdFromObj(obj:any):number {return obj[this.idName]}\n    stopCache():void {this.noCache = true}\n    abstract useId(id:number):void;\n    abstract boxId(id:number):BoxId;\n    abstract valueFromId(id:number):any;\n\tabstract resetCache(id:number|BoxId):void;\n    abstract async assureBox<T> (id:number|BoxId): Promise<T>;\n    static equ(id1:BoxId|number, id2:BoxId|number): boolean {\n        if (id1 === undefined) return false;\n        if (id2 === undefined) return false;\n        if (typeof id1 === 'object') {\n            return id1.equ(id2);\n        }\n        if (typeof id2 === 'object') {\n            return id2.equ(id1);\n        }\n        return id1 === id2;\n    }\n    cacheIds() {}\n    async modifyIds(ids:any[]) {}\n    isImport = false;\n    abstract get hasDiv():boolean;// {return this.divs!==undefined}\n    abstract div(name:string):TuidDiv;\n    abstract async loadMain(id:number|BoxId):Promise<any>;\n\tabstract async load(id:number|BoxId):Promise<any>;\n    abstract async all():Promise<any[]>;\n\tabstract async save(id:number, props:any):Promise<TuidSaveResult>;\n\tabstract saveProp(id:number, prop:string, value:any):Promise<void>;\n    abstract async search(key:string, pageStart:string|number, pageSize:number):Promise<any>;\n    abstract async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any>;\n    abstract async loadArr(arr:string, owner:number, id:number):Promise<any>;\n    abstract async saveArr(arr:string, owner:number, id:number, props:any):Promise<void>;\n\tabstract async posArr(arr:string, owner:number, id:number, order:number):Promise<void>;\n\tabstract async no():Promise<TuidNOResult>;\n}\n\nexport class TuidInner extends Tuid {\n    private divs: {[div:string]: TuidDiv};\n    protected cacheFields: Field[];\n    protected idCache: IdCache;\n    protected localArr:LocalArr;\n    constructor(uq:UqMan, name:string, typeId:number) {\n        super(uq, name, typeId);\n        this.idCache = new IdCache(this);\n        this.localArr = this.cache.arr(this.name + '.whole');\n        if (uq.newVersion === true) this.localArr.removeAll();\n    }\n\n    public setSchema(schema:any) {\n        super.setSchema(schema);\n        let {arrs} = schema;\n        if (arrs !== undefined) {\n            this.divs = {};\n            for (let arr of arrs) {\n                let {name} = arr;\n                let tuidDiv = new TuidDiv(this.uq, this, name);\n                this.divs[name] = tuidDiv;\n                tuidDiv.setSchema(arr);\n                tuidDiv.buildFieldsTuid();\n            }\n        }\n    }\n    \n    useId(id:number, defer?:boolean) {\n        if (this.noCache === true) return;\n        if (!id) return;\n        this.idCache.useId(id, defer);\n    }\n    boxId(id:number):BoxId {\n        if (!id) return;\n        if (typeof id === 'object') return id;\n        this.useId(id);\n        let {createBoxId} = this.uq;\n        if (!createBoxId) return {id: id} as BoxId;\n        return createBoxId(this, id);\n    }\n    valueFromId(id:number) {return this.idCache.getValue(id)}\n\tresetCache(id:number|BoxId):void {\n\t\tif (typeof id === 'object') id = id.id;\n\t\tthis.idCache.resetCache(id);\n\t}\n    async assureBox<T> (id:number|BoxId):Promise<T> {\n\t\tif (!id) return;\n\t\tif (typeof id === 'object') id = id.id;\n\t\tawait this.idCache.assureObj(id);\n\t\treturn this.idCache.getValue(id);\n    }\n\n    cacheIds() {\n        this.idCache.cacheIds();\n        if (this.divs === undefined) return;\n        for (let i in this.divs) this.divs[i].cacheIds();\n    }\n    async modifyIds(ids:any[]) {\n        await this.idCache.modifyIds(ids);\n    }\n    cacheTuids(defer:number) {this.uq.cacheTuids(defer)}\n    get hasDiv():boolean {return this.divs!==undefined}\n    div(name:string):TuidDiv {\n        return this.divs && this.divs[name];\n    }\n    async loadTuidIds(divName:string, ids:number[]):Promise<any[]> {\n        let ret:any[] = await new IdsCaller(this, {divName:divName, ids:ids}, false).request();\n        if (ret.length > 0) this.cached = true;\n        return ret;\n    }\n    async loadMain(id:number|BoxId):Promise<any> {\n        if (typeof id === 'object') id = id.id;\n        await this.idCache.assureObj(id);\n        return this.idCache.valueFromId(id);\n    }\n    async load(id:number|BoxId):Promise<any> {\n        if (id === undefined || id === 0) return;\n        //let cacheValue = this.idCache.valueFromId(id); \n        //if (typeof cacheValue === 'object') return cacheValue;\n        if (typeof id === 'object') id = id.id;\n        let valuesText = undefined; //this.localArr.getItem(id);\n        let values: any;\n        if (valuesText) {\n            values = JSON.parse(valuesText);\n        }\n        else {\n            values = await new GetCaller(this, id).request();\n            if (values !== undefined) {\n                // this.localArr.setItem(id, JSON.stringify(values));\n            }\n        }\n        if (values === undefined) return;\n        for (let f of this.schema.fields) {\n            let {tuid} = f;\n            if (tuid === undefined) continue;\n            let t = this.uq.getTuid(tuid);\n            if (t === undefined) continue;\n            let n = f.name;\n            values[n] = t.boxId(values[n]);\n        }\n        this.idCache.cacheValue(values);\n        this.cacheTuidFieldValues(values);\n        return values;\n    }\n\n    cacheTuidFieldValues(values:any) {\n        let {fields, arrs} = this.schema;\n        this.cacheFieldsInValue(values, fields);\n        if (arrs !== undefined) {\n            for (let arr of arrs as ArrFields[]) {\n                let {name, fields} = arr;\n                let arrValues = values[name];\n                if (arrValues === undefined) continue;\n                let tuidDiv = this.div(name);\n                for (let row of arrValues) {\n                    //row._$tuid = tuidDiv;\n                    //row.$owner = this.boxId(row.owner);\n                    tuidDiv.cacheValue(row);\n                    this.cacheFieldsInValue(row, fields);\n                }\n            }\n        }\n    }\n\n    public buildFieldsTuid() {\n        super.buildFieldsTuid();\n        let {mainFields, $create, $update, stampOnMain} = this.schema;\n\t\tif (mainFields === undefined) debugger;\n\t\tthis.cacheFields = mainFields || this.fields;\n\t\tif (stampOnMain === true) {\n\t\t\tif ($create === true) this.cacheFields.push({name: '$create', type: 'timestamp', _tuid: undefined});\n\t\t\tif ($update === true) this.cacheFields.push({name: '$update', type: 'timestamp', _tuid: undefined});\n\t\t}\n        this.uq.buildFieldTuid(this.cacheFields);\n    }\n\n    unpackTuidIds(values:string[]):any[] {\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\n    }\n\n    async save(id:number, props:any):Promise<TuidSaveResult> {\n        let ret = await new SaveCaller(this, {id:id, props:props}).request();\n        if (id !== undefined) {\n            this.idCache.remove(id);\n            this.localArr.removeItem(id);\n        }\n        return ret;\n\t}\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\n\t\tawait new SavePropCaller(this, {id, prop, value}).request();\n\t\tthis.idCache.remove(id);\n\t\tawait this.idCache.assureObj(id);\n\t}\n    async all():Promise<any[]> {\n        let ret: any[] = await new AllCaller(this, {}).request();\n        return ret;\n    }\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any[]> {\n        let ret:any[] = await this.searchArr(undefined, key, pageStart, pageSize);\n        return ret;\n    }\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        //let api = this.uqApi;\n        //let ret = await api.tuidSearch(this.name, undefined, owner, key, pageStart, pageSize);\n        let params:any = {arr:undefined, owner:owner, key:key, pageStart:pageStart, pageSize:pageSize};\n        let ret = await new SearchCaller(this, params).request();\n        let {fields} = this.schema;\n        for (let row of ret) {\n            this.cacheFieldsInValue(row, fields);\n        }\n        return ret;\n    }\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\n        if (id === undefined || id === 0) return;\n        //let api = this.uqApi;\n        //return await api.tuidArrGet(this.name, arr, owner, id);\n        return await new LoadArrCaller(this, {arr:arr, owner:owner, id:id}).request();\n    }\n    async saveArr(arr:string, owner:number, id:number, props:any) {\n        //let params = _.clone(props);\n        //params[\"$id\"] = id;\n        //return await this.uqApi.tuidArrSave(this.name, arr, owner, params);\n        return await new SaveArrCaller(this, {arr:arr, owner:owner, id:id, props:props}).request();\n    }\n\n    async posArr(arr:string, owner:number, id:number, order:number) {\n        //return await this.uqApi.tuidArrPos(this.name, arr, owner, id, order);\n        return await new ArrPosCaller(this, {arr:arr, owner:owner, id:id, order:order}).request();\n\t}\n\tasync no():Promise<TuidNOResult> {\n\t\treturn await new TuidNoCaller(this, undefined).request();\n\t}\n}\n\nabstract class TuidCaller<T> extends EntityCaller<T> {\n    protected get entity(): Tuid {return this._entity as Tuid};\n}\n\n// 包含main字段的load id\n// 当前为了兼容，先调用的包含所有字段的内容\nclass GetCaller extends TuidCaller<number> {\n    method = 'GET';\n    get path():string {return `tuid/${this.entity.name}/${this.params}`}\n}\n\nclass IdsCaller extends TuidCaller<{divName:string, ids:number[]}> {\n    get path():string {\n        let {divName} = this.params;\n        return `tuidids/${this.entity.name}/${divName !== undefined?divName:'$'}`;\n    }\n    buildParams():any {return this.params.ids}\n    xresult(res:any):any {\n        return (res as string).split('\\n');\n    }\n}\n\n\nclass SaveCaller extends TuidCaller<{id:number, props:any}> {\n    get path():string {return `tuid/${this.entity.name}`}\n    buildParams():any {\n        let {fields, arrs} = this.entity.schema;\n        let {id, props} = this.params;\n        let params:any = {$id: id};\n        this.transParams(params, props, fields);\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                let arrName = arr.name;\n                let arrParams = [];\n                let arrFields = arr.fields;\n                let arrValues = props[arrName];\n                if (arrValues !== undefined) {\n                    for (let arrValue of arrValues) {\n                        let row = {};\n                        this.transParams(row, arrValue, arrFields);\n                        arrParams.push(row);\n                    }\n                }\n                params[arrName] = arrParams;\n            }\n        }\n        return params;\n    }\n    private transParams(values:any, params:any, fields:Field[]) {\n        if (params === undefined) return;\n        for (let field of fields) {\n            let {name, tuid, type} = field;\n            let val = params[name];\n            if (tuid !== undefined) {\n                if (typeof val === 'object') {\n                    if (val !== null) val = val.id;\n                }\n            }\n            else {\n                switch (type) {\n                    case 'date':\n                        val = this.entity.buildDateParam(val); \n                        //val = (val as string).replace('T', ' ');\n                        //val = (val as string).replace('Z', '');\n                        break;\n                    case 'datetime':\n                        val = this.entity.buildDateTimeParam(val);\n                        //val = new Date(val).toISOString();\n                        //val = (val as string).replace('T', ' ');\n                        //val = (val as string).replace('Z', '');\n                        break;\n                }\n            }\n            values[name] = val;\n        }\n    }\n}\n\nclass SearchCaller extends TuidCaller<{arr:string, owner:number, key:string, pageStart:string|number, pageSize:number}> {\n    get path():string {return `tuids/${this.entity.name}`}\n}\n\nclass AllCaller extends TuidCaller<{}> {\n    method = 'GET';\n    get path():string {return `tuid-all/${this.entity.name}`}\n}\n\nclass LoadArrCaller extends TuidCaller<{arr:string, owner:number, id:number}> {\n    method = 'GET';\n    get path():string {\n        let {arr, owner, id} = this.params;\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/${id}`;\n    }\n}\nclass SavePropCaller extends TuidCaller<{id:number, prop:string, value:any}> {\n    get path():string {return `tuid-prop/${this.entity.name}/`;}\n}\nclass SaveArrCaller extends TuidCaller<{arr:string, owner:number, id:number, props:any}> {\n    get path():string {\n        let {arr, owner} = this.params;\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/`;\n    }\n    buildParams():any {\n        let {id, props} = this.params;\n        let params = _.clone(props);\n        params['$id'] = id;\n        return params;\n    }\n}\nclass ArrPosCaller extends TuidCaller<{arr:string, owner:number, id:number, order:number}> {\n    get path():string {\n        let {arr, owner} = this.params;\n        return `tuid-arr-pos/${this.entity.name}/${owner}/${arr}/`;\n    }\n    buildParams():any {\n        let {id, order} = this.params;\n        return { bid: id, $order: order}\n    }\n}\nclass TuidNoCaller extends TuidCaller<{}> {\n    get path():string {\n        return `tuid-no/${this.entity.name}/`;\n    }\n    buildParams():any {\n\t\tlet d = new Date();\n\t\tlet year = d.getFullYear();\n\t\tlet month = d.getMonth() + 1;\n\t\tlet date = d.getDate();\n        return {year, month, date};\n    }\n}\n\nexport class TuidImport extends Tuid {\n    private tuidLocal: TuidInner;\n\n    constructor(uq:UqMan, name:string, typeId:number, from: SchemaFrom) {\n        super(uq, name, typeId);\n        this.from = from;\n    }\n\n    setFrom(tuidLocal: TuidInner) {this.tuidLocal = tuidLocal}\n    \n    readonly from: SchemaFrom;\n    isImport = true;\n\n    useId(id:number) {this.tuidLocal.useId(id);}\n    boxId(id:number):BoxId {return this.tuidLocal.boxId(id);}\n    valueFromId(id:number) {return this.tuidLocal.valueFromId(id)}\n\tresetCache(id:number|BoxId):void {\n\t\tthis.tuidLocal.resetCache(id);\n\t}\n    async assureBox<T>(id:number):Promise<T> {\n        await this.tuidLocal.assureBox(id);\n\t\treturn this.tuidLocal.valueFromId(id);\n    }\n    get hasDiv():boolean {return this.tuidLocal.hasDiv}\n    div(name:string):TuidDiv {return this.tuidLocal.div(name)}\n    async loadMain(id:number|BoxId):Promise<any> {\n        let ret = await this.tuidLocal.loadMain(id);\n        return ret;\n    }\n    async load(id:number|BoxId):Promise<any> {\n        return await this.tuidLocal.load(id);\n    }\n    async save(id:number, props:any):Promise<TuidSaveResult> {\n        return await this.tuidLocal.save(id, props);\n\t}\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\n\t\tawait this.tuidLocal.saveProp(id, prop, value);\n\t}\n    async all():Promise<any[]> {\n        return await this.tuidLocal.all();\n    }\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        return await this.tuidLocal.search(key, pageStart, pageSize);\n    }\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        return await this.tuidLocal.searchArr(owner, key, pageStart, pageSize);\n    }\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\n        return await this.tuidLocal.loadArr(arr, owner, id);\n    }\n    async saveArr(arr:string, owner:number, id:number, props:any):Promise<void> {\n        await this.tuidLocal.saveArr(arr, owner, id, props);\n    }\n    async posArr(arr:string, owner:number, id:number, order:number):Promise<void> {\n        await this.tuidLocal.posArr(arr, owner, id, order);\n    }\n\tasync no():Promise<TuidNOResult> {\n\t\treturn await this.tuidLocal.no();\n\t}\n}\n\n// field._tuid 用这个接口\n// Tuid, TuidDiv 实现这个接口\nexport class TuidBox {\n    tuid: Tuid;\n    ownerField:Field = undefined;\n    constructor(tuid: Tuid) {\n        this.tuid = tuid;\n    }\n\n    boxId(id:number):BoxId {\n        return this.tuid.boxId(id);\n    }\n    getIdFromObj(obj:any):number {\n        return this.tuid.getIdFromObj(obj);\n    }\n    useId(id:number):void {\n        return this.tuid.useId(id);\n    }\n    async showInfo() {\n        alert('showInfo not implemented');\n    }\n}\n\n\nexport class TuidDiv extends TuidInner /* Entity*/ {\n    readonly typeName:string = 'div';\n    protected cacheFields: Field[];\n    protected tuid: TuidInner;\n    protected idName: string;\n    protected idCache: IdDivCache;\n\n    //ui: React.StatelessComponent<any>;\n    //res: any;\n\n    constructor(uq: UqMan, tuid: TuidInner, name: string) {\n        super(uq, name, 0);\n        this.tuid = tuid;\n        this.idName = 'id';\n        this.idCache = new IdDivCache(tuid, this);\n    }\n\n    get owner() {return this.tuid}\n\n    /*\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.buildFieldsTuid();\n    }*/\n\n    /*\n    setUIRes(ui:any, res:any) {\n        this.ui = ui && ui.content;\n        this.res = res;\n    }\n    */\n\n    buildFieldsTuid() {\n        super.buildFieldsTuid();\n        let {mainFields} = this.schema;\n        if (mainFields === undefined) debugger;\n        this.uq.buildFieldTuid(this.cacheFields = mainFields);\n    }\n\n    buildTuidDivBox(ownerField: Field): TuidBoxDiv {\n        return new TuidBoxDiv(this.tuid, this, ownerField);\n    }\n\n    getIdFromObj(obj:any):number {return obj[this.idName]}\n    cacheValue(value:any):void {\n        this.idCache.cacheValue(value);\n    }\n\n    useId(id:number, defer?:boolean):void {\n        if (this.noCache === true) return;\n        this.idCache.useId(id, defer);\n    }\n\n    /*\n    boxId(id:number):BoxId {\n        if (typeof id === 'object') return id;\n        this.useId(id);\n        //return new BoxDivId(this.tuid, this, id);\n        return this.tuid.boxDivId(this, id);\n    }\n    */\n    valueFromId(id:number):any {\n        return this.idCache.getValue(id)\n    }\n\n    async assureBox<T>(id:number):Promise<T> {\n\t\tawait this.idCache.assureObj(id);\n\t\treturn this.idCache.getValue(id);\n    }\n\n    async cacheIds() {\n        await this.idCache.cacheIds();\n    }\n\n    cacheTuidFieldValues(values:any) {\n        let fields = this.schema.fields;\n        this.cacheFieldsInValue(values, fields);\n    }\n\n    unpackTuidIds(values:string[]):any[] {\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\n    }\n}\n\nexport class TuidBoxDiv extends TuidBox {\n    ownerField: Field;\n    private div: TuidDiv;\n    constructor(tuid: Tuid, div: TuidDiv, ownerField: Field) {\n        super(tuid);\n        this.div = div;\n        this.ownerField = ownerField;\n    }\n\n    boxId(id:number):BoxId {\n        return this.div.boxId(id);\n    }\n    getIdFromObj(obj:any):number {\n        return this.div.getIdFromObj(obj);\n    }\n    useId(id:number):void {\n        return this.div.useId(id);\n    }\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport { Page, ItemSchema, UiSchema, StringSchema, UiTextItem, Edit, ImageSchema, nav, UiImageItem } from '../components';\nimport { userApi } from '../net';\n\nexport class EditMeInfo extends React.Component {\n    private schema:ItemSchema[] = [\n        {name:'nick', type:'string'} as StringSchema,\n        {name:'icon', type:'image'} as ImageSchema\n    ];\n    private uiSchema:UiSchema = {\n        items: {\n            nick: {widget:'text', label:'别名', placeholder:'好的别名更方便记忆'} as UiTextItem,\n            icon: {widget:'image', label:'头像'} as UiImageItem,\n        }\n    }\n    @observable private data:any;\n\n    constructor(props:any) {\n        super(props);\n        let {nick, icon} = nav.user;\n        this.data = {\n            nick: nick,\n            icon: icon,\n        }\n    }\n\n    private onItemChanged = async (itemSchema:ItemSchema, newValue:any, preValue:any) => {\n        let {name} = itemSchema;        \n        await userApi.userSetProp(name, newValue);\n        this.data[name] = newValue;\n        let user:any = nav.user;\n        user[name] = newValue;\n        nav.saveLocalUser();\n    }\n\n    render() {\n        return <Page header=\"个人信息\">\n            <Edit schema={this.schema} uiSchema={this.uiSchema}\n                data={this.data}\n                onItemChanged={this.onItemChanged} />\n        </Page>;\n    }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { AppConfig } from \"tonva\";\nimport { appName } from \"./appName\";\n\nexport const appConfig: AppConfig = {\n    appName: appName,\n\tversion: '1.0.0',\n\tnoUnit: true,\n    tvs: {},\n\toem: undefined,\n\thtmlTitle: '小单',\n};\n","export const appName = 'Bruce/notes';\n","import { CSub, CBase, CAppBase, IConstructor } from 'tonva';\nimport { UQs } from './uqs';\nimport { CApp } from './CApp';\n\nexport abstract class CUqBase extends CBase {\n    get cApp(): CApp { return this._cApp; }\n    protected get uqs(): UQs { return this._uqs as UQs };\n}\n\nexport abstract class CUqSub<T extends CUqBase> extends CSub<T> {\n    get cApp(): CApp { return this._cApp; }\n    protected get uqs(): UQs { return this._uqs as UQs };\n    get owner(): T { return this._owner as T }\n}\n\nexport abstract class CUqApp extends CAppBase {\n    get uqs(): UQs { return this._uqs };\n\n    protected newC<T extends CUqBase>(type: IConstructor<T>): T {\n\t\tlet c = new type(this);\n\t\tc.init();\n\t\treturn c;\n    }\n}\n","import * as React from 'react';\nimport { VPage, TabCaptionComponent, Page, TabProp, t } from 'tonva';\nimport { CApp } from './CApp';\n\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\nfunction caption(label:string, icon:string) {\n\treturn (selected: boolean) => TabCaptionComponent(label, icon, color(selected));\n}\nexport class VMain extends VPage<CApp> {\n    async open(param?: any, onClosePage?: (ret:any)=>void) {\n        this.openPage(this.render, param, onClosePage);\n    }\n\n    render = (param?: any): JSX.Element => {\n\t\tlet { cHome, cRelation, cDiscover, cMe } = this.controller;\n\t\t/*\n        let faceTabs = [\n\t\t\t{ name: 'note', label: '首页', icon: 'home', content: cGroup.tab},\n\t\t\t{ name: 'job', label: '查看', icon: 'list', content: cReport.tab, onShown: cReport.load, className: 'job-tab' },\n            //{ name: 'home', label: '绩效', icon: 'tasks', content: cHome.tab, },\n            { name: 'me', label: '我的', icon: 'user', content: cMe.tab }\n        ].map(v => {\n            let { name, label, icon, content, onShown, className } = v;\n            return {\n                name: name,\n                caption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\n                content: content,\n\t\t\t\tonShown: onShown,\n\t\t\t\tclassName: className\n            }\n\t\t});\n\t\t*/\n\t\tlet tabs: TabProp[] = [\n\t\t\t{name: 'home', caption: caption(t('home'), 'home'), content: cHome.tab},\n\t\t\t{name: 'relation', caption: caption(t('relation'), 'user-plus'), content: cRelation.tab, onShown: cRelation.load},\n\t\t\t{name: 'discover', caption: caption(t('discover'), 'arrows-alt'), content: cDiscover.tab, load: cDiscover.loadBookProjects},\n\t\t\t{name: 'me', caption: caption(t('me'), 'user-o'), content: cMe.tab},\n\t\t];\n\t\treturn <Page tabsProps={{tabs}} />;\n    }\n}\n","import { BoxId } from \"tonva\";\nimport { EnumTaskState } from \"./note/task/TaskState\";\n\nexport enum EnumNoteType {\n\ttext=0, task=1, comment=2, folder=3, group=4, groupFolder=5, unit=6, assign=7,\n\ttextList=8, textCheckable=9, unitNote=10,\n}\n\nexport interface NoteItem {\n\tseconds: number;\n\towner: number | BoxId;\n\tnote: number;\n\ttype: EnumNoteType;\n\tcaption: string;\n\tcontent: string;\n\tassigned: string;\n\tfrom: number | BoxId;\n\tfromAssigned: string;\n\tstate: EnumTaskState;\n\tflowContent?: string;\n\tgroupFolder?:number;\n\tunread: number;\n\tobj: any;\n\ttoCount?: number;\n\tspawnCount?: number;\n\tcommentCount?: number;\n\tcommentUnread?: number;\n\t$create: Date;\n\t$update: Date;\n}\n\nexport interface NoteFlow {\t\n}\n\nexport interface Access {\n\tuser: number;\n\taccess: number;\n\tassigned: string;\n}\n\nexport interface CommentItem {\n\tid: number;\n\tcontent: string;\n\towner: number;\n\tassigned: string;\n\t$create: Date;\n\t$update: Date;\n}\n\nexport interface NoteModel {\n\tid: number;\n\tcaption: string;\n\tcontent: string;\n\ttype: EnumNoteType,\n\t$create: Date;\n\t$update: Date;\n\tto: Access[];\n\tflow: NoteFlow[];\n\tspawn: NoteItem[];\n\tcontain: NoteItem[];\n\tcomments: CommentItem[];\n}\n\nexport function replaceAll(str:string, findStr:string, repStr:string):string {\n\tif (!str) return str;\n\treturn str.split(findStr).join(repStr);\n}\n\nexport function numberFromId(id:number|BoxId):number {\n\tlet _id:number;\n\tswitch (typeof id) {\n\t\t\tcase 'object': _id = (id as BoxId).id; break;\n\t\t\tcase 'number': _id = id as number; break;\n\t\t\tdefault: return;\n\t}\n\treturn _id;\n}\n\nexport function compareID(id1:number|BoxId, id2:number|BoxId):boolean {\n\treturn numberFromId(id1) === numberFromId(id2);\n}\n\nexport function checkHourMinutes(v:string): number {\n\tlet reTime = /^(?:(?:[0-9])|(?:[0-2][0-3])|(?:[0-1][0-9])):[0-5][0-9]$/;\n\tif (reTime.test(v)) {\n\t\tlet r = v.split(':');\n\t\treturn Number(r[0]) * 60 + Number(r[1]);\n\t}\n\tlet h = Number(v);\n\tif (isNaN(h) || h > 20 || h < 0) {\n\t\treturn -1;\n\t}\n\treturn h * 60;\n}\n\nexport function taskTimeToString(t:number):string {\n\tif (isNaN(t) || t <= 0)\n\t\treturn '';\n\tlet h = Math.floor(t / 60);\n\tlet m = Math.floor(t % 60);\n\tlet ms = m.toString();\n\tif (m < 10) {\n\t\tms = '0' + ms;\n\t}\n\treturn h.toString() + ':' + ms;\n}\n\n\nexport function initNoteItemObj(item:NoteItem):void {\n\tlet {type, content, flowContent} = item;\n\tif (flowContent) {\n\t\tlet obj = JSON.parse(flowContent);\n\t\titem.obj = obj;\n\t}\n\telse if (content) {\n\t\tif (content[0] === '{') {\n\t\t\tlet obj = JSON.parse(content);\n\t\t\tif (type === EnumNoteType.text) {\n\t\t\t\tswitch (obj.check) {\n\t\t\t\t\tcase 1: item.type = EnumNoteType.textList; break;\n\t\t\t\t\tcase 2: item.type = EnumNoteType.textCheckable; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.obj = obj;\n\t\t}\n\t\telse {\n\t\t\titem.obj = content;\n\t\t}\n\t}\n}\n\n","import React from 'react';\nimport { VPage, User, Image, UserView, CBase } from \"tonva\";\nimport { Contact } from 'model';\n\nexport abstract class VBasePage<T extends CBase> extends VPage<T> {\n\tprotected renderContact = (userId:number, assigned:string) => {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mr-2\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</>\n\t\t}\n\t\treturn <UserView user={userId as number} render={renderUser} />;\n\t}\n\n\tprotected renderContactItem = (item:Contact, index:number) => {\n\t\tlet {contact, assigned} = item;\n\t\treturn <div className=\"px-3 py-2\">\n\t\t\t{this.renderContact(contact, assigned)}\n\t\t</div>;\n\t}\n\n\tprotected renderSelectedContact(contacts:Contact[]) {\n\t\treturn contacts.map((c, index) => {\n\t\t\tlet {contact, assigned} = c;\n\t\t\treturn <span key={index} className=\"mr-3\">{this.renderContact(contact, assigned)}</span>;\n\t\t});\n\t}\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { VBasePage } from './VBasePage';\nimport { List, FA } from 'tonva';\nimport { Contact } from 'model';\nimport { CNotes } from '../CNotes';\n\nexport interface SelectContactOptions {\n\ttitle?: string;\n\taction?: string;\n\tsingle?: boolean;\n}\n\nexport class VSelectContact extends VBasePage<CNotes> {\n\t@observable private anySelected:boolean = false;\n\t@observable private contacts: Contact[];\n\t@observable private multiple:boolean = false;\n\tprivate list: List;\n\tprivate options: SelectContactOptions;\n\n\tinit(options: SelectContactOptions):void {\n\t\tthis.options = options;\n\t}\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\theader() {return this.options?.title ?? '选择'}\n\tright() {\n\t\treturn React.createElement(observer(this.buildRight));\n\t}\n\n\tprivate buildRight = () => {\n\t\tif (this.options?.single === true) return;\n\t\tlet cn = 'btn btn-sm btn-success mr-1';\n\t\tif (this.multiple === false) {\n\t\t\treturn <button className={cn} onClick={this.onToggleSelect}>多选</button>;\n\t\t}\n\t\tif (this.contacts && this.contacts.length > 0) {\n\t\t\treturn <button className={cn} onClick={this.onNext} disabled={!this.anySelected}>\n\t\t\t\t{this.options?.action ?? '选中'}({this.contacts.length}) <FA name=\"angle-right\" />\n\t\t\t</button>;\n\t\t}\n\t\treturn <button className={cn} onClick={this.onToggleSelect}>单选</button>;\n\t}\n\n\tprivate onToggleSelect = () => {\n\t\tthis.multiple = !this.multiple;\n\t}\n\n\tcontent() {\n\t\tlet render = () => {\n\t\t\tlet list:any;\n\t\t\tlet items = this.controller.cApp.contacts;\n\t\t\tif (this.multiple === true) {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onSelect:this.onContactSelect}} />\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onClick:this.onContactClick}} />\n\t\t\t}\n\t\t\treturn <div className=\"\">\n\t\t\t\t{list}\n\t\t\t</div>;\n\t\t}\n\t\treturn React.createElement(observer(render));\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tthis.anySelected = anySelected;\n\t\tthis.contacts = this.list.selectedItems;\n\t}\n\n\tprivate onContactClick = (item:Contact) => {\n\t\tthis.returnCall([item]);\n\t}\n\n\tprivate onNext = () => {\n\t\tthis.returnCall(this.list.selectedItems);\n\t}\n}\n","import React from 'react';\nimport { View, DropdownActions, DropdownAction } from \"tonva\";\nimport { CNotes } from \"../CNotes\";\n\nexport abstract class VNotesDropDown extends View<CNotes> {\n\tprotected text = {\n\t\ticon:'file-o', \n\t\tcaption:this.t('noteText'), \n\t\taction: this.controller.showAddNoteTextPage, \n\t\tcaptionClass: 'text-primary'\n\t};\n\tprotected list = {\n\t\ticon:'list', \n\t\tcaption:this.t('noteList'),\n\t\taction: this.controller.showAddNoteListPage,\n\t};\n\tprotected checkable = {\n\t\ticon:'check-square-o', \n\t\tcaption:this.t('noteCheckable'), \n\t\taction: this.controller.showAddNoteCheckablePage,\n\t};\n\tprotected task = {\n\t\ticon:'hand-pointer-o', \n\t\tcaption:this.t('noteTask'), \n\t\taction: this.controller.showAddAssignPage,\n\t\ticonClass: 'text-primary'\n\t};\n\tprotected folder = {\n\t\ticon:'folder', \n\t\tcaption:this.t('noteFolder'), \n\t\taction: this.controller.showAddMyFolderPage,\n\t\ticonClass: 'text-warning'\n\t};\n\tprotected space = {\n\t\ticon:'users', \n\t\tcaption:this.t('noteCreateSpace'), \n\t\taction: this.controller.showAddGroupPage,\n\t\ticonClass: 'text-danger'\n\t};\n\n\tprotected abstract get dropdownActions(): DropdownAction[];\n\n\trender() {\n\t\treturn <DropdownActions actions={this.dropdownActions}\n\t\t\ticon=\"plus\"\n\t\t\titemIconClass=\"text-info\"\n\t\t\tclassName=\"cursor-pointer btn btn-lg text-white p-1 mr-1\"/>\n\t}\n}\n\nexport class VHomeDropdown extends VNotesDropDown {\n\tprotected get dropdownActions(): DropdownAction[] {\n\t\treturn [this.text, this.list, this.checkable, this.folder, undefined, this.space];\n\t}\n}\n\nexport class VFolderDropdown extends VNotesDropDown {\n\tprotected get dropdownActions(): DropdownAction[] {\n\t\treturn [this.text, this.list, this.checkable, this.folder];\n\t}\n}\n\nexport class  VSpaceDropdown extends VNotesDropDown {\n\tprotected get dropdownActions(): DropdownAction[] {\n\t\treturn [this.text, this.list, this.checkable, this.task, this.folder];\n\t}\n}\n","import { observable, computed } from \"mobx\";\nimport { CUqSub } from '../../tapp';\nimport { NoteItem, NoteModel, EnumNoteType } from '../model';\nimport { CNotes } from '../CNotes';\n\nexport abstract class CNoteBase extends CUqSub<CNotes> {\n\tdisableFrom: boolean = false;\n\t@observable noteModel: NoteModel;\n\t@observable noteItem: NoteItem;\n\n\t@observable activeRelativeTab: string;\n\tget isContentChanged():boolean {return false;}; // {return this.cContent.changed}\n\n\tget groupFolder(): number {\n\t\tif (!this.noteItem)\n\t\t\treturn undefined;\n\t\tlet ret = this.noteItem.groupFolder;\n\t\tif (!ret && this.noteItem.type === EnumNoteType.groupFolder) {\n\t\t\tret = this.noteItem.note;\n\t\t}\n\t\treturn ret;\n\t}\n\n\tinit(param: NoteItem): void {\n\t\tthis.noteItem = param;\n\t}\n\n\tabstract get type():EnumNoteType;\n\n\tprotected async internalStart() { }\n\n\t@observable caption: string;\n\tget isCaptionChanged() {return this.caption !== this.noteItem?.caption;}\n\t@computed get isNoteChanged(): boolean {\n\t\treturn this.isContentChanged || this.isCaptionChanged;\n\t}\n\n\tabstract renderIcon(): JSX.Element;\n\tabstract renderDirItem(index: number): JSX.Element;\n\tabstract showViewPage():void;\n\tabstract showEditPage():void;\n\tabstract showAddPage():void;\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\treturn obj;\n\t}\n\n\tasync showShareTo() {\n\t\tawait this.owner.showShareTo();\n\t}\n\n\tasync SetNote(showWaiting: boolean = true) {\n\t\tlet obj = this.endContentInput();\n\t\tlet noteContent = JSON.stringify(obj);\n\t\tawait this.owner.editNote(showWaiting,\n\t\t\tthis.noteItem,\n\t\t\tthis.caption,\n\t\t\tnoteContent,\n\t\t\tobj);\n\t\tthis.updateChange();\n\t}\n\n\tprotected updateChange() {\n\t\tif (!this.noteItem) {\n\t\t\tdebugger;\n\t\t\tthrow new Error('this.noteItem can not be undefined');\n\t\t}\n\t\tthis.noteItem.$update = new Date();\n\t\tif (this.caption && this.caption !== this.noteItem.caption) {\n\t\t\tthis.noteItem.caption = this.caption;\n\t\t}\n\t\tthis.owner.itemChanged(this.noteItem);\n\t}\n\n\t// return the folder noteItem\n\titemChanged(noteItem: NoteItem):NoteItem {\n\t\t//if (this.noteItem) {\n\t\tthis.noteItem.$update = noteItem.$update;\n\t\treturn this.noteItem;\n\t\t//}\n\t}\n\n\tasync AddNote() {\n\t\tlet obj = this.endContentInput();\n\t\tlet noteContent = JSON.stringify(obj);\n\t\tlet {folderId} = this.owner.currentFold;\n\t\tlet ret = await this.owner.addNote(folderId, this.caption, noteContent, obj, this.type);\n\t\tif (this.noteItem) {\n\t\t\tthis.updateChange();\n\t\t}\n\t\treturn ret;\n\t}\n}\n","import { VBasePage } from \"notes/views/VBasePage\";\nimport React from \"react\";\nimport { User, Image, UserView, Page, EasyTime, FA } from \"tonva\";\nimport { CNoteBase } from \"./CNoteBase\";\n\nexport function renderIcon(name:string, cn:string) {\n\treturn <span className=\"fa-stack fa-lg\">\n\t\t<i className={'fa fa-square-o fa-stack-2x ' + cn}></i>\n\t\t<i className={'fa fa-stack-1x fa-' + name + ' ' + cn}></i>\n\t</span>\n\t//return <FA name={name} size=\"lg\" className={cn} fixWidth={true} />;\n}\n\nexport abstract class VNoteBase<T extends CNoteBase> extends VBasePage<T> {\n\t// VPage 里面的页面主体\n\tcontent() {\n\t\treturn this.renderBody();\n\t}\n\n\t// 页面主体\n\tprotected renderBody():JSX.Element {\n\t\treturn;\n\t}\n\n\t// 小单的主要部分，top, caption和content\n\tprotected renderTopCaptionContent() {\n\t\treturn <div className=\"bg-white\">\n\t\t\t{this.renderTop()}\n\t\t\t<div className=\"py-2\">\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderTop():JSX.Element {\n\t\treturn <div className=\"d-flex px-3 py-2 align-items-center border-top border-bottom bg-light\">\n\t\t\t{this.renderIcon()}\n\t\t\t<span className=\"mr-4\">{this.renderEditTime()}</span>\n\t\t\t{this.renderFrom()}\n\t\t</div>;\n\t}\n\tprotected renderIcon():JSX.Element {return;}\n\t\n\tprotected renderFrom = () => {\n\t\tlet {noteItem, disableFrom: disableOwnerFrom} = this.controller;\n\t\tif (!noteItem) return <div>noteItem undefined in renderFrom</div>;\n\t\tlet {owner, assigned, from} = noteItem;\n\t\tlet contact:number = from? from as number : owner as number;\n\t\tif (disableOwnerFrom === false && this.isMe(contact) === false) {\n\t\t\tlet renderUser = (user:User) => {\n\t\t\t\tlet {name, nick, icon} = user;\n\t\t\t\tlet vImage:any, cnName:string = 'text-muted';\n\t\t\t\tif (icon) {\n\t\t\t\t\tcnName += ' small'\n\t\t\t\t\tvImage = <Image className=\"w-1c h-1c mr-1\" src={icon} />;\n\t\t\t\t}\n\t\t\t\treturn <>\n\t\t\t\t\t{vImage} <span className={cnName}>{assigned || nick || name}</span>\n\t\t\t\t</>\n\t\t\t}\n\t\t\treturn <UserView user={contact} render={renderUser} />;\n\t\t}\n\t}\n\n\tprotected renderEditTime() {\n\t\tlet {$create, $update} = this.controller.noteItem;\n\t\tlet create:Date = $create;\n\t\tlet update:Date = $update;\n\t\tif (create && update) {\n\t\t\tlet time:Date, action:any;\n\t\t\tif (update.getTime() - create.getTime() > 60*1000) {\n\t\t\t\taction = <FA className=\"ml-1\" name=\"pencil\" />;\n\t\t\t\ttime = update;\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttime = create;\n\t\t\t}\n\t\t\treturn <small className=\"text-muted\">\n\t\t\t\t<span><EasyTime date={time} /></span>\n\t\t\t\t{action}\n\t\t\t</small>\n\t\t}\n\t}\n\n\tprotected renderCaption() {\n\t\tlet {caption: title} = this.controller;\n\t\tif (title) {\n\t\t\treturn <div className=\"pr-3\">\n\t\t\t\t<div><b>{title}</b></div>\n\t\t\t</div>;\n\t\t}\n\t}\n\n\tprotected renderContent():JSX.Element {return;}\n\n\tprotected renderToCount() {\n\t\tlet {toCount} = this.controller.noteItem;\n\t\tif (toCount === undefined || toCount <= 0)\n\t\t\treturn;\n\t\treturn <span className=\"mr-5 text-muted\">\n\t\t\t<FA className=\"mr-2\" name=\"share\"/><small className=\"\">{toCount}</small> \n\t\t</span>;\n\t}\n\n\tprotected renderSpawnCount() {\n\t\tlet {spawnCount} = this.controller.noteItem;\n\t\tif (spawnCount === undefined || spawnCount <= 0)\n\t\t\treturn;\n\t\treturn  <span className=\"mr-5 text-muted\">\n\t\t\t<FA className=\"mr-2\" name=\"hand-pointer-o\"/><small className=\"\">{spawnCount}</small>\n\t\t</span>;\n\t}\n\n\tprotected renderCommentFlag = () => {\n\t\tlet {commentCount, commentUnread} = this.controller.noteItem;\n\t\tif (commentCount === undefined || commentCount <= 0)\n\t\t\treturn;\n\t\tlet vCU:any;\n\t\tif (commentUnread > 0) {\n\t\t\tlet cu:any = commentUnread>99? <>99<sup>+</sup></> : commentUnread;\n\t\t\tvCU = <div className=\"unread-num\">{cu}</div>;\n\t\t};\n\t\treturn  <span className=\"mr-5 text-muted position-relative\">\n\t\t\t<FA className=\"mr-2\" name=\"comment-o\"/><small className=\"\">{commentCount}</small>\n\t\t\t{vCU}\n\t\t</span>;\n\t}\n\n\tprotected showActionEndPage({content, onClick}:{content:any; onClick?:()=>void}) {\n\t\tthis.openPage(() => {\n\t\t\tonClick = onClick || (()=>this.closePage());\n\t\t\tlet {caption: title} = this.controller;\n\t\t\treturn <Page header={title} back=\"close\">\n\t\t\t\t<div className=\"border bg-white rounded m-5\">\n\t\t\t\t\t<div className=\"py-5 text-center\">\n\t\t\t\t\t\t{content}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"border-top text-center py-3\">\n\t\t\t\t\t\t<button className=\"btn btn-outline-info\" onClick={onClick}>返回</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Page>;\n\t\t});\n\t}\n\n\tprotected renderShareButton() {\n\t\treturn <span onClick={this.onSendNote} className=\"cursor-pointer text-primary mr-5\">\n\t\t\t<FA name=\"share\" />\n\t\t</span>;\n\t}\n\n\tprotected onSendNote = async () => {\n\t\tawait this.controller.cApp.loadRelation();\n\t\tthis.controller.showShareTo();\n\t}\n\n\tprotected renderEditButton() {\n\t\treturn <span onClick={()=>this.onEdit()} className=\"cursor-pointer text-primary\">\n\t\t\t<FA name=\"pencil-square-o\" />\n\t\t</span>;\n\t}\n\t\n\tprotected renderStateSpan(content: string, isEnd: boolean = false) {\n\t\tif (isEnd === true) {\n\t\t\treturn <span className=\"small text-danger\"><FA className=\"small mr-1\" name=\"stop\" />{content}</span>;\n\t\t}\n\t\treturn <span className=\"small text-success border border-success rounded px-2\">{content}</span>;\n\t}\n\n\tprotected onEdit() {this.controller.showEditPage()}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from \"./VNoteBase\";\nimport { CNoteBase } from \"./CNoteBase\";\n\nexport class VNoteBaseDir<T extends CNoteBase> extends VNoteBase<T> {\n\trender() {\n\t\treturn this.renderBody();\n\t}\n\n\tprotected renderBody() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t{this.renderTopCaptionContent()}\n\t\t\t\t{this.renderDirBottom()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderTopCaptionContent() {\n\t\treturn <div className=\"bg-white\">\n\t\t\t{this.renderTop()}\n\t\t\t<div className=\"py-2\">\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderTop():JSX.Element {\n\t\treturn <div className=\"d-flex pl-2 pr-3 py-2 border-top\">\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderFrom()}\n\t\t\t</div>\n\t\t\t<div className=\"ml-auto\">{this.renderEditTime()}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderDirBottom():JSX.Element {\n\t\tlet divToCount = this.renderToCount();\n\t\tlet divSpawnCount = this.renderSpawnCount();\n\t\tlet divComment = this.renderCommentFlag();\n\t\tif (divToCount || divSpawnCount || divComment) {\n\t\t\treturn <div className=\"d-flex align-items-center px-3 mb-1\">\n\t\t\t\t{divToCount}\n\t\t\t\t{divSpawnCount}\n\t\t\t\t{divComment}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>;\n\t\t}\n\t}\n\n\tprotected renderIcon(): JSX.Element {\n\t\tlet {unread} = this.controller.noteItem;\n\t\tlet dot:any;\n\t\tif (unread>0) dot = <u/>;\n\t\treturn <div className=\"mr-3 unread-dot\">{this.controller.renderIcon()}{dot}</div>\n\t}\n}\n\nexport class VNoteBaseDirView extends VNoteBaseDir<CNoteBase> {\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { CNoteBase } from \"./CNoteBase\";\nimport { VNoteBaseForm } from './VNoteBaseForm';\n\nexport class VNoteBaseEdit<T extends CNoteBase> extends VNoteBaseForm<T> {\n\t/*\n\t@computed protected get btnSaveDisabled():boolean {\n\t\tif (this.controller.isContentChanged === true) return false;\n\t\tif (this.controller.isCaptionChanged === true) return false;\n\t\treturn true;\n\t}\n\t*/\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={!this.controller.isNoteChanged}>\n\t\t\t\t\t保存\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t\t{this.renderExButtons()}\n\t\t</div>;\n\t}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.SetNote();\n\t\tthis.closePage();\n\t}\n\n\tprotected renderExButtons():JSX.Element {return}\n}\n\nexport class VNoteBaseEditPage extends VNoteBaseEdit<CNoteBase> {\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from \"./VNoteBase\";\nimport { CNoteBase } from \"./CNoteBase\";\n//import { computed } from 'mobx';\nimport { ConfirmOptions, FA } from 'tonva';\n\nexport class VNoteBaseForm<T extends CNoteBase> extends VNoteBase<T> {\n\t//@computed protected get changed(): boolean {return this.controller.captionChanged};\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {return this.t('notes')};\n\n\tprotected renderBody() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"d-block\">\n\t\t\t\t{this.renderTopCaptionContent()}\n\t\t\t\t{this.renderEditBottom()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderTopCaptionContent():JSX.Element {\n\t\treturn <div className=\"\">\n\t\t\t{this.renderCaptionInput()}\n\t\t\t<div className=\"mx-1 py-1 bg-white\">\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderCaptionInput() {\n\t\treturn <div className=\"py-2 px-1\">\n\t\t\t<input type=\"text\" className=\"w-100 border-0 form-control font-weight-bold\" placeholder=\"标题\" maxLength={80}\n\t\t\t\tonChange={this.onCaptionChange}\n\t\t\t\tdefaultValue={this.controller.caption} />\n\t\t</div>;\n\t\t//autoFocus={true}\n\t}\n\n\tprotected onCaptionChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.controller.caption = evt.target.value.trim();\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn;\n\t}\n\n\tprotected async onDelete(): Promise<void> {\n\t\tlet options: ConfirmOptions = {\n\t\t\tcaption: '请确认',\n\t\t\tmessage: <div className=\"my-3\"><FA name=\"question-circle-o\" size=\"2x\" className=\"mr-3 text-danger\" />真的要删除这个小单吗？</div>,\n\t\t\tyes: '确认删除',\n\t\t\tno: '不删除'\n\t\t};\n\t\tif (await this.controller.confirm(options) === 'yes') {\n\t\t\tawait this.controller.owner.hideNote(this.controller.noteItem.note, 1);\n\t\t\tthis.closePage(2);\n\t\t}\n\t}\n\n\tprotected renderDeleteButton() {\n\t\treturn <button className=\"btn btn-outline-secondary mr-3\" onClick={() => this.onDelete()}>\n\t\t\t删除\n\t\t</button>;\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from \"./VNoteBase\";\nimport { CNoteBase } from \"./CNoteBase\";\n\nexport class VNoteBaseView<T extends CNoteBase> extends VNoteBase<T> {\n\theader() {return this.t('notes')}\n\n\tprotected renderBody() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"d-block\">\n\t\t\t\t{this.renderTopCaptionContent()}\n\t\t\t\t{this.renderViewBottom()}\n\t\t\t\t{this.renderRelatives()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderTop():JSX.Element {\n\t\tlet vEditButton:any;\n\t\tlet isMe = this.isMe(this.controller.noteItem.owner);\n\t\tif (isMe === true) {\n\t\t\tvEditButton = <div className=\"ml-auto\">{this.renderEditButton()}</div>;\n\t\t}\n\t\treturn <div className=\"d-flex px-3 py-3 border-top border-bottom bg-light\">\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t<div className=\"d-flex align-items-center mt-1\">\n\t\t\t\t\t{this.renderFrom()}\n\t\t\t\t\t<span className=\"mx-4\">{this.renderEditTime()}</span>\n\t\t\t\t\t{vEditButton}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\t// 小单的主要部分，top, caption和content\n\tprotected renderTopCaptionContent() {\n\t\treturn <div className=\"bg-white\">\n\t\t\t{this.renderTop()}\n\t\t\t<div className=\"py-2\">\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderViewBottom():JSX.Element {\n\t\treturn <div className=\"h-1c\"></div>;\n\t}\n\n\tprotected renderRelatives():JSX.Element {\n\t\treturn;\n\t}\n\n\tprotected renderIcon(): JSX.Element {\n\t\treturn <div className=\"mr-3\">{this.controller.renderIcon()}</div>;\n\t}\n}\n","import React from 'react';\n\nexport const none = <small className=\"text-muted\">[无]</small>;\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { User, Image, UserView, FA } from \"tonva\";\nimport { VNoteBase, CNoteBase } from '.';\nimport { none } from 'tool';\n\nexport interface TabRelative {\n\tname: string;\n\tcaption: (isAction:boolean) => JSX.Element;\n\trender: () => JSX.Element;\n\tvisible: () => boolean;\n}\n\nexport class VRelativesBase<T extends CNoteBase> extends VNoteBase<T> {\n\n\tprotected tabShare:TabRelative = {\n\t\tname: 'share',\n\t\tvisible: () => this.controller.noteItem.toCount>0,\n\t\tcaption: (isAction:boolean) => {\n\t\t\tlet {toCount} = this.controller.noteItem;\n\t\t\tlet vCount:any;\n\t\t\tif (toCount > 0) vCount = <small>{toCount}</small>;\n\t\t\treturn <>\n\t\t\t\t<FA className=\"mr-2\" name=\"share\" /> \n\t\t\t\t{vCount}\n\t\t\t</>;\n\t\t},\n\t\trender: () => {\n\t\t\tlet {to} = this.controller.noteModel;\n\t\t\tif (!to || to.length === 0) return;\n\t\t\treturn <div className=\"px-3 py-2\">\n\t\t\t\t<small className=\"text-muted mr-3\">已分享给: </small>\n\t\t\t\t{to.map((t, index) => {\n\t\t\t\t\tlet {user, assigned} = t;\n\t\t\t\t\treturn <span key={index} className=\"mr-3\">{this.renderContact(user, assigned)}</span>;\n\t\t\t\t})}\n\t\t\t</div>\n\t\t}\n\t}\n\tprotected renderContact = (userId:number, assigned:string) => {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mr-2\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</>\n\t\t}\n\t\treturn <UserView user={userId as number} render={renderUser} />;\n\t}\n\n\tprotected get tabs():TabRelative[] { return [this.tabShare] };\n\n\tprotected renderTabs():JSX.Element {\n\t\tlet render = observer(() => {\n\t\t\tlet {activeRelativeTab} = this.controller;\n\t\t\tlet tabs = this.tabs.filter(tab => tab.visible?.());\n\t\t\tif (tabs.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet tab = tabs.find(v => v.name === activeRelativeTab);\n\t\t\tif (!tab) tab = tabs[0];\n\t\t\treturn <div className=\"bg-white\">\n\t\t\t\t<div className=\"d-flex px-3 pt-3\">\n\t\t\t\t\t{tabs.map(v => {\n\t\t\t\t\t\tlet {name, caption} = v;\n\t\t\t\t\t\tlet isActive = v === tab;\n\t\t\t\t\t\treturn this.renderTab(isActive, name, caption(isActive));\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"border-top\" style={{marginTop: '-1px'}}>\n\t\t\t\t\t{tab.render() || <div className=\"p-3\">{none}</div>}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t});\n\t\treturn React.createElement(render);\n\t}\n\n\trender():JSX.Element {\n\t\treturn this.renderTabs();\n\t}\n\n\tprivate renderTab(isAction:boolean, tabName:string, tabContent:any) {\n\t\tlet cn:string = isAction === true? ' bg-white' : ' bg-light text-muted border-bottom';\n\t\treturn <div key={tabName}\n\t\t\tclassName={'border-left border-top border-right rounded-top px-3 py-2 cursor-pointer' + cn}\n\t\t\tonClick={()=>this.controller.activeRelativeTab = tabName}>\n\t\t\t{tabContent}\n\t\t</div>;\n\t}\n}\n","import { Controller } from \"tonva\";\nimport { observable } from \"mobx\";\n\nexport abstract class CContent extends Controller {\n\t@observable changed: boolean = false;\n\tprotected async internalStart() {}\n\n\t//onContentChanged: () => Promise<void>;\n\ttoString(): string {return};\n\tprotected fromString(v:string):void {};\n\t\n\tstartInput(): void {\n\t\tthis.changed = false;\n\t}\n\tendInput(obj:any): void {this.buildObj(obj)}\n\tprotected abstract buildObj(obj:any): void;\n\n\tabstract renderInput(): JSX.Element;\n\tabstract renderViewContent(): JSX.Element;\n\trenderDirContent(): JSX.Element {return this.renderViewContent();}\n\n\treset(content:string) {\n\t\tthis.fromString(content);\n\t\tthis.startInput();\n\t\tthis.changed = true;\n\t}\n}\n","import React from 'react';\nimport { View } from \"tonva\";\nimport { CCheckable, ContentCheckItem } from './CCheckable';\nimport { observer } from 'mobx-react';\n\nexport abstract class VBase extends View<CCheckable> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {uncheckedItems, checkedItems} = this.controller.doneItems;\n\t\t\treturn <div className=\"mb-2\">\n\t\t\t\t{uncheckedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t\t{this.renderCheckedItems(checkedItems)}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected abstract renderCheckItem(v:ContentCheckItem):JSX.Element;\n\tprotected abstract renderCheckedItems(checkedItems:ContentCheckItem[]):JSX.Element;\n}\n","import React from 'react';\nimport { ContentCheckItem } from './CCheckable';\nimport { VBase } from './VBase';\n\nexport class VView extends VBase {\n\tprotected renderCheckItem(v:ContentCheckItem) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <label key={key} className=\"d-flex mx-3 align-items-center form-check mb-0\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tdata-key={key}\n\t\t\t\tonChange={e => this.onCheckChange(v, e.currentTarget.checked)} />\n\t\t\t<div className={'form-control-plaintext ' + cn}>{content}</div>\n\t\t</label>;\n\t}\n\n\tprivate onCheckChange(item:ContentCheckItem, checked:boolean) {\n\t\titem.checked = checked;\n\t}\n\n\tprotected renderCheckedItems(checkedItems:ContentCheckItem[]):JSX.Element {\n\t\tlet checkedCount = checkedItems.length;\n\t\tif (checkedCount > 0) {\n\t\t\treturn <div className=\"border-top py-2\">\n\t\t\t\t<div className=\"px-3 pt-2 small text-muted\">{checkedCount}项完成</div>\n\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t</div>;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { VBase } from \"./VBase\";\nimport { ContentCheckItem } from \"./CCheckable\";\nimport { FA } from 'tonva';\n\nexport class VItem extends VBase {\n\tprotected renderCheckItem(v:ContentCheckItem) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tlet icon: string;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t\ticon = 'check-square';\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t\ticon = 'square-o';\n\t\t}\n\t\treturn <div key={key} className=\"d-flex mx-3 align-items-center\">\n\t\t\t<FA name={icon} />\n\t\t\t<div className={'py-1 ' + cn}>{content}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderCheckedItems(checkedItems:ContentCheckItem[]):JSX.Element {\n\t\tlet checkedCount = checkedItems.length;\n\t\tif (checkedCount > 0) {\n\t\t\treturn <div className=\"\">\n\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t</div>;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { observable, toJS } from 'mobx';\nimport { FA } from 'tonva';\n\ninterface Focusable<T> {\n\titem: T;\n\tfocused: boolean;\n}\n\nexport interface ListInputProps<T> {\n\titems: T[];\n\tuniqueKey: () => number;\n\tonChanged: () => void;\n}\n\nexport abstract class ListInputBase<T> {\n\tprotected props: ListInputProps<T>;\n\t@observable private focusables: Focusable<T>[];\n\tprivate currentFocusable: Focusable<T>;\n\tprivate inputingText: string;\n\tprivate focuseTimeout: any;\n\n\tconstructor(props: ListInputProps<T>) {\n\t\tthis.props = props;\n\t\tlet {items} = props;\n\t\tthis.focusables = items? items.map(item => ({\n\t\t\titem: toJS(item), \n\t\t\tfocused: false\n\t\t})) : [];\n\t}\n\n\tprotected abstract getItemKey(item:T): number;\n\tprotected abstract getItemText(item:T): string;\n\tprotected abstract setItemText(item:T, text:string): void;\n\tprotected abstract newItem(key:number, text:string): T;\n\n\tgetList():T[] { return this.focusables.map(v => toJS(v.item))}\n\n\trender(): JSX.Element {\n\t\treturn React.createElement(observer(() => <div>\n\t\t\t{this.focusables.map(this.renderItem)}\n\t\t\t{this.renderNewInput()}\n\t\t</div>));\n\t}\n\n\tprotected renderItem = (focusable: Focusable<T>):JSX.Element => {\n\t\tlet {focused} = focusable;\n\t\treturn focused === true? this.renderInputItem(focusable) : this.renderTextItem(focusable);\n\t}\n\n\tprotected renderTextItem(focusable:Focusable<T>):JSX.Element {\n\t\tlet {item} = focusable;\n\t\tlet key = this.getItemKey(item);\n\t\tlet text = this.getItemText(item);\n\t\treturn <div key={key} className=\"d-flex mr-3 align-items-stretch\">\n\t\t\t{this.renderItemHeader(item)}\n\t\t\t<div className=\"flex-fill py-2\" onMouseDown={() => this.onItemClick(focusable)}>{text}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderItemHeader(item:T):JSX.Element {\n\t\treturn <span>item</span>;\n\t}\n\n\tprotected onItemClick(focusable: Focusable<T>) {\n\t\tif (this.currentFocusable) {\n\t\t\tthis.currentFocusable.focused = false;\n\t\t}\n\t\tthis.currentFocusable = focusable;\n\t\tfocusable.focused = true;\n\t\tif (this.focuseTimeout) {\n\t\t\tclearTimeout(this.focuseTimeout);\n\t\t\tthis.focuseTimeout = undefined;\n\t\t}\n\t\tthis.focuseTimeout = setTimeout(() => {\n\t\t\tthis.input?.focus();\n\t\t\tconsole.log('this.input ' + (this.input? 'null' : 'focus') );\n\t\t}, 10);\n\t}\n\n\tprotected renderInputItem(focusable: Focusable<T>):JSX.Element {\n\t\tlet {item} = focusable;\n\t\tlet key = this.getItemKey(item);\n\t\treturn <div key={key} className=\"d-flex mr-3 align-items-stretch\">\n\t\t\t{this.renderItemHeader(item)}\n\t\t\t{this.renderInput(focusable)}\n\t\t</div>;\n\t}\n\n\tprotected renderInput(focusable?: Focusable<T>):JSX.Element {\n\t\treturn <input type=\"text\" className=\"flex-fill form-control\"\n\t\t\tdefaultValue={this.getItemText(focusable?.item)}\n\t\t\tref={this.inputRef}\n\t\t\tonBlur={this.onBlur}\n\t\t\tonKeyDown={this.onKeyDown}\n\t\t\tonChange={this.onChange} />;\n\t}\n\n\tprotected renderNewInput():JSX.Element {\n\t\treturn <div className=\"d-flex mr-3 my-2 align-items-center\">\n\t\t\t<div className=\"w-3c w-min-3c w-max-3c text-center\">\n\t\t\t\t<FA name=\"plus\" className=\"text-info mt-1\" fixWidth={true} /> \n\t\t\t</div>\n\t\t\t<input className=\"flex-fill form-control\" \n\t\t\t\ttype=\"text\" \n\t\t\t\tplaceholder=\"新增\" \n\t\t\t\tonBlur={this.onBlurAddNew}\n\t\t\t\tonChange={this.onChange}\n\t\t\t\tonKeyDown={this.onAddNewEnter} />\n\t\t</div>;\n\t}\n\n\tprivate onAddNewEnter = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode !== 13) return;\n\t\tevt.currentTarget.value = '';\n\t\tthis.addNewItem();\n\t}\n\n\tprivate addNewItem() {\n\t\tif (!this.inputingText) return;\n\t\tif (this.inputingText.trim().length === 0) return;\n\t\tthis.focusables.push(\n\t\t\t{\n\t\t\t\titem: this.newItem(this.props.uniqueKey(), this.inputingText.trimRight()),\n\t\t\t\tfocused: false\n\t\t\t}\n\t\t);\n\t\tthis.inputingText = undefined;\n\t}\n\n\tprotected input: HTMLInputElement;\n\tprivate onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode !== 13) return;\n\t\tthis.currentFocusable.focused = false;\n\t\tevt.currentTarget.value = '';\n\t\tthis.inputingText = undefined;\n\t\tthis.currentFocusable = undefined;\n\t}\n\n\tprivate onBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t\tthis.currentFocusable.focused = false;\n\t\tthis.currentFocusable = undefined;\n\t}\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet {value} = evt.target;\n\t\tthis.inputingText = value;\n\t\tif (this.currentFocusable) this.setItemText(this.currentFocusable.item, value);\n\t\tthis.props.onChanged();\n\t}\n\tprivate inputRef = (input: any) => {\n\t\tif (!input) return;\n\t\tif (window.getComputedStyle(input).visibility === 'hidden') return;\n\t\tthis.input = input;\n\t\t//this.input.focus();\n\t}\n\tprivate onBlurAddNew = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t\tevt.currentTarget.value = '';\n\t\tthis.addNewItem();\n\t}\n}\n","import React from 'react';\nimport { ListInputBase } from \"../ListInputBase\";\nimport { ContentCheckItem } from \"./CCheckable\";\n\nexport class CheckableListInput extends ListInputBase<ContentCheckItem> {\n\tprotected getItemKey(item:ContentCheckItem): number {return item.key}\n\tprotected getItemText(item:ContentCheckItem): string {return item?.text}\n\tprotected setItemText(item:ContentCheckItem, text:string): void {if (item) {item.text = text}}\n\tprotected newItem(key:number, text:string): ContentCheckItem {return {key, text, checked:false}};\n\n\tprotected renderItemHeader(item:ContentCheckItem):JSX.Element {\n\t\treturn <label className=\"w-3c w-min-3c w-max-3c text-center mb-0\">\n\t\t\t<input className=\"mt-3\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={item.checked}\n\t\t\t\tonChange={e => this.onCheckChange(item, e.currentTarget.checked)} />\n\t\t</label>;\n\t}\n\n\tprivate onCheckChange = (item:ContentCheckItem, checked:boolean) => {\n\t\titem.checked = checked;\n\t\tthis.props.onChanged();\n\t}\n}\n","import { observable, computed } from \"mobx\";\nimport { CContent } from \"../CContent\";\nimport { VView } from \"./VView\";\nimport { VItem } from \"./VItem\";\nimport { CheckableListInput } from \"./CheckableListInput\";\n\nexport interface ContentCheckItem {\n\tkey: number;\n\ttext: string;\n\tchecked: boolean;\n}\n\nexport class CCheckable extends CContent {\n\tprivate listInput: CheckableListInput;\n\t@observable items: ContentCheckItem[] = [];\n\titemKey: number = 1;\n\n\tinit(obj:any) {\n\t\tif (obj) {\n\t\t\tthis.itemKey = obj.itemKey;\n\t\t\tthis.items = obj.items;\n\t\t}\n\t}\n\n\tstartInput(): void {\n\t\tsuper.startInput();\n\t\tthis.listInput = new CheckableListInput({\n\t\t\titems: this.items,\n\t\t\tuniqueKey: () => this.itemKey++,\n\t\t\tonChanged: () => this.changed = true,\t\t\t\t\t\n\t\t});\n\t}\n\n\trenderInput():JSX.Element {\n\t\treturn this.listInput.render();\n\t\t/*\n\t\tlet v = new VInput(this, this.items);\n\t\treturn v.render();\n\t\t*/\n\t}\n\n\trenderViewContent():JSX.Element {return this.renderView(VView)}\n\trenderDirContent():JSX.Element {return this.renderView(VItem)}\n\n\tendInput(obj:any): void {\n\t\tthis.items = this.listInput.getList();\n\t\tthis.buildObj(obj);\n\t}\n\n\tprotected buildObj(obj:any): void {\n\t\tobj.itemKey = this.itemKey;\n\t\tobj.items = this.items;\n\t\tdelete obj.content;\n\t}\n\n\ttoString():string { \n\t\treturn this.items?.map(v => v.text).join('\\n')\n\t}\n\n\tfromString(value: string) {\n\t\tif (value) {\n\t\t\tthis.items = [];\n\t\t\tthis.itemKey = 1;\n\t\t\tthis.items.push(...value.split('\\n').filter((v, index) => {\n\t\t\t\treturn v.trim().length > 0;\n\t\t\t}).map((v, index) => {\n\t\t\t\treturn {\n\t\t\t\t\tkey: this.itemKey++,\n\t\t\t\t\ttext: v,\n\t\t\t\t\tchecked: false\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\t/*\n\tasync onCheckChange(key: number, checked: boolean) {\n\t\tlet item = this.items.find(v => v.key === key);\n\t\tif (item) item.checked = checked;\n\t\tawait this.onContentChanged?.();\n\t\t//await this.SetNote(false);\n\t}\n\n\tonItemChanged = (key: number, value: string) => {\n\t\tlet item = key && this.items.find(v => v.key === key);\n\t\tif (item) {\n\t\t\titem.text = value;\n\t\t}\n\t\telse {\n\t\t\tthis.inputingText = value;\n\t\t}\n\t\tthis.changed = true;\n\t}\n\n\taddNewItem(): void {\n\t\tif (this.inputingText === undefined) return;\n\t\tlet text = this.inputingText.trim();\n\t\tif (text.length === 0) return;\n\t\tthis.items.push({\n\t\t\tkey: this.itemKey++,\n\t\t\ttext,\n\t\t\tchecked: false,\n\t\t});\n\t\tthis.changed = true;\n\t\tthis.inputingText = undefined;\n\t}\n*/\n\t@computed get doneItems():{uncheckedItems:ContentCheckItem[], checkedItems: ContentCheckItem[]} {\n\t\tlet uncheckedItems:ContentCheckItem[] = [];\n\t\tlet checkedItems:ContentCheckItem[] = [];\n\t\tfor (let ci of this.items) {\n\t\t\tlet {checked} = ci;\n\t\t\tif (checked === true) checkedItems.push(ci);\n\t\t\telse uncheckedItems.push(ci);\n\t\t}\n\t\treturn {uncheckedItems, checkedItems};\n\t}\n}\n","import React from 'react';\nimport { View } from \"tonva\";\nimport { CList } from './CList';\nimport { observer } from 'mobx-react';\n\nexport class VView extends View<CList> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet items = this.controller.items;\n\t\t\treturn <ul className=\"note-content-list px-3 my-2\">\n\t\t\t\t{items.map((v, index) => {\n\t\t\t\t\tlet {key, text} = v;\n\t\t\t\t\treturn <li key={key} className=\"ml-3 pt-1 pb-2 align-items-center\">\n\t\t\t\t\t\t{text}\n\t\t\t\t\t</li>\n\t\t\t\t})}\n\t\t\t</ul>;\n\t\t}));\n\t}\n}\n","import React from 'react';\nimport { ListInputBase } from \"../ListInputBase\";\nimport { ListItem } from \"./CList\";\n\nexport class ListInput extends ListInputBase<ListItem> {\n\tprotected getItemKey(item:ListItem): number {return item.key}\n\tprotected getItemText(item:ListItem): string {return item?.text}\n\tprotected setItemText(item:ListItem, text:string): void {if (item) {item.text = text}}\n\tprotected newItem(key:number, text:string): ListItem {return {key, text}};\n\n\tprotected renderItemHeader(item:ListItem):JSX.Element {\n\t\treturn <div className=\"w-3c w-min-3c w-max-3c pt-2 text-center\">●</div>;\n\t}\n}\n","import { CContent } from \"../CContent\";\n//import { VInput } from \"./VInput\";\nimport { VView } from \"./VView\";\nimport { observable } from \"mobx\";\nimport { ListInput } from \"./ListInput\";\n\nexport interface ListItem {\n\tkey: number;\n\ttext: string;\n}\n\nexport class CList extends CContent {\n\tprivate listInput: ListInput;\n\t@observable items: ListItem[] = [];\n\titemKey: number = 1;\n\n\tinit(obj:any) {\n\t\tthis.itemKey = obj.itemKey;\n\t\tthis.items = obj.items;\n\t}\n\n\tstartInput(): void {\n\t\tsuper.startInput();\n\t\tthis.listInput = new ListInput({\n\t\t\titems: this.items,\n\t\t\tuniqueKey: () => this.itemKey++,\n\t\t\tonChanged: () => this.changed = true,\t\t\t\t\t\n\t\t});\n\t}\n\n\trenderInput():JSX.Element {\n\t\treturn this.listInput.render();\n\t\t//let v = new VInput(this);\n\t\t//return v.render();\n\t}\n\trenderViewContent():JSX.Element {return this.renderView(VView)}\n\n\tendInput(obj:any): void {\n\t\tthis.items = this.listInput.getList();\n\t\tthis.buildObj(obj);\n\t}\n\n\tprotected buildObj(obj:any): void {\n\t\tobj.itemKey = this.itemKey;\n\t\tobj.items = this.items;\n\t\tdelete obj.content;\n\t}\n\n\ttoString():string { \n\t\treturn this.items?.map(v => v.text).join('\\n')\n\t}\n\n\tfromString(value: string) {\n\t\tif (value) {\n\t\t\tthis.items = [];\n\t\t\tthis.itemKey = 1;\n\t\t\tthis.items.push(...value.split('\\n').filter((v, index) => {\n\t\t\t\treturn v.trim().length > 0;\n\t\t\t}).map((v, index) => {\n\t\t\t\treturn {\n\t\t\t\t\tkey: this.itemKey++,\n\t\t\t\t\ttext: v,\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n/*\n\tonItemChanged = (key: number, value: string) => {\n\t\tlet item = this.items.find(v => v.key === key);\n\t\tif (item) {\n\t\t\titem.text = value;\n\t\t}\n\t\telse {\n\t\t\tthis.inputingText = value;\n\t\t}\n\t\tthis.changed = true;\n\t}\n\n\taddNewItem(): void {\n\t\tif (this.inputingText === undefined) return;\n\t\tlet text = this.inputingText.trim();\n\t\tif (text.length === 0) return;\n\t\tthis.items.push({\n\t\t\tkey: this.itemKey++,\n\t\t\ttext: text,\n\t\t});\n\t\tthis.changed = true;\n\t\tthis.inputingText = undefined;\n\t}\n*/\n}\n","import { CContent } from \"../CContent\";\nimport { observable } from \"mobx\";\n\nexport abstract class CTextBase extends CContent {\n\t@observable noteContent: string;\n\t@observable changedNoteContent: string;\n\n\tinit(obj: any): void {\n\t\tswitch (typeof obj) {\n\t\t\tdefault: break;\t\t\t\t// Add状态，没有初始值\n\t\t\tcase 'undefined': break;\n\t\t\tcase \"string\":  this.noteContent = (obj as string).trim(); break;\n\t\t\tcase \"object\": this.noteContent = obj.content?.trim(); break;\n\t\t}\n\t}\n\n\tendInput(obj:any): void {\n\t\tif (this.changedNoteContent !== undefined) {\n\t\t\tthis.noteContent = this.changedNoteContent;\n\t\t\tthis.changedNoteContent = undefined;\n\t\t}\n\t\tthis.buildObj(obj);\n\t}\n\n\tprotected buildObj(obj:any) {\n\t\tobj.content = this.changedNoteContent || this.noteContent;\n\t\tdelete obj.itemKey;\n\t\tdelete obj.items;\n\t}\n}\n","import { renderParagraphs } from '../../../components';\nimport React from 'react';\nimport { View } from \"tonva\";\nimport { CTextBase } from './CTextBase';\n\nexport class VTextBaseView<T extends CTextBase> extends View<T> {\n\trender() {\n\t\treturn <div className=\"px-3 my-2\">\n\t\t\t{this.renderParagraphs(this.controller.noteContent)}\n\t\t</div>;\n\t}\n\t\n\tprotected renderParagraphs(content:string):JSX.Element {\n\t\treturn renderParagraphs(content);\n\t}\n}\n","import React from 'react';\nimport { View } from \"tonva\";\nimport { CTextBase } from './CTextBase';\nimport { observer } from 'mobx-react';\n\nexport class VTextBaseInput<T extends CTextBase> extends View<T> {\n\trender() {\n\t\treturn <div className=\"py-1 px-1\">\n\t\t\t{React.createElement(observer(() => this.renderContentTextArea()))}\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={this.t('content')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n\n\tprivate onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t\tthis.controller.changed = true;\n\t}\n}\n","//import React from 'react';\nimport { CText } from './CText';\n//import { observer } from 'mobx-react';\n//import { View, t } from 'tonva';\nimport { VTextBaseInput } from '../textBase';\n\nexport class VInput<T extends CText> extends VTextBaseInput<T> {\n\t/*\n\trender() {\n\t\treturn <div className=\"py-1 px-1\">\n\t\t\t{React.createElement(observer(() => this.renderContentTextArea()))}\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={t('content')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n\n\tprivate onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t\tthis.controller.changed = true;\n\t}\n\t*/\n}\n","import React from 'react';\nimport { VTextBaseView } from '../textBase';\nimport { CText } from './CText';\n\nexport class VView<T extends CText> extends VTextBaseView<T> {\n\trender() {\n\t\treturn <div className=\"px-3 my-2\">\n\t\t\t{this.renderParagraphs(this.controller.noteContent)}\n\t\t</div>;\n\t}\n}\n","import { VInput } from \"./VInput\";\nimport { VView } from \"./VView\";\nimport { CTextBase } from \"../textBase\";\n\nexport class CText extends CTextBase {\n\trenderInput():JSX.Element {return this.renderView<this>(VInput)}\n\trenderViewContent():JSX.Element {return this.renderView<this>(VView)}\n\n\ttoString():string { return this.changedNoteContent || this.noteContent }\n\tfromString(v: string) {\n\t\tthis.noteContent = v.trim();\n\t}\n}\n\n","//import React from 'react';\n//import { View, t } from \"tonva\";\nimport { CFolder } from './CFolder';\n//import { observer } from 'mobx-react';\nimport { VTextBaseInput } from '../textBase';\n\nexport class VInput extends VTextBaseInput<CFolder> {\n\t/*\n\trender() {\n\t\treturn <div className=\"py-1 px-1\">\n\t\t\t{React.createElement(observer(() => this.renderContentTextArea()))}\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={t('content')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n\n\tprivate onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t\tthis.controller.changed = true;\n\t}\n\t*/\n}\n","//import React from 'react';\n//import { View } from \"tonva\";\nimport { CFolder } from './CFolder';\nimport { VTextBaseView } from '../textBase';\n\nexport class VView extends VTextBaseView<CFolder> {\n\t/*\n\trender() {\n\t\treturn <div className=\"px-3 my-2\">\n\t\t\t{this.renderParagraphs(this.controller.noteContent)}\n\t\t</div>;\n\t}\n\n\tprotected renderParagraphs(content:string):JSX.Element {\n\t\tif (!content) return;\n\t\treturn <>{content.trimRight().split('\\n').map((v, index) => {\n\t\t\tlet c:any;\n\t\t\tif (!v) {\n\t\t\t\tc = '\\u00A0'; //<>&nbsp;</>;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc = '';\n\t\t\t\tlet len = v.length, i=0;\n\t\t\t\tfor (; i<len; i++) {\n\t\t\t\t\tswitch(v.charCodeAt(i)) {\n\t\t\t\t\t\tcase 0x20: c +='\\u2000'; continue;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tc += v.substr(i);\n\t\t\t}\n\t\t\treturn <div key={index} className=\"pt-1 pb-2\">{c}</div>;\n\t\t})}</>;\n\t}\n\t*/\n}\n","import { VInput } from \"./VInput\";\nimport { VView } from \"./VView\";\nimport { CTextBase } from \"../textBase\";\n\nexport class CFolder extends CTextBase {\n\trenderInput():JSX.Element {return this.renderView(VInput)}\n\trenderViewContent():JSX.Element {\n\t\treturn this.renderView(VView)\n\t}\n}\n\n","import React from 'react';\nimport { VBasePage } from '../../views/VBasePage';\nimport { CTo } from './CTo';\n\nexport class VSent extends VBasePage<CTo> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {return '已发送'}\n\tcontent() {\n\t\treturn <div className=\"m-5 border rounded bg-white\">\n\t\t\t<div className=\"p-5 text-center border-bottom\">已发送</div>\n\t\t\t<div className=\"text-center py-3\">\n\t\t\t\t<button className=\"btn btn-outline-info\" onClick={()=>this.backPage()}>返回</button>\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { List, FA } from 'tonva';\nimport { Contact } from '../../../model';\nimport { VBasePage } from '../../views/VBasePage';\n//import { VActions } from './VActions';\nimport { CTo } from './CTo';\n\nexport class VTo extends VBasePage<CTo> {\n\t//protected backPageCount = 2;\n\t/*\n\tinit(param?:any):void {\n\t\tif (param) {\n\t\t\tthis.backPageCount = Number(param);\n\t\t}\t\n\t}\n\t*/\n\n\t@observable private anyChanged:boolean = false;\n\tprivate list: List;\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\theader() {return '收件人'}\n\tright():any {\n\t\tlet c = observer(() => <button className=\"btn btn-sm btn-primary mr-1\" onClick={this.onNext} disabled={!this.anyChanged}>\n\t\t\t下一步 <FA name=\"angle-right\" />\n\t\t</button>);\n\t\treturn React.createElement(c);\n\t}\n\tcontent() {\n\t\tlet items = this.controller.groupContacts; //.cApp.contacts;\n\t\treturn <div className=\"\">\n\t\t\t<List ref={v => this.list = v}\n\t\t\t\titems={items} \n\t\t\t\titem={{render:this.renderContactItem, onSelect:this.onContactSelect}}\n\t\t\t\tisItemSelected={v => v.already} />\n\t\t</div>\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tlet {already} = item;\n\t\tif (\n\t\t\t\t(isSelected === true && already === 0)\n\t\t\t || (isSelected === false && already > 0)\n\t\t\t)\n\t\t{\n\t\t\tthis.anyChanged = true;\n\t\t}\n\t}\n\n\tprivate onNext = async () => {\n\t\tlet contacts = this.list.selectedItems;\n\t\tawait this.controller.onContactsSelected(contacts);\n\t\t//this.controller.contacts = contacts;\n\t\t//this.openVPage(VActions, this.backPageCount + 1); //, {contacts, noteId: this.currentNoteId});\n\t}\n}\n","import { observable } from \"mobx\";\nimport { CUqBase } from \"../../../tapp\";\nimport { Contact } from \"../../../model\";\nimport { VSent } from \"./VSent\";\nimport { VTo } from \"./VTo\";\nimport { Query } from \"tonva\";\nimport { NoteItem } from \"notes/model\";\n\nexport abstract class CTo extends CUqBase {\n\tprotected currentGroupFolder: number;\n\tcurrentNoteItem: NoteItem;\n\t@observable groupContacts: Contact[];\n\t@observable contacts: Contact[];\n\n\tconstructor(cApp:any, currentGroupFolder: number, currentNoteItem: NoteItem) {\n\t\tsuper(cApp);\n\t\tthis.currentGroupFolder = currentGroupFolder;\n\t\tthis.currentNoteItem = currentNoteItem;\n\t}\n\n\tprotected abstract get GetContacts(): Query; // this.uqs.notes.GetMyContacts\n\tprotected abstract sendOut(toList:number[]):Promise<void>;\n\tprotected abstract afterContactsSelected(): Promise<void>;\n\n\tprotected async internalStart():Promise<void> {\n\t\tlet ret = await this.GetContacts.page(\n\t\t\t{\n\t\t\t\tgroupFolder: this.currentGroupFolder,\n\t\t\t\tnote: this.currentNoteItem.note,\n\t\t\t}, 0, 50, true);\n\t\tthis.groupContacts = ret.$page;\n\t\tthis.startAction();\n\t\tthis.openVPage(VTo);\n\t}\n\n\tonSendOut = async (): Promise<void> => {\n\t\t//let {contacts, noteItem, currentFold: currentFoldItem} = this.controller;\n\t\tlet toList = this.contacts.map (v => {\n\t\t\tlet {contact} = v;\n\t\t\tif (!contact) return undefined;\n\t\t\tif (typeof contact === 'object') return (contact as any).id;\n\t\t\treturn contact;\n\t\t});\n\t\t//await this.controller.sendNoteTo(currentFoldItem.folderId, noteItem.note, toList);\n\t\tawait this.sendOut(toList);\n\t\tthis.popToTopPage();\n\t\tthis.openVPage(VSent);\n\t}\n\n\tasync onContactsSelected(contacts: Contact[]) {\n\t\tthis.contacts = contacts;\n\t\tawait this.afterContactsSelected();\n\t}\n}\n","import React from 'react';\n\nexport function renderParagraphs(content:string):JSX.Element {\n\tif (!content) return;\n\treturn <>{content.trimRight().split('\\n').map((v, index) => {\n\t\tlet c:any;\n\t\tif (!v) {\n\t\t\tc = '\\u00A0'; //<>&nbsp;</>;\n\t\t}\n\t\telse {\n\t\t\tc = '';\n\t\t\tlet len = v.length, i=0;\n\t\t\tfor (; i<len; i++) {\n\t\t\t\tswitch(v.charCodeAt(i)) {\n\t\t\t\t\tcase 0x20: c +='\\u2000'; continue;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tc += v.substr(i);\n\t\t}\n\t\treturn <div key={index} className=\"pt-1 pb-2\">{c}</div>;\n\t})}</>;\n}\n","import React from 'react';\nimport { List, FA, User, Image, UserView } from 'tonva';\nimport { CContainer } from '../CContainer';\nimport { CNoteBase, VNoteBase } from \"../../noteBase\";\nimport { observer } from 'mobx-react';\nimport { renderParagraphs } from '../../components';\n\nexport class VFolder<T extends CContainer> extends VNoteBase<T> {\n\tafterBack() {\n\t\tthis.controller.owner.popFolder();\n\t}\n\theader() {\n\t\treturn React.createElement(observer(() => {\n\t\t\t\tlet {noteItem} = this.controller;\n\t\t\tif (noteItem) {\n\t\t\t\treturn noteItem.caption;\n\t\t\t}\n\t\t\treturn this.t('notes');\n\t\t}));\n\t}\n\n\tright() {\n\t\t// 应该任何群成员都可以发小单吧\n\t\t//if (this.isMe(this.controller.noteItem.owner)) {\n\t\t\treturn this.controller.owner.renderFolderDropDown();\n\t\t//}\n\t}\n\n\tprotected top() {\n\t\tlet {noteItem} = this.controller;\n\t\tif (!noteItem) return;\n\n\t\tlet paragraphs: string;\n\t\tlet {content: contentString} = noteItem;\n\t\tlet json = JSON.parse(contentString);\n\t\tif (json) {\n\t\t\tlet {content} = json;\n\t\t\tparagraphs = (content as string)?.trimEnd();\n\t\t}\n\t\telse {\n\t\t\tparagraphs = \"整理小单\";\n\t\t}\n\t\tlet left: any;\n\t\tif (this.isMe(this.controller.noteItem.owner)) {\n\t\t\tleft = <>\n\t\t\t\t<FA className=\"mr-3 text-warning py-3\" name={noteItem.toCount > 0 ? \"folder-open\":\"folder\"} size=\"3x\" />\n\t\t\t\t<div className=\"small text-muted py-3\">{this.renderParagraphs(paragraphs)}</div>\n\t\t\t</>;\n\t\t}\n\t\telse {\n\t\t\tlet {owner, assigned} = noteItem;\n\t\t\tlet renderUser = (user:User) => {\n\t\t\t\tlet {name, nick, icon} = user;\n\t\t\t\treturn <>\n\t\t\t\t\t<Image className=\"w-3c h-3c mr-2 my-3\" src={icon || '.user-o'} />\n\t\t\t\t\t<div className=\"py-3\">\n\t\t\t\t\t\t<div className=\"small\">{assigned || nick || name}</div>\n\t\t\t\t\t\t<div className=\"small text-muted py-3\">{this.renderParagraphs(paragraphs)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</>;\n\t\t\t}\n\t\t\tleft = <UserView user={owner as number} render={renderUser} />;\n\t\t}\n\t\treturn <div className=\"d-flex ml-3\">\n\t\t\t{left}\n\t\t\t<div className=\"ml-auto align-self-stretch cursor-pointer px-3 d-flex align-items-center\" \n\t\t\t\tonClick={(e)=>{e.stopPropagation(); this.controller.showFolderView()}}>\n\t\t\t\t<FA name=\"ellipsis-h\" />\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tcontent() {\n\t\tlet {notesPager, showNoteItem} = this.controller;\n\t\treturn <div>\n\t\t\t{React.createElement(observer(() => this.top()))}\n\t\t\t<List className=\"\" \n\t\t\t\titems={notesPager} \n\t\t\t\titem={{\n\t\t\t\t\trender: this.renderItemInFolder,\n\t\t\t\t\tkey: this.noteKey, \n\t\t\t\t\tonClick: showNoteItem,\n\t\t\t\t\tclassName:'notes'}} />\n\t\t</div>\n\t}\n\n\tprotected renderParagraphs(content:string):JSX.Element {\n\t\treturn renderParagraphs(content);\n\t}\n\n\trenderListView() {\n\t\treturn this.content();\n\t}\n\n\tprivate noteKey = (item: CNoteBase) => {\n\t\tlet note = item.noteItem.note;\n\t\treturn note;\n\t}\n\n\tprivate renderItemInFolder = (cNoteBase: CNoteBase, index:number) => {\n\t\treturn <div className=\"d-block mb-2 bg-white\">{cNoteBase.renderDirItem(index)}</div>;\n\t}\n}\n","import React from 'react';\nimport { FA } from 'tonva';\nimport { CContainer } from '../CContainer';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from '../../noteBase/VNoteBase';\n\nexport class VFolderDir extends VNoteBase<CContainer> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet {toCount, unread} = noteItem;\n\t\t\tlet divToCount:any;\n\t\t\tif (toCount > 0) {\n\t\t\t\tdivToCount = <small className=\"ml-4 text-muted\">\n\t\t\t\t\t<FA name=\"share\" className=\"mr-1\" />\n\t\t\t\t\t{toCount}\n\t\t\t\t</small>;\n\t\t\t}\n\n\t\t\tlet dot:any;\n\t\t\tif (unread>0) {\n\t\t\t\tdot = <u/>;\n\t\t\t}\n\t\n\t\t\tlet vIcon = <div className=\"unread-dot mr-3\">\n\t\t\t\t<FA name=\"folder\" className=\"text-warning\" size=\"lg\" fixWidth={true} />\n\t\t\t\t{dot}\n\t\t\t</div>;\n\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t<div className=\"d-flex px-3 py-2 align-items-center\">\n\t\t\t\t\t{vIcon}\n\t\t\t\t\t<b className=\"\">{noteItem.caption}</b>\n\t\t\t\t\t{divToCount}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}));\n\t}\n}\n","//import React from 'react';\nimport { VRelativesBase, TabRelative } from \"../../noteBase\";\nimport { CFolder } from \"../CFolder\";\n\nexport class VFolderRelatives extends VRelativesBase<CFolder> {\n\tprotected get tabs():TabRelative[] { return [this.tabShare] };\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VNoteBaseView } from '../../noteBase';\nimport { CContainer } from '../CContainer';\nimport { VFolderRelatives } from './VFolderRelatives';\n\nexport class VFolderView<T extends CContainer> extends VNoteBaseView<T> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tif (noteItem) {\n\t\t\t\treturn noteItem.caption;\n\t\t\t}\n\t\t\treturn this.t('notes');\n\t\t}));\n\t}\n\n\tprotected renderRelatives() {\n\t\treturn this.renderVm(VFolderRelatives as any);\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.controller.cContent.renderViewContent();\n\t}\n}\n","import { CNoteBase } from \"../noteBase\";\nimport { NoteItem, NoteModel, EnumNoteType, initNoteItemObj } from '../model';\nimport { QueryPager } from \"tonva\";\nimport { EnumSpecFolder } from \"tapp\";\nimport { VFolder } from \"./views/VFolder\"\nimport { VFolderDir } from \"./views/VFolderDir\";\nimport { VFolderView } from \"./views/VFolderView\";\nimport { observable, computed } from \"mobx\";\nimport { CContent, CFolder } from \"notes/components\";\n\nexport abstract class CContainer extends CNoteBase {\n\t@observable cContent: CContent;\n\tfolderId: number;\n\tnotesPager: QueryPager<CNoteBase>;\n\tcurrentNoteItem: NoteItem;\n\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tthis.cContent = new CFolder(this.res)\n\t\tif (param) {\n\t\t\tthis.caption = param.caption;\n\t\t\tthis.cContent.init(param.obj);\n\t\t}\n\t\t//this.relativeKey = 'to';\n\n\t\tlet folderId = this.noteItem?.note;\n\t\tif (!folderId) this.folderId = -EnumSpecFolder.notes;\n\t\telse this.folderId = folderId;\n\n\t\tthis.notesPager = new QueryPager<CNoteBase>(this.uqs.notes.GetNotes, undefined, undefined, true);\n\t\tthis.notesPager.setItemConverter(this.getItemConverter());\n\t}\n\n\t@computed get isContentChanged():boolean {return this.cContent.changed}\n\n\tprotected getItemConverter() {\n\t\treturn this.owner.noteItemConverter;\n\t}\n\n\tasync load() {\n\t\tawait this.notesPager.first({folderId: this.folderId});\n\t}\n\n\tasync refresh() {\n\t\t//每次刷新取5个。\n\t\tlet newnotes = new QueryPager<NoteItem>(this.uqs.notes.GetNotes, 5, 5, false);\n\t\tawait newnotes.first({folderId: this.folderId});\n\t\tlet newitems = newnotes.items;\n\t\tif (newitems) {\n\t\t\tlet len = newitems.length;\n\t\t\tlet items = this.notesPager.items;\n\t\t\tfor (let i = len - 1; i >= 0; --i) {\n\t\t\t\tlet item = newitems[i];\n\t\t\t\tlet note = item.note;\n\t\t\t\tlet index = items.findIndex(v => v.noteItem.note===note);\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\titems.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tlet cNoteItem = this.owner.noteItemConverter(item, undefined);\n\t\t\t\titems.unshift(cNoteItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async getNote(id: number): Promise<NoteModel> {\n\t\tlet folderId = this.owner.currentFold?.folderId;\n\t\tlet ret = await this.uqs.notes.GetNote.query({folder: folderId, note: id});\n\t\tlet noteModel:NoteModel = ret.ret[0];\n\t\tnoteModel.to = ret.to;\n\t\tnoteModel.flow = ret.flow;\n\t\tnoteModel.spawn = ret.spawn;\n\t\tnoteModel.contain = ret.contain;\n\t\tnoteModel.comments = ret.comments;\n\t\tfor (var sItem of noteModel.spawn) {\n\t\t\tinitNoteItemObj(sItem);\n\t\t}\n\t\treturn noteModel;\n\t}\n\n\tshowNoteItem = async (item: CNoteBase) => {\n\t\tlet noteItem = this.currentNoteItem = item.noteItem;\n\t\tlet noteModel = await this.getNote(noteItem.note);\n\t\tnoteItem.unread = 0;\n\t\tnoteItem.commentUnread = 0;\n\t\titem.noteModel = noteModel;\n\t\treturn item.showViewPage();\n\t}\n\n\titemChanged(noteItem: NoteItem):NoteItem {\n\t\tlet {items} = this.notesPager;\n\t\tlet index = items.findIndex(v => v.noteItem === noteItem);\n\t\tif (index > 0) {\n\t\t\tlet fItem = items.splice(index, 1);\n\t\t\titems.unshift(...fItem);\n\t\t}\n\t\t//return index >= 0;\n\t\treturn this.noteItem;\n\t}\n\n\tabstract async showFolder(): Promise<void>;\n\t/* {\n\t\tthis.load();\n\t\tthis.openVPage(VFolder);\n\t}*/\n\n\trenderListView() {\n\t\treturn (new VFolder(this)).renderListView();\n\t}\n\n\tshowViewPage(): void {\n\t\tthis.owner.openFolder(this);\n\t}\n\n\tasync showFolderView() {\n\t\tlet noteItem = this.noteItem;\n\t\tif (!noteItem)\n\t\t\treturn;\n\t\tlet noteModel = await this.getNote(noteItem.note);\n\t\tnoteItem.unread = 0;\n\t\tnoteItem.commentUnread = 0;\n\t\tthis.noteModel = noteModel;\n\t\tthis.showFolderViewPage();\n\t}\n\n\tshowFolderViewPage() {\n\t\tthis.openVPage(VFolderView as any);\n\t}\n\n\tasync addNote(folder:number, caption:string, content:string, obj:any, type:EnumNoteType) {\n\t\tlet sub = 0;\n\t\tlet param = {\n\t\t\tgroupFolder:this.groupFolder,\n\t\t\tfolder:folder,\n\t\t\tcaption,\n\t\t\tcontent,\n\t\t\ttype,\n\t\t\tsub}\n\t\tlet ret = await this.uqs.notes.AddNote.submit(param);\n\t\tlet {note} = ret;\n\t\tlet date = new Date();\n\t\tlet noteItem:NoteItem = {\n\t\t\tseconds: undefined,\n\t\t\towner: this.user.id,\n\t\t\tnote: note as number,\n\t\t\ttype,\n\t\t\tcaption,\n\t\t\tcontent,\n\t\t\tassigned: undefined,\n\t\t\tfrom: undefined,\n\t\t\tfromAssigned: undefined,\n\t\t\tstate: undefined,\n\t\t\tunread: 0,\n\t\t\tobj,\n\t\t\t$create: date,\n\t\t\t$update: date,\n\t\t}\n\t\tif (type === EnumNoteType.folder) {\n\t\t\tnoteItem.groupFolder = this.groupFolder;\n\t\t}\n\t\tlet cNoteItem = this.owner.createCNoteBase(noteItem);\n\t\tcNoteItem.init(noteItem);\n\t\tif (folder === this.folderId) {\n\t\t\tthis.notesPager.items.unshift(cNoteItem);\n\t\t}\n\t\treturn cNoteItem;\n\t}\n\n\tasync editNote(waiting:boolean, noteItem:NoteItem, caption:string, content:string, obj:any) {\n\t\tlet {SetNote} = this.uqs.notes;\n\t\tlet {note, type} = noteItem;\n\t\tawait SetNote.submit({note, caption, content, type}, waiting);\n\t\t// Note.resetCache(note); 现在不调用NoteTuid的cache，所以不需要了\n\t\t// noteItem.unread = 1; 自己修改自己的小单，只是移到最前面，并不显示unread\n\t\tif (note === this.noteItem?.note) {\n\t\t\tthis.noteItem.caption = caption;\n\t\t\tthis.noteItem.content = content;\n\t\t\tthis.noteItem.obj = obj;\n\t\t}\n\t\telse {\n\t\t\tlet {items} = this.notesPager;\n\t\t\tlet index = items.findIndex(v => v.noteItem.note===note);\n\t\t\tif (index >= 0) {\n\t\t\t\tlet theItems = items.splice(index, 1);\n\t\t\t\tlet theItem = theItems[0];\n\t\t\t\ttheItem.noteItem.caption = caption;\n\t\t\t\ttheItem.noteItem.content = content;\n\t\t\t\ttheItem.noteItem.obj = obj;\n\t\t\t\titems.unshift(theItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync hideNote(note:number, x:number) {\n\t\tawait this.uqs.notes.HideNote.submit({note, x});\n\t\tlet index = this.notesPager.items.findIndex(v => v.noteItem.note === note);\n\t\tif (index >= 0) this.notesPager.items.splice(index, 1);\n\t}\n\n\trenderDirItem(index: number): JSX.Element {\n\t\tlet vNoteItem = new VFolderDir(this);\n\t\treturn vNoteItem.render();\n\t}\n\n\tasync addGroup(caption:string, content:string, members:{member:number}[]) {\n\t\tlet ret = await this.uqs.notes.AddGroup.submit({caption, content, members});\n\t\tlet {group, folder} = ret;\n\t\tlet date = new Date();\n\t\tlet type = EnumNoteType.groupFolder;\n\t\tlet noteItem:NoteItem = {\n\t\t\tseconds: undefined,\n\t\t\towner: this.user.id,\n\t\t\tnote: folder as number,\n\t\t\ttype,\n\t\t\tcaption,\n\t\t\tcontent,\n\t\t\tassigned: undefined,\n\t\t\tfrom: undefined,\n\t\t\tfromAssigned: undefined,\n\t\t\tstate: undefined,\n\t\t\tgroupFolder:group,\n\t\t\tunread: 0,\n\t\t\tobj: undefined,\n\t\t\t$create: date,\n\t\t\t$update: date,\n\t\t}\n\t\tlet cNoteItem = this.owner.createCNoteBase(noteItem);\n\t\tcNoteItem.init(noteItem);\n\t\tthis.notesPager.items.unshift(cNoteItem);\n\t\treturn cNoteItem;\n\t}\n\n\ttaskUpdateState(noteItem:NoteItem) {\n\t\tlet {items} = this.notesPager;\n\t\tlet {note} = noteItem;\n\t\tlet index = items.findIndex(v => v.noteItem.note===note);\n\t\tif (index >= 0) {\n\t\t\titems.splice(index, 1);\n\t\t\tlet c = this.getItemConverter();\n\t\t\tlet newItem = c(noteItem, undefined);\n\t\t\titems.unshift(newItem);\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { FA } from 'tonva';\nimport { CSpace } from './CSpace';\nimport { observer } from 'mobx-react';\nimport { VNoteBase, renderIcon } from 'notes/noteBase';\n\nexport class VSpaceDir extends VNoteBase<CSpace> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet {toCount, unread} = noteItem;\n\t\t\tlet divToCount:any;\n\t\t\tif (toCount > 0) {\n\t\t\t\tdivToCount = <small className=\"ml-4 text-muted\">\n\t\t\t\t\t<FA name=\"share\" className=\"mr-1\" />\n\t\t\t\t\t{toCount}\n\t\t\t\t</small>;\n\t\t\t}\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t<div className=\"d-flex pl-2 pr-3 py-2 align-items-center\">\n\t\t\t\t\t<div className=\"unread-dot mr-3\">\n\t\t\t\t\t\t{renderIcon('users', 'text-warning')}\n\t\t\t\t\t\t{unread>0 && <u />}\n\t\t\t\t\t</div>\n\t\t\t\t\t<b className=\"text-primary\">{noteItem.caption}</b>\n\t\t\t\t\t{divToCount}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}));\n\t}\n\t// <FA name=\"users\" className=\"text-warning\" size=\"lg\" fixWidth={true} />\n}\n","import { VBasePage } from 'notes/views/VBasePage';\nimport React from 'react';\nimport { FA, List } from 'tonva';\nimport { CSpace } from './CSpace';\n\nexport class VSpaceMembers extends VBasePage<CSpace> {\n\theader() {return '空间成员'}\n\tright() {\n\t\treturn <div className=\"cursor-pointer btn btn-lg text-white p-1 mr-1\" onClick={this.controller.showAddMember}>\n\t\t\t<FA name=\"plus\" />\n\t\t</div>;\n\t}\n\tcontent() {\n\t\treturn <div>\n\t\t\t<div className=\"text-success px-3 py-2 bg-white border-bottom\">[自己]</div>\n\t\t\t<List items={this.controller.members} item={{render: this.renderContactItem}} />\n\t\t</div>\n\t}\n}","import React from 'react';\nimport { DropdownAction, FA } from 'tonva';\nimport { VFolder } from \"../views/VFolder\";\nimport { CSpace } from './CSpace';\nimport { VNotesDropDown } from '../../views';\nimport { CNotes } from 'notes/CNotes';\nimport { observer } from 'mobx-react';\n\nexport class VSpaceView extends VFolder<CSpace> {\n\theader() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet caption = noteItem ? noteItem.caption : this.t('noteSpace');\n\t\t\treturn <div>{caption}</div>\n\t\t}));\n\t}\n\n\tright() {\n\t\tif (this.isMe(this.controller.groupOwner)) {\n\t\t\tlet dd = new VSpaceDropdown(this.controller.owner, this.controller);\n\t\t\treturn dd.render();\n\t\t}\n\t\telse {\n\t\t\treturn this.controller.owner.renderSpaceDropDown();\n\t\t}\n\t}\n\n\tprotected top():JSX.Element {\n\t\tlet {noteItem} = this.controller;\n\t\tif (!noteItem) return;\n\n\t\tlet paragraphs: string = '群';\n\t\tlet {content: contentString} = noteItem;\n\t\tif (contentString) {\n\t\t\tlet json = JSON.parse(contentString);\n\t\t\tif (json) {\n\t\t\t\tlet {content} = json;\n\t\t\t\tparagraphs = (content as string)?.trimEnd();\n\t\t\t\tparagraphs = paragraphs.replace(/(\\r|\\n)/g, ' ');\n\t\t\t}\n\t\t}\n\t\treturn <div className=\"px-3 py-3 d-flex cursor-pointer align-items-center\"\n\t\t\tonClick={this.controller.showSpaceContent}>\n\t\t\t<FA className=\"mr-3 mt-1 text-warning\" name=\"users\" size=\"2x\" />\n\t\t\t<div className=\"text-muted mr-3\" style={{whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis'}}>\n\t\t\t\t{paragraphs}\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n\nclass  VSpaceDropdown extends VNotesDropDown {\n\tprivate cSpace: CSpace;\n\t\n\tconstructor(cNotes:CNotes, cSpace: CSpace) {\n\t\tsuper(cNotes);\n\t\tthis.cSpace = cSpace;\n\t}\n\tprotected get dropdownActions(): DropdownAction[] {\n\t\tlet addMember = {\n\t\t\ticon:'user-o', \n\t\t\tcaption:this.t('成员增减'), \n\t\t\taction: this.cSpace.showAddMember,\n\t\t\ticonClass: 'text-success'\n\t\t};\n\t\treturn [this.text, this.list, this.checkable, this.task, this.folder, undefined, addMember];\n\t}\n}\n","import { CContainer } from '../CContainer';\nimport { VNoteBaseEdit } from 'notes/noteBase';\n\nexport abstract class VContainerForm<T extends CContainer> extends VNoteBaseEdit<T> {\n\theader() {\n\t\treturn this.t('noteFolder');\n\t}\n\n\tprotected renderContent():JSX.Element {\n\t\treturn this.controller.cContent.renderInput()\n\t}\n\n}\n\n/*\nexport abstract class VContainerForm<T extends CContainer> extends VNoteBaseView<T> {\n\t@observable private changed: boolean = false;\n\tprivate inputAdd: HTMLInputElement;\n\n\theader() {return this.t('notes')}\n\n\tprotected onTitleChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.controller.title = evt.target.value.trim();\n\t}\n\n\tprotected onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t}\n\n\t@computed protected get btnSaveDisabled():boolean {\n\t\tif (this.changed === true) return false;\n\t\treturn this.getSaveDisabled();\n\t}\n\n\tprotected abstract getSaveDisabled():boolean;\n\n\tprotected abstract onButtonSave(): Promise<void>;\n\n\tprotected async onDelete(): Promise<void> {\n\t\tlet options: ConfirmOptions = {\n\t\t\tcaption: '请确认',\n\t\t\tmessage: '真的要删除这个小单吗？',\n\t\t\tyes: '确认删除',\n\t\t\tno: '不删除'\n\t\t};\n\t\tif (await this.controller.confirm(options) === 'yes') {\n\t\t\tawait this.controller.owner.hideNote(this.controller.noteItem.note, 1);\n\t\t\tthis.closePage(2);\n\t\t}\n\t}\n\n\tprotected renderDeleteButton() {\n\t\treturn <button className=\"btn btn-outline-secondary mr-3\" onClick={() => this.onDelete()}>\n\t\t\t删除\n\t\t</button>;\n\t}\n\n\tprotected abstract renderExButtons():JSX.Element;\n\n\tprotected renderEdit() {\n\t\treturn <div className=\"m-2\">\n\t\t\t<div className=\"border rounded\">\n\t\t\t\t<div className=\"bg-white\">\n\t\t\t\t\t<div className=\"py-1 px-1 border-bottom\">\n\t\t\t\t\t\t<input type=\"text\" className=\"w-100 border-0 form-control font-weight-bold\" placeholder=\"标题\" maxLength={80}\n\t\t\t\t\t\t\tonChange={this.onTitleChange}\n\t\t\t\t\t\t\tdefaultValue={this.controller.title} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"py-1 px-1\">\n\t\t\t\t\t\t{React.createElement(observer(() => this.renderContentTextArea()))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={this.btnSaveDisabled}>\n\t\t\t\t\t\t\t保存\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</>))}\n\t\t\t\t\t{this.renderExButtons()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={this.t('notes')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n}\n*/","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VContainerForm } from '../views/VContainerForm';\nimport { CSpace } from './CSpace';\n\nexport class VSpaceEdit extends VContainerForm<CSpace> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {\n\t\treturn '编辑空间';\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={!this.controller.isNoteChanged}>\n\t\t\t\t\t保存\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t</div>;\n\t}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.SetGroup();\n\t\tthis.closePage();\n\t}\n}\n","import { observer } from 'mobx-react';\nimport { renderParagraphs } from '../../components';\nimport React from 'react';\nimport { FA, List } from 'tonva';\nimport { VNoteBase } from \"../../noteBase\";\nimport { CSpace } from \"./CSpace\";\n\nexport class VContentView extends VNoteBase<CSpace> {\n\theader() {return '详情'}\n\tright() {\n\t\tlet vEditButton:any;\n\t\tif (this.isMe(this.controller.groupOwner)) {\n\t\t\tvEditButton = <span className=\"mr-2\">{this.renderEditButton()}</span>;\n\t\t}\n\t\treturn vEditButton;\n\t}\n\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tif (!noteItem) return;\n\n\t\t\tlet paragraphs: string = '空间';\n\t\t\tlet {caption, content: contentString} = noteItem;\n\t\t\tif (contentString) {\n\t\t\t\tlet json = JSON.parse(contentString);\n\t\t\t\tif (json) {\n\t\t\t\t\tlet {content} = json;\n\t\t\t\t\tparagraphs = (content as string)?.trimEnd();\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet left: any;\n\t\t\tleft = <div className=\"\">\n\t\t\t\t<div className=\"d-flex py-3 px-3\">\n\t\t\t\t\t<FA className=\"mr-3 text-warning\" name=\"users\" size=\"2x\" />\n\t\t\t\t\t<div>{caption}</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"bg-white px-3 py-2\">\n\t\t\t\t\t{renderParagraphs(paragraphs)}\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t\tlet {memberCount} = this.controller;\n\t\t\tlet members = this.controller.members.filter((value, index)=>value.already===1);\n\t\t\treturn <div>\n\t\t\t\t{left}\n\t\t\t\t<div className=\"d-flex mt-2 align-items-end\">\n\t\t\t\t\t<div className=\"ml-3 mb-2 small text-muted\">{memberCount}成员</div>\n\t\t\t\t\t{ this.isMe(this.controller.groupOwner) ?\n\t\t\t\t\t\t<div className=\"ml-auto cursor-pointer text-success border border-success rounded bg-white px-1 mr-2 mb-1\"\n\t\t\t\t\t\t\tonClick={this.controller.showAddMember}>\n\t\t\t\t\t\t\t<FA name=\"plus\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t:\n\t\t\t\t\t\tundefined\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div className=\"text-success px-3 py-2 bg-white border-bottom\">[自己]</div>\n\t\t\t\t\t{members.length>0 && <List items={members} item={{render: this.renderContactItem}} />}\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}));\n\t}\n}\n","import { Contact } from 'model';\nimport { VBasePage } from 'notes/views/VBasePage';\nimport React from 'react';\nimport { List } from 'tonva';\nimport { CSpace } from './CSpace';\n\nexport class VContacts extends VBasePage<CSpace> {\n\theader() {return '选择成员'}\n\tcontent() {\n\t\treturn <div>\n\t\t\t<List items={this.controller.contacts} \n\t\t\t\titem={{render: this.renderContactItem, onSelect:this.onContactSelect}} \n\t\t\t\tisItemSelected={v=> v.already > 0}/>\n\t\t</div>\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tthis.controller.selectMember(item, isSelected);\n\t}\n\n}","import { VSpaceEdit } from \"./VSpaceEdit\";\n\nexport class VSapceAdd extends VSpaceEdit {\n\theader() {return '新建群'}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.addGroup();\n\t\tthis.closePage();\n\t\treturn;\n\t}\n}","import { CContainer } from \"../CContainer\";\nimport { VSpaceDir } from \"./VSpaceDir\";\nimport { renderIcon } from \"../../noteBase\";\nimport { compareID, EnumNoteType, NoteItem } from \"notes/model\";\nimport { observable } from \"mobx\";\nimport { Contact } from \"model\";\nimport { VSpaceMembers } from \"./VSpaceMembers\";\nimport { VSpaceView } from \"./VSpaceView\";\nimport { VSpaceEdit } from \"./VSpaceEdit\";\nimport { VContentView } from \"./VContentView\";\nimport { VContacts } from \"./VContacts\";\nimport { VSapceAdd } from \"./VSpaceAdd\";\n\nexport class CSpace extends CContainer {\n\tgroupId: number;\n\tgroupOwner: number;\n\t@observable memberCount: number;\n\t@observable members:Contact[];\n\t@observable contacts:Contact[];\n\n\tget type():EnumNoteType { return EnumNoteType.groupFolder }\n\tasync showFolder() {\n\t\tthis.load();\n\t\tawait this.loadSpace();\t\t \n\t\tthis.openVPage(VSpaceView);\n\t}\n\n\tasync loadSpace() {\n\t\tlet resulte = await this.uqs.notes.GetGroupFolderMemberCount.query({folder: this.folderId});\n\t\tlet {group, count, owner} = resulte.ret[0];\n\t\tthis.groupId = group;\n\t\tthis.groupOwner = owner;\n\t\tthis.memberCount = count;\n\t}\n\n\tasync loadMembers() {\n\t\tlet result = await this.uqs.notes.GetGroupMembers.query({group: this.groupId});\n\t\tlet ret:any[] = result.ret;\n\t\tlet index = ret.findIndex(v => this.isMe(v.contact));\n\t\tif (index >= 0) ret.splice(index, 1);\n\t\tthis.members = ret;\n\t}\n\n\tasync loadContacts() {\n\t\tlet result = await this.uqs.notes.GetGroupContacts.query({group: this.groupId});\n\t\tlet ret:any[] = result.ret;\n\t\tlet index = ret.findIndex(v => this.isMe(v.contact));\n\t\tif (index >= 0) ret.splice(index, 1);\n\t\tthis.contacts = ret;\n\t}\n\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('users', 'text-warning');\n\t}\n\trenderDirItem():JSX.Element {\n\t\tlet item = new VSpaceDir(this);\n\t\treturn item.render();\n\t}\n\n\tshowAddPage() {\n\t\tthis.openVPage(VSapceAdd);\n\t}\n\n\tshowEditPage() {\n\t\tthis.openVPage(VSpaceEdit);\n\t}\n\n\tshowMembers = async () => {\n\t\tawait this.loadMembers();\n\t\tthis.openVPage(VSpaceMembers);\n\t}\n\n\tshowSpaceContent = async() => {\n\t\tawait this.loadMembers();\n\t\tthis.openVPage(VContentView);\n\t}\n\n\tshowAddMember = async () => {\n\t\tawait this.loadContacts();\n\t\tawait this.loadMembers();\n\t\tthis.openVPage(VContacts);\n\t}\n\n\tasync selectMember(item:Contact, isSelected:boolean) {\n\t\tlet i = this.contacts.findIndex(v=>compareID(v.contact, item.contact));\n\t\tif (i < 0)\n\t\t\treturn;\n\t\tlet c = this.contacts[i];\n\t\tif (isSelected) {\n\t\t\tawait this.uqs.notes.AddGroupMember.submit({group:this.groupId, member:c.contact});\n\t\t\tc.already = 1;\n\t\t}\n\t\telse {\n\t\t\tawait this.uqs.notes.RemoveGroupMember.submit({group:this.groupId, member:c.contact})\n\t\t\tc.already = 0;\n\t\t}\n\t\tlet mi = this.members.findIndex(v=>compareID(v.contact, item.contact));\n\t\tif (mi >= 0) {\n\t\t\tlet m = this.members[mi];\n\t\t\tm.already = c.already;\n\t\t}\n\t\telse if (isSelected) {\n\t\t\tthis.members.push({...c});\n\t\t}\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n\n\tasync addGroup() {\n\t\tlet obj = this.endContentInput();\n\t\tlet noteContent = JSON.stringify(obj);\n\t\treturn await this.owner.rootFold.addGroup(this.caption, noteContent, []);\n\t}\n\n\tasync SetGroup(showWaiting: boolean = true) {\n\t\tlet obj = this.endContentInput();\n\t\tlet noteContent = JSON.stringify(obj);\n\t\tawait this.editGroup(showWaiting,\n\t\t\tthis.noteItem,\n\t\t\tthis.caption,\n\t\t\tnoteContent,\n\t\t\tobj);\n\t\tthis.updateChange();\n\t}\n\n\tasync editGroup(waiting:boolean, noteItem:NoteItem, caption:string, content:string, obj:any) {\n\t\tlet {SetGroup} = this.uqs.notes;\n\t\tlet {note} = noteItem;\n\t\tawait SetGroup.submit({group:this.groupId, caption, content}, waiting);\n\t\tif (note === this.noteItem?.note) {\n\t\t\tthis.noteItem.caption = caption;\n\t\t\tthis.noteItem.content = content;\n\t\t\tthis.noteItem.obj = obj;\n\t\t}\n\t}\n\n}\n","import { CContainer } from \"./CContainer\";\nimport { NoteItem, EnumNoteType } from \"../model\";\nimport { CNoteBase } from \"../noteBase\";\n\nexport abstract class CFolder extends CContainer {\n\tget type():EnumNoteType { return EnumNoteType.folder }\n}\n\nexport abstract class CFolderDisableItemFrom extends CFolder {\n\tprotected getItemConverter() {\n\t\treturn (item:NoteItem, queryResults:{[name:string]:any[]}):CNoteBase => {\n\t\t\tlet ret = this.owner.noteItemConverter(item, queryResults);\n\t\t\tret.disableFrom = true;\n\t\t\treturn ret;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VContainerForm } from '../views/VContainerForm';\nimport { CFolderMy } from './CFolderMy';\n\nexport class VFolderMyEdit extends VContainerForm<CFolderMy> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {\n\t\treturn '编辑目录';\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={!this.controller.isNoteChanged}>\n\t\t\t\t\t保存\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t</div>;\n\t}\n}\n","import { VFolderMyEdit } from \"./VFolderMyEdit\";\n\nexport class VFolderMyAdd extends VFolderMyEdit {\n\theader() {return '新建小单夹'}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.AddNote();\n\t\tthis.closePage();\n\t\treturn;\n\t}\n}","import React from 'react';\nimport { VFolderView } from '../views';\nimport { CFolderMy } from './CFolderMy';\n\nexport class VFolderMyView extends VFolderView<CFolderMy> {\n\tprotected renderViewBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-end\">\n\t\t\t{this.renderShareButton()}\n\t\t</div>;\n\t}\n}\n","import { VFolder } from '../views/VFolder'\nimport { CFolderMy } from './CFolderMy';\n\nexport class VFolderMy extends VFolder<CFolderMy> {\n\n}","import { CFolderDisableItemFrom } from \"../CFolder\";\nimport { renderIcon } from \"../../noteBase\";\nimport { VFolderMyEdit } from \"./VFolderMyEdit\";\nimport { VFolderMyAdd } from \"./VFolderMyAdd\";\nimport { VFolderMyView } from \"./VFolderMyView\";\nimport { VFolderMy } from \"./VFolderMy\";\n\n// 小单夹\nexport class CFolderMy extends CFolderDisableItemFrom {\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon(this.noteItem.toCount>0? 'files-o': 'file-o', 'text-info');\n\t}\n\tshowAddPage() {\n\t\tthis.openVPage(VFolderMyAdd);\n\t}\n\tshowEditPage() {\n\t\tthis.openVPage(VFolderMyEdit);\n\t}\n\n\tshowFolderViewPage() {\n\t\tthis.openVPage(VFolderMyView);\n\t}\n\n\tasync showFolder() {\n\t\tthis.load();\n\t\tthis.openVPage(VFolderMy);\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n}\n","import { VFolder } from '../views/VFolder'\nimport { CFolderShare } from './CFolderShare';\n\nexport class VFolderShare extends VFolder<CFolderShare> {\n\n}","import { CFolderDisableItemFrom } from \"../CFolder\";\nimport { renderIcon } from \"../../noteBase\";\nimport { VFolderShare } from \"./VFolderShare\";\n\nexport class CFolderShare extends CFolderDisableItemFrom {\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('folder', 'text-warning');\n\t}\n\tshowAddPage() {}\n\tshowEditPage() {}\n\n\tasync showFolder() {\n\t\tthis.load();\n\t\tthis.openVPage(VFolderShare);\n\t}\n}\n","import { CFolder } from \"../CFolder\";\n\nexport class CFolderRoot extends CFolder {\n\trenderIcon(): JSX.Element {return;}\n\tshowAddPage() {}\n\tshowEditPage() {}\n\n\tasync showFolder() {\n\t\tthis.load();\n\t\t//this.openVPage(VFolder);\n\t}\n}\n","import React from 'react';\nimport { FA } from 'tonva';\nimport { CContainer } from '../CContainer';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from '../../noteBase/VNoteBase';\n\nexport class VUnitNoteDir extends VNoteBase<CContainer> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet {toCount, unread} = noteItem;\n\t\t\tlet divToCount:any;\n\t\t\tif (toCount > 0) {\n\t\t\t\tdivToCount = <small className=\"ml-4 text-muted\">\n\t\t\t\t\t<FA name=\"share\" className=\"mr-1\" />\n\t\t\t\t\t{toCount}\n\t\t\t\t</small>;\n\t\t\t}\n\n\t\t\tlet dot:any;\n\t\t\tif (unread>0) {\n\t\t\t\tdot = <u/>;\n\t\t\t}\n\t\n\t\t\tlet vIcon = <div className=\"unread-dot mr-3\">\n\t\t\t\t{this.controller.renderIcon()}\n\t\t\t\t{dot}\n\t\t\t</div>;\n\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t<div className=\"d-flex pl-2 pr-3 py-2 align-items-center\">\n\t\t\t\t\t{vIcon}\n\t\t\t\t\t<b className=\"text-primary\">{noteItem.caption}</b>\n\t\t\t\t\t{divToCount}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}));\n\t}\n}\n","import { EnumNoteType } from \"notes/model\";\nimport { renderIcon } from \"notes/noteBase\";\nimport { CContainer } from \"../CContainer\";\nimport { VUnitNoteDir } from \"./VUnitNoteDir\";\n\nexport class CUniteNote extends CContainer {\n\tget type():EnumNoteType { return EnumNoteType.unitNote }\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('sitemap', 'text-primary');\n\t}\n\n\trenderDirItem(index: number): JSX.Element {\n\t\tlet vNoteItem = new VUnitNoteDir(this);\n\t\treturn vNoteItem.render();\n\t}\n\n\tshowAddPage() {\n\t\t//this.openVPage(VFolderMyAdd);\n\t}\n\tshowEditPage() {\n\t\t//this.openVPage(VFolderMyEdit);\n\t}\n\n\tasync showFolder() {\n\t\tthis.load();\n\t\t//this.openVPage(VFolderMy);\n\t}\n\n}","import React from 'react';\nimport { View, Page, UserView, EasyTime, User } from \"tonva\";\nimport { CComments } from \"./CComments\";\nimport { CommentItem } from 'notes/model';\n\nexport class VCommentsList extends View<CComments> {\n\trender() {\n\t\treturn this.renderComments();\n\t}\n\t\n\tprotected renderComments = () => {\n\t\tlet {comments} = this.controller.cNote.noteModel;\n\t\tlet {length} = comments;\n\t\tif (length === 0) return;\n\t\treturn <div className=\"py-3\">\n\t\t\t{comments.map(v => this.renderComment(v))}\n\t\t\t{\n\t\t\t\tlength >= 10 && <div className=\"px-3 pt-3 cursor-pointer text-primary text-right small\"\n\t\t\t\tonClick={this.showMoreComments}>更多评论...</div>\n\t\t\t}\n\t\t</div>;\n\t}\n\n\tprivate showMoreComments = () => {\n\t\tthis.openPageElement(<Page header=\"评论\">\n\t\t\t<div className=\"text-muted p-3\">更多评论正在开发中 ...</div>\n\t\t</Page>);\n\t}\n\n\tprotected renderComment(comment:CommentItem) {\n\t\tlet {id, owner, assigned, content, $update} = comment;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {id, name, nick} = user;\n\t\t\tlet isMe = this.isMe(id);\n\t\t\tlet userName:string, cn:string;\n\t\t\tif (isMe === true) {\n\t\t\t\tcn = 'text-success';\n\t\t\t\tuserName = '[我]';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcn = 'text-primary-dark';\n\t\t\t\tuserName = assigned || nick || name;\n\t\t\t}\n\t\t\tlet divUserName = <span className={cn + ' mr-2'}>{userName}:</span>;\n\t\t\t// <Image className=\"w-1-5c h-1-5c mx-3\" src={icon || '.user-o'} />\n\t\t\t// <div className=\"small mb-3\">{divUserName}</div>\n\t\t\treturn <div className=\"mt-1 d-flex bg-white pt-2\">\n\t\t\t\t<div className=\"mx-3\">\n\t\t\t\t\t<div className=\"small text-muted\"><EasyTime date={$update} /></div>\n\t\t\t\t\t<div className=\"\">{this.renderCommentContent(divUserName, content)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}\n\t\treturn <UserView key={id} user={owner} render={renderUser} />;\n\t}\n\t\n\tprotected renderCommentContent(vUser:any, content:string):JSX.Element {\n\t\tif (!content) return;\n\t\treturn <>{content.trimRight().split('\\n').map((v, index) => {\n\t\t\tlet c:any;\n\t\t\tif (!v) {\n\t\t\t\tc = '\\u00A0'; //<>&nbsp;</>;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc = '';\n\t\t\t\tlet len = v.length, i=0;\n\t\t\t\tfor (; i<len; i++) {\n\t\t\t\t\tswitch(v.charCodeAt(i)) {\n\t\t\t\t\t\tcase 0x20: c +='\\u2000'; continue;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tc += v.substr(i);\n\t\t\t}\n\t\t\tif (index === 0) c = <>{vUser}{c}</>;\n\t\t\treturn <div key={index} className=\"pb-1\">{c}</div>;\n\t\t})}</>;\n\t}\n}\n","import { EnumNoteType, NoteItem } from \"../../model\";\n\nexport enum EnumTaskState { Start = 0, Done = 1, Pass = 2, Fail = 3, Rated = 4, Canceled = 5 };\n\nexport interface TaskStateResult {\n\tcontent: string;\n\tisEnd: boolean;\n}\nconst stateContents: {[key in EnumTaskState]: TaskStateResult} = {\n\t[EnumTaskState.Start]: {content: '待办', isEnd: false},\n\t[EnumTaskState.Done]: {content: '已办', isEnd: true},\n\t[EnumTaskState.Pass]: {content: '签收', isEnd: true},\n\t[EnumTaskState.Fail]: {content: '拒签', isEnd: true},\n\t[EnumTaskState.Rated]: {content: '已评价', isEnd: true},\n\t[EnumTaskState.Canceled]: {content: '已取消', isEnd: true}\n}\n\nexport function GetTaskStateContent(type:number, state:number) {\n\tif (type !== EnumNoteType.task)\n\t\treturn;\n\treturn stateContents[state as EnumTaskState];\n}\n\nexport function getTaskItemState(noteItem: NoteItem): TaskStateResult {\n\tlet {type, state} = noteItem;\n\tif (type !== EnumNoteType.task)\n\t\treturn;\n\tswitch (state) {\n\t\tcase EnumTaskState.Done:\n\t\t\tif (noteItem.obj.checker) {\n\t\t\t\treturn {content: '待验收', isEnd: false};\n\t\t\t}\n\t\t\telse if (noteItem.obj.rater) {\n\t\t\t\treturn {content: '待评分', isEnd: false};\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EnumTaskState.Pass:\n\t\t\tif (noteItem.obj.rater) {\n\t\t\t\treturn {content: '待评分', isEnd: false};\n\t\t\t}\n\t\t\tbreak;\n\t}\n\treturn GetTaskStateContent(type, state);\n}\n","import React from 'react';\nimport { VPage } from \"tonva\";\nimport { CComments } from \"./CComments\";\n\nexport class VAddComment extends VPage<CComments> {\n\theader() {return \"评论\"}\n\t\n\tcontent() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\"\n\t\t\tplaceholder=\"请输入\" maxLength={20000}\n\t\t\tonChange={this.onCommentChange} />\n\t}\n\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-success mr-1\" onClick={this.onCommentSubmit}>提交</button>;\n\t}\n\n\tprivate comment:string;\n\tprivate onCommentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.comment = evt.target.value;\n\t}\n\n\tprivate onCommentSubmit = async () => {\n\t\tawait this.controller.onAddComment(this.comment);\n\t\t//this.controller.relativeKey = 'comment';\n\t\tthis.closePage();\n\t}\n}\n","import React from 'react';\nimport { View, Page, FA } from \"tonva\";\nimport { CComments } from \"./CComments\";\n\nexport class VWriteComment extends View<CComments> {\n\trender():JSX.Element {\n\t\treturn <div\n\t\t\tclassName=\"flex-fill rounded-pill mr-3 border bg-white px-3 py-1 small cursor-pointer\"\n\t\t\tonClick={this.onComment}>\n\t\t\t写评论...\n\t\t</div>;\n\t}\n\n\trenderButton():JSX.Element {\n\t\treturn <span className=\"cursor-pointer text-primary mr-5\" onClick={this.onComment}>\n\t\t\t<FA name=\"comment-o\" />\n\t\t</span>;\n\t}\n\n\tprotected onComment = () => {\n\t\tlet right = <button className=\"btn btn-sm btn-success mr-1\" onClick={this.onCommentSubmit}>提交</button>;\n\t\tthis.openPageElement(<Page header=\"评论\" right={right}>\n\t\t\t<textarea rows={10} \n\t\t\t\tclassName=\"w-100 border-0 form-control\"\n\t\t\t\tplaceholder=\"请输入\" maxLength={20000}\n\t\t\t\tonChange={this.onCommentChange} />\n\t\t</Page>);\n\t}\n\tprivate comment:string;\n\tprivate onCommentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.comment = evt.target.value;\n\t}\n\n\tprivate onCommentSubmit = async () => {\n\t\tawait this.controller.onAddComment(this.comment);\n\t\t//this.controller.relativeKey = 'comment';\n\t\tthis.closePage();\n\t}\n}\n","import { Controller } from \"tonva\";\nimport { VCommentsList } from \"./VCommentsList\";\nimport { VAddComment } from \"./VAddComment\";\nimport { CNote } from \"notes/note/CNote\";\nimport { VWriteComment } from \"./VWriteComment\";\n\nexport class CComments extends Controller {\n\tcNote: CNote;\n\n\tprotected async internalStart() {}\n\n\tinit(cNote: CNote) {\n\t\tthis.cNote = cNote;\n\t}\n\n\trenderCommentsList():JSX.Element { return this.renderView(VCommentsList); }\n\t\n\tshowAddCommentPage() {\n\t\tthis.openVPage(VAddComment);\n\t}\n\n\tasync onAddComment(comment:string) {\n\t\tawait this.cNote.addComment(comment);\n\t}\n\n\trenderWriteComment():JSX.Element {\n\t\treturn this.renderView(VWriteComment);\n\t}\n\n\trenderCommentButton():JSX.Element {\n\t\tlet vWriteComment = new VWriteComment(this);\n\t\treturn vWriteComment.renderButton();\n\t}\n}\n","import { CNoteBase } from \"../noteBase\";\nimport { NoteItem } from \"../model\";\nimport { CComments } from \"./components\";\n\nexport abstract class CNote extends CNoteBase {\n\tcComments: CComments;\n\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tthis.cComments = new CComments(this.res);\n\t\tthis.cComments.init(this);\n\t\tif (param) {\n\t\t\tif (!this.caption) this.caption = param.caption;\n\t\t}\n\t}\n\t\n\taddComment = async (content: string) => {\n\t\tlet ret = await this.uqs.notes.AddComment.submit({ note: this.noteModel.id, content });\n\t\tlet commentId = ret.comment;\n\t\t// 加入note界面，显示comment\n\t\tif (commentId) {\n\t\t\tthis.noteItem.commentCount++;\n\t\t\tthis.noteModel.comments.unshift({\n\t\t\t\tid: commentId,\n\t\t\t\tcontent: content,\n\t\t\t\towner: this.user.id,\n\t\t\t\tassigned: undefined,\n\t\t\t\t$create: new Date(),\n\t\t\t\t$update: new Date(),\n\t\t\t});\n\t\t\tthis.activeRelativeTab = 'comment';\n\t\t\tthis.updateChange();\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { FA } from \"tonva\";\nimport { CNote } from \"../CNote\";\nimport { VRelativesBase, TabRelative } from '../../noteBase';\n\nexport class VRelativesNoteBase<T extends CNote> extends VRelativesBase<T> {\n\tprotected tabComment:TabRelative = {\n\t\tname: 'comment',\n\t\tvisible: () => this.controller.noteItem.commentCount>0,\n\t\tcaption: (isAction:boolean) => {\n\t\t\tlet {commentCount} = this.controller.noteItem;\n\t\t\tlet vCount:any;\n\t\t\tif (commentCount > 0) vCount = <small>{commentCount}</small>;\n\t\t\treturn <>\n\t\t\t\t<FA className=\"mr-2\" name=\"comment-o\" /> \n\t\t\t\t{vCount}\n\t\t\t</>\n\t\t},\n\t\trender: () => this.controller.cComments.renderCommentsList(),\n\t}\n\n\tprotected tabFlow:TabRelative = {\n\t\tname: 'flow',\n\t\tvisible: () => this.controller.noteModel?.flow.length>0,\n\t\tcaption: (isAction:boolean) => {\n\t\t\treturn <>流程</>;\n\t\t},\n\t\trender: () => {\n\t\t\tlet {flow} = this.controller.noteModel;\n\t\t\tif (!flow || flow.length === 0) return;\n\t\t\treturn <div>flow: {flow.length}</div>\n\t\t}\n\t}\n\t\n\tprotected get tabs():TabRelative[] { return [this.tabComment, this.tabShare, this.tabFlow] };\n}\n\nexport class VNoteRelatives extends VRelativesNoteBase<CNote> {\n}","//import React from 'react';\nimport { VRelativesNoteBase } from '../views';\nimport { CNoteAssign } from './CNoteAssign';\nimport { TabRelative } from '../../noteBase';\n\nexport class VAssignRelatives extends VRelativesNoteBase<CNoteAssign> {\n\tprotected get tabs():TabRelative[] { return [this.tabComment, this.tabShare] };\n}\n","import { NoteItem } from 'notes/model';\nimport React from 'react';\nimport { List } from 'tonva';\nimport { VNoteBaseView } from '../../noteBase';\nimport { getTaskItemState } from '../task/TaskState';\nimport { CNoteAssign } from './CNoteAssign';\nimport { VAssignRelatives } from './VAssignRelatives';\n\nexport class VAssignView extends VNoteBaseView<CNoteAssign> {\n\theader() {\n\t\treturn this.t('noteTask')\n\t}\n\n\tprotected renderRelatives() {\n\t\treturn this.renderVm(VAssignRelatives);\n\t}\n\n\tfooter() {\n\t\treturn this.renderFooter();\n\t}\n\n\tprotected renderFooter() {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-center\">\n\t\t\t{this.renderShareButton()}\n\t\t\t{this.controller.cComments.renderWriteComment()}\n\t\t</div>;\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.controller.cContent.renderViewContent();\n\t}\n\n\tprotected renderViewBottom():JSX.Element {\n\t\tlet {noteItem, noteModel} = this.controller;\n\t\tif (this.isMe(noteItem.owner) === false) return;\n\n\t\tlet {spawn} = noteModel;\n\t\tlet div:any;\n\t\tif (spawn.length === 0) {\n\t\t\tdiv = <div className=\"px-3 py-2\">\n\t\t\t\t<button className=\"btn btn-primary\" onClick={this.controller.showAssignTo}>分派</button>\n\t\t\t</div>;\n\t\t}\n\t\telse {\n\t\t\tdiv = <div className=\"my-3\">\n\t\t\t\t<div className=\"d-flex px-3 py-2 align-items-end\">\n\t\t\t\t\t<div className=\"small text-muted pt-2 pb-1\">已分派</div>\n\t\t\t\t\t<button className=\"ml-auto btn btn-primary btn-sm\" onClick={this.controller.showAssignTo}>追加分派</button>\n\t\t\t\t</div>\n\t\t\t\t<List items={spawn} item={{render: this.renderSpawn, className:'notes'}} />\n\t\t\t</div>;\n\t\t}\n\t\treturn <div className=\"bg-light\">{div}</div>;\n\t}\n\n\tprivate renderSpawn = (noteItem: NoteItem, index: number) => {\n\t\tlet {owner, assigned} = noteItem;\n\t\tlet state = getTaskItemState(noteItem);\n\t\tlet {content, isEnd} = state;\n\t\treturn <div className=\"px-3 py-2 bg-light border-top\">\n\t\t\t{this.renderContact(owner as number, assigned)}\n\t\t\t<div className=\"ml-2\"></div>\n\t\t\t{this.renderStateSpan(content, isEnd)}\n\t\t</div>\n\t}\n}\n","import React from 'react';\nimport { CNoteAssign } from \"./CNoteAssign\";\nimport { VNoteBaseEdit } from 'notes/noteBase';\n\nexport class VAssignEdit extends VNoteBaseEdit<CNoteAssign> { // VNoteForm<CNoteAssign> {\n\theader() {\n\t\treturn this.t('noteTask');\n\t}\n\n\tprotected renderContent():JSX.Element {\n\t\treturn this.controller.cContent.renderInput()\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn <>{this.renderDeleteButton()}</>;\n\t}\n}\n","import React from \"react\";\nimport { VAssignEdit } from './VAssignEdit';\n\nexport class VAssignAdd extends VAssignEdit {\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.AddNote();\n\t\tthis.closePage();\n\t\treturn;\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn;\n\t\t// \treturn this.renderShareButton();\n\t}\n\n\tprotected renderShareButton() {\n\t\treturn <button onClick={this.onSaveAndSendNote}\n\t\t\tclassName=\"btn btn-outline-primary mr-3\">\n\t\t\t发给\n\t\t</button>;\n\t}\n\tprotected onSaveAndSendNote = async () => {\n\t\tlet cnewNote = await this.controller.AddNote();\n\t\tthis.closePage();\n\t\tawait cnewNote.cApp.loadRelation();\n\t\tcnewNote.showShareTo();\n\t}\n}\n","import { VNoteBaseDir } from '../../noteBase';\nimport { CNoteAssign } from './CNoteAssign';\n\nexport class VAssignDir extends VNoteBaseDir<CNoteAssign> {\n\tprotected renderContent():JSX.Element {\n\t\treturn this.controller.cContent.renderDirContent();\n\t}\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { List, FA } from 'tonva';\nimport { Contact } from 'model';\nimport { CSelectContact } from './CSelectContact';\nimport { VBasePage } from '../../views/VBasePage';\n\nexport interface SelectContactOptions {\n\ttitle?: string;\n\taction?: string;\n\tsingle?: boolean;\n}\n\nexport class VSelectContact extends VBasePage<CSelectContact> {\n\t@observable private anySelected:boolean = false;\n\t@observable private contacts: Contact[];\n\t@observable private multiple:boolean = false;\n\tprivate list: List;\n\tprivate options: SelectContactOptions;\n\n\tinit(options: SelectContactOptions):void {\n\t\tthis.options = options;\n\t}\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\theader() {return this.options?.title ?? '选择'}\n\tright() {\n\t\treturn React.createElement(observer(this.buildRight));\n\t}\n\n\tprivate buildRight = () => {\n\t\tif (this.options?.single === true) return;\n\t\tlet cn = 'btn btn-sm btn-success mr-1';\n\t\tif (this.multiple === false) {\n\t\t\treturn <button className={cn} onClick={this.onToggleSelect}>多选</button>;\n\t\t}\n\t\tif (this.contacts && this.contacts.length > 0) {\n\t\t\treturn <button className={cn} onClick={this.onNext} disabled={!this.anySelected}>\n\t\t\t\t{this.options?.action ?? '选中'}({this.contacts.length}) <FA name=\"angle-right\" />\n\t\t\t</button>;\n\t\t}\n\t\treturn <button className={cn} onClick={this.onToggleSelect}>单选</button>;\n\t}\n\n\tprivate onToggleSelect = () => {\n\t\tthis.multiple = !this.multiple;\n\t}\n\n\tcontent() {\n\t\tlet render = () => {\n\t\t\tlet list:any;\n\t\t\tlet items = this.controller.contacts;\n\t\t\tif (this.multiple === true) {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onSelect:this.onContactSelect}} />\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onClick:this.onContactClick}} />\n\t\t\t}\n\t\t\treturn <div className=\"\">\n\t\t\t\t{list}\n\t\t\t</div>;\n\t\t}\n\t\treturn React.createElement(observer(render));\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tthis.anySelected = anySelected;\n\t\tthis.contacts = this.list.selectedItems;\n\t}\n\n\tprivate onContactClick = (item:Contact) => {\n\t\tthis.returnCall([item]);\n\t}\n\n\tprivate onNext = () => {\n\t\tthis.returnCall(this.list.selectedItems);\n\t}\n}\n","import { observable } from \"mobx\";\nimport { Contact } from \"model\";\nimport { SelectContactOptions, VSelectContact } from \"./VSelectContact\";\nimport { CUqBase } from \"tapp\";\n\nexport abstract class CSelectContact extends CUqBase {\n\t@observable contacts: Contact[];\n\n\t//protected abstract get GetContacts(): Query; // this.uqs.notes.GetMyContacts\n\tprotected abstract loadContacts(): Promise<void>;\n\n\tprotected async internalStart():Promise<void> {\n\t\tawait this.loadContacts();\n\t\t/*\n\t\tlet ret = await this.GetContacts.page(\n\t\t\t{\n\t\t\t\tgroupFolder: this.currentGroupFolder,\n\t\t\t\tnote: this.currentNoteItem.note,\n\t\t\t}, 0, 50, true);\n\t\tthis.groupContacts = ret.$page;\n\t\tthis.startAction();\n\t\t*/\n\t\tthis.openVPage(VSelectContact);\n\t}\n\n\tSetContacts(contacts:Contact[]) {\n\t\tthis.contacts = [];\n\t\tfor (var ci of contacts) {\n\t\t\tlet n = {...ci};\n\t\t\tthis.contacts.push(n);\n\t\t}\n\t}\n\n\tasync callSelectContact(options: SelectContactOptions): Promise<Contact[]> {\n\t\treturn await this.vCall(VSelectContact, options);\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VPage, FA, UserView, Image, User } from \"tonva\";\nimport { none } from 'tool';\nimport { Contact } from '../../../model';\nimport { SelectContactOptions } from '../../views';\nimport { CNoteAssign } from \"./CNoteAssign\";\nimport { CAssignTo } from './CAssignTo';\nimport { CNotes } from 'notes/CNotes';\nimport { CSelectContact } from 'notes/components/selectContact';\nimport { checkHourMinutes } from 'notes/model';\n\nexport interface Row {\n\tlabel: string;\n\tvalues?: any;\n\tonClick?: () => void;\n}\n\n//const none = <small className=\"text-muted\">[无]</small>;\n\nexport class VAssignParams extends VPage<CAssignTo> {\n\tprivate cNoteAssign: CNoteAssign;\n\n\tinit() {\n\t\tthis.cNoteAssign = this.controller.cNoteAssign;\n\t}\n\n\theader() {return '分派任务'}\n\tget back(): 'close'|'back'|'none' {return 'close';}\n\n\tprivate renderParam(param: Row) {\n\t\tlet {label, values, onClick} = param;\n\t\treturn <div key={label} className=\"px-3 py-2 bg-white d-flex cursor-pointer align-items-center border-bottom\" onClick={onClick}>\n\t\t\t<div className=\"text-muted mr-3 w-5c\">{label}</div>\n\t\t\t<div className=\"flex-fill mr-3 \">{values || none}</div>\n\t\t\t{\n\t\t\t\tonClick ?\n\t\t\t\t<FA className=\"ml-auto\" name=\"angle-right\" />\n\t\t\t\t:\n\t\t\t\tundefined\n\t\t\t}\n\t\t</div>\n\t}\n\n\tcontent() {\n\t\tlet rows: Row[] = [\n\t\t\t//{label: '执行人', values: this.renderContacts(), onClick: this.onClickContacts}, \n\t\t\t//{label: '分值', values: this.renderPoint()}, \n\t\t\t{label: '工时', values: this.renderHours()}, \n\t\t\t{label: '检查人', values: this.renderChecker(), onClick: this.onClickChecker}, \n\t\t\t{label: '评价人', values: this.renderRater(), onClick: this.onClickRater}, \n\t\t];\n\t\t//let {owner} = this.controller;\n\t\treturn <div className=\"py-2\">\n\t\t\t{this.cNoteAssign.renderDirItem(0)}\n\t\t\t{rows.map(v => this.renderParam(v))}\n\t\t\t<div className=\"px-3 py-2\"><button className=\"btn btn-primary\" onClick={this.controller.onSendOut}>发送</button></div>\n\t\t</div>;\n\t}\n\n\tprivate renderContact = (item:Contact, index?:number) => {\n\t\tif (!item) return none;\n\t\tlet {contact, assigned} = item;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1c h-1c mr-1\" src={icon || '.user-o'} />\n\t\t\t\t<span className=\"mr-3\">{assigned || nick || name}</span>\n\t\t\t</>;\n\t\t}\n\t\treturn <UserView user={contact} render={renderUser} />;\n\t}\n\n\tprivate renderPoint() {\n\t\treturn <input className=\"flex-fill form-control border-0\"\n\t\t\t\ttype=\"number\" step=\"1\" min=\"1\" defaultValue={this.cNoteAssign.point}\n\t\t\t\tonChange={this.onItemChange}\n\t\t\t\tonKeyDown={this.onItemKeyDown}/>;\n\t}\n\n\tprivate renderHours() {\n\t\treturn <input className=\"flex-fill form-control border-0\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder=\"2.5或者2：30表示两个半小时\"\n\t\t\t\tonChange={this.onHoursChange}\n\t\t\t\tonBlur={this.onHoursBlur}\n\t\t\t\tonKeyDown={this.onHoursKeyDown}/>;\n\t}\n\n\tprivate onItemChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.cNoteAssign.point = Number(evt.currentTarget.value);\n\t}\n\n\tprivate onItemKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t}\n\n\tprivate onHoursChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet m = checkHourMinutes(evt.target.value);\n\t\tif (m < 0) {\n\t\t\tm = 0;\n\t\t}\n\t\tthis.cNoteAssign.assignhours = m;\n\t}\n\n\tprivate onHoursKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t}\n\n\tprotected onHoursBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t\tif (checkHourMinutes(evt.target.value) < 0) {\n\t\t\tevt.target.value = '';\n\t\t\tthis.cNoteAssign.assignhours = 0;\n\t\t}\n\t}\n\n\tprivate renderChecker() {\n\t\treturn React.createElement(observer(() => this.renderContact(this.cNoteAssign.checker)));\n\t}\n\n\tprivate onClickChecker = async () => {\n\t\tlet cSelectContact = new CNotesSelectContact(this.cNoteAssign.owner, '检查人')\n\t\tcSelectContact.SetContacts(this.controller.GetAssignToContacts());\n\n\t\tlet options: SelectContactOptions = {title: '检查人', single: true};\n\t\tlet contacts = await cSelectContact.callSelectContact(options);\n\t\tthis.closePage();\n\t\tthis.cNoteAssign.checker = contacts[0];\n\t}\n\n\tprivate renderRater() {\n\t\treturn React.createElement(observer(() => this.renderContact(this.cNoteAssign.rater)));\n\t}\n\n\tprivate onClickRater = async () => {\n\t\tlet cSelectContact = new CNotesSelectContact(this.cNoteAssign.owner, '评价人')\n\t\tcSelectContact.SetContacts(this.controller.GetAssignToContacts());\n\n\t\tlet options: SelectContactOptions = {title: '评价人', single: true};\n\t\tlet contacts = await cSelectContact.callSelectContact(options);\n\t\tthis.closePage();\n\t\tthis.cNoteAssign.rater = contacts[0];\n\t}\n}\n\nclass CNotesSelectContact extends CSelectContact {\n\tprotected cNotes: CNotes;\n\ttitle: string;\n\tconstructor(cNotes:CNotes, title: string) {\n\t\tsuper(cNotes.cApp);\n\t\tthis.cNotes = cNotes;\n\t\tthis.title = title;\n\t}\n\n\tSetContacts(contacts:Contact[]) {\n\t\tthis.contacts = [];\n\t\tfor (var ci of contacts) {\n\t\t\tlet n = {...ci};\n\t\t\tn.already = 0;\n\t\t\tthis.contacts.push(n);\n\t\t}\n\t}\n\n\tprotected async loadContacts() {\n\t}\n}\n","import { CTo } from \"notes/components\";\nimport { VTo } from \"notes/components/to/VTo\"\nimport { VAssignParams } from \"./VAssignParams\";\nimport { CNoteAssign } from \"./CNoteAssign\";\nimport { Query } from \"tonva\";\nimport { Contact } from \"model\";\n\nexport class CAssignTo extends CTo {\n\tcNoteAssign: CNoteAssign;\n\n\tconstructor(cApp:any, cNoteAssign: CNoteAssign) {\n\t\tlet {currentFold} = cNoteAssign.owner;\n\t\tlet {groupFolder, currentNoteItem} = currentFold;\n\t\tsuper(cApp, groupFolder, currentNoteItem);\n\t\tthis.cNoteAssign = cNoteAssign;\n\t}\n\n\tprotected get GetContacts(): Query {return this.uqs.notes.GetAssignToContacts}\n\n\tprotected async internalStart():Promise<void> {\n\t\tlet ret = await this.GetContacts.page(\n\t\t\t{\n\t\t\t\tgroupFolder: this.currentGroupFolder,\n\t\t\t\tnote: this.currentNoteItem.note,\n\t\t\t}, 0, 50, true);\n\t\tthis.groupContacts = ret.$page;\n\t\tthis.groupContacts.unshift({contact:this.user.id, assigned:'[自己]', already:0});\n\t\tthis.startAction();\n\t\tthis.openVPage(VTo);\n\t}\n\n\tGetAssignToContacts() : Contact[] {\n\t\treturn this.groupContacts;\n\t\t// let ret = this.groupContacts.filter((v,index) => {\n\t\t// \tlet vid = numberFromId(v.contact);\n\t\t// \tif (this.contacts.findIndex(cv=> numberFromId(cv.contact) === vid) >= 0) {\n\t\t// \t\treturn false;\n\t\t// \t}\n\t\t// \treturn true;\n\t\t// });\n\t\t// ret.unshift({contact:this.user.id, assigned:'[自己]', already:0});\n\t\t// return ret;\n\t}\n\n\tprotected async sendOut(toList:number[]): Promise<void> {\n\t\tawait this.cNoteAssign.assignTask(toList);\n\t}\n\n\tprotected async afterContactsSelected(): Promise<void> {\n\t\tthis.openVPage(VAssignParams);\n\t}\n}\n","//import React from 'react';\nimport { computed, observable } from 'mobx';\n//import { FA } from 'tonva';\nimport { Contact } from '../../../model';\nimport { EnumNoteType, NoteItem, numberFromId } from '../../model';\nimport { renderIcon } from '../../noteBase';\nimport { CContent, CCheckable } from '../../components';\nimport { CNote } from '../CNote';\nimport { VAssignView } from './VAssignView';\nimport { VAssignAdd } from './VAssignAdd';\nimport { VAssignEdit } from './VAssignEdit'\nimport { VAssignDir } from './VAssignDir';\nimport { CAssignTo } from './CAssignTo';\n\nexport class CNoteAssign extends CNote {\n\tcContent: CContent;\n\t@observable checker: Contact;\n\t@observable rater: Contact;\n\n\tpoint:number = 100;\n\tassignhours:number = 0;\n\n\tinit(param: NoteItem): void {\n\t\tsuper.init(param);\n\t\tthis.cContent = new CCheckable(this.res);\n\t\tlet obj:any;\n\t\tif (param) {\n\t\t\tthis.caption = param.caption;\n\t\t\tobj = param.obj;\n\t\t}\n\t\tthis.cContent.init(obj);\n\t}\n\n\t@computed get isContentChanged():boolean {return this.cContent.changed}\n\tget type():EnumNoteType { return EnumNoteType.assign }\n\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('list', 'text-primary');\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VAssignDir);\n\t}\n\n\tshowViewPage() {\n\t\tthis.openVPage(VAssignView);\n\t}\n\n\tshowEditPage() {\n\t\tthis.cContent.startInput();\n\t\tthis.openVPage(VAssignEdit);\n\t}\n\n\tshowAddPage() {\n\t\tthis.cContent.startInput();\n\t\tthis.openVPage(VAssignAdd);\n\t}\n\n\tshowAssignTo = async () => {\n\t\tlet cAssignTo = new CAssignTo(this.cApp, this);\n\t\tawait cAssignTo.start();\n\t}\n\n\tassignTask = async (toList: number[]) => {\n\t\tlet { note } = this.noteItem;\n\t\tlet { caption, content } = this.noteItem;\n\t\tlet cObj = JSON.parse(content);\n\t\tif (this.checker) {\n\t\t\tcObj.checker = numberFromId(this.checker.contact);\n\t\t}\n\t\telse {\n\t\t\tdelete cObj.checker;\n\t\t}\n\t\tif (this.rater) {\n\t\t\tcObj.rater = numberFromId(this.rater.contact);\n\t\t}\n\t\telse {\n\t\t\tdelete cObj.rater;\n\t\t}\n\t\tcObj.assignhours = this.assignhours;\n\t\t//cObj.hours = this.assignhours;\n\t\tcObj.point = this.point;\n\t\tlet data = {\n\t\t\tgroupFolder: this.owner.currentFold.groupFolder,\n\t\t\tfolder: this.owner.currentFold.folderId,\n\t\t\tnote,\n\t\t\tcaption,\n\t\t\tcontent: JSON.stringify(cObj),\n\t\t\ttos: toList.map(v => ({to:v})),\n\t\t\tchecker: this.checker?.contact,\n\t\t\trater: this.rater?.contact,\n\t\t\tpoint: this.point,\n\t\t}\n\t\tawait this.uqs.notes.AssignTask.submit(data);\n\t}\n}\n","//import React from 'react';\nimport { TabRelative } from '../../noteBase';\nimport { VRelativesNoteBase } from '../views';\nimport { CNoteText } from './CNoteText';\n\nexport class VTextRelatives extends VRelativesNoteBase<CNoteText> {\n\tprotected get tabs():TabRelative[] { return [this.tabComment, this.tabShare] };\n}\n","import React from 'react';\nimport { View } from \"tonva\";\nimport { CNoteText } from \"./CNoteText\";\nimport { observer } from 'mobx-react';\n\nexport class VTextHeader extends View<CNoteText> {\n\trender() {\n\t\treturn React.createElement(observer(() => <>{this.controller.header}</>));\n\t}\n}\n","import React from 'react';\nimport { VNoteBaseView } from '../../noteBase';\nimport { CNoteText } from './CNoteText';\nimport { VTextRelatives } from './VTextRelatives';\nimport { VTextHeader } from './VTextHeader';\n\nexport class VTextView extends VNoteBaseView<CNoteText> {\n\theader() {\n\t\treturn this.renderVm(VTextHeader);\n\t}\n\n\tprotected renderRelatives() {\n\t\treturn this.renderVm(VTextRelatives);\n\t}\n\n\tfooter() {\n\t\treturn this.renderFooter();\n\t}\n\n\tprotected renderFooter() {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-center\">\n\t\t\t{this.renderShareButton()}\n\t\t\t{this.controller.cComments.renderWriteComment()}\n\t\t</div>;\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.controller.cContent.renderViewContent();\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { DropdownActions, DropdownAction } from 'tonva';\nimport { VNoteBaseEdit } from '../../noteBase';\nimport { CNoteText } from \"./CNoteText\";\nimport { VTextHeader } from './VTextHeader';\n\nexport class VTextEdit extends VNoteBaseEdit<CNoteText> {\n\theader() {\n\t\treturn this.renderVm(VTextHeader);\n\t}\n\n\tprotected renderContent():JSX.Element {\n\t\t//return this.controller.cContent.renderInput();\n\t\treturn React.createElement(observer(() =>{\n\t\t\tlet {cType, cContent} = this.controller;\n\t\t\treturn <>\n\t\t\t\t<span className=\"d-none\">{cType}</span>\n\t\t\t\t{cContent.renderInput()}\n\t\t\t</>;\n\t\t}));\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t{this.renderButtonLeft()}\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={!this.controller.isNoteChanged}>\n\t\t\t\t\t保存\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t\t{this.renderExButtons()}\n\t\t</div>;\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn this.renderDeleteButton();\n\t}\n\n\tprivate dropdownActions: {[type: string]: DropdownAction} = {\n\t\ttext: {\n\t\t\ticon:'file-o', \n\t\t\tcaption:this.t('noteText'), \n\t\t\taction: this.controller.changeToText,\n\t\t},\n\t\tlist: {\n\t\t\ticon:'list', \n\t\t\tcaption:this.t('noteList'), \n\t\t\taction: this.controller.changeToList,\n\t\t},\n\t\tcheckable: {\n\t\t\ticon:'check-square-o', \n\t\t\tcaption:this.t('noteCheckable'), \n\t\t\taction: this.controller.changeToCheckable,\n\t\t},\n\t};\n\n\tprotected renderButtonLeft():JSX.Element { \n\t\treturn <DropdownActions\n\t\t\tactions={this.controller.dropdowns.map(v => this.dropdownActions[v])} \n\t\t\ticon=\"th-list\" \n\t\t\titemIconClass=\"text-info\" \n\t\t\tisRight={false}\n\t\t\tclassName=\"cursor-pointer btn btn-lg p-1 mr-1\"/>;\n\t}\n}\n","import React from \"react\";\nimport { VTextEdit } from \"./VTextEdit\";\nimport { observer } from \"mobx-react\";\n\nexport class VTextAdd extends VTextEdit {\n\theader() {return <>新建</>}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.AddNote();\n\t\tthis.closePage();\n\t\treturn;\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn this.renderShareButton();\n\t\t}));\n\t}\n\n\tprotected renderShareButton() {\n\t\treturn <button onClick={this.onSaveAndSendNote}\n\t\t\tclassName=\"btn btn-outline-primary mr-3\">\n\t\t\t发给\n\t\t</button>;\n\t}\n\n\tprotected onSaveAndSendNote = async () => {\n\t\tlet cnewNote = await this.controller.AddNote();\n\t\tthis.closePage();\n\t\tawait cnewNote.cApp.loadRelation();\n\t\tcnewNote.showShareTo();\n\t}\n\n}\n","import { CNoteText } from \"./CNoteText\";\nimport { VNoteBaseDir } from \"../../noteBase\";\n\nexport class VTextDir extends VNoteBaseDir<CNoteText> {\n\tprotected renderContent():JSX.Element {\n\t\treturn this.controller.cContent.renderDirContent();\n\t}\n}\n","import { computed, observable } from 'mobx';\nimport { EnumNoteType, NoteItem } from '../../model';\nimport { VTextView } from './VTextView';\nimport { VTextAdd } from './VTextAdd';\nimport { renderIcon } from '../../noteBase';\nimport { VTextDir } from './VTextDir';\nimport { VTextEdit } from './VTextEdit';\nimport { CContent, CText, CCheckable, CList } from '../../components';\nimport { CNote } from '../CNote';\n\nexport class CNoteText extends CNote {\n\t@observable header: string;\n\t@observable cType: EnumNoteType;\n\t@observable dropdowns: string[];\n\t@observable cContent: CContent;\n\n\tcreateTextContent(): void {\n\t\tthis.header = this.t('noteText');\n\t\tthis.cContent = new CText(this.res);\n\t\tthis.cType = EnumNoteType.text;\n\t\tthis.dropdowns = ['list', 'checkable'];\n\t}\n\t\n\tcreateListContent(): void {\n\t\tthis.header = this.t('noteList');\n\t\tthis.cContent = new CList(this.res);\n\t\tthis.cType = EnumNoteType.textList;\n\t\tthis.dropdowns = ['text', 'checkable'];\n\t}\n\n\tcreateCheckableContent(): void {\n\t\tthis.header = this.t('noteCheckable');\n\t\tthis.cContent = new CCheckable(this.res);\n\t\tthis.cType = EnumNoteType.textCheckable;\n\t\tthis.dropdowns = ['text', 'list'];\n\t}\n\t\n\tinit(param: NoteItem): void {\n\t\tsuper.init(param);\n\t\tif (param) {\n\t\t\tif (this.cContent === undefined) {\n\t\t\t\tdebugger;\n\t\t\t\tthrow new Error('this.cContent should have created');\n\t\t\t}\n\t\t\tthis.cContent.init(param.obj);\n\t\t}\n\t}\n\n\t@computed get isContentChanged():boolean { return this.cContent.changed }\n\tget type():EnumNoteType { return this.cType; }\n\n\trenderIcon(): JSX.Element {\n\t\t//return renderIcon(this.noteIcon, this.noteItem.toCount>0? 'text-success' : 'text-info');\n\t\treturn renderIcon(this.noteItem.toCount>0? 'files-o': 'file-o', 'text-info');\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTextDir);\n\t}\n\n\tshowViewPage() {\n\t\tthis.openVPage(VTextView);\n\t}\n\n\tshowEditPage() {\n\t\tthis.cContent.startInput();\n\t\tthis.openVPage(VTextEdit);\n\t}\n\n\tshowAddPage() {\n\t\tthis.cContent.startInput();\n\t\tthis.openVPage(VTextAdd);\n\t}\n\n\tchangeToText = () => {\n\t\tif (this.cType === EnumNoteType.text)\n\t\t\treturn;\n\t\tlet content = this.cContent.toString();\n\t\tthis.createTextContent();\n\t\tthis.cContent.reset(content);\n\t\tif (this.noteItem) {\n\t\t\tthis.noteItem.type = EnumNoteType.text;\n\t\t}\n\t}\n\n\tchangeToList = () => {\n\t\tif (this.cType === EnumNoteType.textList)\n\t\t\treturn;\n\t\tlet content = this.cContent.toString();\n\t\tthis.createListContent();\n\t\tthis.cContent.reset(content);\n\t\tif (this.noteItem) {\n\t\t\tthis.noteItem.type = EnumNoteType.textList;\n\t\t}\n\t}\n\n\tchangeToCheckable = () => {\n\t\tif (this.cType === EnumNoteType.textCheckable)\n\t\t\treturn;\n\t\tlet content = this.cContent.toString();\n\t\tthis.createCheckableContent();\n\t\tthis.cContent.reset(content);\n\t\tif (this.noteItem) {\n\t\t\tthis.noteItem.type = EnumNoteType.textCheckable;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { View } from \"tonva\";\nimport { CTaskContent } from './CTaskContent';\nimport { TaskCheckItem } from '../model';\n\nexport abstract class VBase extends View<CTaskContent> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {uncheckedItems, checkedItems} = this.controller.getItems();\n\t\t\treturn <div className=\"mb-2\">\n\t\t\t\t{uncheckedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t\t{this.renderCheckedItems(checkedItems)}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected abstract renderCheckItem(v:TaskCheckItem):JSX.Element;\n\tprotected abstract renderCheckedItems(checkedItems:TaskCheckItem[]):JSX.Element;\n}\n","import React from 'react';\nimport { TaskCheckItem } from '../model';\nimport { VBase } from './VBase';\n\nexport class VView extends VBase {\n\tprotected renderCheckItem(v:TaskCheckItem) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <div key={key} className=\"d-flex mx-3 align-items-center form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tdisabled={!this.controller.allowCheck}\n\t\t\t\tdata-key={key} />\n\t\t\t<div className={'form-control-plaintext ' + cn}>{content}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderCheckedItems(checkedItems:TaskCheckItem[]):JSX.Element {\n\t\tlet checkedCount = checkedItems.length;\n\t\tif (checkedCount > 0) {\n\t\t\treturn <div className=\"border-top py-2\">\n\t\t\t\t<div className=\"px-3 pt-2 small text-muted\">{checkedCount}项完成</div>\n\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t</div>;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { FA } from 'tonva';\nimport { TaskCheckItem } from '../model';\nimport { VBase } from \"./VBase\";\n\nexport class VItem extends VBase {\n\tprotected renderCheckItem(v:TaskCheckItem) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tlet icon: string;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t\ticon = 'check-square';\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t\ticon = 'square-o';\n\t\t}\n\t\treturn <div key={key} className=\"d-flex mx-3 align-items-center\">\n\t\t\t<FA name={icon} />\n\t\t\t<div className={'py-1 ' + cn}>{content}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderCheckedItems(checkedItems:TaskCheckItem[]):JSX.Element {\n\t\tlet checkedCount = checkedItems.length;\n\t\tif (checkedCount > 0) {\n\t\t\treturn <div className=\"\">\n\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t</div>;\n\t\t}\n\t}\n}\n","import { observable } from \"mobx\";\nimport { CContent } from \"../../../components\";\nimport { VView } from \"./VView\";\nimport { VItem } from \"./VItem\";\nimport { TaskCheckItem } from \"../model\";\n\nexport class CTaskContent extends CContent {\n\tallowCheck: boolean;\n\tprivate inputingText: string;\n\t@observable items: TaskCheckItem[] = [];\n\titemKey: number = 1;\n\n\tinit(obj:any) {\n\t\tif (obj) {\n\t\t\tif (obj.itemKey !== undefined && obj.itmes !== undefined) {\n\t\t\t\tthis.itemKey = obj.itemKey;\n\t\t\t\tthis.items = obj.items;\n\t\t\t}\n\t\t}\n\t}\n\n\trenderInput():JSX.Element {\n\t\treturn;\n\t}\n\n\trenderViewContent():JSX.Element {return this.renderView(VView)}\n\trenderDirContent():JSX.Element {return this.renderView(VItem)}\n\n\tendInput(obj:any): void {\n\t\tthis.addNewItem();\n\t\tthis.buildObj(obj);\n\t}\n\n\tprotected buildObj(obj:any): void {\n\t\tobj.itemKey = this.itemKey;\n\t\tobj.items = this.items;\n\t}\n\n\ttoString():string { \n\t\treturn this.items?.map(v => v.text).join('\\n')\n\t}\n\n\tfromString(value: string) {\n\t\tif (value) {\n\t\t\tthis.items = [];\n\t\t\tthis.itemKey = 1;\n\t\t\tthis.items.push(...value.split('\\n').filter((v, index) => {\n\t\t\t\treturn v.trim().length > 0;\n\t\t\t}).map((v, index) => {\n\t\t\t\treturn {\n\t\t\t\t\tkey: this.itemKey++,\n\t\t\t\t\ttext: v,\n\t\t\t\t\tchecked: false\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tasync onCheckChange(key: number, checked: boolean) {\n\t\tlet item = this.items.find(v => v.key === key);\n\t\tif (item) item.checked = checked;\n\t\t//await this.onContentChanged?.();\n\t\t//await this.SetNote(false);\n\t}\n\t/*\n\tonItemChanged = (key: number, value: string) => {\n\t\tlet item = key && this.items.find(v => v.key === key);\n\t\tif (item) {\n\t\t\titem.text = value;\n\t\t}\n\t\telse {\n\t\t\tthis.inputingText = value;\n\t\t}\n\t\tthis.changed = true;\n\t}\n\t*/\n\n\taddNewItem(): void {\n\t\tif (this.inputingText === undefined) return;\n\t\tlet text = this.inputingText.trim();\n\t\tif (text.length === 0) return;\n\t\tthis.items.push({\n\t\t\tkey: this.itemKey++,\n\t\t\ttext,\n\t\t\tchecked: false,\n\t\t});\n\t\tthis.changed = true;\n\t\tthis.inputingText = undefined;\n\t}\n\n\tgetItems():{uncheckedItems:TaskCheckItem[], checkedItems: TaskCheckItem[]} {\n\t\tlet uncheckedItems:TaskCheckItem[] = [];\n\t\tlet checkedItems:TaskCheckItem[] = [];\n\t\tfor (let ci of this.items) {\n\t\t\tlet {checked} = ci;\n\t\t\tif (checked === true) checkedItems.push(ci);\n\t\t\telse uncheckedItems.push(ci);\n\t\t}\n\t\treturn {uncheckedItems, checkedItems};\n\t}\n}\n","import { observable } from \"mobx\";\nimport { NoteItem, EnumNoteType } from '../../model';\nimport { renderIcon } from '../../noteBase';\nimport { TaskStateResult } from \"./TaskState\"\nimport { CNote } from \"../CNote\";\nimport { CTaskContent } from \"./content\";\n\nexport abstract class CNoteTask extends CNote {\n\tget type():EnumNoteType { return EnumNoteType.task }\n\n\tcContent: CTaskContent;\n\tget allowCheck() { return false; }\n\n\t@observable checkInfo: string;\n\t@observable rateInfo: string;\n\n\tprotected checker: number;\n\tprotected rater: number;\n\tprotected checkInfoInput: string;\n\tprotected rateInfoInput: string;\n\tprotected rateValue: number;\n\tprotected rateValueInput: number;\n\tassignhours: number;\n\thours: number;\n\tpoint: number;\n\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tthis.cContent = new CTaskContent(this.res);\n\t\tif (param) {\n\t\t\tlet {obj} = param;\n\t\t\tif (obj) {\n\t\t\t\tthis.cContent.init(obj);\n\t\t\t\tthis.checkInfo = obj.checkInfo;\n\t\t\t\tthis.checkInfoInput = this.checkInfo;\n\t\t\t\tthis.rateInfo = obj.rateInfo;\n\t\t\t\tthis.rateInfoInput = this.rateInfo;\n\t\t\t\tthis.rateValue = obj.rateValue;\n\t\t\t\tthis.rateValueInput = this.rateValue;\n\t\t\t\tthis.checker = obj.checker;\n\t\t\t\tthis.rater = obj.rater;\n\t\t\t\tthis.assignhours = obj.assignhours;\n\t\t\t\tthis.hours = obj.hours;\n\t\t\t\tthis.point = obj.point;\n\t\t\t}\n\t\t}\n\t\tthis.cContent.allowCheck = this.allowCheck;\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = super.endContentInput();\n\t\tif (this.checkInfo) {\n\t\t\tobj.checkInfo = this.checkInfo;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.checkInfo;\n\t\t}\n\t\tif (this.rateInfo) {\n\t\t\tobj.rateInfo = this.rateInfo;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.rateInfo;\n\t\t}\n\t\tif (this.rateValue !== undefined) {\n\t\t\tobj.rateValue = this.rateValue;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.rateValue;\n\t\t}\n\t\tif (this.checker !== undefined) {\n\t\t\tobj.checker = this.checker;\n\t\t}\n\t\tif (this.rater !== undefined) {\n\t\t\tobj.rater = this.rater;\n\t\t}\n\t\tobj.assignhours = this.assignhours;\n\t\tobj.hours = this.hours;\n\t\tobj.point = this.point;\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n\n\tupdateCheckInfo(v:string) {\n\t\tthis.checkInfoInput = v;\n\t}\n\n\tupdateRateInfo(v:string) {\n\t\tthis.rateInfoInput = v;\n\t}\n\tabstract get taskStateResult(): TaskStateResult;\n\n\tshowAddPage() {/*CNoteTask no need to Add*/}\n\tshowEditPage() {/*CNoteTask no need to Edit*/}\n\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('tasks', 'text-success');\n\t}\n\n\tasync checkSaveInfo() {\n\t\tlet change = false;\n\t\tif (this.rateInfo !== this.rateInfoInput) {\n\t\t\tthis.rateInfo = this.rateInfoInput;\n\t\t\tchange = true;\n\t\t}\n\t\tif (this.checkInfo !== this.checkInfoInput) {\n\t\t\tthis.checkInfo = this.checkInfoInput;\n\t\t\tchange = true;\n\t\t}\n\t\tif (this.rateValue !== this.rateValueInput) {\n\t\t\tthis.rateValue = this.rateValueInput;\n\t\t\tchange = true;\n\t\t}\n\n\t\tif (change) {\n\t\t\tawait this.saveX();\n\t\t}\n\t}\n\n\tprotected async saveX() {\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet obj = this.endContentInput();\n\t\tlet flowContent = JSON.stringify(obj);\n\t\tlet param = { note: noteId, content: flowContent };\n\t\tawait this.uqs.notes.SetNoteX.submit(param, false);\n\t}\n}\n","import { TabRelative } from '../../noteBase';\nimport { CNoteTask } from \"./CNoteTask\";\nimport { VRelativesNoteBase } from '../views';\n\nexport class VTaskRelatives extends VRelativesNoteBase<CNoteTask> {\n\tprotected get tabs():TabRelative[] { return [this.tabComment] };\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { TaskCheckItemBase } from './model';\nimport { VNoteBaseView } from '../../noteBase';\nimport { CNoteTask } from \"./CNoteTask\";\nimport { VTaskRelatives } from './VTaskRelatives';\nimport { none } from 'tool';\nimport { taskTimeToString } from 'notes/model';\n\nexport interface TaskParam {\n\tlabel: string;\n\tvalues?: any;\n\tonClick?: () => void;\n}\n\nexport abstract class VTaskView<T extends CNoteTask> extends VNoteBaseView<T> {\n\tprotected get back(): 'close' | 'back' | 'none' { return 'close' }\n\theader() { return this.t('task') }\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"\">\n\t\t\t\t{this.renderTopCaptionContent()}\n\t\t\t\t{this.renderTaskAdditions()}\n\t\t\t\t{this.renderViewBottom()}\n\t\t\t\t{this.renderRelatives()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.controller.cContent.renderViewContent();\n\t}\n\n\tfooter() {\n\t\treturn this.renderFooter();\n\t}\n\n\tprotected renderFooter() {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-center\">\n\t\t\t{this.renderShareButton()}\n\t\t\t{this.controller.cComments?.renderWriteComment()}\n\t\t</div>;\n\t}\n\n\trenderDirView() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t<div className=\"bg-white\">\n\t\t\t\t\t{this.renderTaskDirTop()}\n\t\t\t\t\t<div className=\"py-2\">\n\t\t\t\t\t\t{this.controller.cContent.renderDirContent()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{this.renderDirBottom()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderTop():JSX.Element {\n\t\treturn <div className={'d-flex px-3 py-3 border-top border-bottom bg-light'}>\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t<div>\n\t\t\t\t\t{this.renderFrom()} \n\t\t\t\t\t<span className=\"px-4\">{this.renderEditTime()}</span>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t</div>;\n\t}\n\n\tprivate renderTaskDirTop():JSX.Element {\n\t\treturn <div className={'d-flex pr-3 pl-2 py-2'}>\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderFrom()}\n\t\t\t</div>\n\t\t\t<span className=\"ml-auto\">{this.renderEditTime()}</span>\n\t\t</div>;\n\t}\n\n\t/*\n\tprotected renderDirTop():JSX.Element {\n\t\treturn <div className=\"d-flex px-3 py-2 border-top\">\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderFrom()}\n\t\t\t</div>\n\t\t\t<div className=\"ml-auto\">{this.renderEditTime()}</div>\n\t\t</div>;\n\t}*/\n\n\tprotected renderDirBottom():JSX.Element {\n\t\tlet divToCount = this.renderToCount();\n\t\tlet divSpawnCount = this.renderSpawnCount();\n\t\tlet divComment = this.renderCommentFlag();\n\t\tif (divToCount || divSpawnCount || divComment) {\n\t\t\treturn <div className=\"d-flex align-items-center px-3 mb-1\">\n\t\t\t\t{divToCount}\n\t\t\t\t{divSpawnCount}\n\t\t\t\t{divComment}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>;\n\t\t}\n\t}\n\n\tprotected renderCaption() {\n\t\tlet { caption: title } = this.controller;\n\t\tlet divCaption = title ? <b className=\"text-primary\">{title}</b> : <span className=\"text-info\">任务</span>;\n\t\treturn <div className=\"pr-3\">\n\t\t\t<span className=\"mr-2\">{divCaption}</span> {this.renderState()}\n\t\t</div>;\n\t}\n\n\tprotected renderParam(param: TaskParam) {\n\t\tlet {label, values, onClick} = param;\n\t\treturn <div key={label} className=\"px-3 py-2 bg-white d-flex align-items-center border-bottom\" onClick={onClick}>\n\t\t\t<div className=\"text-muted mr-3 w-5c\">{label}</div>\n\t\t\t<div className=\"flex-fill mr-3 \">{values || none}</div>\n\t\t</div>\n\t}\n\n\tprotected additionRows: TaskParam[] = [\n\t\t//{label: '分值', values: this.renderPoint()}, \n\t\t{label: '分派工时', values: this.renderAssignHours()}, \n\t\t{label: '实际工时', values: this.renderHours()}, \n\t];\n\n\n\tprotected renderTaskAdditions() {\n\t\treturn <div>\n\t\t\t{this.additionRows.map(v => this.renderParam(v))}\n\t\t</div>;\n\t}\n\n\tprotected renderPoint() {\n\t\treturn <div className=\"flex-fill form-control border-0\">\n\t\t\t{this.controller.point}\n\t\t</div>;\n\t}\n\n\tprotected renderAssignHours() {\n\t\treturn <div className=\"flex-fill form-control border-0\">\n\t\t\t{taskTimeToString(this.controller.assignhours)}\n\t\t</div>;\n\t}\n\n\tprotected renderHours() {\n\t\treturn <div className=\"flex-fill form-control border-0\">\n\t\t\t{taskTimeToString(this.controller.hours)}\n\t\t</div>;\n\t}\n\n\tprotected renderViewBottom():JSX.Element {\n\t\treturn;\n\t\t/*\n\t\tlet { owner, state } = this.controller.noteItem;\n\t\tlet right: any;\n\t\tlet isMe = this.isMe(owner);\t\t\n\t\tif (isMe === true && state === EnumTaskState.Start) {\n\t\t\tright = <>{this.renderEditButton()}</>;\n\t\t}\n\t\treturn <div className=\"py-2 bg-light border-top d-flex align-items-end\">\n\t\t\t{this.controller.cComments.renderCommentButton()}\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{right}\n\t\t</div>;\n\t\t*/\n\t}\n\n\trenderRelatives() {\n\t\treturn this.renderVm(VTaskRelatives as any);\n\t}\n\n\tprotected renderState(): JSX.Element {\n\t\treturn <>state</>;\n\t}\n\t/*\n\tprotected onEdit() {\n\t\tthis.openVPage(VEdit as any);\n\t}\n\t*/\n\n\tprotected renderCheckItem(v:TaskCheckItemBase, checkable:boolean) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <label key={key} className=\"d-flex mx-3 my-0 align-items-center form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tonChange={this.onCheckChange}\n\t\t\t\tdata-key={key}\n\t\t\t\tdisabled={!checkable} />\n\t\t\t<div className={cn}>{content}</div>\n\t\t</label>;\n\t}\n\n\tprivate onCheckChange = async (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\t//let t = evt.currentTarget;\n\t\t//let key = Number(t.getAttribute('data-key'));\n\t\t//await this.controller.onCheckChange(key, t.checked);\n\t}\n}\n","import { checkHourMinutes, taskTimeToString } from 'notes/model';\nimport React from 'react';\nimport { VTaskView, TaskParam } from '../VTaskView';\nimport { CTaskStart } from './CTaskStart';\n\nexport class VTaskStart extends VTaskView<CTaskStart> {\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待办');\n\t}\n\n\tprotected renderViewBottom() {\n\t\tlet { owner } = this.controller.noteItem;\n\t\tlet left: any, right: any;\n\t\tlet isMe = this.isMe(owner);\n\t\tif (isMe === true) {\n\t\t\tleft = <button onClick={this.onDone} className=\"btn btn-primary mx-3\">\n\t\t\t\t完成\n\t\t\t</button>;\n\t\t}\n\n\t\treturn <div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t\t{left}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t\t{right}\n\t\t</div>;\n\t}\n\n\tprotected additionRows: TaskParam[] = [\n\t\t//{label: '分值', values: this.renderPoint()}, \n\t\t{label: '分派工时', values: this.renderAssignHours()}, \n\t\t{label: '实际工时', values: this.renderHours()}, \n\t];\n\n\tprotected renderHours() {\n\t\treturn <div className=\"flex-fill mr-3 \"><input className=\"flex-fill form-control border-0\"\n\t\t\ttype=\"text\" defaultValue={taskTimeToString(this.controller.assignhours)}\n\t\t\tplaceholder=\"2.5或者2：30表示两个半小时\"\n\t\t\tonBlur={this.onHoursBlur}\n\t\t\tonChange={e=>this.onHoursChange(e)}/>\n\t\t</div>;\n\t}\n\n\tprotected onHoursChange(evt:React.ChangeEvent<HTMLInputElement>) {\n\t\tlet m = checkHourMinutes(evt.target.value);\n\t\tif (m < 0) {\n\t\t\tm = 0;\n\t\t}\n\t\tthis.controller.hours = m;\n\t}\n\n\tprotected onHoursBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t\tif (checkHourMinutes(evt.target.value) < 0) {\n\t\t\tevt.target.value = '';\n\t\t\tthis.controller.hours = 0;\n\t\t}\n\t}\n\n\tprivate onDone = async () => {\n\t\tawait this.controller.DoneTask();\n\t\tthis.closePage();\n\t\t//this.openPage(this.resultPage);\n\n\t\t// 这个地方应该要显示，下一步是由谁来做什么。比如谁来验收，或者谁来评价\n\t\t// 这些信息应该在nodeModel里面\n\t\t// 如果没有后续操作，显示成红色，加一个终止标志 #\n\t\t// 如果由后续操作，显示成绿色，并且显示下一步什么操作，由谁来操作\n\t\tlet content = <>任务完成</>;\n\t\tthis.showActionEndPage({ content });\n\t}\n\t/*\n\tprotected resultPage = () => {\n\t\tlet {title} = this.controller;\n\t\treturn <Page header={title} back=\"close\">\n\t\t\t\t完成！\n\t\t</Page>;\n\t}\n\t*/\n}\n\nexport class VTaskStartDir extends VTaskStart {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { numberFromId } from \"../../../model\";\nimport { CNoteTask } from \"../CNoteTask\";\nimport { VTaskStart, VTaskStartDir } from \"./VTaskStart\";\nimport { TaskStateResult, EnumTaskState } from \"../TaskState\";\n\nexport class CTaskStart extends CNoteTask {\t\n\tget allowCheck() { return this.isMe(this.noteItem.owner); }\n\n\tshowViewPage():void {this.openVPage(VTaskStart);};\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskStartDir);\n\t}\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '待办', isEnd: false}\n\t}\n\n\tasync DoneTask() {\n\t\tlet { note: noteId, caption } = this.noteItem;\n\t\tlet obj = this.endContentInput();\n\t\tlet content = JSON.stringify(obj);\n\t\tlet data = {\n\t\t\tgroupFolder: this.owner.currentFold.groupFolder,\n\t\t\tfolder: this.owner.currentFold.folderId,\n\t\t\tnote: numberFromId(noteId),\n\t\t\tcontent: content,\n\t\t\tcaption: caption,\n\t\t\thours: this.hours\n\t\t}\n\n\t\tawait this.uqs.notes.DoneTask.submit(data);\n\t\tthis.noteItem.state = EnumTaskState.Done;\n\t\tthis.noteItem.flowContent = content;\n\t\tthis.noteItem.$update = new Date();\n\t\tthis.owner.currentFold.taskUpdateState(this.noteItem);\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskDone } from './CTaskDone';\n\nexport class VTaskDone extends VTaskView<CTaskDone> {\n\tprotected renderState() {\n\t\tlet { noteItem } = this.controller;\n\t\tlet obj = noteItem.obj;\n\t\tif (obj) {\n\t\t\tlet { checker } = obj;\n\t\t\tif (checker) {\n\t\t\t\treturn this.renderStateSpan('待验收');\n\t\t\t}\n\t\t\tlet { rater } = obj;\n\t\t\tif (rater) {\n\t\t\t\treturn this.renderStateSpan('待评分');\n\t\t\t}\n\t\t}\n\t\treturn this.renderStateSpan('已办', true);\n\t}\n}\n\nexport class VTaskDoneDir extends VTaskDone {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskDone, VTaskDoneDir } from \"./VTaskDone\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskDone extends CNoteTask {\t\n\t//protected getTaskView() {return VTaskDone };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskDoneDir);\n\t}\n\tshowViewPage():void {this.openVPage(VTaskDone);}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '已办', isEnd: true}\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskCanceled } from './CTaskCanceled';\n\nexport class VTaskCanceled extends VTaskView<CTaskCanceled> {\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('已取消', true);\n\t}\n}\n\nexport class VTaskCanceledDir extends VTaskCanceled {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskCanceled, VTaskCanceledDir } from \"./VTaskCanceled\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskCanceled extends CNoteTask {\t\n\t//protected getTaskView() {return VTaskCanceled };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskCanceledDir);\n\t}\n\tshowViewPage():void {this.openVPage(VTaskCanceled);}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '已取消', isEnd: false}\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskPass } from './CTaskPass';\n\nexport class VTaskPass extends VTaskView<CTaskPass> {\n\tprotected renderState() {\n\t\tlet { noteItem } = this.controller;\n\t\tlet obj = noteItem.obj;\n\t\tif (obj) {\n\t\t\tlet { rater } = obj;\n\t\t\tif (rater) {\n\t\t\t\treturn this.renderStateSpan('待评价');\n\t\t\t}\n\t\t}\n\t\treturn this.renderStateSpan('签收', true);\n\t}\n}\n\nexport class VTaskPassDir extends VTaskPass {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskPass, VTaskPassDir } from \"./VTaskPass\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskPass extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskPass) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskPassDir);\n\t}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '签收', isEnd: true}\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskFail } from './CTaskFail';\n\nexport class VTaskFail extends VTaskView<CTaskFail> {\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('拒签', true);\n\t}\n}\n\nexport class VTaskFailDir extends VTaskFail {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskFail, VTaskFailDir } from \"./VTaskFail\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskFail extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskFail) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskFailDir);\n\t}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '拒签', isEnd: true}\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskRated } from './CTaskRated';\n\nexport class VTaskRated extends VTaskView<CTaskRated> {\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('已评价', true);\n\t}\n}\n\nexport class VTaskRatedDir extends VTaskRated {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskRated, VTaskRatedDir } from \"./VTaskRated\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskRated extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskRated) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskRatedDir);\n\t}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '已评价', isEnd: true}\n\t}\n}\n","import React from \"react\";\nimport { Controller, View, Page } from \"tonva\";\nimport { observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport interface EditTextItemProps {\n\tonUpdate: (inputContent: string) => Promise<void>;\n\tcontent: string;\n\theader: string;\n}\n\nexport class VEditTextItemInput<T extends Controller> extends View<T> {\n\t@observable private disabled: boolean;\n\tprivate inputText: string;\n\tprivate props: EditTextItemProps;\n\n\tconstructor(controller: T, props: EditTextItemProps) {\n\t\tsuper(controller);\n\t\tthis.props = props;\n\t\tthis.inputText = this.props.content;\n\t}\n\n\tonUpdate = () => {\n\t\tthis.disabled = true;\n\t\tthis.openPageElement(React.createElement(observer(() => {\n\t\t\tlet onClickSave = async () => {\n\t\t\t\tif (this.disabled === true) return;\n\t\t\t\tlet inputText = this.inputText.trim();\n\t\t\t\tawait this.props.onUpdate(inputText);\n\t\t\t\tthis.closePage();\n\t\t\t}\n\t\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\t\tif (evt.keyCode === 13) onClickSave();\n\t\t\t}\n\t\t\tlet onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\t\tthis.inputText = evt.target.value;\n\t\t\t\tthis.disabled = this.props.content === this.inputText;\n\t\t\t}\n\t\t\tlet right = <button className=\"btn btn-sm btn-success mr-2\"\n\t\t\t\tdisabled={this.disabled}\n\t\t\t\tonClick={onClickSave}>保存</button>;\n\t\t\treturn <Page header={this.props.header} back=\"close\" right={right}>\n\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t<input className=\"form-control\" type=\"text\"\n\t\t\t\t\t\tonChange={onInputChange} onKeyDown={onKeyDown}\n\t\t\t\t\t\tdefaultValue={this.props.content} />\n\t\t\t\t</div>\n\t\t\t</Page>;\n\t\t})));\n\t}\n\n\trender(props: EditTextItemProps): JSX.Element {\n\t\tthis.props = props;\n\t\tthis.inputText = this.props.content;\n\n\t\treturn <></>\n\t}\n}\n","import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { Page, FA } from 'tonva';\nimport { VEditTextItemInput, EditTextItemProps } from '../VEditTextItem';\nimport { CTaskCheck } from './CTaskCheck';\nimport { TaskCheckItem } from '../model';\n\nexport class VTaskCheck extends VTaskView<CTaskCheck> {\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待验收');\n\t}\n\n\tprotected renderCheckItem(item: TaskCheckItem) {\n\t\tlet { key, text, checked, checkInfo } = item;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\tlet onUpdate = async (v: string) => {\n\t\t\tawait this.controller.setCheckInfo(item, v);\n\t\t}\n\t\tlet eprops: EditTextItemProps = { onUpdate: onUpdate, content: checkInfo, header: '验收事项说明' }\n\t\tlet vEdit = new VEditTextItemInput(this.controller, eprops);\n\t\treturn <div key={key} className={'d-flex'}>\n\t\t\t<label className=\"flex-grow-1 d-flex mx-3 my-0 align-items-center form-check\">\n\t\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\t\tdefaultChecked={checked}\n\t\t\t\t\tdata-key={key}\n\t\t\t\t\tdisabled={!this.controller.allowCheck} />\n\t\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t\t<div className={cn}>{content}</div>\n\t\t\t\t\t{checkInfo && <div className=\"mt-1 ml-3 small\">\n\t\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t<span className=\"text-info cursor-ponter\" onClick={vEdit.onUpdate}>{checkInfo}</span>\n\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t<div className=\"p-2 cursor-pointer\" onClick={vEdit.onUpdate}>\n\t\t\t\t<FA name=\"pencil-square-o text-info\" />\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderOrtherContent() {\n\t\tlet { checkInfo } = this.controller;\n\t\treturn <div className=\"px-3 py-2 d-flex align-items-center border-bottom\" >\n\t\t\t<div className=\"text-muted mr-1 w-5c\">验收意见</div>\n\t\t\t<div className=\"flex-fill mr-3 \">\n\t\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\t\ttype=\"text\" step=\"1\" min=\"1\"\n\t\t\t\t\tdefaultValue={checkInfo}\n\t\t\t\t\tonChange={this.onDiscribeChange}\n\t\t\t\t\tonKeyDown={this.onDiscribeKeyDown} /></div>\n\t\t</div>\n\t}\n\n\tprivate onDiscribeChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet v = evt.target.value;\n\t\tif (v.length <= 0)\n\t\t\tv = undefined;\n\t\tthis.controller.updateCheckInfo(v);\n\t}\n\n\tprivate onDiscribeKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.controller.checkSaveInfo();\n\t\t}\n\t}\n\n\tprotected renderViewBottom() {\n\t\tlet left = <div>\n\t\t\t<button onClick={()=>this.onCheck(true)} className=\"btn btn-success mx-3\">\n\t\t\t\t<FA name=\"check\" /> 通过\n\t\t\t</button>\n\t\t\t<button onClick={() => this.onCheck(false)} className=\"btn btn-outline-secondary mx-3\">\n\t\t\t\t<FA name=\"times\" /> 不通过\n\t\t\t</button>\n\t\t</div>;\n\t\treturn <>\n\t\t\t{this.renderOrtherContent()}\n\t\t\t<div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t\t{left}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>\n\t\t</>;\n\t}\n\n\tprotected onCheck = async (pass: boolean) => {\n\t\tawait this.controller.checkTask(pass);\n\t\tthis.closePage();\n\t\tlet content = pass ?\n\t\t\t<span className=\"text-success\"><FA name=\"check\" /> 验收通过</span>\n\t\t\t:\n\t\t\t<span className=\"text-secondary\"><FA name=\"check\" /> 验收不通过</span>\n\t\tthis.showActionEndPage({ content });\n\t\t//this.openPage(this.resultPage, {pass})\n\t}\n\n\tprotected resultPage = ({ pass }: { pass: boolean }) => {\n\t\tlet { caption: title } = this.controller;\n\t\tlet content = pass ?\n\t\t\t<span className=\"text-success\"><FA name=\"check\" /> 验收通过</span>\n\t\t\t:\n\t\t\t<span className=\"text-secondary\"><FA name=\"check\" /> 验收不通过</span>\n\t\treturn <Page header={title} back=\"close\">\n\t\t\t<div className=\"border bg-white rounded m-5\">\n\t\t\t\t<div className=\"py-5 text-center\">\n\t\t\t\t\t{content}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"border-top text-center py-3\">\n\t\t\t\t\t<button className=\"btn btn-outline-info\" onClick={() => this.closePage()}>返回</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Page>;\n\t}\n}\n\nexport class VTaskCheckDir extends VTaskCheck {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { numberFromId } from \"../../../model\";\nimport { CNoteTask } from \"../CNoteTask\";\nimport { VTaskCheck, VTaskCheckDir } from \"./VTaskCheck\";\nimport { TaskStateResult, EnumTaskState } from \"../TaskState\";\nimport { TaskCheckItem } from \"../model\";\n\nexport class CTaskCheck extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskCheck) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskCheckDir);\n\t}\n\t\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: 'check', isEnd: false}\n\t}\n\n\tasync checkTask(pass: boolean) {\n\t\tawait this.checkSaveInfo();\n\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet obj = this.endContentInput();\n\t\tlet content = JSON.stringify(obj);\n\t\tlet data = {\n\t\t\tgroupFolder: this.owner.currentFold.groupFolder,\n\t\t\tfolder: this.owner.currentFold.folderId,\n\t\t\tnote: numberFromId(noteId),\n\t\t\taction: pass ? 1 : 2,\n\t\t\tcontent: content\n\t\t}\n\n\t\tawait this.uqs.notes.CheckTask.submit(data);\n\t\tthis.noteItem.state = pass ? EnumTaskState.Pass : EnumTaskState.Fail;\n\t\tthis.noteItem.flowContent = content;\n\t\tthis.noteItem.$update = new Date();\n\t\tthis.owner.currentFold.taskUpdateState(this.noteItem);\n\t}\n\n\tasync setCheckInfo(item: TaskCheckItem, v:string) {\n\t\tif (v === undefined || v.length === 0) {\n\t\t\tdelete item.checkInfo;\n\t\t}\n\t\telse {\n\t\t\titem.checkInfo = v;\n\t\t}\n\t\tawait this.saveX();\n\t}\n}\n","import React from 'react';\nimport { FA } from 'tonva';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskRate } from './CTaskRate';\nimport { TaskCheckItem } from '../model';\n\nexport class VTaskRate extends VTaskView<CTaskRate> {\n\tprotected rateValue: number = 0;\n\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待评价');\n\t}\n\n\tprotected renderCheckItem(item: TaskCheckItem) {\n\t\tlet { key, text, checked, checkInfo } = item;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <label key={key} className=\"flex-grow-1 d-flex mx-3 my-0 align-items-center form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tdata-key={key}\n\t\t\t\tdisabled={!this.controller.allowCheck} />\n\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t<div className={cn}>{content}</div>\n\t\t\t\t{checkInfo && <div className=\"mt-1 ml-3 small\">\n\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t<span className=\"text-info cursor-ponter\" >{checkInfo}</span>\n\t\t\t\t</div>}\n\t\t\t</div>\n\t\t</label>;\n\t}\n\n\tprotected renderOrtherContent() {\n\t\tlet { rateInfo, checkInfo } = this.controller;\n\t\treturn <div>\n\t\t\t{\n\t\t\t\tcheckInfo && <div className=\"px-3 py-2 d-flex align-items-center border-bottom\" >\n\t\t\t\t\t<div className=\"text-muted mr-1 w-5c\">验收意见</div>\n\t\t\t\t\t<div className=\"flex-fill mr-3 \">\n\t\t\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\t\t\ttype=\"text\" step=\"1\" min=\"1\"\n\t\t\t\t\t\tdefaultValue={checkInfo}\n\t\t\t\t\t\tdisabled={true}\n\t\t\t\t\t\t /></div>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t<div className=\"px-3 py-2 d-flex align-items-center border-bottom\" >\n\t\t\t\t<div className=\"text-muted mr-1 w-5c\">评分意见</div>\n\t\t\t\t<div className=\"flex-fill mr-3 \">\n\t\t\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\t\t\ttype=\"text\" step=\"1\" min=\"1\"\n\t\t\t\t\t\tdefaultValue={rateInfo}\n\t\t\t\t\t\tonChange={this.onDiscribeChange}\n\t\t\t\t\t\tonKeyDown={this.onDiscribeKeyDown} /></div>\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprivate onDiscribeChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet v = evt.target.value;\n\t\tif (v.length <= 0)\n\t\t\tv = undefined;\n\t\tthis.controller.updateRateInfo(v);\n\t}\n\n\tprivate onDiscribeKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.controller.checkSaveInfo();\n\t\t}\n\t}\n\n\tprotected renderViewBottom() {\n\t\tlet left = <div>\n\t\t\t<button onClick={() => this.onRate()} className=\"btn btn-success mx-3\">\n\t\t\t\t评价\n\t\t\t</button>\n\t\t</div>;\n\n\t\treturn <div>\n\t\t\t{this.renderOrtherContent()}\n\t\t\t{this.renderValueRadio()}\n\t\t\t<div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t\t{left}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>\n\t\t</div>\n\t}\n\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.rateValue = Number(evt.target.value);\n\t};\n\n\tprotected renderValueRadio(): JSX.Element {\n\t\tlet radios = [\n\t\t\t{ val: 2, text: '卓越' },\n\t\t\t{ val: 1, text: '谢谢' },\n\t\t];\n\n\t\treturn <div className=\"my-3\">\n\t\t\t{radios.map((v, index) => {\n\t\t\t\tlet { val, text } = v;\n\t\t\t\treturn <label key={index} className=\"mb-0 mx-3\">\n\t\t\t\t\t<input className=\"mr-1\" type=\"radio\" value={val}\n\t\t\t\t\t\tdefaultChecked={this.rateValue === val} name={'ratevalue'} onChange={this.onChange} />\n\t\t\t\t\t{text}\n\t\t\t\t</label>\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprivate onRate = async () => {\n\t\tawait this.controller.rateTask(this.rateValue);\n\t\tthis.closePage();\n\t\tlet content = <>评价完成</>;\n\t\tthis.showActionEndPage({ content });\n\t}\n}\n\nexport class VTaskRateDir extends VTaskRate {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { numberFromId } from \"../../../model\";\nimport { CNoteTask } from \"../CNoteTask\";\nimport { VTaskRate, VTaskRateDir } from \"./VRateTask\";\nimport { TaskStateResult, EnumTaskState } from \"../TaskState\";\nimport { TaskCheckItem } from \"../model\";\n\nexport class CTaskRate extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskRate) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskRateDir);\n\t}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: 'rate', isEnd: true}\n\t}\n\n\tasync rateTask(value: number) {\n\t\tthis.rateValueInput = value;\n\t\tawait this.checkSaveInfo();\n\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet obj = this.endContentInput();\n\t\tlet content = JSON.stringify(obj);\n\t\tlet data = {\n\t\t\tgroupFolder: this.owner.currentFold.groupFolder,\n\t\t\tfolder: this.owner.currentFold.folderId,\n\t\t\tnote: numberFromId(noteId),\n\t\t\tvalue: value,\n\t\t\tcontent: content\n\t\t}\n\n\t\tawait this.uqs.notes.RateTask.submit(data);\n\t\tthis.noteItem.state = EnumTaskState.Rated;\n\t\tthis.noteItem.flowContent = content;\n\t\tthis.noteItem.$update = new Date();\n\t\tthis.owner.currentFold.taskUpdateState(this.noteItem);\n\t}\n\n\tasync setRateInfo(item: TaskCheckItem, v:string) {\n\t\tif (v === undefined || v.length === 0) {\n\t\t\tdelete item.rateInfo;\n\t\t}\n\t\telse {\n\t\t\titem.rateInfo = v;\n\t\t}\n\t\tawait this.saveX();\n\t}\n}\n","import React from 'react';\nimport { VBasePage } from './VBasePage';\nimport { CShareTo } from 'notes/CShareTo';\n\nexport class VActions extends VBasePage<CShareTo> {\n\theader() {return '操作'}\n\tcontent() {\n\t\tlet cn = 'px-3 py-2 cursor-pointer bg-white mt-1';\n\t\treturn <div className=\"\">\n\t\t\t<div className=\"text-muted small px-3 py-1 mt-2\">收件人</div>\n\t\t\t<div className=\"border rounded p-3 mb-3\">\n\t\t\t\t{this.renderSelectedContact(this.controller.contacts)}\n\t\t\t</div>\n\t\t\t<div className={cn} onClick={this.controller.onSendOut}>\n\t\t\t\t分享内容\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n","import { CTo } from \"./components\";\nimport { VActions } from \"./views/VActions\";\nimport { CNotes } from \"./CNotes\";\nimport { Query } from \"tonva\";\n\nexport class CShareTo extends CTo {\n\tprivate cNotes:CNotes;\n\tconstructor(cApp:any, cNotes:CNotes) {\n\t\tlet {currentFold} = cNotes;\n\t\tlet {groupFolder, currentNoteItem} = currentFold;\n\t\tsuper(cApp, groupFolder, currentNoteItem);\n\t\tthis.cNotes = cNotes;\n\t}\n\t\n\tprotected get GetContacts(): Query {return this.uqs.notes.GetShareContacts}\n\n\tprotected async sendOut(toList:number[]):Promise<void> {\n\t\tawait this.cNotes.sendNoteTo(toList);\n\t}\n\n\tprotected async afterContactsSelected(): Promise<void> {\n\t\tthis.openVPage(VActions); //, {contacts, noteId: this.currentNoteId});\n\t}\n}\n","import { CUqBase } from \"tapp\";\nimport { VSelectContact, SelectContactOptions } from \"./views\";\nimport { EnumNoteType, initNoteItemObj, NoteItem } from \"./model\";\nimport { CNoteBase } from \"./noteBase\";\nimport { CContainer, CFolderRoot, createCSpace, createCFolder, createCUnitNote } from \"./container\";\nimport { Contact } from \"../model\";\nimport { createCNoteTask } from \"./note\";\nimport { VFolderDropdown, VHomeDropdown, VSpaceDropdown } from \"./views/VNotesDropDown\";\nimport { CNoteText } from \"./note/text\";\nimport { CNoteAssign } from \"./note/assign\";\nimport { CFolderMy } from \"./container/folderMy\";\nimport { CShareTo } from \"./CShareTo\";\nimport { CSpace } from \"./container/space\";\n\nexport class CNotes extends CUqBase {\n\tprotected foldStack: CContainer[];\n\trootFold: CContainer;\n\tcurrentFold: CContainer;\n\tnoteItem: NoteItem;\n\n    protected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.rootFold =this.currentFold = this.newSub(CFolderRoot);\n\t\tthis.foldStack = [];\n\t}\n\n\tnoteItemConverter = (item:NoteItem, queryResults:{[name:string]:any[]}):CNoteBase => {\n\t\tinitNoteItemObj(item);\n\t\tlet cNoteBase = this.createCNoteBase(item);\n\t\tcNoteBase.init(item);\n\t\treturn cNoteBase;\n\t}\n\n\titemChanged(noteItem: NoteItem) {\n\t\tlet folderNoteItem = this.currentFold.itemChanged(noteItem);\n\t\tif (this.foldStack.length > 0) {\n\t\t\tfor (let folder of this.foldStack) {\n\t\t\t\tfolderNoteItem = folder.itemChanged(folderNoteItem)\n\t\t\t}\n\t\t}\n\t}\n\n\topenFolder(foldItem:CContainer) {\n\t\tthis.foldStack.push(this.currentFold);\n\t\tthis.currentFold = foldItem;\n\t\tthis.currentFold.showFolder();\n\t}\n\n\tpopFolder() {\n\t\tthis.currentFold = this.foldStack.pop();\n\t}\n\n\tcreateCNoteBase(noteItem: NoteItem): CNoteBase {\n\t\tswitch (noteItem.type) {\n\t\t\tdefault: throw Error(\"unknown type\");\n\t\t\tcase EnumNoteType.text: return this.createCNoteText();\n\t\t\tcase EnumNoteType.textList: return this.createCNoteList(); \n\t\t\tcase EnumNoteType.textCheckable: return this.createCNoteCheckable(); \n\t\t\tcase EnumNoteType.folder: return createCFolder(this, noteItem);\n\t\t\tcase EnumNoteType.task: return createCNoteTask(this, noteItem); \n\t\t\tcase EnumNoteType.group: debugger; throw Error(\"type group undefined\");\n\t\t\tcase EnumNoteType.groupFolder: return createCSpace(this); \n\t\t\tcase EnumNoteType.unit:  debugger; throw Error(\"type unit undefined\");\n\t\t\tcase EnumNoteType.assign: return new CNoteAssign(this);\n\t\t\tcase EnumNoteType.unitNote: return createCUnitNote(this);\n\t\t}\n\t}\n\n\tprivate createCNoteText(): CNoteText {\n\t\tlet ret = new CNoteText(this);\n\t\tret.createTextContent();\n\t\treturn ret;\n\t}\n\n\tprivate createCNoteList(): CNoteText {\n\t\tlet ret = new CNoteText(this);\n\t\tret.createListContent();\n\t\treturn ret;\n\t}\n\n\tprivate createCNoteCheckable(): CNoteText {\n\t\tlet ret = new CNoteText(this);\n\t\tret.createCheckableContent();\n\t\treturn ret;\n\t}\n\n\tasync load() {\n\t\tawait this.currentFold.load();\n\t}\n\n\tasync refresh() {\n\t\tawait this.currentFold.refresh();\n\t}\n\t/*\n\tasync getNote(id: number): Promise<NoteModel> {\n\t\treturn await this.currentFold.getNote(id);\n\t}\n\t*/\n\n\tasync addNote(folder:number, caption:string, content:string, obj:any, type: EnumNoteType) {\n\t\treturn await this.currentFold.addNote(folder, caption, content, obj, type);\n\t}\n\n\tasync editNote(waiting:boolean, noteItem:NoteItem, caption:string, content:string, obj:any) {\n\t\treturn await this.currentFold.editNote(waiting, noteItem, caption, content, obj);\n\t}\n\n\tasync sendNoteTo(toList:number[]) {\n\t\tlet {groupFolder, currentNoteItem} = this.currentFold;\n\t\tlet {note} = currentNoteItem;\n\t\tlet tos = toList.join('|');\n\t\tawait this.uqs.notes.SendNoteTo.submit({groupFolder, note, tos});\n\t}\n\n\tasync hideNote(note:number, x:number) {\n\t\tawait this.currentFold.hideNote(note, x);\n\t}\n\n\trenderNotesView() {\n\t\treturn this.currentFold.renderListView();\n\t}\n\n\trenderHomeDropDown() {\n\t\tlet vHomeDropdown = new VHomeDropdown(this);\n\t\treturn vHomeDropdown.render();\n\t};\n\n\trenderFolderDropDown() {\n\t\tlet vHomeDropdown = new VFolderDropdown(this);\n\t\treturn vHomeDropdown.render();\n\t};\n\n\trenderSpaceDropDown() {\n\t\tlet vSpaceDropdown = new VSpaceDropdown(this);\n\t\treturn vSpaceDropdown.render();\n\t};\n\n\tshowAddNoteTextPage = () => {\n\t\tlet cNoteText = this.createCNoteText();\n\t\tcNoteText.showAddPage();\n\t}\n\n\tshowAddNoteListPage = () => {\n\t\tlet cNoteText = this.createCNoteList();\n\t\tcNoteText.showAddPage();\n\t}\n\t\n\tshowAddNoteCheckablePage = () => {\n\t\tlet cNoteText = this.createCNoteCheckable();\n\t\tcNoteText.showAddPage();\n\t}\n\n\tshowAddMyFolderPage = () => {\n\t\tlet cFolder = new CFolderMy(this);\n\t\tcFolder.init(undefined);\n\t\tcFolder.showAddPage();\n\t}\n\n\tshowAddGroupPage = () => {\n\t\t//let cGroup = this.newSub(CGroup);\n\t\t//cGroup.showAddPage()\n\t\tlet cGroup = new CSpace(this);\n\t\tcGroup.init(undefined);\n\t\tcGroup.showAddPage();\n\t}\n\n\tshowAddAssignPage = () => {\n\t\tlet cNoteAssign = new CNoteAssign(this);\n\t\tcNoteAssign.init(undefined);\n\t\tcNoteAssign.showAddPage();\n\t}\n\t\n\tasync showShareTo() {\n\t\t//this.noteItem = noteItem;\n\t\t/*\n\t\tlet ret = await this.uqs.notes.GetMyContacts.page(\n\t\t\t{\n\t\t\t\tgroupFolder: this.currentFold.groupFolder\n\t\t\t}, 0, 50, true);\n\t\tthis.groupMembers = ret.$page;\n\t\tthis.openVPage(VTo, backPageCount);\n\t\t*/\n\t\t//let {groupFolder} = this.currentFold;\n\t\t//let {note} = noteItem;\n\t\t/*\n\t\tlet props: CToProps = {\n\t\t\tcurrentGroupFolder: groupFolder,\n\t\t\tonAfterContactsSelected: async () => {\n\t\t\t\tthis.openVPage(VActions); //, {contacts, noteId: this.currentNoteId});\n\t\t\t},\n\t\t\tsendOut: async (toList: number[]) => {\n\t\t\t\tlet tos = toList.join('|');\n\t\t\t\tawait this.uqs.notes.SendNoteTo.submit({groupFolder, note, tos});\n\t\t\t},\n\t\t};\n\t\tlet cTo = new CTo(this.cApp, props);\n\t\tawait cTo.start();\n\t\t*/\n\t\tlet cShareTo = new CShareTo(this.cApp, this);\n\t\tawait cShareTo.start();\n\t}\n\n\t/*\n\tshowSentPage() {\n\t\tthis.openVPage(VSent);\n\t}\n\t*/\n\n\tasync callSelectContact(options: SelectContactOptions): Promise<Contact[]> {\n\t\treturn await this.vCall(VSelectContact, options);\n\t}\n\n\t/*\n\tshowAssignTaskPage() {\n\t\tlet cNoteTask = createCNoteTask(this, this.noteItem); // this.newSub(CNoteTask);\n\t\tcNoteTask.init(this.noteItem);\n\t\tcNoteTask.showAssignTaskPage();\n\t}\n\t*/\n}\n","import { CNotes } from '../CNotes';\nimport { CSpace } from './space';\nimport { CFolder } from './CFolder';\nimport { NoteItem } from '../model';\nimport { CFolderMy } from './folderMy';\nimport { CFolderShare } from './folderShare';\n\nexport { CContainer } from './CContainer';\nexport { CFolderRoot } from './folderRoot';\n\nexport * from './unitNote';\n\nexport function createCSpace(cNotes: CNotes): CSpace { \n\treturn new CSpace(cNotes);\n}\n\nexport function createCFolder(cNotes: CNotes, noteItem: NoteItem): CFolder {\n\tif (cNotes.isMe(noteItem.owner) === true) {\n\t\treturn new CFolderMy(cNotes);\n\t}\n\telse {\n\t\treturn new CFolderShare(cNotes);\n\t}\n}\n","import { CNotes } from '../../CNotes';\nimport { NoteItem } from '../../model';\nimport { CNoteTask } from './CNoteTask';\nimport { EnumTaskState } from './TaskState';\nimport { CTaskStart } from './start';\nimport { CTaskDone } from './done';\nimport { CTaskCanceled } from './canceled';\nimport { CTaskPass } from './pass';\nimport { CTaskFail } from './fail';\nimport { CTaskRated } from './rated';\nimport { CTaskCheck } from './check';\nimport { CTaskRate } from './rate';\n\nexport function createCNoteTask(cNotes: CNotes, noteItem: NoteItem): CNoteTask {\n\tswitch (noteItem.state) {\n\t\tdefault:\n\t\tcase EnumTaskState.Start:\n\t\t\treturn new CTaskStart(cNotes);\n\t\tcase EnumTaskState.Done:\n\t\t\tif (noteItem && cNotes.isMe(noteItem.obj.checker)) {\n\t\t\t\treturn new CTaskCheck(cNotes);\n\t\t\t}\n\t\t\treturn new CTaskDone(cNotes);\n\t\tcase EnumTaskState.Pass:\n\t\t\tif (noteItem && cNotes.isMe(noteItem.obj.rater)) {\n\t\t\t\treturn new CTaskRate(cNotes);\n\t\t\t}\n\t\t\treturn new CTaskPass(cNotes);\n\t\tcase EnumTaskState.Fail:\n\t\t\treturn new CTaskFail(cNotes);\n\t\tcase EnumTaskState.Rated:\n\t\t\treturn new CTaskRated(cNotes);\n\t\tcase EnumTaskState.Canceled:\n\t\t\treturn new CTaskCanceled(cNotes);\n\t}\n}\n","import { CNotes } from \"notes/CNotes\";\nimport { CUniteNote } from \"./CUnitNote\";\n\nexport function createCUnitNote(cNotes: CNotes): CUniteNote { \n\treturn new CUniteNote(cNotes);\n}\n","import React from 'react';\nimport { VPage, Page } from 'tonva';\nimport { CHome } from './CHome';\n\nexport class VHome extends VPage<CHome> {\n\trender() {\n\t\tlet {cNotes: cNodes} = this.controller;\n\t\tlet right = this.controller.cNotes.renderHomeDropDown();\n\t\treturn <Page header={this.t('home')} right={right}>\n\t\t\t{cNodes.renderNotesView()}\n\t\t</Page>;\n\t}\n}\n","import { CUqBase } from \"tapp\";\nimport { CNotes } from \"../notes\";\nimport { VHome } from \"./VHome\";\n\nexport class CHome extends CUqBase {\n\tcNotes: CNotes;\n\n  \tprotected async internalStart() {\n\t}\n\n\tasync refresh() {\n\t\tawait this.cNotes.refresh();\n\t}\n\n\tinit() {\n\t\tthis.cNotes = this.newC(CNotes);\n\t}\n\n\ttab = () => this.renderView(VHome);\n\n\tasync load() {\n\t\tawait this.cNotes.load();\n\t}\n}\n","import React from \"react\";\nimport { CRelation } from \"./CRelation\";\nimport { VPage, SearchBox, userApi, Image, FA, Muted } from \"tonva\";\nimport { observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport class VAdd extends VPage<CRelation> {\n\t@observable private hasError = false;\n\t@observable private user:{id:number, name:string, nick:string, icon:string};\n\n\theader() {\n\t\treturn <div className=\"w-100 mr-1 d-flex\">\n\t\t\t<SearchBox className=\"flex-fill\" \n\t\t\t\tonSearch={this.onSearch} \n\t\t\t\tonFocus={this.onFocus}\n\t\t\t\tplaceholder=\"搜索联系人\" />\n\t\t\t<button className=\"btn btn-sm btn-outline-info ml-1\" onClick={()=>this.closePage()}>取消</button>\n\t\t</div>;\n\t}\n\n\tprivate onSearch = async (key:string) => {\n\t\tlet ret = await userApi.fromKey(key);\n\t\tif (!ret) {\n\t\t\tthis.hasError = true;\n\t\t\treturn;\n\t\t}\n\t\tif (this.controller.isMe(ret.id)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.user = ret;\n\t}\n\n\tprivate onFocus = () => {\n\t\tthis.hasError = false;\n\t}\n\n\tprivate onAddContact = async () => {\n\t\tawait this.controller.AddContact(this.user.id);\n\t\tthis.closePage();\n\t}\n\n\tcontent() {\n\t\tlet c = observer(() => {\n\t\t\tif (this.hasError === true) {\n\t\t\t\treturn <div className=\"p-4\">\n\t\t\t\t\t<FA className=\"text-danger mr-2\" name=\"times-circle\" />\n\t\t\t\t\t<Muted>账号不存在或者不接受邀请</Muted>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tif (!this.user) return;\n\n\t\t\tlet {name, nick, icon} = this.user;\n\t\t\tlet div:any;\n\t\t\tif (nick) {\n\t\t\t\tdiv =  <div>\n\t\t\t\t\t<div><b>{nick}</b></div>\n\t\t\t\t\t<div>{name}</div>\n\t\t\t\t</div>;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdiv = <div><b>{name}</b></div>\n\t\t\t}\n\t\t\treturn <div className=\"my-3 mx-3 border rounded\">\n\t\t\t\t<div className=\"p-4 d-flex bg-white rounded-top\">\n\t\t\t\t\t<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />\n\t\t\t\t\t{div}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"py-3 px-4\">\n\t\t\t\t\t<button className=\"btn btn-primary\" onClick={this.onAddContact}>增加</button>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t});\n\t\treturn React.createElement(c);\n\t}\n}","import React from 'react';\nimport { CRelation } from './CRelation';\nimport { VPage, FA, List, UserView, User, Image } from 'tonva';\nimport { VAdd } from './VAdd';\nimport { Contact } from 'model';\n\nexport class VRelation extends VPage<CRelation> {\n\theader() {return this.t('relation')}\n\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-primary mr-1\" onClick={()=>this.openVPage(VAdd)}>\n\t\t\t<FA name=\"user-plus\" />\n\t\t</button>;\n\t}\n\n\tcontent() {\n\t\treturn <div className=\"\">\n\t\t\t<List items={this.controller.contacts} item={{render: this.renderContact}} />\n\t\t</div>\n\t}\n\n\tprivate renderContact = (item:Contact, index:number) => {\n\t\tlet {contact, assigned} = item;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <div className=\"px-3 py-2 cursor-pointer\" onClick={()=>this.controller.onShowContact(item)}>\n\t\t\t\t<Image className=\"w-2c h-2c mr-3\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</div>\n\t\t}\n\t\treturn <UserView user={contact} render={renderUser} />;\n\t}\n}\n","import React from \"react\";\r\nimport { CContact } from \"./CContact\";\r\nimport { VPage, UserView, Image, FA, Muted, User } from \"tonva\";\r\nimport { observer } from \"mobx-react\";\r\n\r\nexport class VContact extends VPage<CContact> {\r\n\r\n\tinit(param:any) {\r\n\t}\r\n\r\n\theader() {\r\n\t\treturn ' ';\r\n\t}\r\n\r\n\tprivate onEditAlias = () => {\r\n\t\tthis.controller.onEditAssigned();\r\n\t}\r\n\r\n\tcontent() {\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {id, name, nick, icon} = user;\r\n\t\t\tlet { assigned } = this.controller.contact;\r\n\t\t\treturn <div className=\"p-3 d-flex\">\r\n\t\t\t\t<Image className=\"w-3c h-3c mr-4\" src={icon || '.user-o'} />\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className=\"h6\"><b>{assigned || nick || name}</b></div>\r\n\t\t\t\t\t<div><Muted>id: </Muted>{id}</div>\r\n\t\t\t\t\t<div><Muted>用户名: </Muted>{name}</div>\r\n\t\t\t\t\t{nick && <div><Muted>别名: </Muted>{nick}</div>}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t}\r\n\t\tlet { contact } = this.controller.contact;\r\n\t\tlet cn = 'px-3 py-2 bg-white d-flex align-items-center border-bottom cursor-pointer';\r\n\t\treturn <div>\r\n\t\t\t<UserView user={contact as number} render={renderUser} />\r\n\t\t\t{\r\n\t\t\t\tReact.createElement(observer(() =>\r\n\t\t\t\t<div className={cn}  onClick={this.onEditAlias}>\r\n\t\t\t\t\t<div className=\"text-muted mr-3 w-4c\">备注名</div>\r\n\t\t\t\t\t<div className=\"flex-fill w-100 border-0 form-control mr-auto\">{this.controller.contact.assigned || <Muted>[无]</Muted>}</div>\r\n\t\t\t\t\t<FA name=\"angle-right\" />\r\n\t\t\t\t</div>))\r\n\t\t\t}\r\n\t\t</div>;\r\n\t}\r\n}","import React from \"react\";\nimport { CContact } from \"./CContact\";\nimport { VPage } from \"tonva\";\nimport { observable, computed } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport class VEditAssigned extends VPage<CContact> {\n\t@observable private assigned:string;\n\n\tinit(param?:any) {\n\t\tthis.assigned = this.controller.contact?.assigned;\n\t}\n\n\t@computed protected get btnSaveDisabled():boolean {\n\t\treturn this.assigned === this.controller.contact.assigned;\n\t}\n\n\theader() {\n\t\treturn '编辑';\n\t}\n\n\tright():JSX.Element {\n\t\treturn React.createElement(observer(() => <>\n\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\tclassName=\"btn btn-sm btn-success mr-1\" disabled={this.btnSaveDisabled}>\n\t\t\t\t保存\n\t\t\t</button>\n\t\t</>));\n\t}\n\n\tprotected onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.assigned = evt.target.value.trim();\n\t}\n\n\tprivate onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tif (!this.btnSaveDisabled) {\n\t\t\t\tthis.onButtonSave();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tthis.controller.SaveContactAssign(this.assigned);\n\t\tthis.closePage();\n\t}\n\n\tcontent() {\n\t\treturn <div className=\"border rounded\">\n\t\t\t<div className=\"bg-white\">\n\t\t\t\t<div className=\"px-3 py-2 bg-white d-flex align-items-center border-bottom\">\n\t\t\t\t\t<div className=\"text-muted mr-3 w-4c\">备注名</div>\n\t\t\t\t\t<input type=\"text\" className=\"flex-fill w-100 border-0 form-control\" maxLength={80}\n\t\t\t\t\t\tautoFocus={true}\n\t\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\t\tonKeyDown={this.onKeyDown}\n\t\t\t\t\t\tdefaultValue={this.assigned} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t}\n}","import { CUqSub } from \"tapp\"\r\nimport { observable } from \"mobx\";\r\nimport { Contact } from \"model\";\r\nimport { CRelation } from \"../CRelation\";\r\nimport { VContact } from \"./VContact\";\r\nimport { VEditAssigned } from \"./VEditAssigned\";\r\n\r\nexport class CContact extends CUqSub<CRelation> {\r\n\tprotected async internalStart() {}\r\n\t@observable contact: Contact;\r\n\r\n\tinit(param:Contact):void {\r\n\t\tthis.contact = {...param};\r\n\t}\r\n\r\n\tasync SaveContactAssign(value:string) {\r\n\t\tawait this.owner.SaveContactAssign(this.contact, value);\r\n\t\tthis.contact.assigned = value;\r\n\t}\r\n\r\n\tasync showContact() {\r\n\t\tthis.openVPage(VContact);\r\n\t}\r\n\r\n\tasync onEditAssigned() {\r\n\t\tthis.openVPage(VEditAssigned);\r\n\t}\r\n}","import { CUqBase } from \"tapp\";\nimport { VRelation } from \"./VRelation\";\nimport { observable } from \"mobx\";\nimport { Contact } from \"model\";\nimport { CContact } from \"./contact\";\n\nexport class CRelation extends CUqBase {\n\tprivate loaded: boolean = false;\n\t@observable contacts: Contact[] = [];\n\n    protected async internalStart() {\n\t}\n\n\ttab = () => this.renderView(VRelation);\n\n\tload = async () => {\n\t\tif (this.loaded === true) return;\n\t\tlet ret = await this.uqs.notes.GetMyContacts.page({}, 0, 500, true);\n\t\tthis.contacts.push(...ret['$page']);\n\t\tthis.loaded = true;\n\t}\n\n\tasync AddContact(contact: number) {\n\t\tawait this.uqs.notes.AddContact.submit({contact});\n\t\tthis.contacts.unshift({contact, assigned:undefined});\n\t}\n\n\tasync onShowContact(item:Contact) {\n\t\tlet cc = this.newSub(CContact, item);\n\t\tcc.showContact();\n\t}\n\n\tasync SaveContactAssign(item:Contact, value:string) {\n\t\tlet param = {contact:item.contact, assigned:value};\n\t\tawait this.uqs.notes.SetContactAssinged.submit(param);\n\t\tlet c = this.contacts.find(v=>v.contact === item.contact);\n\t\tif (c !== undefined) {\n\t\t\tc.assigned = value;\n\t\t}\n\t}\n}\n","import { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport React from 'react';\nimport { VPage, userApi, User, Image, Page } from \"tonva\";\nimport { CMe } from \"./CMe\";\n\nexport class VAdmin extends VPage<CMe> {\n\theader() {return '管理员'}\n\tcontent() {\n\t\treturn <div>\n\t\t\t<div className=\"px-3 py-3 bg-white border-bottom\">\n\t\t\t\t<div><b className=\"text-info\">为用户创建机构</b></div>\n\t\t\t\t<div>\n\t\t\t\t\t给指定用户创建机构。机构下面的部门和成员，由机构所有者创建。\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-2\">\n\t\t\t\t\t<button className=\"btn btn-primary\" onClick={()=>this.openVPage(VUser)}>创建</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n\nclass VUser extends VPage<CMe> {\n\t@observable private hasError = false;\n\t@observable private user:{id:number, name:string, nick:string, icon:string};\n\t@observable private inputName: string;\n\n\theader() {return '机构所有者'}\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet vError:any;\n\t\t\tif (this.hasError===true)\n\t\t\t\tvError = <div className=\"my-3 text-danger\">用户不存在！</div>;\n\t\t\treturn <div className=\"m-3\">\n\t\t\t\t<div>\n\t\t\t\t\t<input type=\"text\" className=\"form-control\"  maxLength={100}\n\t\t\t\t\t\tplaceholder=\"用户\"\n\t\t\t\t\t\tonFocus={()=>this.hasError = false}\n\t\t\t\t\t\tonKeyDown={this.onKeyDown}\n\t\t\t\t\t\tonChange={this.onChange}/>\n\t\t\t\t</div>\n\t\t\t\t{vError}\n\t\t\t\t<div className=\"my-2\">\n\t\t\t\t\t<button className=\"btn btn-primary\" disabled={this.inputName?.trim().length===0}\n\t\t\t\t\t\tonClick={this.onNext}>下一步</button>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate onKeyDown = async (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tthis.hasError = false;\n\t\tif (evt.keyCode === 13) {\n\t\t\tawait this.onNext();\n\t\t}\n\t}\n\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.inputName = evt.currentTarget.value;\n\t}\n\n\tprivate onNext = async () => {\n\t\tawait this.search(this.inputName.trim());\n\t\tif (this.hasError === false) {\n\t\t\tthis.controller.unitOwner = this.user as User;\n\t\t\tthis.openVPage(VUnit);\n\t\t}\n\t}\n\n\tprivate search = async (key:string) => {\n\t\tlet ret = await userApi.fromKey(key);\n\t\tif (!ret) {\n\t\t\tthis.hasError = true;\n\t\t\treturn;\n\t\t}\n\t\t// if (this.controller.isMe(ret.id)) {\n\t\t//\treturn;\n\t\t//}\n\t\tthis.user = ret;\n\t}\n}\n\nclass VUnit extends VPage<CMe> {\n\t@observable private input: string;\n\n\theader() {return '新建机构'}\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {unitOwner} = this.controller;\n\t\t\tlet {icon, name, nick} = unitOwner;\n\t\t\treturn <div className=\"m-3\">\n\t\t\t\t<div className=\"my-2\">所有者: <Image className=\"w-2c h-2c\" src={icon} /> {nick ?? name} </div>\n\t\t\t\t<div>\n\t\t\t\t\t<input type=\"text\" className=\"form-control\" maxLength={100}\n\t\t\t\t\t\tplaceholder=\"机构名称\" onChange={this.onChange}/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-2\">\n\t\t\t\t\t<button className=\"btn btn-primary\" disabled={this.input?.trim().length===0}\n\t\t\t\t\t\tonClick={this.onCreate}>创建机构</button>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.input = evt.currentTarget.value;\n\t}\n\n\tprivate onCreate = async () => {\n\t\tlet unitId = await this.controller.createUnit({\n\t\t\tname: this.input.trim(),  \n\t\t\tcontent: undefined,\n\t\t\towner: this.controller.user.id\n\t\t});\n\t\tif (unitId > 0) {\n\t\t\tthis.openPageElement(<Page header=\"成功\" afterBack={()=>this.closePage(3)} back=\"close\">\n\t\t\t\t<div className=\"m-3 text-success\">机构创建成功！</div>\n\t\t\t</Page>)\n\t\t}\n\t\telse {\n\t\t\tthis.openPageElement(<Page header=\"错误\" afterBack={()=>this.closePage(3)} back=\"close\">\n\t\t\t\t<div className=\"m-3 text-danger\">机构创建时错误！</div>\n\t\t\t</Page>)\n\t\t}\n\t}\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport {\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\n    Edit, UiSchema, VPage\n} from 'tonva';\nimport { CMe } from './CMe';\n\nexport class VEditMe extends VPage<CMe>{\n\n    async open(param: any) {\n        this.openPage(this.page);\n    }\n\n    private schema: ItemSchema[] = [\n        { name: 'nick', type: 'string' } as StringSchema,\n        { name: 'icon', type: 'image' } as ImageSchema,\n    ];\n    private uiSchema: UiSchema = {\n        items: {\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\n        }\n    }\n    @observable private data: any;\n\n    constructor(props: any) {\n        super(props);\n        let { nick, icon } = nav.user;\n        this.data = {\n            nick: nick,\n            icon: icon,\n        };\n    }\n\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\n        let { name } = itemSchema;\n        await userApi.userSetProp(name, newValue);\n        this.data[name] = newValue;\n        nav.user.name = newValue;\n        nav.saveLocalUser();\n    }\n\n    private page = () => {\n\t\tlet { schema, uiSchema, data, onItemChanged } = this;\n\t\tlet vAdmin: any;\n\t\t\n\t\tlet { role } = this.controller;\n\t\tif ((role & 2) === 2) {\n\t\t\tvAdmin = <div className=\"px-3 py-2 cursor-pointer bg-white border-bottom\" onClick={this.controller.showAdmin}>管理员</div>;\n\t\t}\n\n        return <Page header=\"个人信息\">\n            <Edit schema={schema} uiSchema={uiSchema}\n                data={data}\n                onItemChanged={onItemChanged} />\n\t\t\t{vAdmin}\n        </Page>;\n    }\n}\n\nexport const webUserSchema: ItemSchema[] = [\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\n    { name: 'gender', type: 'string' } as StringSchema,\n    { name: 'salutation', type: 'string' } as StringSchema,\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\n    { name: 'departmentName', type: 'string' } as StringSchema,\n];\n\n","import React from 'react';\nimport { CMe } from './CMe';\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop } from 'tonva';\nimport { observer } from 'mobx-react';\nimport { appConfig } from 'tapp';\n\nexport class VMe extends VPage<CMe> {\n\theader() {return this.t('me')}\n\n\tcontent() {\n        const { user } = nav;\n        let aboutRows: Prop[] = [\n            '',\n            {\n                type: 'component',\n                component: <div className=\"w-100 d-flex justify-content-between\">\n                    <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text={this.t('aboutTheApp')} />\n                    <div className=\"py-2 small\">V{appConfig.version}</div>\n                </div>,\n            }\n        ];\n\n        let rows: Prop[];\n        if (user === undefined) {\n            rows = aboutRows;\n            rows.push(\n                {\n                    type: 'component',\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.logout()}>\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\n                    </button>\n                },\n            );\n        }\n        else {\n            let logOutRows: Prop[] = [\n                '',\n                {\n                    type: 'component',\n                    bk: '',\n                    component: <button className=\"btn btn-danger w-100\" onClick={this.onExit}>\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\n                </button>\n                },\n            ];\n\n            rows = [\n                '',\n                {\n                    type: 'component',\n                    component: <this.meInfo />\n                },\n                '',\n                {\n                    type: 'component',\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text={this.t('changePassword')} />,\n                    onClick: this.changePassword\n                },\n            ]\n            rows.push(...aboutRows, ...logOutRows);\n        }\n        return <PropGrid rows={[...rows]} values={{}} />;\n\t}\n\n\tprivate onExit = () => {\n        nav.showLogout();\n    }\n\n    private changePassword = async () => {\n        await nav.changePassword();\n    }\n\n    private meInfo = observer(() => {\n        let { user } = nav;\n        if (user === undefined) return null;\n        let { id, name, nick, icon } = user;\n        return <LMR className=\"py-2 cursor-pointer w-100\"\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />}\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\n            onClick={this.controller.showEditMe}>\n            <div>\n                <div>{userSpan(name, nick)}</div>\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\n            </div>\n        </LMR>;\n    });\n}\n\nfunction userSpan(name: string, nick: string): JSX.Element {\n    return nick ?\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\n        : <b>{name}</b>\n}\n","import { CUqBase } from \"tapp\";\nimport { User } from \"tonva\";\nimport { VAdmin } from \"./VAdmin\";\nimport { VEditMe } from \"./VEditMe\";\nimport { VMe } from \"./VMe\";\n\nexport class CMe extends CUqBase {\n\trole: number;\n\tunitOwner: User;\n\n    protected async internalStart() {\n\t}\n\n\ttab = () => this.renderView(VMe);\n\n\tshowEditMe = async () => {\n\t\tlet result = await this.uqs.notes.GetSystemRole.query({});\n\t\tthis.role = result.ret[0]?.role;\n\t\tthis.openVPage(VEditMe);\n\t}\n\n\tshowAdmin = async () => {\n\t\tthis.openVPage(VAdmin);\n\t}\n\n\tasync createUnit(param: {name:string; content:string; owner:number}): Promise<number> {\n\t\tlet result = await this.uqs.notes.CreateUnit.submit(param);\n\t\treturn result.id;\n\t}\n}\n","import { Tuid, Query, Action/*, Map, Sheet, Tag*/ } from \"tonva\";\n\nexport enum EnumSpecFolder {notes=1};\n\nexport interface Notes {\n\tNote: Tuid;\n\n\tAddNote: Action;\n\tSetNote: Action;\n\tSetNoteX: Action;\n\tSendNoteTo: Action;\n\tHideNote: Action;\n\tAddContact: Action;\n\tSetContactAssinged: Action;\n\tAssignTask: Action;\n\n\tDoneTask: Action;\n\tCheckTask: Action;\n\tRateTask: Action;\n\n\tAddComment: Action;\n\n\tAddGroup: Action;\n\tSetGroup: Action;\n\n\t$Poked: Query;\n\tGetNotes: Query;\n\tGetMyContacts: Query;\n\tGetNote: Query;\n\tGetNoteItemFromId: Query;\n\tGetShareContacts: Query;\n\tGetSpawnContacts: Query;\n\tGetAssignToContacts: Query;\n\n\tAddGroupMember: Action;\n\tRemoveGroupMember: Action;\n\tGetGroupFolderMemberCount: Query;\n\tGetGroupMembers: Query;\n\tGetGroupContacts: Query;\n\n\tGetBookProjects: Query;\n\tGetProjectFlow: Query;\n\tGetProjectYearSum: Query;\n\tGetProjectMonthSum: Query;\n\tGetProjectDaySum: Query;\n\n\tInitMySetting: Action;\n\tCreateUnit: Action;\n\tGetSystemRole: Query;\n};\n\nexport interface UQs {\n    notes: Notes\n}\n","import React from 'react';\nimport { CDiscover } from './CDiscover';\nimport { VPage, LMR, FA } from 'tonva';\n\ninterface Item {\n\ticon: string;\n\tcaption: string;\n\tonClick: () => void;\n}\n\nexport class VDiscover extends VPage<CDiscover> {\n\tprivate onTaskReport = () => {\n\t\talert('实现中');\n\t}\n\n\tprivate onOtherReport = () => {\n\t\talert('实现中');\n\t}\n\n\tprivate items:(Item|string)[] = [\n\t\t{icon: undefined, caption: '任务报表', onClick: this.onTaskReport}, \n\t\t{icon: undefined, caption: '其它报表', onClick: this.onOtherReport}, \n\t\t'-',\n\t\t{icon: undefined, caption: '任务报表', onClick: this.onTaskReport}, \n\t\t{icon: undefined, caption: '其它报表', onClick: this.onOtherReport}, \n\t];\n\n\theader() {return this.t('discover')}\n\tcontent() {\n\t\tlet cn = 'px-3 py-2 cursor-pointer bg-white mb-1';\n\t\tlet right = <FA name=\"angle-right\" />;\n\t\treturn <div className=\"py-3\">\n\t\t\t{this.controller.cBook.renderBook()}\n\n\t\t\t{this.items.map((v, index) => {\n\t\t\t\tif (typeof v === 'string') {\n\t\t\t\t\treturn <div key={index} className=\"pt-2\" />;\n\t\t\t\t}\n\t\t\t\tlet {icon, caption, onClick} = v;\n\t\t\t\tlet left = <FA name={icon} />;\n\t\t\t\treturn <LMR key={index} className={cn} onClick={onClick} left={left} right={right}>\n\t\t\t\t\t{caption}\n\t\t\t\t</LMR>\n\t\t\t})}\n\t\t</div>;\n\t}\n}\n","import React from 'react';\nimport { View, FA } from \"tonva\";\nimport { CBook, ProjectSum } from './CBook';\n\nexport class VBook extends View<CBook> {\n\trender() {\n\t\tlet {projectSums} = this.controller;\n\t\tif (projectSums.length === 0) return;\n\t\treturn <div className=\"px-3 mb-3 border-top\">\n\t\t\t{projectSums.map(v => { \n\t\t\t\t//let {id, name, debitYear, creditYear, debitMonth, creditMonth, debitWeek, creditWeek, debitDay, creditDay} = v;\n\t\t\t\tlet {id, name, debitMonth, debitWeek, debitDay} = v;\n\t\t\t\treturn <div key={id} className=\"row py-3 align-items-end border-bottom bg-white cursor-pointer\"\n\t\t\t\t\tonClick={() => this.onProject(v)}>\n\t\t\t\t\t<div className=\"col text-center\">{name}</div>\n\t\t\t\t\t{this.renderNumber('今天', debitDay)}\n\t\t\t\t\t{this.renderNumber('本周', debitWeek)}\n\t\t\t\t\t{this.renderNumber('本月', debitMonth)}\n\t\t\t\t\t<div className=\"mx-3\">\n\t\t\t\t\t\t<FA name=\"angle-right\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>;\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprivate renderNumber(caption:string, num:number) {\n\t\treturn <div className=\"text-center col\">\n\t\t\t<small className=\"text-muted\">{caption}</small><br/>\n\t\t\t<span>{num ?? 0}</span>\n\t\t</div>\n\t}\n\n\tprivate onProject = async (projectSum:ProjectSum) => {\n\t\tawait this.controller.showProjectFlow(projectSum);\n\t}\n}\n","import React from 'react';\nimport { CBook, ProjectFlowItem, ProjectSum } from './CBook';\nimport { VPage, List, EasyTime, FA } from 'tonva';\n\nexport class VFlow extends VPage<CBook> {\n\tprivate projectSum: ProjectSum;\n\tinit(param: ProjectSum) {\n\t\tthis.projectSum = param;\n\t}\n\n\theader() {return '明细 - ' + this.projectSum.name}\n\n\tcontent() {\n\t\treturn <div>\n\t\t\t<div className=\"px-3 py-2 d-flex\">\n\t\t\t\t<div className=\"w-8c\">日期</div>\n\t\t\t\t<div className=\"w-5c text-right\"><FA name=\"plus\"/></div>\n\t\t\t\t<div className=\"w-5c text-right\"><FA name=\"minus\"/></div>\n\t\t\t</div>\n\t\t\t<List\n\t\t\t\titems={this.controller.projectDetailPager}\n\t\t\t\titem={{render: this.renderFlowItem}}/>\n\t\t</div>;\n\t}\n\n\tprivate renderFlowItem = (flowItem:ProjectFlowItem) => {\n\t\tlet {stamp, memo, debit, credit} = flowItem;\n\t\treturn <div className=\"px-3 py-2 d-flex cursor-pointer\" onClick={()=>this.controller.showFlowItem(flowItem)}>\n\t\t\t<div className=\"w-8c\"><EasyTime date={stamp} /></div>\n\t\t\t<div className=\"w-5c text-right\">{debit}</div>\n\t\t\t<div className=\"w-5c text-right\">{credit}</div>\n\t\t\t<div className=\"ml-5\">{memo}</div>\n\t\t</div>;\n\t}\n}\n","import { CUqBase } from \"tapp\";\nimport { initNoteItemObj, NoteItem } from \"notes/model\";\nimport { VBook } from \"./VBook\";\nimport { QueryPager } from \"tonva\";\nimport { VFlow } from \"./VFlow\";\n\nexport interface ProjectSum {\n\tid: number;\n\tname: string;\n\tdebitYear: number;\n\tcreditYear: number;\n\tdebitMonth: number;\n\tcreditMonth: number;\n\tdebitWeek: number;\n\tcreditWeek: number;\n\tdebitDay: number;\n\tcreditDay: number;\n\th8: number;\n}\n\nexport interface ProjectFlowItem {\n\tproject: number;\n\tstamp: Date;\n\tdebit: number;\n\tcredit: number;\n\tmemo: string;\n\tnote: number; \t\t// 关联的Note\n}\n\nexport class CBook extends CUqBase {\n\tprojectSums: ProjectSum[];\n\tprojectDetailPager: QueryPager<ProjectFlowItem>;\n\n    protected async internalStart() {\n\t}\n\n\tasync loadBookProjects() {\n\t\tlet ret = await this.uqs.notes.GetBookProjects.query({user: this.user.id, at: undefined}, true);\n\t\tthis.projectSums = ret.ret;\n\t}\n\n\trenderBook() {\n\t\treturn this.renderView(VBook);\n\t}\n\n\tasync showProjectFlow(projectSum: ProjectSum) {\n\t\tthis.projectDetailPager = new QueryPager(this.uqs.notes.GetProjectFlow);\n\t\tthis.projectDetailPager.first({project: projectSum.id});\n\t\tthis.openVPage(VFlow, projectSum);\n\t}\n\n\tasync showFlowItem(projectFlowItem: ProjectFlowItem) {\n\t\tlet {note} = projectFlowItem;\n\t\tlet ret = await this.uqs.notes.GetNoteItemFromId.query({note});\n\t\tlet noteItem:NoteItem = ret.ret[0];\n\t\tinitNoteItemObj(noteItem);\n\t\tlet cNote = this.cApp.cHome.cNotes.createCNoteBase(noteItem);\n\t\tcNote.init(noteItem);\n\t\tcNote.showViewPage();\n\t}\n}\n","import { CUqBase } from \"tapp\";\nimport { VDiscover } from \"./VDiscover\";\nimport { CBook } from \"book\";\n\nexport class CDiscover extends CUqBase {\n\tcBook: CBook;\n\n    protected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.cBook = this.newC(CBook);\n\t\treturn;\n\t}\n\n\tloadBookProjects = async () => {\n\t\tawait this.cBook.loadBookProjects();\n\t}\n\n\ttab = () => this.renderView(VDiscover);\n\n}\n","import React from 'react';\nimport { CApp } from \"./CApp\";\nimport { VPage } from \"tonva\";\n\nexport class VTestMe extends VPage<CApp> {\n\theader() {return 'VTestMe'}\n\tcontent() {\n\t\treturn <div>VTestMe</div>;\n\t}\n}\n","import React from 'react';\nimport { CApp } from \"./CApp\";\nimport { VPage } from \"tonva\";\nimport { VTestMe } from './VTestMe';\n\nexport class VTestAB extends VPage<CApp> {\n\theader() {return 'VTestAB'}\n\tcontent() {\n\t\treturn <div>\n\t\t\tVTestAB\n\t\t\t<button onClick={()=>this.go(()=>this.openVPage(VTestMe), '/bbbb/cccc')}>To Me</button>\n\t\t</div>;\n\t}\n}\n","import { zh } from \"./zh\";\nimport { en } from \"./en\";\n\nexport const res = {\n\t$zh: zh,\n\t$en: en,\n}\n","export const zh = {\n\thome: '首页',\n\trelation: '关系',\n\tdiscover: '发现',\n\tme: '我',\n\n\tchangePassword: '修改密码',\n\taboutTheApp: '关于本APP',\n\tlogout: '退出登录',\n\tpleaseLogin: '登录',\n\n\tnotes: '小单',\n\ttask: '任务',\n\tassign: '作业单',\n\n\tnoteSpace: '群',\n\n\tnoteText: '文字单',\n\tnoteList: '列表单',\n\tnoteCheckable: '勾选单',\n\tnoteTask: '派发任务',\n\tnoteFolder: '小单夹',\n\tnoteCreateSpace: '新建群',\n\n\tcontent: '内容',\n}\n","export const en = {\n\thome: 'Home',\n\trelation: 'Relation',\n\tdiscover: 'Discover',\n\tme: 'Me',\n\n\tchangePassword: 'Change password',\n\taboutTheApp: 'About the APP',\n\tlogout: 'Logout',\n\tpleaseLogin: 'Login',\n\n\tnotes: 'Notes',\n\ttask: 'Task',\n\tassign: 'Assign',\n\n\tnoteSpace: 'Group',\n\n\tnoteText: 'Text',\n\tnoteList: 'List',\n\tnoteCheckable: 'Checkable',\n\tnoteTask: 'Task',\n\tnoteFolder: 'Folder',\n\tnoteCreateSpace: 'Create Group',\n\n\tcontent: 'Content',\n}\n","import { CUqApp } from \"./CBase\";\nimport { VMain } from \"./main\";\nimport { CHome } from \"home\";\nimport { CRelation } from \"relation\";\nimport { CMe } from \"me\";\nimport { CDiscover } from \"discover\";\nimport { computed } from \"mobx\";\nimport { Contact } from \"model\";\nimport { VTestMe } from \"./VTestMe\";\nimport { VTestAB } from \"./VTestAB\";\nimport { res } from \"./res\";\n\nconst gaps = [10, 3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60];\n\nexport class CApp extends CUqApp {\n\tprivate timer:any;\n\tcHome: CHome;\n\tcRelation: CRelation;\n\tcDiscover: CDiscover;\n\tcMe: CMe;\n\n\tprotected async internalStart(isUserLogin: boolean) {\n\t\tthis.setRes(res);\n\t\tif (isUserLogin === true) await this.initMySetting();\n\t\tif (this.isRouting === false) await this.startHome();\n\t}\n\n\tprotected async startHome() {\n\t\tthis.cHome = this.newC(CHome);\n\t\tthis.cRelation = this.newC(CRelation);\n\t\tthis.cDiscover = this.newC(CDiscover);\n\t\tthis.cMe = this.newC(CMe);\n\t\tthis.cHome.load();\n\t\tthis.showMain();\n\n\t\tthis.timer = setInterval(this.callTick, 1000);\n\t}\n\n\tprivate async initMySetting() {\n\t\tlet timezone:number = - (new Date()).getTimezoneOffset() / 60;\n\t\tawait this.uqs.notes.InitMySetting.submit({timezone}, true);\n\t}\n\n\tprotected onDispose() {\n\t\tclearInterval(this.timer);\n\t\tthis.timer = undefined;\n\t}\n\n\tprotected async startMe() {\n\t\tthis.openVPage(VTestMe);\n\t}\n\n\tprotected async startAB() {\n\t\tthis.openVPage(VTestAB);\n\t}\n\n\tprotected onRoute() {\n\t\tthis.on({\n\t\t\t'/a/b': () => {\n\t\t\t\t// renderDom(<div>/a/b <button onClick={()=>nav.navigate('/c/d')}>test</button></div>)\n\t\t\t\tthis.startAB();\n\t\t\t},\n\t\t\t'/c/d': () => {\n\t\t\t\t/*\n\t\t\t\trenderDom(<div>\n\t\t\t\t\t/c/d\n\t\t\t\t\t<button onClick={()=>nav.navigate('/eeee/a/1?c=1 & d=3')}>test</button>\n\t\t\t\t</div>)\n\t\t\t\t*/\n\t\t\t},\n\t\t\t'/eeee/:action/:id': (params:any, queryStr:any) => {\n\t\t\t\t/*\n\t\t\t\tlet span:any;\n\t\t\t\tif (queryStr) {\n\t\t\t\t\tspan = <span>{queryStr}</span>\n\t\t\t\t}\n\t\t\t\trenderDom(<div>/e query:{span}  params:{JSON.stringify(params)}</div>)\n\t\t\t\t*/\n\t\t\t},\n\t\t\t'/bbbb/cccc': () => {\n\t\t\t\t//renderCApp(new CAppBBBBCCCC());\n\t\t\t\tthis.startMe();\n\t\t\t},\n\t\t});\n\t\tthis.on(() => {\n\t\t\t//renderCApp(new CApp());\n\t\t\tthis.startHome();\n\t\t});\n\t}\n\n\n\t@computed get contacts(): Contact[] {return this.cRelation.contacts;};\n\n\tasync loadRelation() {\n\t\tawait this.cRelation.load();\n\t}\n\n    private showMain(initTabName?: string) {\n        this.openVPage(VMain, initTabName, this.dispose);\n\t}\n\n\tprivate tick = 0;\n\tprivate gapIndex = 0;\n\tprivate callTick = async () => {\n\t\ttry {\n\t\t\tif (!this.user) return;\n\t\t\t++this.tick;\n\t\t\tif (this.tick<gaps[this.gapIndex]) return;\n\t\t\t//console.error('tick ', new Date());\n\t\t\tthis.tick = 0;\n\t\t\tif (this.gapIndex < gaps.length - 1) ++this.gapIndex;\n\t\t\tlet ret = await this.uqs.notes.$Poked.query(undefined, false);\n\t\t\tlet v = ret.ret[0];\n\t\t\tif (v === undefined) return;\n\t\t\tif (!v.poke) return;\n\t\t\tthis.gapIndex = 1;\n\n\t\t\t// uq 里面加入这一句，会让相应的$Poked查询返回poke=1：\n\t\t\t// TUID [$User] ID (member) SET poke=1;\n\t\t\t// 这个地方重新调入的数据\n\t\t\tthis.cHome.refresh();\n\t\t}\n\t\tcatch {\n\t\t}\n\t}\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport './index.css';\n//import App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport { NavView, start, nav } from 'tonva';\n//import logo from './logo.svg';\nimport './App.css';\nimport { CApp, appConfig } from './tapp';\n//import { CAppAB, CAppCD, CAppBBBBCCCC } from 'tapp/CAppAB';\n\n/*\n(async function() {\n\tfunction renderDom(div:any) {\n\t\tReactDOM.render(\n\t\t\t<React.StrictMode>\n\t\t\t\t{div}\n\t\t\t</React.StrictMode>,\n\t\t\tdocument.getElementById('root')\n\t\t);\n\t}\n\n\tfunction renderCApp(cApp: CAppBase) {\n\t\tconst App: React.FC = () => {\n\t\t\tconst onLogined = async () => {\n\t\t\t\tawait cApp.start();\n\t\t\t}\n\t\t\treturn <NavView onLogined={onLogined} />;\n\t\t}\n\t\trenderDom(<App/>);\n\t}\n\tnav.on({\n\t\t'/a/b': () => {\n\t\t\trenderDom(<div>/a/b <button onClick={()=>nav.navigate('/c/d')}>test</button></div>)\n\t\t},\n\t\t'/c/d': () => {\n\t\t\trenderDom(<div>\n\t\t\t\t/c/d\n\t\t\t\t<button onClick={()=>nav.navigate('/eeee/a/1?c=1 & d=3')}>test</button>\n\t\t\t</div>)\n\t\t},\n\t\t'/eeee/:action/:id': (params:any, queryStr:any) => {\n\t\t\tlet span:any;\n\t\t\tif (queryStr) {\n\t\t\t\tspan = <span>{queryStr}</span>\n\t\t\t}\n\t\t\trenderDom(<div>/e query:{span}  params:{JSON.stringify(params)}</div>)\n\t\t},\n\t\t'/bbbb/cccc': () => {\n\t\t\trenderCApp(new CAppBBBBCCCC());\n\t\t},\n\t});\n\tnav.on(() => {\n\t\trenderCApp(new CApp());\n\t});\n\tawait startRoute(appConfig);\n\n\t// If you want your app to work offline and load faster, you can change\n\t// unregister() to register() below. Note this comes with some pitfalls.\n\t// Learn more about service workers: https://bit.ly/CRA-PWA\n\tserviceWorker.unregister();\n})();\n*/\n\n(async function() {\n\tnav.setSettings(appConfig);\n\t//如果要支持route，必须调用下面这一句\n\t//await startRoute(appConfig);\n\tconst App: React.FC = () => {\n\t\tconst onLogined = async (isUserLogin?:boolean) => {\n\t\t\tawait start(CApp, appConfig, isUserLogin);\n\t\t}\n\t\treturn <NavView onLogined={onLogined} />;\n\t}\n\n\tReactDOM.render(\n\t\t<React.StrictMode>\n\t\t\t<App />\n\t\t</React.StrictMode>,\n\t\tdocument.getElementById('root')\n\t);\n\n\t// If you want your app to work offline and load faster, you can change\n\t// unregister() to register() below. Note this comes with some pitfalls.\n\t// Learn more about service workers: https://bit.ly/CRA-PWA\n\tserviceWorker.unregister();\n})();\n"],"sourceRoot":""}